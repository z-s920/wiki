2022-08-29 20:10:10.958 INFO  org.hibernate.validator.internal.util.Version     :21  
                [32m                  [0;39m HV000001: Hibernate Validator 6.2.3.Final
2022-08-29 20:10:10.996 INFO  com.zs.wikibb.WikibbApplication                   :55  
                [32m                  [0;39m Starting WikibbApplication using Java 1.8.0_221 on LAPTOP-OO2VPQLS with PID 41892 (D:\wikibb\target\classes started by 张硕 in D:\wikibb)
2022-08-29 20:10:10.997 INFO  com.zs.wikibb.WikibbApplication                   :640 
                [32m                  [0;39m No active profile set, falling back to 1 default profile: "default"
2022-08-29 20:10:11.071 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255 
                [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-08-29 20:10:11.072 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255 
                [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-08-29 20:10:14.940 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262 
                [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-08-29 20:10:14.944 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132 
                [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-08-29 20:10:14.981 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201 
                [32m                  [0;39m Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
2022-08-29 20:10:16.581 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108 
                [32m                  [0;39m Tomcat initialized with port(s): 8880 (http)
2022-08-29 20:10:16.606 INFO  org.apache.coyote.http11.Http11NioProtocol        :173 
                [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8880"]
2022-08-29 20:10:16.607 INFO  org.apache.catalina.core.StandardService          :173 
                [32m                  [0;39m Starting service [Tomcat]
2022-08-29 20:10:16.607 INFO  org.apache.catalina.core.StandardEngine           :173 
                [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.60]
2022-08-29 20:10:16.766 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173 
                [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-08-29 20:10:16.766 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290 
                [32m                  [0;39m Root WebApplicationContext: initialization completed in 5693 ms
2022-08-29 20:10:20.413 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58  
                [32m                  [0;39m LiveReload server is running on port 35729
2022-08-29 20:10:20.439 INFO  org.apache.coyote.http11.Http11NioProtocol        :173 
                [32m                  [0;39m Starting ProtocolHandler ["http-nio-8880"]
2022-08-29 20:10:20.461 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220 
                [32m                  [0;39m Tomcat started on port(s): 8880 (http) with context path ''
2022-08-29 20:10:20.492 INFO  com.zs.wikibb.WikibbApplication                   :61  
                [32m                  [0;39m Started WikibbApplication in 11.351 seconds (JVM running for 15.512)
2022-08-29 20:10:20.496 INFO  com.zs.wikibb.WikibbApplication                   :26  
                [32m                  [0;39m 启动成功！！
2022-08-29 20:10:20.496 INFO  com.zs.wikibb.WikibbApplication                   :27  
                [32m                  [0;39m 地址: 	http://127.0.0.1:8880
2022-08-29 20:10:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21564699476889600 [0;39m 生成今日电子书快照开始
2022-08-29 20:10:25.062 INFO  com.zaxxer.hikari.HikariDataSource                :110 
                [32m21564699476889600 [0;39m HikariPool-1 - Starting...
2022-08-29 20:10:25.812 INFO  com.zaxxer.hikari.HikariDataSource                :123 
                [32m21564699476889600 [0;39m HikariPool-1 - Start completed.
2022-08-29 20:10:25.818 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564699476889600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:10:25.842 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564699476889600 [0;39m ==> Parameters: 
2022-08-29 20:10:25.956 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564699476889600 [0;39m <==    Updates: 8
2022-08-29 20:10:25.957 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21564699476889600 [0;39m 生成今日电子书快照结束，耗时：949 毫秒
2022-08-29 20:10:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21564720419049472 [0;39m 生成今日电子书快照开始
2022-08-29 20:10:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564720419049472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:10:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564720419049472 [0;39m ==> Parameters: 
2022-08-29 20:10:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564720419049472 [0;39m <==    Updates: 0
2022-08-29 20:10:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21564720419049472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:10:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21564741415735296 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:10:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21564741415735296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:10:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21564741415735296 [0;39m ==> Parameters: 
2022-08-29 20:10:35.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21564741415735296 [0;39m <==    Updates: 8
2022-08-29 20:10:35.022 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21564741415735296 [0;39m 更新电子书下的文档数据结束，耗时：15 毫秒
2022-08-29 20:10:35.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21564741482844160 [0;39m 生成今日电子书快照开始
2022-08-29 20:10:35.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564741482844160 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:10:35.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564741482844160 [0;39m ==> Parameters: 
2022-08-29 20:10:35.025 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564741482844160 [0;39m <==    Updates: 0
2022-08-29 20:10:35.025 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21564741482844160 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:10:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21564762391449600 [0;39m 生成今日电子书快照开始
2022-08-29 20:10:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564762391449600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:10:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564762391449600 [0;39m ==> Parameters: 
2022-08-29 20:10:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564762391449600 [0;39m <==    Updates: 0
2022-08-29 20:10:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21564762391449600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-29 20:10:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21564783354580992 [0;39m 生成今日电子书快照开始
2022-08-29 20:10:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564783354580992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:10:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564783354580992 [0;39m ==> Parameters: 
2022-08-29 20:10:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564783354580992 [0;39m <==    Updates: 0
2022-08-29 20:10:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21564783354580992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:10:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21564804355461120 [0;39m 生成今日电子书快照开始
2022-08-29 20:10:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564804355461120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:10:50.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564804355461120 [0;39m ==> Parameters: 
2022-08-29 20:10:50.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564804355461120 [0;39m <==    Updates: 0
2022-08-29 20:10:50.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21564804355461120 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-29 20:10:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21564825280843776 [0;39m 生成今日电子书快照开始
2022-08-29 20:10:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564825280843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:10:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564825280843776 [0;39m ==> Parameters: 
2022-08-29 20:10:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564825280843776 [0;39m <==    Updates: 0
2022-08-29 20:10:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21564825280843776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:11:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21564846248169472 [0;39m 生成今日电子书快照开始
2022-08-29 20:11:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564846248169472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:11:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564846248169472 [0;39m ==> Parameters: 
2022-08-29 20:11:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564846248169472 [0;39m <==    Updates: 0
2022-08-29 20:11:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21564846248169472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:11:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21564867232272384 [0;39m 生成今日电子书快照开始
2022-08-29 20:11:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564867232272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:11:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564867232272384 [0;39m ==> Parameters: 
2022-08-29 20:11:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564867232272384 [0;39m <==    Updates: 0
2022-08-29 20:11:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21564867232272384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:11:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21564867249049600 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:11:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21564867249049600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:11:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21564867249049600 [0;39m ==> Parameters: 
2022-08-29 20:11:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21564867249049600 [0;39m <==    Updates: 8
2022-08-29 20:11:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21564867249049600 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-29 20:11:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21564888241541120 [0;39m 生成今日电子书快照开始
2022-08-29 20:11:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564888241541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:11:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564888241541120 [0;39m ==> Parameters: 
2022-08-29 20:11:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564888241541120 [0;39m <==    Updates: 0
2022-08-29 20:11:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21564888241541120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:11:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21564909192089600 [0;39m 生成今日电子书快照开始
2022-08-29 20:11:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564909192089600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:11:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564909192089600 [0;39m ==> Parameters: 
2022-08-29 20:11:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564909192089600 [0;39m <==    Updates: 0
2022-08-29 20:11:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21564909192089600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:11:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21564930142638080 [0;39m 生成今日电子书快照开始
2022-08-29 20:11:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564930142638080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:11:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564930142638080 [0;39m ==> Parameters: 
2022-08-29 20:11:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564930142638080 [0;39m <==    Updates: 0
2022-08-29 20:11:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21564930142638080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:11:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21564951114158080 [0;39m 生成今日电子书快照开始
2022-08-29 20:11:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564951114158080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:11:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564951114158080 [0;39m ==> Parameters: 
2022-08-29 20:11:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564951114158080 [0;39m <==    Updates: 0
2022-08-29 20:11:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21564951114158080 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-29 20:11:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21564972123426816 [0;39m 生成今日电子书快照开始
2022-08-29 20:11:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564972123426816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:11:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564972123426816 [0;39m ==> Parameters: 
2022-08-29 20:11:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564972123426816 [0;39m <==    Updates: 0
2022-08-29 20:11:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21564972123426816 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-29 20:11:35.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21564993048809472 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:11:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21564993048809472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:11:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21564993048809472 [0;39m ==> Parameters: 
2022-08-29 20:11:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21564993048809472 [0;39m <==    Updates: 8
2022-08-29 20:11:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21564993048809472 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-29 20:11:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21564993065586688 [0;39m 生成今日电子书快照开始
2022-08-29 20:11:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564993065586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:11:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564993065586688 [0;39m ==> Parameters: 
2022-08-29 20:11:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21564993065586688 [0;39m <==    Updates: 0
2022-08-29 20:11:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21564993065586688 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-29 20:11:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565014083244032 [0;39m 生成今日电子书快照开始
2022-08-29 20:11:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565014083244032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:11:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565014083244032 [0;39m ==> Parameters: 
2022-08-29 20:11:40.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565014083244032 [0;39m <==    Updates: 0
2022-08-29 20:11:40.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565014083244032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:11:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565035025403904 [0;39m 生成今日电子书快照开始
2022-08-29 20:11:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565035025403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:11:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565035025403904 [0;39m ==> Parameters: 
2022-08-29 20:11:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565035025403904 [0;39m <==    Updates: 0
2022-08-29 20:11:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565035025403904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:11:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565055996923904 [0;39m 生成今日电子书快照开始
2022-08-29 20:11:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565055996923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:11:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565055996923904 [0;39m ==> Parameters: 
2022-08-29 20:11:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565055996923904 [0;39m <==    Updates: 0
2022-08-29 20:11:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565055996923904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:11:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565076939083776 [0;39m 生成今日电子书快照开始
2022-08-29 20:11:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565076939083776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:11:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565076939083776 [0;39m ==> Parameters: 
2022-08-29 20:11:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565076939083776 [0;39m <==    Updates: 0
2022-08-29 20:11:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565076939083776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:12:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565097931575296 [0;39m 生成今日电子书快照开始
2022-08-29 20:12:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565097931575296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:12:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565097931575296 [0;39m ==> Parameters: 
2022-08-29 20:12:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565097931575296 [0;39m <==    Updates: 0
2022-08-29 20:12:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565097931575296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:12:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21565118928261120 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:12:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565118928261120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:12:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565118928261120 [0;39m ==> Parameters: 
2022-08-29 20:12:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565118928261120 [0;39m <==    Updates: 8
2022-08-29 20:12:05.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21565118928261120 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-29 20:12:05.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565118957621248 [0;39m 生成今日电子书快照开始
2022-08-29 20:12:05.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565118957621248 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:12:05.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565118957621248 [0;39m ==> Parameters: 
2022-08-29 20:12:05.025 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565118957621248 [0;39m <==    Updates: 0
2022-08-29 20:12:05.025 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565118957621248 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-29 20:12:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565139891392512 [0;39m 生成今日电子书快照开始
2022-08-29 20:12:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565139891392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:12:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565139891392512 [0;39m ==> Parameters: 
2022-08-29 20:12:10.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565139891392512 [0;39m <==    Updates: 0
2022-08-29 20:12:10.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565139891392512 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-29 20:12:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565160888078336 [0;39m 生成今日电子书快照开始
2022-08-29 20:12:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565160888078336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:12:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565160888078336 [0;39m ==> Parameters: 
2022-08-29 20:12:15.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565160888078336 [0;39m <==    Updates: 0
2022-08-29 20:12:15.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565160888078336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:12:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565181851209728 [0;39m 生成今日电子书快照开始
2022-08-29 20:12:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565181851209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:12:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565181851209728 [0;39m ==> Parameters: 
2022-08-29 20:12:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565181851209728 [0;39m <==    Updates: 0
2022-08-29 20:12:20.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565181851209728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:12:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565202814341120 [0;39m 生成今日电子书快照开始
2022-08-29 20:12:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565202814341120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:12:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565202814341120 [0;39m ==> Parameters: 
2022-08-29 20:12:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565202814341120 [0;39m <==    Updates: 0
2022-08-29 20:12:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565202814341120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:12:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565223777472512 [0;39m 生成今日电子书快照开始
2022-08-29 20:12:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565223777472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:12:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565223777472512 [0;39m ==> Parameters: 
2022-08-29 20:12:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565223777472512 [0;39m <==    Updates: 0
2022-08-29 20:12:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565223777472512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:12:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21565244715438080 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:12:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565244715438080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:12:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565244715438080 [0;39m ==> Parameters: 
2022-08-29 20:12:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565244715438080 [0;39m <==    Updates: 8
2022-08-29 20:12:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21565244715438080 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:12:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565244723826688 [0;39m 生成今日电子书快照开始
2022-08-29 20:12:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565244723826688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:12:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565244723826688 [0;39m ==> Parameters: 
2022-08-29 20:12:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565244723826688 [0;39m <==    Updates: 0
2022-08-29 20:12:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565244723826688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:12:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565265691152384 [0;39m 生成今日电子书快照开始
2022-08-29 20:12:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565265691152384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:12:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565265691152384 [0;39m ==> Parameters: 
2022-08-29 20:12:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565265691152384 [0;39m <==    Updates: 0
2022-08-29 20:12:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565265691152384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:12:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565286696226816 [0;39m 生成今日电子书快照开始
2022-08-29 20:12:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565286696226816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:12:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565286696226816 [0;39m ==> Parameters: 
2022-08-29 20:12:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565286696226816 [0;39m <==    Updates: 0
2022-08-29 20:12:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565286696226816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:12:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565307634192384 [0;39m 生成今日电子书快照开始
2022-08-29 20:12:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565307634192384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:12:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565307634192384 [0;39m ==> Parameters: 
2022-08-29 20:12:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565307634192384 [0;39m <==    Updates: 0
2022-08-29 20:12:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565307634192384 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:12:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565328622489600 [0;39m 生成今日电子书快照开始
2022-08-29 20:12:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565328622489600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:12:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565328622489600 [0;39m ==> Parameters: 
2022-08-29 20:12:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565328622489600 [0;39m <==    Updates: 0
2022-08-29 20:12:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565328622489600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:13:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565349577232384 [0;39m 生成今日电子书快照开始
2022-08-29 20:13:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565349577232384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:13:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565349577232384 [0;39m ==> Parameters: 
2022-08-29 20:13:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565349577232384 [0;39m <==    Updates: 0
2022-08-29 20:13:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565349577232384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:13:05.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21565370544558080 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:13:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565370544558080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:13:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565370544558080 [0;39m ==> Parameters: 
2022-08-29 20:13:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565370544558080 [0;39m <==    Updates: 8
2022-08-29 20:13:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21565370544558080 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-29 20:13:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565370573918208 [0;39m 生成今日电子书快照开始
2022-08-29 20:13:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565370573918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:13:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565370573918208 [0;39m ==> Parameters: 
2022-08-29 20:13:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565370573918208 [0;39m <==    Updates: 0
2022-08-29 20:13:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565370573918208 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-29 20:13:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565391562215424 [0;39m 生成今日电子书快照开始
2022-08-29 20:13:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565391562215424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:13:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565391562215424 [0;39m ==> Parameters: 
2022-08-29 20:13:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565391562215424 [0;39m <==    Updates: 0
2022-08-29 20:13:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565391562215424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:13:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565412521152512 [0;39m 生成今日电子书快照开始
2022-08-29 20:13:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565412521152512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:13:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565412521152512 [0;39m ==> Parameters: 
2022-08-29 20:13:15.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565412521152512 [0;39m <==    Updates: 0
2022-08-29 20:13:15.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565412521152512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-29 20:13:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565433505255424 [0;39m 生成今日电子书快照开始
2022-08-29 20:13:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565433505255424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:13:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565433505255424 [0;39m ==> Parameters: 
2022-08-29 20:13:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565433505255424 [0;39m <==    Updates: 0
2022-08-29 20:13:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565433505255424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:13:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565454459998208 [0;39m 生成今日电子书快照开始
2022-08-29 20:13:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565454459998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:13:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565454459998208 [0;39m ==> Parameters: 
2022-08-29 20:13:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565454459998208 [0;39m <==    Updates: 0
2022-08-29 20:13:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565454459998208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:13:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565475393769472 [0;39m 生成今日电子书快照开始
2022-08-29 20:13:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565475393769472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:13:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565475393769472 [0;39m ==> Parameters: 
2022-08-29 20:13:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565475393769472 [0;39m <==    Updates: 0
2022-08-29 20:13:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565475393769472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:13:35.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21565496398843904 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:13:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565496398843904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:13:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565496398843904 [0;39m ==> Parameters: 
2022-08-29 20:13:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565496398843904 [0;39m <==    Updates: 8
2022-08-29 20:13:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21565496398843904 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-29 20:13:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565496411426816 [0;39m 生成今日电子书快照开始
2022-08-29 20:13:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565496411426816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:13:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565496411426816 [0;39m ==> Parameters: 
2022-08-29 20:13:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565496411426816 [0;39m <==    Updates: 0
2022-08-29 20:13:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565496411426816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:13:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565517370363904 [0;39m 生成今日电子书快照开始
2022-08-29 20:13:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565517370363904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:13:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565517370363904 [0;39m ==> Parameters: 
2022-08-29 20:13:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565517370363904 [0;39m <==    Updates: 0
2022-08-29 20:13:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565517370363904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:13:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565538320912384 [0;39m 生成今日电子书快照开始
2022-08-29 20:13:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565538320912384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:13:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565538320912384 [0;39m ==> Parameters: 
2022-08-29 20:13:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565538320912384 [0;39m <==    Updates: 0
2022-08-29 20:13:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565538320912384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:13:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565559284043776 [0;39m 生成今日电子书快照开始
2022-08-29 20:13:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565559284043776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:13:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565559284043776 [0;39m ==> Parameters: 
2022-08-29 20:13:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565559284043776 [0;39m <==    Updates: 0
2022-08-29 20:13:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565559284043776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:13:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565580284923904 [0;39m 生成今日电子书快照开始
2022-08-29 20:13:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565580284923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:13:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565580284923904 [0;39m ==> Parameters: 
2022-08-29 20:13:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565580284923904 [0;39m <==    Updates: 0
2022-08-29 20:13:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565580284923904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:14:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565601222889472 [0;39m 生成今日电子书快照开始
2022-08-29 20:14:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565601222889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:14:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565601222889472 [0;39m ==> Parameters: 
2022-08-29 20:14:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565601222889472 [0;39m <==    Updates: 0
2022-08-29 20:14:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565601222889472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:14:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21565622223769600 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:14:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565622223769600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:14:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565622223769600 [0;39m ==> Parameters: 
2022-08-29 20:14:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565622223769600 [0;39m <==    Updates: 8
2022-08-29 20:14:05.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21565622223769600 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:14:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565622232158208 [0;39m 生成今日电子书快照开始
2022-08-29 20:14:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565622232158208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:14:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565622232158208 [0;39m ==> Parameters: 
2022-08-29 20:14:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565622232158208 [0;39m <==    Updates: 0
2022-08-29 20:14:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565622232158208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:14:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565643174318080 [0;39m 生成今日电子书快照开始
2022-08-29 20:14:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565643174318080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:14:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565643174318080 [0;39m ==> Parameters: 
2022-08-29 20:14:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565643174318080 [0;39m <==    Updates: 0
2022-08-29 20:14:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565643174318080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:14:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565664204558336 [0;39m 生成今日电子书快照开始
2022-08-29 20:14:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565664204558336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:14:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565664204558336 [0;39m ==> Parameters: 
2022-08-29 20:14:15.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565664204558336 [0;39m <==    Updates: 0
2022-08-29 20:14:15.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565664204558336 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:14:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565685129940992 [0;39m 生成今日电子书快照开始
2022-08-29 20:14:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565685129940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:14:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565685129940992 [0;39m ==> Parameters: 
2022-08-29 20:14:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565685129940992 [0;39m <==    Updates: 0
2022-08-29 20:14:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565685129940992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:14:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565706088878080 [0;39m 生成今日电子书快照开始
2022-08-29 20:14:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565706088878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:14:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565706088878080 [0;39m ==> Parameters: 
2022-08-29 20:14:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565706088878080 [0;39m <==    Updates: 0
2022-08-29 20:14:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565706088878080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:14:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565727098146816 [0;39m 生成今日电子书快照开始
2022-08-29 20:14:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565727098146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:14:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565727098146816 [0;39m ==> Parameters: 
2022-08-29 20:14:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565727098146816 [0;39m <==    Updates: 0
2022-08-29 20:14:30.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565727098146816 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-29 20:14:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565748027723776 [0;39m 生成今日电子书快照开始
2022-08-29 20:14:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565748027723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:14:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565748027723776 [0;39m ==> Parameters: 
2022-08-29 20:14:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565748027723776 [0;39m <==    Updates: 0
2022-08-29 20:14:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565748027723776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:14:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21565748044500992 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:14:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565748044500992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:14:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565748044500992 [0;39m ==> Parameters: 
2022-08-29 20:14:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565748044500992 [0;39m <==    Updates: 8
2022-08-29 20:14:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21565748044500992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:14:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565769045381120 [0;39m 生成今日电子书快照开始
2022-08-29 20:14:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565769045381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:14:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565769045381120 [0;39m ==> Parameters: 
2022-08-29 20:14:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565769045381120 [0;39m <==    Updates: 0
2022-08-29 20:14:40.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565769045381120 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-29 20:14:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565790016901120 [0;39m 生成今日电子书快照开始
2022-08-29 20:14:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565790016901120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:14:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565790016901120 [0;39m ==> Parameters: 
2022-08-29 20:14:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565790016901120 [0;39m <==    Updates: 0
2022-08-29 20:14:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565790016901120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:14:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565810950672384 [0;39m 生成今日电子书快照开始
2022-08-29 20:14:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565810950672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:14:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565810950672384 [0;39m ==> Parameters: 
2022-08-29 20:14:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565810950672384 [0;39m <==    Updates: 0
2022-08-29 20:14:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565810950672384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:14:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565831964135424 [0;39m 生成今日电子书快照开始
2022-08-29 20:14:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565831964135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:14:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565831964135424 [0;39m ==> Parameters: 
2022-08-29 20:14:55.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565831964135424 [0;39m <==    Updates: 0
2022-08-29 20:14:55.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565831964135424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-29 20:15:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565852893712384 [0;39m 生成今日电子书快照开始
2022-08-29 20:15:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565852893712384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:15:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565852893712384 [0;39m ==> Parameters: 
2022-08-29 20:15:00.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565852893712384 [0;39m <==    Updates: 0
2022-08-29 20:15:00.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565852893712384 [0;39m 生成今日电子书快照结束，耗时：16 毫秒
2022-08-29 20:15:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21565873882009600 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:15:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565873882009600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:15:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565873882009600 [0;39m ==> Parameters: 
2022-08-29 20:15:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565873882009600 [0;39m <==    Updates: 8
2022-08-29 20:15:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21565873882009600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:15:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565873890398208 [0;39m 生成今日电子书快照开始
2022-08-29 20:15:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565873890398208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:15:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565873890398208 [0;39m ==> Parameters: 
2022-08-29 20:15:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565873890398208 [0;39m <==    Updates: 0
2022-08-29 20:15:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565873890398208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:15:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565894857723904 [0;39m 生成今日电子书快照开始
2022-08-29 20:15:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565894857723904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:15:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565894857723904 [0;39m ==> Parameters: 
2022-08-29 20:15:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565894857723904 [0;39m <==    Updates: 0
2022-08-29 20:15:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565894857723904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:15:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565915833438208 [0;39m 生成今日电子书快照开始
2022-08-29 20:15:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565915833438208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:15:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565915833438208 [0;39m ==> Parameters: 
2022-08-29 20:15:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565915833438208 [0;39m <==    Updates: 0
2022-08-29 20:15:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565915833438208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:15:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565936821735424 [0;39m 生成今日电子书快照开始
2022-08-29 20:15:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565936821735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:15:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565936821735424 [0;39m ==> Parameters: 
2022-08-29 20:15:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565936821735424 [0;39m <==    Updates: 0
2022-08-29 20:15:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565936821735424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:15:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565957759700992 [0;39m 生成今日电子书快照开始
2022-08-29 20:15:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565957759700992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:15:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565957759700992 [0;39m ==> Parameters: 
2022-08-29 20:15:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565957759700992 [0;39m <==    Updates: 0
2022-08-29 20:15:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565957759700992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:15:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565978760581120 [0;39m 生成今日电子书快照开始
2022-08-29 20:15:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565978760581120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:15:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565978760581120 [0;39m ==> Parameters: 
2022-08-29 20:15:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565978760581120 [0;39m <==    Updates: 0
2022-08-29 20:15:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565978760581120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:15:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21565999727906816 [0;39m 生成今日电子书快照开始
2022-08-29 20:15:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565999727906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:15:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565999727906816 [0;39m ==> Parameters: 
2022-08-29 20:15:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21565999727906816 [0;39m <==    Updates: 0
2022-08-29 20:15:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21565999727906816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:15:35.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21565999740489728 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:15:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565999740489728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:15:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565999740489728 [0;39m ==> Parameters: 
2022-08-29 20:15:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21565999740489728 [0;39m <==    Updates: 8
2022-08-29 20:15:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21565999740489728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:15:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566020686843904 [0;39m 生成今日电子书快照开始
2022-08-29 20:15:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566020686843904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:15:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566020686843904 [0;39m ==> Parameters: 
2022-08-29 20:15:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566020686843904 [0;39m <==    Updates: 0
2022-08-29 20:15:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566020686843904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:15:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566041641586688 [0;39m 生成今日电子书快照开始
2022-08-29 20:15:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566041641586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:15:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566041641586688 [0;39m ==> Parameters: 
2022-08-29 20:15:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566041641586688 [0;39m <==    Updates: 0
2022-08-29 20:15:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566041641586688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:15:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566062608912384 [0;39m 生成今日电子书快照开始
2022-08-29 20:15:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566062608912384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:15:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566062608912384 [0;39m ==> Parameters: 
2022-08-29 20:15:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566062608912384 [0;39m <==    Updates: 0
2022-08-29 20:15:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566062608912384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:15:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566083597209600 [0;39m 生成今日电子书快照开始
2022-08-29 20:15:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566083597209600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:15:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566083597209600 [0;39m ==> Parameters: 
2022-08-29 20:15:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566083597209600 [0;39m <==    Updates: 0
2022-08-29 20:15:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566083597209600 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-29 20:16:00.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566104535175168 [0;39m 生成今日电子书快照开始
2022-08-29 20:16:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566104535175168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:16:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566104535175168 [0;39m ==> Parameters: 
2022-08-29 20:16:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566104535175168 [0;39m <==    Updates: 0
2022-08-29 20:16:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566104535175168 [0;39m 生成今日电子书快照结束，耗时：13 毫秒
2022-08-29 20:16:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566125519278080 [0;39m 生成今日电子书快照开始
2022-08-29 20:16:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566125519278080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:16:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566125519278080 [0;39m ==> Parameters: 
2022-08-29 20:16:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566125519278080 [0;39m <==    Updates: 0
2022-08-29 20:16:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566125519278080 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-29 20:16:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21566125540249600 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:16:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566125540249600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:16:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566125540249600 [0;39m ==> Parameters: 
2022-08-29 20:16:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566125540249600 [0;39m <==    Updates: 8
2022-08-29 20:16:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21566125540249600 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-29 20:16:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566146532741120 [0;39m 生成今日电子书快照开始
2022-08-29 20:16:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566146532741120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:16:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566146532741120 [0;39m ==> Parameters: 
2022-08-29 20:16:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566146532741120 [0;39m <==    Updates: 0
2022-08-29 20:16:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566146532741120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:16:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566167458123776 [0;39m 生成今日电子书快照开始
2022-08-29 20:16:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566167458123776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:16:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566167458123776 [0;39m ==> Parameters: 
2022-08-29 20:16:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566167458123776 [0;39m <==    Updates: 0
2022-08-29 20:16:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566167458123776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:16:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566188438032384 [0;39m 生成今日电子书快照开始
2022-08-29 20:16:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566188438032384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:16:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566188438032384 [0;39m ==> Parameters: 
2022-08-29 20:16:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566188438032384 [0;39m <==    Updates: 0
2022-08-29 20:16:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566188438032384 [0;39m 生成今日电子书快照结束，耗时：12 毫秒
2022-08-29 20:16:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566209447301120 [0;39m 生成今日电子书快照开始
2022-08-29 20:16:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566209447301120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:16:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566209447301120 [0;39m ==> Parameters: 
2022-08-29 20:16:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566209447301120 [0;39m <==    Updates: 0
2022-08-29 20:16:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566209447301120 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-29 20:16:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566230414626816 [0;39m 生成今日电子书快照开始
2022-08-29 20:16:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566230414626816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:16:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566230414626816 [0;39m ==> Parameters: 
2022-08-29 20:16:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566230414626816 [0;39m <==    Updates: 0
2022-08-29 20:16:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566230414626816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:16:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566251373563904 [0;39m 生成今日电子书快照开始
2022-08-29 20:16:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566251373563904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:16:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566251373563904 [0;39m ==> Parameters: 
2022-08-29 20:16:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566251373563904 [0;39m <==    Updates: 0
2022-08-29 20:16:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566251373563904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:16:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21566251390341120 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:16:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566251390341120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:16:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566251390341120 [0;39m ==> Parameters: 
2022-08-29 20:16:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566251390341120 [0;39m <==    Updates: 8
2022-08-29 20:16:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21566251390341120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:16:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566272366055424 [0;39m 生成今日电子书快照开始
2022-08-29 20:16:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566272366055424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:16:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566272366055424 [0;39m ==> Parameters: 
2022-08-29 20:16:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566272366055424 [0;39m <==    Updates: 0
2022-08-29 20:16:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566272366055424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:16:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566293287243776 [0;39m 生成今日电子书快照开始
2022-08-29 20:16:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566293287243776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:16:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566293287243776 [0;39m ==> Parameters: 
2022-08-29 20:16:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566293287243776 [0;39m <==    Updates: 0
2022-08-29 20:16:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566293287243776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:16:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566314258763776 [0;39m 生成今日电子书快照开始
2022-08-29 20:16:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566314258763776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:16:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566314258763776 [0;39m ==> Parameters: 
2022-08-29 20:16:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566314258763776 [0;39m <==    Updates: 0
2022-08-29 20:16:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566314258763776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:16:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566335255449600 [0;39m 生成今日电子书快照开始
2022-08-29 20:16:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566335255449600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:16:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566335255449600 [0;39m ==> Parameters: 
2022-08-29 20:16:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566335255449600 [0;39m <==    Updates: 0
2022-08-29 20:16:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566335255449600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:17:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566356239552512 [0;39m 生成今日电子书快照开始
2022-08-29 20:17:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566356239552512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:17:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566356239552512 [0;39m ==> Parameters: 
2022-08-29 20:17:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566356239552512 [0;39m <==    Updates: 0
2022-08-29 20:17:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566356239552512 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-29 20:17:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566377185906688 [0;39m 生成今日电子书快照开始
2022-08-29 20:17:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566377185906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:17:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566377185906688 [0;39m ==> Parameters: 
2022-08-29 20:17:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566377185906688 [0;39m <==    Updates: 0
2022-08-29 20:17:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566377185906688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:17:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21566377198489600 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:17:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566377198489600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:17:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566377198489600 [0;39m ==> Parameters: 
2022-08-29 20:17:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566377198489600 [0;39m <==    Updates: 8
2022-08-29 20:17:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21566377198489600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:17:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566398149038080 [0;39m 生成今日电子书快照开始
2022-08-29 20:17:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566398149038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:17:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566398149038080 [0;39m ==> Parameters: 
2022-08-29 20:17:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566398149038080 [0;39m <==    Updates: 0
2022-08-29 20:17:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566398149038080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:17:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566419120558080 [0;39m 生成今日电子书快照开始
2022-08-29 20:17:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566419120558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:17:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566419120558080 [0;39m ==> Parameters: 
2022-08-29 20:17:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566419120558080 [0;39m <==    Updates: 0
2022-08-29 20:17:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566419120558080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:17:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566440083689472 [0;39m 生成今日电子书快照开始
2022-08-29 20:17:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566440083689472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:17:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566440083689472 [0;39m ==> Parameters: 
2022-08-29 20:17:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566440083689472 [0;39m <==    Updates: 0
2022-08-29 20:17:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566440083689472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:17:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566461067792384 [0;39m 生成今日电子书快照开始
2022-08-29 20:17:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566461067792384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:17:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566461067792384 [0;39m ==> Parameters: 
2022-08-29 20:17:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566461067792384 [0;39m <==    Updates: 0
2022-08-29 20:17:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566461067792384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:17:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566482051895296 [0;39m 生成今日电子书快照开始
2022-08-29 20:17:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566482051895296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:17:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566482051895296 [0;39m ==> Parameters: 
2022-08-29 20:17:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566482051895296 [0;39m <==    Updates: 0
2022-08-29 20:17:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566482051895296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:17:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21566503010832384 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:17:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566503010832384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:17:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566503010832384 [0;39m ==> Parameters: 
2022-08-29 20:17:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566503010832384 [0;39m <==    Updates: 8
2022-08-29 20:17:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21566503010832384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:17:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566503019220992 [0;39m 生成今日电子书快照开始
2022-08-29 20:17:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566503019220992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:17:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566503019220992 [0;39m ==> Parameters: 
2022-08-29 20:17:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566503019220992 [0;39m <==    Updates: 0
2022-08-29 20:17:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566503019220992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:17:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566523999129600 [0;39m 生成今日电子书快照开始
2022-08-29 20:17:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566523999129600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:17:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566523999129600 [0;39m ==> Parameters: 
2022-08-29 20:17:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566523999129600 [0;39m <==    Updates: 0
2022-08-29 20:17:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566523999129600 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-29 20:17:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566544970649600 [0;39m 生成今日电子书快照开始
2022-08-29 20:17:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566544970649600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:17:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566544970649600 [0;39m ==> Parameters: 
2022-08-29 20:17:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566544970649600 [0;39m <==    Updates: 0
2022-08-29 20:17:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566544970649600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:17:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566565971529728 [0;39m 生成今日电子书快照开始
2022-08-29 20:17:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566565971529728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:17:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566565971529728 [0;39m ==> Parameters: 
2022-08-29 20:17:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566565971529728 [0;39m <==    Updates: 0
2022-08-29 20:17:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566565971529728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:17:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566586917883904 [0;39m 生成今日电子书快照开始
2022-08-29 20:17:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566586917883904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:17:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566586917883904 [0;39m ==> Parameters: 
2022-08-29 20:17:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566586917883904 [0;39m <==    Updates: 0
2022-08-29 20:17:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566586917883904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:18:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566607889403904 [0;39m 生成今日电子书快照开始
2022-08-29 20:18:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566607889403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:18:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566607889403904 [0;39m ==> Parameters: 
2022-08-29 20:18:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566607889403904 [0;39m <==    Updates: 0
2022-08-29 20:18:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566607889403904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:18:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21566628848340992 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:18:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566628848340992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:18:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566628848340992 [0;39m ==> Parameters: 
2022-08-29 20:18:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566628848340992 [0;39m <==    Updates: 8
2022-08-29 20:18:05.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21566628848340992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:18:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566628856729600 [0;39m 生成今日电子书快照开始
2022-08-29 20:18:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566628856729600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:18:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566628856729600 [0;39m ==> Parameters: 
2022-08-29 20:18:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566628856729600 [0;39m <==    Updates: 0
2022-08-29 20:18:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566628856729600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:18:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566649824055296 [0;39m 生成今日电子书快照开始
2022-08-29 20:18:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566649824055296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:18:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566649824055296 [0;39m ==> Parameters: 
2022-08-29 20:18:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566649824055296 [0;39m <==    Updates: 0
2022-08-29 20:18:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566649824055296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:18:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566670778798080 [0;39m 生成今日电子书快照开始
2022-08-29 20:18:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566670778798080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:18:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566670778798080 [0;39m ==> Parameters: 
2022-08-29 20:18:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566670778798080 [0;39m <==    Updates: 0
2022-08-29 20:18:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566670778798080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:18:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566691750318080 [0;39m 生成今日电子书快照开始
2022-08-29 20:18:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566691750318080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:18:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566691750318080 [0;39m ==> Parameters: 
2022-08-29 20:18:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566691750318080 [0;39m <==    Updates: 0
2022-08-29 20:18:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566691750318080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:18:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566712742809600 [0;39m 生成今日电子书快照开始
2022-08-29 20:18:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566712742809600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:18:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566712742809600 [0;39m ==> Parameters: 
2022-08-29 20:18:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566712742809600 [0;39m <==    Updates: 0
2022-08-29 20:18:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566712742809600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:18:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566733701746688 [0;39m 生成今日电子书快照开始
2022-08-29 20:18:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566733701746688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:18:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566733701746688 [0;39m ==> Parameters: 
2022-08-29 20:18:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566733701746688 [0;39m <==    Updates: 0
2022-08-29 20:18:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566733701746688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:18:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21566754698432512 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:18:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566754698432512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:18:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566754698432512 [0;39m ==> Parameters: 
2022-08-29 20:18:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566754698432512 [0;39m <==    Updates: 8
2022-08-29 20:18:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21566754698432512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:18:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566754706821120 [0;39m 生成今日电子书快照开始
2022-08-29 20:18:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566754706821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:18:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566754706821120 [0;39m ==> Parameters: 
2022-08-29 20:18:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566754706821120 [0;39m <==    Updates: 0
2022-08-29 20:18:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566754706821120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:18:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566775657369600 [0;39m 生成今日电子书快照开始
2022-08-29 20:18:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566775657369600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:18:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566775657369600 [0;39m ==> Parameters: 
2022-08-29 20:18:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566775657369600 [0;39m <==    Updates: 0
2022-08-29 20:18:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566775657369600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-29 20:18:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566796620500992 [0;39m 生成今日电子书快照开始
2022-08-29 20:18:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566796620500992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:18:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566796620500992 [0;39m ==> Parameters: 
2022-08-29 20:18:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566796620500992 [0;39m <==    Updates: 0
2022-08-29 20:18:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566796620500992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:18:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566817596215296 [0;39m 生成今日电子书快照开始
2022-08-29 20:18:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566817596215296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:18:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566817596215296 [0;39m ==> Parameters: 
2022-08-29 20:18:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566817596215296 [0;39m <==    Updates: 0
2022-08-29 20:18:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566817596215296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:18:55.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566838542569472 [0;39m 生成今日电子书快照开始
2022-08-29 20:18:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566838542569472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:18:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566838542569472 [0;39m ==> Parameters: 
2022-08-29 20:18:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566838542569472 [0;39m <==    Updates: 0
2022-08-29 20:18:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566838542569472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:19:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566859530866688 [0;39m 生成今日电子书快照开始
2022-08-29 20:19:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566859530866688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:19:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566859530866688 [0;39m ==> Parameters: 
2022-08-29 20:19:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566859530866688 [0;39m <==    Updates: 0
2022-08-29 20:19:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566859530866688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:19:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566880514969600 [0;39m 生成今日电子书快照开始
2022-08-29 20:19:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566880514969600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:19:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566880514969600 [0;39m ==> Parameters: 
2022-08-29 20:19:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566880514969600 [0;39m <==    Updates: 0
2022-08-29 20:19:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566880514969600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:19:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21566880535941120 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:19:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566880535941120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:19:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566880535941120 [0;39m ==> Parameters: 
2022-08-29 20:19:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21566880535941120 [0;39m <==    Updates: 8
2022-08-29 20:19:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21566880535941120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:19:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566901494878208 [0;39m 生成今日电子书快照开始
2022-08-29 20:19:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566901494878208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:19:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566901494878208 [0;39m ==> Parameters: 
2022-08-29 20:19:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566901494878208 [0;39m <==    Updates: 0
2022-08-29 20:19:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566901494878208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:19:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566922470592512 [0;39m 生成今日电子书快照开始
2022-08-29 20:19:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566922470592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:19:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566922470592512 [0;39m ==> Parameters: 
2022-08-29 20:19:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566922470592512 [0;39m <==    Updates: 0
2022-08-29 20:19:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566922470592512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:19:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566943433723904 [0;39m 生成今日电子书快照开始
2022-08-29 20:19:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566943433723904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:19:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566943433723904 [0;39m ==> Parameters: 
2022-08-29 20:19:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566943433723904 [0;39m <==    Updates: 0
2022-08-29 20:19:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566943433723904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:19:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566964384272384 [0;39m 生成今日电子书快照开始
2022-08-29 20:19:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566964384272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:19:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566964384272384 [0;39m ==> Parameters: 
2022-08-29 20:19:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566964384272384 [0;39m <==    Updates: 0
2022-08-29 20:19:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566964384272384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:19:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21566985397735424 [0;39m 生成今日电子书快照开始
2022-08-29 20:19:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566985397735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:19:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566985397735424 [0;39m ==> Parameters: 
2022-08-29 20:19:30.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21566985397735424 [0;39m <==    Updates: 0
2022-08-29 20:19:30.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21566985397735424 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-29 20:19:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21567006339895296 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:19:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567006339895296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:19:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567006339895296 [0;39m ==> Parameters: 
2022-08-29 20:19:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567006339895296 [0;39m <==    Updates: 8
2022-08-29 20:19:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21567006339895296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:19:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567006348283904 [0;39m 生成今日电子书快照开始
2022-08-29 20:19:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567006348283904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:19:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567006348283904 [0;39m ==> Parameters: 
2022-08-29 20:19:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567006348283904 [0;39m <==    Updates: 0
2022-08-29 20:19:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567006348283904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:19:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567027290443776 [0;39m 生成今日电子书快照开始
2022-08-29 20:19:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567027290443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:19:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567027290443776 [0;39m ==> Parameters: 
2022-08-29 20:19:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567027290443776 [0;39m <==    Updates: 0
2022-08-29 20:19:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567027290443776 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:19:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567048270352384 [0;39m 生成今日电子书快照开始
2022-08-29 20:19:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567048270352384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:19:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567048270352384 [0;39m ==> Parameters: 
2022-08-29 20:19:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567048270352384 [0;39m <==    Updates: 0
2022-08-29 20:19:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567048270352384 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-29 20:19:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567069271232512 [0;39m 生成今日电子书快照开始
2022-08-29 20:19:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567069271232512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:19:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567069271232512 [0;39m ==> Parameters: 
2022-08-29 20:19:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567069271232512 [0;39m <==    Updates: 0
2022-08-29 20:19:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567069271232512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:19:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567090221780992 [0;39m 生成今日电子书快照开始
2022-08-29 20:19:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567090221780992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:19:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567090221780992 [0;39m ==> Parameters: 
2022-08-29 20:19:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567090221780992 [0;39m <==    Updates: 0
2022-08-29 20:19:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567090221780992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:20:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567111239438336 [0;39m 生成今日电子书快照开始
2022-08-29 20:20:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567111239438336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:20:00.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567111239438336 [0;39m ==> Parameters: 
2022-08-29 20:20:00.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567111239438336 [0;39m <==    Updates: 0
2022-08-29 20:20:00.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567111239438336 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-29 20:20:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567132160626688 [0;39m 生成今日电子书快照开始
2022-08-29 20:20:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567132160626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:20:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567132160626688 [0;39m ==> Parameters: 
2022-08-29 20:20:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567132160626688 [0;39m <==    Updates: 0
2022-08-29 20:20:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567132160626688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:20:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21567132169015296 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:20:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567132169015296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:20:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567132169015296 [0;39m ==> Parameters: 
2022-08-29 20:20:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567132169015296 [0;39m <==    Updates: 8
2022-08-29 20:20:05.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21567132169015296 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:20:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567153127952384 [0;39m 生成今日电子书快照开始
2022-08-29 20:20:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567153127952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:20:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567153127952384 [0;39m ==> Parameters: 
2022-08-29 20:20:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567153127952384 [0;39m <==    Updates: 0
2022-08-29 20:20:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567153127952384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:20:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567174116249600 [0;39m 生成今日电子书快照开始
2022-08-29 20:20:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567174116249600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:20:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567174116249600 [0;39m ==> Parameters: 
2022-08-29 20:20:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567174116249600 [0;39m <==    Updates: 0
2022-08-29 20:20:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567174116249600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:20:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567195083575296 [0;39m 生成今日电子书快照开始
2022-08-29 20:20:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567195083575296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:20:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567195083575296 [0;39m ==> Parameters: 
2022-08-29 20:20:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567195083575296 [0;39m <==    Updates: 0
2022-08-29 20:20:20.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567195083575296 [0;39m 生成今日电子书快照结束，耗时：11 毫秒
2022-08-29 20:20:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567216059289600 [0;39m 生成今日电子书快照开始
2022-08-29 20:20:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567216059289600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:20:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567216059289600 [0;39m ==> Parameters: 
2022-08-29 20:20:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567216059289600 [0;39m <==    Updates: 0
2022-08-29 20:20:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567216059289600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:20:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567237035003904 [0;39m 生成今日电子书快照开始
2022-08-29 20:20:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567237035003904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:20:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567237035003904 [0;39m ==> Parameters: 
2022-08-29 20:20:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567237035003904 [0;39m <==    Updates: 0
2022-08-29 20:20:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567237035003904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:20:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567258019106816 [0;39m 生成今日电子书快照开始
2022-08-29 20:20:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567258019106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:20:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567258019106816 [0;39m ==> Parameters: 
2022-08-29 20:20:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567258019106816 [0;39m <==    Updates: 0
2022-08-29 20:20:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567258019106816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:20:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21567258027495424 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:20:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567258027495424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:20:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567258027495424 [0;39m ==> Parameters: 
2022-08-29 20:20:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567258027495424 [0;39m <==    Updates: 8
2022-08-29 20:20:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21567258027495424 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:20:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567278986432512 [0;39m 生成今日电子书快照开始
2022-08-29 20:20:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567278986432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:20:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567278986432512 [0;39m ==> Parameters: 
2022-08-29 20:20:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567278986432512 [0;39m <==    Updates: 0
2022-08-29 20:20:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567278986432512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:20:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567299941175296 [0;39m 生成今日电子书快照开始
2022-08-29 20:20:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567299941175296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:20:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567299941175296 [0;39m ==> Parameters: 
2022-08-29 20:20:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567299941175296 [0;39m <==    Updates: 0
2022-08-29 20:20:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567299941175296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:20:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567320950444032 [0;39m 生成今日电子书快照开始
2022-08-29 20:20:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567320950444032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:20:50.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567320950444032 [0;39m ==> Parameters: 
2022-08-29 20:20:50.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567320950444032 [0;39m <==    Updates: 0
2022-08-29 20:20:50.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567320950444032 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-29 20:20:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567341884215296 [0;39m 生成今日电子书快照开始
2022-08-29 20:20:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567341884215296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:20:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567341884215296 [0;39m ==> Parameters: 
2022-08-29 20:20:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567341884215296 [0;39m <==    Updates: 0
2022-08-29 20:20:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567341884215296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:21:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567362830569472 [0;39m 生成今日电子书快照开始
2022-08-29 20:21:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567362830569472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:21:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567362830569472 [0;39m ==> Parameters: 
2022-08-29 20:21:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567362830569472 [0;39m <==    Updates: 0
2022-08-29 20:21:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567362830569472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:21:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21567383844032512 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:21:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567383844032512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:21:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567383844032512 [0;39m ==> Parameters: 
2022-08-29 20:21:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567383844032512 [0;39m <==    Updates: 8
2022-08-29 20:21:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21567383844032512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:21:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567383852421120 [0;39m 生成今日电子书快照开始
2022-08-29 20:21:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567383852421120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:21:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567383852421120 [0;39m ==> Parameters: 
2022-08-29 20:21:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567383852421120 [0;39m <==    Updates: 0
2022-08-29 20:21:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567383852421120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:21:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567404773609472 [0;39m 生成今日电子书快照开始
2022-08-29 20:21:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567404773609472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:21:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567404773609472 [0;39m ==> Parameters: 
2022-08-29 20:21:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567404773609472 [0;39m <==    Updates: 0
2022-08-29 20:21:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567404773609472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:21:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567425766100992 [0;39m 生成今日电子书快照开始
2022-08-29 20:21:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567425766100992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:21:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567425766100992 [0;39m ==> Parameters: 
2022-08-29 20:21:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567425766100992 [0;39m <==    Updates: 0
2022-08-29 20:21:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567425766100992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:21:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567446779564032 [0;39m 生成今日电子书快照开始
2022-08-29 20:21:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567446779564032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:21:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567446779564032 [0;39m ==> Parameters: 
2022-08-29 20:21:20.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567446779564032 [0;39m <==    Updates: 0
2022-08-29 20:21:20.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567446779564032 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:21:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567467713335296 [0;39m 生成今日电子书快照开始
2022-08-29 20:21:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567467713335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:21:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567467713335296 [0;39m ==> Parameters: 
2022-08-29 20:21:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567467713335296 [0;39m <==    Updates: 0
2022-08-29 20:21:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567467713335296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:21:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567488693243904 [0;39m 生成今日电子书快照开始
2022-08-29 20:21:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567488693243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:21:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567488693243904 [0;39m ==> Parameters: 
2022-08-29 20:21:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567488693243904 [0;39m <==    Updates: 0
2022-08-29 20:21:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567488693243904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:21:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567509685735424 [0;39m 生成今日电子书快照开始
2022-08-29 20:21:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567509685735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:21:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567509685735424 [0;39m ==> Parameters: 
2022-08-29 20:21:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567509685735424 [0;39m <==    Updates: 0
2022-08-29 20:21:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567509685735424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:21:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21567509694124032 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:21:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567509694124032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:21:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567509694124032 [0;39m ==> Parameters: 
2022-08-29 20:21:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567509694124032 [0;39m <==    Updates: 8
2022-08-29 20:21:35.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21567509694124032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:21:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567530653061120 [0;39m 生成今日电子书快照开始
2022-08-29 20:21:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567530653061120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:21:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567530653061120 [0;39m ==> Parameters: 
2022-08-29 20:21:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567530653061120 [0;39m <==    Updates: 0
2022-08-29 20:21:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567530653061120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:21:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567551599415296 [0;39m 生成今日电子书快照开始
2022-08-29 20:21:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567551599415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:21:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567551599415296 [0;39m ==> Parameters: 
2022-08-29 20:21:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567551599415296 [0;39m <==    Updates: 0
2022-08-29 20:21:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567551599415296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:21:50.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567572545769472 [0;39m 生成今日电子书快照开始
2022-08-29 20:21:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567572545769472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:21:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567572545769472 [0;39m ==> Parameters: 
2022-08-29 20:21:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567572545769472 [0;39m <==    Updates: 0
2022-08-29 20:21:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567572545769472 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-29 20:21:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567593555038208 [0;39m 生成今日电子书快照开始
2022-08-29 20:21:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567593555038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:21:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567593555038208 [0;39m ==> Parameters: 
2022-08-29 20:21:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567593555038208 [0;39m <==    Updates: 0
2022-08-29 20:21:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567593555038208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:22:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567614509780992 [0;39m 生成今日电子书快照开始
2022-08-29 20:22:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567614509780992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:22:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567614509780992 [0;39m ==> Parameters: 
2022-08-29 20:22:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567614509780992 [0;39m <==    Updates: 0
2022-08-29 20:22:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567614509780992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:22:05.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21567635468718080 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:22:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567635468718080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:22:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567635468718080 [0;39m ==> Parameters: 
2022-08-29 20:22:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567635468718080 [0;39m <==    Updates: 8
2022-08-29 20:22:05.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21567635468718080 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:22:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567635477106688 [0;39m 生成今日电子书快照开始
2022-08-29 20:22:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567635477106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:22:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567635477106688 [0;39m ==> Parameters: 
2022-08-29 20:22:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567635477106688 [0;39m <==    Updates: 0
2022-08-29 20:22:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567635477106688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:22:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567656477986816 [0;39m 生成今日电子书快照开始
2022-08-29 20:22:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567656477986816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:22:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567656477986816 [0;39m ==> Parameters: 
2022-08-29 20:22:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567656477986816 [0;39m <==    Updates: 0
2022-08-29 20:22:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567656477986816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:22:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567677453701120 [0;39m 生成今日电子书快照开始
2022-08-29 20:22:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567677453701120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:22:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567677453701120 [0;39m ==> Parameters: 
2022-08-29 20:22:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567677453701120 [0;39m <==    Updates: 0
2022-08-29 20:22:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567677453701120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:22:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567698374889472 [0;39m 生成今日电子书快照开始
2022-08-29 20:22:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567698374889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:22:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567698374889472 [0;39m ==> Parameters: 
2022-08-29 20:22:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567698374889472 [0;39m <==    Updates: 0
2022-08-29 20:22:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567698374889472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:22:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567719379963904 [0;39m 生成今日电子书快照开始
2022-08-29 20:22:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567719379963904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:22:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567719379963904 [0;39m ==> Parameters: 
2022-08-29 20:22:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567719379963904 [0;39m <==    Updates: 0
2022-08-29 20:22:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567719379963904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:22:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567740376649728 [0;39m 生成今日电子书快照开始
2022-08-29 20:22:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567740376649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:22:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567740376649728 [0;39m ==> Parameters: 
2022-08-29 20:22:30.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567740376649728 [0;39m <==    Updates: 0
2022-08-29 20:22:30.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567740376649728 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-29 20:22:35.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21567761289449472 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:22:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567761289449472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:22:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567761289449472 [0;39m ==> Parameters: 
2022-08-29 20:22:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567761289449472 [0;39m <==    Updates: 8
2022-08-29 20:22:35.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21567761289449472 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:22:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567761302032384 [0;39m 生成今日电子书快照开始
2022-08-29 20:22:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567761302032384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:22:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567761302032384 [0;39m ==> Parameters: 
2022-08-29 20:22:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567761302032384 [0;39m <==    Updates: 0
2022-08-29 20:22:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567761302032384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:22:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567782277746688 [0;39m 生成今日电子书快照开始
2022-08-29 20:22:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567782277746688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:22:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567782277746688 [0;39m ==> Parameters: 
2022-08-29 20:22:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567782277746688 [0;39m <==    Updates: 0
2022-08-29 20:22:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567782277746688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:22:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567803257655296 [0;39m 生成今日电子书快照开始
2022-08-29 20:22:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567803257655296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:22:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567803257655296 [0;39m ==> Parameters: 
2022-08-29 20:22:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567803257655296 [0;39m <==    Updates: 0
2022-08-29 20:22:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567803257655296 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-29 20:22:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567824208203776 [0;39m 生成今日电子书快照开始
2022-08-29 20:22:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567824208203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:22:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567824208203776 [0;39m ==> Parameters: 
2022-08-29 20:22:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567824208203776 [0;39m <==    Updates: 0
2022-08-29 20:22:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567824208203776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:22:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567845217472512 [0;39m 生成今日电子书快照开始
2022-08-29 20:22:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567845217472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:22:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567845217472512 [0;39m ==> Parameters: 
2022-08-29 20:22:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567845217472512 [0;39m <==    Updates: 0
2022-08-29 20:22:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567845217472512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:23:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567866180603904 [0;39m 生成今日电子书快照开始
2022-08-29 20:23:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567866180603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:23:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567866180603904 [0;39m ==> Parameters: 
2022-08-29 20:23:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567866180603904 [0;39m <==    Updates: 0
2022-08-29 20:23:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567866180603904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:23:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567887164706816 [0;39m 生成今日电子书快照开始
2022-08-29 20:23:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567887164706816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:23:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567887164706816 [0;39m ==> Parameters: 
2022-08-29 20:23:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567887164706816 [0;39m <==    Updates: 0
2022-08-29 20:23:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567887164706816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:23:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21567887173095424 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:23:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567887173095424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:23:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567887173095424 [0;39m ==> Parameters: 
2022-08-29 20:23:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21567887173095424 [0;39m <==    Updates: 8
2022-08-29 20:23:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21567887173095424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:23:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567908127838208 [0;39m 生成今日电子书快照开始
2022-08-29 20:23:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567908127838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:23:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567908127838208 [0;39m ==> Parameters: 
2022-08-29 20:23:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567908127838208 [0;39m <==    Updates: 0
2022-08-29 20:23:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567908127838208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:23:15.035 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567929204215808 [0;39m 生成今日电子书快照开始
2022-08-29 20:23:15.035 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567929204215808 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:23:15.036 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567929204215808 [0;39m ==> Parameters: 
2022-08-29 20:23:15.038 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567929204215808 [0;39m <==    Updates: 0
2022-08-29 20:23:15.039 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567929204215808 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:23:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567950079266816 [0;39m 生成今日电子书快照开始
2022-08-29 20:23:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567950079266816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:23:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567950079266816 [0;39m ==> Parameters: 
2022-08-29 20:23:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567950079266816 [0;39m <==    Updates: 0
2022-08-29 20:23:20.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567950079266816 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-29 20:23:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567971038203904 [0;39m 生成今日电子书快照开始
2022-08-29 20:23:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567971038203904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:23:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567971038203904 [0;39m ==> Parameters: 
2022-08-29 20:23:25.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567971038203904 [0;39m <==    Updates: 0
2022-08-29 20:23:25.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567971038203904 [0;39m 生成今日电子书快照结束，耗时：11 毫秒
2022-08-29 20:23:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21567992022306816 [0;39m 生成今日电子书快照开始
2022-08-29 20:23:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567992022306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:23:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567992022306816 [0;39m ==> Parameters: 
2022-08-29 20:23:30.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21567992022306816 [0;39m <==    Updates: 0
2022-08-29 20:23:30.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21567992022306816 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-29 20:23:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568012989632512 [0;39m 生成今日电子书快照开始
2022-08-29 20:23:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568012989632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:23:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568012989632512 [0;39m ==> Parameters: 
2022-08-29 20:23:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568012989632512 [0;39m <==    Updates: 0
2022-08-29 20:23:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568012989632512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:23:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21568012998021120 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:23:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568012998021120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:23:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568012998021120 [0;39m ==> Parameters: 
2022-08-29 20:23:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568012998021120 [0;39m <==    Updates: 8
2022-08-29 20:23:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21568012998021120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:23:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568033940180992 [0;39m 生成今日电子书快照开始
2022-08-29 20:23:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568033940180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:23:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568033940180992 [0;39m ==> Parameters: 
2022-08-29 20:23:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568033940180992 [0;39m <==    Updates: 0
2022-08-29 20:23:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568033940180992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:23:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568054953644032 [0;39m 生成今日电子书快照开始
2022-08-29 20:23:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568054953644032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:23:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568054953644032 [0;39m ==> Parameters: 
2022-08-29 20:23:45.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568054953644032 [0;39m <==    Updates: 0
2022-08-29 20:23:45.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568054953644032 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-29 20:23:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568075912581120 [0;39m 生成今日电子书快照开始
2022-08-29 20:23:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568075912581120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:23:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568075912581120 [0;39m ==> Parameters: 
2022-08-29 20:23:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568075912581120 [0;39m <==    Updates: 0
2022-08-29 20:23:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568075912581120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:23:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568096863129600 [0;39m 生成今日电子书快照开始
2022-08-29 20:23:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568096863129600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:23:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568096863129600 [0;39m ==> Parameters: 
2022-08-29 20:23:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568096863129600 [0;39m <==    Updates: 0
2022-08-29 20:23:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568096863129600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:24:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568117838843904 [0;39m 生成今日电子书快照开始
2022-08-29 20:24:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568117838843904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:24:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568117838843904 [0;39m ==> Parameters: 
2022-08-29 20:24:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568117838843904 [0;39m <==    Updates: 0
2022-08-29 20:24:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568117838843904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:24:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21568138827141120 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:24:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568138827141120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:24:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568138827141120 [0;39m ==> Parameters: 
2022-08-29 20:24:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568138827141120 [0;39m <==    Updates: 8
2022-08-29 20:24:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21568138827141120 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-29 20:24:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568138839724032 [0;39m 生成今日电子书快照开始
2022-08-29 20:24:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568138839724032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:24:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568138839724032 [0;39m ==> Parameters: 
2022-08-29 20:24:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568138839724032 [0;39m <==    Updates: 0
2022-08-29 20:24:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568138839724032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:24:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568159790272512 [0;39m 生成今日电子书快照开始
2022-08-29 20:24:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568159790272512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:24:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568159790272512 [0;39m ==> Parameters: 
2022-08-29 20:24:10.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568159790272512 [0;39m <==    Updates: 0
2022-08-29 20:24:10.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568159790272512 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-29 20:24:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568180757598208 [0;39m 生成今日电子书快照开始
2022-08-29 20:24:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568180757598208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:24:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568180757598208 [0;39m ==> Parameters: 
2022-08-29 20:24:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568180757598208 [0;39m <==    Updates: 0
2022-08-29 20:24:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568180757598208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:24:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568201750089728 [0;39m 生成今日电子书快照开始
2022-08-29 20:24:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568201750089728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:24:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568201750089728 [0;39m ==> Parameters: 
2022-08-29 20:24:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568201750089728 [0;39m <==    Updates: 0
2022-08-29 20:24:20.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568201750089728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:24:25.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568222658695168 [0;39m 生成今日电子书快照开始
2022-08-29 20:24:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568222658695168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:24:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568222658695168 [0;39m ==> Parameters: 
2022-08-29 20:24:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568222658695168 [0;39m <==    Updates: 0
2022-08-29 20:24:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568222658695168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:24:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568243638603776 [0;39m 生成今日电子书快照开始
2022-08-29 20:24:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568243638603776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:24:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568243638603776 [0;39m ==> Parameters: 
2022-08-29 20:24:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568243638603776 [0;39m <==    Updates: 0
2022-08-29 20:24:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568243638603776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:24:35.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21568264639483904 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:24:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568264639483904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:24:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568264639483904 [0;39m ==> Parameters: 
2022-08-29 20:24:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568264639483904 [0;39m <==    Updates: 8
2022-08-29 20:24:35.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21568264639483904 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:24:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568264643678208 [0;39m 生成今日电子书快照开始
2022-08-29 20:24:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568264643678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:24:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568264643678208 [0;39m ==> Parameters: 
2022-08-29 20:24:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568264643678208 [0;39m <==    Updates: 0
2022-08-29 20:24:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568264643678208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:24:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568285619392512 [0;39m 生成今日电子书快照开始
2022-08-29 20:24:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568285619392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:24:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568285619392512 [0;39m ==> Parameters: 
2022-08-29 20:24:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568285619392512 [0;39m <==    Updates: 0
2022-08-29 20:24:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568285619392512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:24:45.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568306544775168 [0;39m 生成今日电子书快照开始
2022-08-29 20:24:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568306544775168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:24:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568306544775168 [0;39m ==> Parameters: 
2022-08-29 20:24:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568306544775168 [0;39m <==    Updates: 0
2022-08-29 20:24:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568306544775168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:24:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568327533072384 [0;39m 生成今日电子书快照开始
2022-08-29 20:24:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568327533072384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:24:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568327533072384 [0;39m ==> Parameters: 
2022-08-29 20:24:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568327533072384 [0;39m <==    Updates: 0
2022-08-29 20:24:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568327533072384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:24:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568348554924032 [0;39m 生成今日电子书快照开始
2022-08-29 20:24:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568348554924032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:24:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568348554924032 [0;39m ==> Parameters: 
2022-08-29 20:24:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568348554924032 [0;39m <==    Updates: 0
2022-08-29 20:24:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568348554924032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:25:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568369505472512 [0;39m 生成今日电子书快照开始
2022-08-29 20:25:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568369505472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:25:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568369505472512 [0;39m ==> Parameters: 
2022-08-29 20:25:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568369505472512 [0;39m <==    Updates: 0
2022-08-29 20:25:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568369505472512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:25:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568390476992512 [0;39m 生成今日电子书快照开始
2022-08-29 20:25:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568390476992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:25:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568390476992512 [0;39m ==> Parameters: 
2022-08-29 20:25:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568390476992512 [0;39m <==    Updates: 0
2022-08-29 20:25:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568390476992512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:25:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21568390489575424 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:25:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568390489575424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:25:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568390489575424 [0;39m ==> Parameters: 
2022-08-29 20:25:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568390489575424 [0;39m <==    Updates: 8
2022-08-29 20:25:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21568390489575424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:25:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568411406569472 [0;39m 生成今日电子书快照开始
2022-08-29 20:25:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568411406569472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:25:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568411406569472 [0;39m ==> Parameters: 
2022-08-29 20:25:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568411406569472 [0;39m <==    Updates: 0
2022-08-29 20:25:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568411406569472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:25:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568432378089472 [0;39m 生成今日电子书快照开始
2022-08-29 20:25:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568432378089472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:25:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568432378089472 [0;39m ==> Parameters: 
2022-08-29 20:25:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568432378089472 [0;39m <==    Updates: 0
2022-08-29 20:25:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568432378089472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:25:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568453374775296 [0;39m 生成今日电子书快照开始
2022-08-29 20:25:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568453374775296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:25:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568453374775296 [0;39m ==> Parameters: 
2022-08-29 20:25:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568453374775296 [0;39m <==    Updates: 0
2022-08-29 20:25:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568453374775296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:25:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568474379849728 [0;39m 生成今日电子书快照开始
2022-08-29 20:25:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568474379849728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:25:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568474379849728 [0;39m ==> Parameters: 
2022-08-29 20:25:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568474379849728 [0;39m <==    Updates: 0
2022-08-29 20:25:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568474379849728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:25:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568495334592512 [0;39m 生成今日电子书快照开始
2022-08-29 20:25:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568495334592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:25:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568495334592512 [0;39m ==> Parameters: 
2022-08-29 20:25:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568495334592512 [0;39m <==    Updates: 0
2022-08-29 20:25:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568495334592512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:25:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568516272558080 [0;39m 生成今日电子书快照开始
2022-08-29 20:25:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568516272558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:25:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568516272558080 [0;39m ==> Parameters: 
2022-08-29 20:25:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568516272558080 [0;39m <==    Updates: 0
2022-08-29 20:25:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568516272558080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:25:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21568516285140992 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:25:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568516285140992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:25:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568516285140992 [0;39m ==> Parameters: 
2022-08-29 20:25:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568516285140992 [0;39m <==    Updates: 8
2022-08-29 20:25:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21568516285140992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:25:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568537235689472 [0;39m 生成今日电子书快照开始
2022-08-29 20:25:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568537235689472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:25:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568537235689472 [0;39m ==> Parameters: 
2022-08-29 20:25:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568537235689472 [0;39m <==    Updates: 0
2022-08-29 20:25:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568537235689472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:25:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568558228180992 [0;39m 生成今日电子书快照开始
2022-08-29 20:25:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568558228180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:25:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568558228180992 [0;39m ==> Parameters: 
2022-08-29 20:25:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568558228180992 [0;39m <==    Updates: 0
2022-08-29 20:25:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568558228180992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:25:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568579191312384 [0;39m 生成今日电子书快照开始
2022-08-29 20:25:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568579191312384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:25:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568579191312384 [0;39m ==> Parameters: 
2022-08-29 20:25:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568579191312384 [0;39m <==    Updates: 0
2022-08-29 20:25:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568579191312384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:25:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568600208969728 [0;39m 生成今日电子书快照开始
2022-08-29 20:25:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568600208969728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:25:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568600208969728 [0;39m ==> Parameters: 
2022-08-29 20:25:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568600208969728 [0;39m <==    Updates: 0
2022-08-29 20:25:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568600208969728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:26:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568621180489728 [0;39m 生成今日电子书快照开始
2022-08-29 20:26:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568621180489728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:26:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568621180489728 [0;39m ==> Parameters: 
2022-08-29 20:26:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568621180489728 [0;39m <==    Updates: 0
2022-08-29 20:26:00.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568621180489728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:26:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21568642105872384 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:26:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568642105872384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:26:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568642105872384 [0;39m ==> Parameters: 
2022-08-29 20:26:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568642105872384 [0;39m <==    Updates: 8
2022-08-29 20:26:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21568642105872384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:26:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568642118455296 [0;39m 生成今日电子书快照开始
2022-08-29 20:26:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568642118455296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:26:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568642118455296 [0;39m ==> Parameters: 
2022-08-29 20:26:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568642118455296 [0;39m <==    Updates: 0
2022-08-29 20:26:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568642118455296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:26:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568663077392384 [0;39m 生成今日电子书快照开始
2022-08-29 20:26:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568663077392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:26:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568663077392384 [0;39m ==> Parameters: 
2022-08-29 20:26:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568663077392384 [0;39m <==    Updates: 0
2022-08-29 20:26:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568663077392384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:26:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568684048912384 [0;39m 生成今日电子书快照开始
2022-08-29 20:26:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568684048912384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:26:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568684048912384 [0;39m ==> Parameters: 
2022-08-29 20:26:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568684048912384 [0;39m <==    Updates: 0
2022-08-29 20:26:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568684048912384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:26:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568705041403904 [0;39m 生成今日电子书快照开始
2022-08-29 20:26:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568705041403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:26:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568705041403904 [0;39m ==> Parameters: 
2022-08-29 20:26:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568705041403904 [0;39m <==    Updates: 0
2022-08-29 20:26:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568705041403904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:26:25.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568725975175168 [0;39m 生成今日电子书快照开始
2022-08-29 20:26:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568725975175168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:26:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568725975175168 [0;39m ==> Parameters: 
2022-08-29 20:26:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568725975175168 [0;39m <==    Updates: 0
2022-08-29 20:26:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568725975175168 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:26:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568746959278080 [0;39m 生成今日电子书快照开始
2022-08-29 20:26:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568746959278080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:26:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568746959278080 [0;39m ==> Parameters: 
2022-08-29 20:26:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568746959278080 [0;39m <==    Updates: 0
2022-08-29 20:26:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568746959278080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:26:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568767972741120 [0;39m 生成今日电子书快照开始
2022-08-29 20:26:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568767972741120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:26:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568767972741120 [0;39m ==> Parameters: 
2022-08-29 20:26:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568767972741120 [0;39m <==    Updates: 0
2022-08-29 20:26:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568767972741120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:26:35.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21568767981129728 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:26:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568767981129728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:26:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568767981129728 [0;39m ==> Parameters: 
2022-08-29 20:26:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568767981129728 [0;39m <==    Updates: 8
2022-08-29 20:26:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21568767981129728 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:26:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568788927483904 [0;39m 生成今日电子书快照开始
2022-08-29 20:26:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568788927483904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:26:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568788927483904 [0;39m ==> Parameters: 
2022-08-29 20:26:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568788927483904 [0;39m <==    Updates: 0
2022-08-29 20:26:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568788927483904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:26:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568809907392512 [0;39m 生成今日电子书快照开始
2022-08-29 20:26:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568809907392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:26:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568809907392512 [0;39m ==> Parameters: 
2022-08-29 20:26:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568809907392512 [0;39m <==    Updates: 0
2022-08-29 20:26:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568809907392512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:26:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568830866329600 [0;39m 生成今日电子书快照开始
2022-08-29 20:26:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568830866329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:26:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568830866329600 [0;39m ==> Parameters: 
2022-08-29 20:26:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568830866329600 [0;39m <==    Updates: 0
2022-08-29 20:26:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568830866329600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:26:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568851825266688 [0;39m 生成今日电子书快照开始
2022-08-29 20:26:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568851825266688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:26:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568851825266688 [0;39m ==> Parameters: 
2022-08-29 20:26:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568851825266688 [0;39m <==    Updates: 0
2022-08-29 20:26:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568851825266688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:27:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568872780009472 [0;39m 生成今日电子书快照开始
2022-08-29 20:27:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568872780009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:27:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568872780009472 [0;39m ==> Parameters: 
2022-08-29 20:27:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568872780009472 [0;39m <==    Updates: 0
2022-08-29 20:27:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568872780009472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:27:05.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568893755723776 [0;39m 生成今日电子书快照开始
2022-08-29 20:27:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568893755723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:27:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568893755723776 [0;39m ==> Parameters: 
2022-08-29 20:27:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568893755723776 [0;39m <==    Updates: 0
2022-08-29 20:27:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568893755723776 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-29 20:27:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21568893797666816 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:27:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568893797666816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:27:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568893797666816 [0;39m ==> Parameters: 
2022-08-29 20:27:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21568893797666816 [0;39m <==    Updates: 8
2022-08-29 20:27:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21568893797666816 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-29 20:27:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568914777575424 [0;39m 生成今日电子书快照开始
2022-08-29 20:27:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568914777575424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:27:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568914777575424 [0;39m ==> Parameters: 
2022-08-29 20:27:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568914777575424 [0;39m <==    Updates: 0
2022-08-29 20:27:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568914777575424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:27:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568935749095424 [0;39m 生成今日电子书快照开始
2022-08-29 20:27:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568935749095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:27:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568935749095424 [0;39m ==> Parameters: 
2022-08-29 20:27:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568935749095424 [0;39m <==    Updates: 0
2022-08-29 20:27:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568935749095424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:27:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568956703838208 [0;39m 生成今日电子书快照开始
2022-08-29 20:27:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568956703838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:27:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568956703838208 [0;39m ==> Parameters: 
2022-08-29 20:27:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568956703838208 [0;39m <==    Updates: 0
2022-08-29 20:27:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568956703838208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:27:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568977687941120 [0;39m 生成今日电子书快照开始
2022-08-29 20:27:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568977687941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:27:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568977687941120 [0;39m ==> Parameters: 
2022-08-29 20:27:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568977687941120 [0;39m <==    Updates: 0
2022-08-29 20:27:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568977687941120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:27:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21568998655266816 [0;39m 生成今日电子书快照开始
2022-08-29 20:27:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568998655266816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:27:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568998655266816 [0;39m ==> Parameters: 
2022-08-29 20:27:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21568998655266816 [0;39m <==    Updates: 0
2022-08-29 20:27:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21568998655266816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:27:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21569019618398208 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:27:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569019618398208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:27:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569019618398208 [0;39m ==> Parameters: 
2022-08-29 20:27:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569019618398208 [0;39m <==    Updates: 8
2022-08-29 20:27:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21569019618398208 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:27:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569019626786816 [0;39m 生成今日电子书快照开始
2022-08-29 20:27:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569019626786816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:27:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569019626786816 [0;39m ==> Parameters: 
2022-08-29 20:27:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569019626786816 [0;39m <==    Updates: 0
2022-08-29 20:27:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569019626786816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:27:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569040589918208 [0;39m 生成今日电子书快照开始
2022-08-29 20:27:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569040589918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:27:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569040589918208 [0;39m ==> Parameters: 
2022-08-29 20:27:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569040589918208 [0;39m <==    Updates: 0
2022-08-29 20:27:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569040589918208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:27:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569061536272384 [0;39m 生成今日电子书快照开始
2022-08-29 20:27:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569061536272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:27:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569061536272384 [0;39m ==> Parameters: 
2022-08-29 20:27:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569061536272384 [0;39m <==    Updates: 0
2022-08-29 20:27:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569061536272384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:27:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569082532958208 [0;39m 生成今日电子书快照开始
2022-08-29 20:27:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569082532958208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:27:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569082532958208 [0;39m ==> Parameters: 
2022-08-29 20:27:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569082532958208 [0;39m <==    Updates: 0
2022-08-29 20:27:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569082532958208 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-29 20:27:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569103500283904 [0;39m 生成今日电子书快照开始
2022-08-29 20:27:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569103500283904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:27:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569103500283904 [0;39m ==> Parameters: 
2022-08-29 20:27:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569103500283904 [0;39m <==    Updates: 0
2022-08-29 20:27:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569103500283904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:28:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569124463415296 [0;39m 生成今日电子书快照开始
2022-08-29 20:28:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569124463415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:28:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569124463415296 [0;39m ==> Parameters: 
2022-08-29 20:28:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569124463415296 [0;39m <==    Updates: 0
2022-08-29 20:28:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569124463415296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:28:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569145430740992 [0;39m 生成今日电子书快照开始
2022-08-29 20:28:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569145430740992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:28:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569145430740992 [0;39m ==> Parameters: 
2022-08-29 20:28:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569145430740992 [0;39m <==    Updates: 0
2022-08-29 20:28:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569145430740992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:28:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21569145439129600 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:28:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569145439129600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:28:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569145439129600 [0;39m ==> Parameters: 
2022-08-29 20:28:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569145439129600 [0;39m <==    Updates: 8
2022-08-29 20:28:05.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21569145439129600 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:28:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569166381289472 [0;39m 生成今日电子书快照开始
2022-08-29 20:28:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569166381289472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:28:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569166381289472 [0;39m ==> Parameters: 
2022-08-29 20:28:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569166381289472 [0;39m <==    Updates: 0
2022-08-29 20:28:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569166381289472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:28:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569187394752512 [0;39m 生成今日电子书快照开始
2022-08-29 20:28:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569187394752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:28:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569187394752512 [0;39m ==> Parameters: 
2022-08-29 20:28:15.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569187394752512 [0;39m <==    Updates: 0
2022-08-29 20:28:15.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569187394752512 [0;39m 生成今日电子书快照结束，耗时：11 毫秒
2022-08-29 20:28:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569208341106688 [0;39m 生成今日电子书快照开始
2022-08-29 20:28:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569208341106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:28:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569208341106688 [0;39m ==> Parameters: 
2022-08-29 20:28:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569208341106688 [0;39m <==    Updates: 0
2022-08-29 20:28:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569208341106688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:28:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569229316820992 [0;39m 生成今日电子书快照开始
2022-08-29 20:28:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569229316820992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:28:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569229316820992 [0;39m ==> Parameters: 
2022-08-29 20:28:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569229316820992 [0;39m <==    Updates: 0
2022-08-29 20:28:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569229316820992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:28:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569250275758080 [0;39m 生成今日电子书快照开始
2022-08-29 20:28:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569250275758080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:28:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569250275758080 [0;39m ==> Parameters: 
2022-08-29 20:28:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569250275758080 [0;39m <==    Updates: 0
2022-08-29 20:28:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569250275758080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:28:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21569271247278080 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:28:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569271247278080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:28:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569271247278080 [0;39m ==> Parameters: 
2022-08-29 20:28:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569271247278080 [0;39m <==    Updates: 8
2022-08-29 20:28:35.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21569271247278080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:28:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569271255666688 [0;39m 生成今日电子书快照开始
2022-08-29 20:28:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569271255666688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:28:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569271255666688 [0;39m ==> Parameters: 
2022-08-29 20:28:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569271255666688 [0;39m <==    Updates: 0
2022-08-29 20:28:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569271255666688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:28:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569292239769600 [0;39m 生成今日电子书快照开始
2022-08-29 20:28:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569292239769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:28:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569292239769600 [0;39m ==> Parameters: 
2022-08-29 20:28:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569292239769600 [0;39m <==    Updates: 0
2022-08-29 20:28:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569292239769600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:28:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569313202900992 [0;39m 生成今日电子书快照开始
2022-08-29 20:28:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569313202900992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:28:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569313202900992 [0;39m ==> Parameters: 
2022-08-29 20:28:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569313202900992 [0;39m <==    Updates: 0
2022-08-29 20:28:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569313202900992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:28:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569334195392512 [0;39m 生成今日电子书快照开始
2022-08-29 20:28:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569334195392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:28:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569334195392512 [0;39m ==> Parameters: 
2022-08-29 20:28:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569334195392512 [0;39m <==    Updates: 0
2022-08-29 20:28:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569334195392512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:28:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569355145940992 [0;39m 生成今日电子书快照开始
2022-08-29 20:28:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569355145940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:28:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569355145940992 [0;39m ==> Parameters: 
2022-08-29 20:28:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569355145940992 [0;39m <==    Updates: 0
2022-08-29 20:28:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569355145940992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:29:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569376104878080 [0;39m 生成今日电子书快照开始
2022-08-29 20:29:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569376104878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:29:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569376104878080 [0;39m ==> Parameters: 
2022-08-29 20:29:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569376104878080 [0;39m <==    Updates: 0
2022-08-29 20:29:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569376104878080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:29:05.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21569397076398080 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:29:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569397076398080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:29:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569397076398080 [0;39m ==> Parameters: 
2022-08-29 20:29:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569397076398080 [0;39m <==    Updates: 8
2022-08-29 20:29:05.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21569397076398080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:29:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569397080592384 [0;39m 生成今日电子书快照开始
2022-08-29 20:29:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569397080592384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:29:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569397080592384 [0;39m ==> Parameters: 
2022-08-29 20:29:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569397080592384 [0;39m <==    Updates: 0
2022-08-29 20:29:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569397080592384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:29:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569418047918080 [0;39m 生成今日电子书快照开始
2022-08-29 20:29:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569418047918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:29:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569418047918080 [0;39m ==> Parameters: 
2022-08-29 20:29:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569418047918080 [0;39m <==    Updates: 0
2022-08-29 20:29:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569418047918080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:29:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569439040409600 [0;39m 生成今日电子书快照开始
2022-08-29 20:29:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569439040409600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:29:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569439040409600 [0;39m ==> Parameters: 
2022-08-29 20:29:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569439040409600 [0;39m <==    Updates: 0
2022-08-29 20:29:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569439040409600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:29:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569459986763776 [0;39m 生成今日电子书快照开始
2022-08-29 20:29:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569459986763776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:29:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569459986763776 [0;39m ==> Parameters: 
2022-08-29 20:29:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569459986763776 [0;39m <==    Updates: 0
2022-08-29 20:29:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569459986763776 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-29 20:29:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569480975060992 [0;39m 生成今日电子书快照开始
2022-08-29 20:29:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569480975060992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:29:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569480975060992 [0;39m ==> Parameters: 
2022-08-29 20:29:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569480975060992 [0;39m <==    Updates: 0
2022-08-29 20:29:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569480975060992 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-29 20:29:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569501938192384 [0;39m 生成今日电子书快照开始
2022-08-29 20:29:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569501938192384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:29:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569501938192384 [0;39m ==> Parameters: 
2022-08-29 20:29:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569501938192384 [0;39m <==    Updates: 0
2022-08-29 20:29:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569501938192384 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:29:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21569522913906688 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:29:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569522913906688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:29:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569522913906688 [0;39m ==> Parameters: 
2022-08-29 20:29:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569522913906688 [0;39m <==    Updates: 8
2022-08-29 20:29:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21569522913906688 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:29:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569522922295296 [0;39m 生成今日电子书快照开始
2022-08-29 20:29:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569522922295296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:29:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569522922295296 [0;39m ==> Parameters: 
2022-08-29 20:29:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569522922295296 [0;39m <==    Updates: 0
2022-08-29 20:29:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569522922295296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:29:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569543918981120 [0;39m 生成今日电子书快照开始
2022-08-29 20:29:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569543918981120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:29:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569543918981120 [0;39m ==> Parameters: 
2022-08-29 20:29:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569543918981120 [0;39m <==    Updates: 0
2022-08-29 20:29:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569543918981120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:29:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569564890501120 [0;39m 生成今日电子书快照开始
2022-08-29 20:29:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569564890501120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:29:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569564890501120 [0;39m ==> Parameters: 
2022-08-29 20:29:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569564890501120 [0;39m <==    Updates: 0
2022-08-29 20:29:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569564890501120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:29:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569585824272384 [0;39m 生成今日电子书快照开始
2022-08-29 20:29:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569585824272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:29:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569585824272384 [0;39m ==> Parameters: 
2022-08-29 20:29:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569585824272384 [0;39m <==    Updates: 0
2022-08-29 20:29:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569585824272384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:29:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569606808375296 [0;39m 生成今日电子书快照开始
2022-08-29 20:29:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569606808375296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:29:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569606808375296 [0;39m ==> Parameters: 
2022-08-29 20:29:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569606808375296 [0;39m <==    Updates: 0
2022-08-29 20:29:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569606808375296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:30:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569627771506688 [0;39m 生成今日电子书快照开始
2022-08-29 20:30:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569627771506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:30:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569627771506688 [0;39m ==> Parameters: 
2022-08-29 20:30:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569627771506688 [0;39m <==    Updates: 0
2022-08-29 20:30:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569627771506688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:30:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21569648755609600 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:30:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569648755609600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:30:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569648755609600 [0;39m ==> Parameters: 
2022-08-29 20:30:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569648755609600 [0;39m <==    Updates: 8
2022-08-29 20:30:05.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21569648755609600 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:30:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569648763998208 [0;39m 生成今日电子书快照开始
2022-08-29 20:30:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569648763998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:30:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569648763998208 [0;39m ==> Parameters: 
2022-08-29 20:30:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569648763998208 [0;39m <==    Updates: 0
2022-08-29 20:30:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569648763998208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:30:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569669760684032 [0;39m 生成今日电子书快照开始
2022-08-29 20:30:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569669760684032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:30:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569669760684032 [0;39m ==> Parameters: 
2022-08-29 20:30:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569669760684032 [0;39m <==    Updates: 0
2022-08-29 20:30:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569669760684032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:30:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569690690260992 [0;39m 生成今日电子书快照开始
2022-08-29 20:30:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569690690260992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:30:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569690690260992 [0;39m ==> Parameters: 
2022-08-29 20:30:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569690690260992 [0;39m <==    Updates: 0
2022-08-29 20:30:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569690690260992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:30:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569711653392384 [0;39m 生成今日电子书快照开始
2022-08-29 20:30:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569711653392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:30:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569711653392384 [0;39m ==> Parameters: 
2022-08-29 20:30:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569711653392384 [0;39m <==    Updates: 0
2022-08-29 20:30:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569711653392384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:30:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569732666855424 [0;39m 生成今日电子书快照开始
2022-08-29 20:30:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569732666855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:30:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569732666855424 [0;39m ==> Parameters: 
2022-08-29 20:30:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569732666855424 [0;39m <==    Updates: 0
2022-08-29 20:30:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569732666855424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:30:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569753604820992 [0;39m 生成今日电子书快照开始
2022-08-29 20:30:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569753604820992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:30:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569753604820992 [0;39m ==> Parameters: 
2022-08-29 20:30:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569753604820992 [0;39m <==    Updates: 0
2022-08-29 20:30:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569753604820992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:30:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569774614089728 [0;39m 生成今日电子书快照开始
2022-08-29 20:30:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569774614089728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:30:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569774614089728 [0;39m ==> Parameters: 
2022-08-29 20:30:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569774614089728 [0;39m <==    Updates: 0
2022-08-29 20:30:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569774614089728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:30:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21569774626672640 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:30:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569774626672640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:30:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569774626672640 [0;39m ==> Parameters: 
2022-08-29 20:30:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569774626672640 [0;39m <==    Updates: 8
2022-08-29 20:30:35.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21569774626672640 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:30:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569795573026816 [0;39m 生成今日电子书快照开始
2022-08-29 20:30:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569795573026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:30:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569795573026816 [0;39m ==> Parameters: 
2022-08-29 20:30:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569795573026816 [0;39m <==    Updates: 0
2022-08-29 20:30:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569795573026816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:30:45.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569816494215168 [0;39m 生成今日电子书快照开始
2022-08-29 20:30:45.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569816494215168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:30:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569816494215168 [0;39m ==> Parameters: 
2022-08-29 20:30:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569816494215168 [0;39m <==    Updates: 0
2022-08-29 20:30:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569816494215168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:30:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569837503483904 [0;39m 生成今日电子书快照开始
2022-08-29 20:30:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569837503483904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:30:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569837503483904 [0;39m ==> Parameters: 
2022-08-29 20:30:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569837503483904 [0;39m <==    Updates: 0
2022-08-29 20:30:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569837503483904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:30:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569858491781120 [0;39m 生成今日电子书快照开始
2022-08-29 20:30:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569858491781120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:30:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569858491781120 [0;39m ==> Parameters: 
2022-08-29 20:30:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569858491781120 [0;39m <==    Updates: 0
2022-08-29 20:30:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569858491781120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:31:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569879442329600 [0;39m 生成今日电子书快照开始
2022-08-29 20:31:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569879442329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:31:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569879442329600 [0;39m ==> Parameters: 
2022-08-29 20:31:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569879442329600 [0;39m <==    Updates: 0
2022-08-29 20:31:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569879442329600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:31:05.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21569900392878080 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:31:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569900392878080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:31:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569900392878080 [0;39m ==> Parameters: 
2022-08-29 20:31:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21569900392878080 [0;39m <==    Updates: 8
2022-08-29 20:31:05.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21569900392878080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:31:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569900397072384 [0;39m 生成今日电子书快照开始
2022-08-29 20:31:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569900397072384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:31:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569900397072384 [0;39m ==> Parameters: 
2022-08-29 20:31:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569900397072384 [0;39m <==    Updates: 0
2022-08-29 20:31:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569900397072384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:31:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569921360203776 [0;39m 生成今日电子书快照开始
2022-08-29 20:31:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569921360203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:31:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569921360203776 [0;39m ==> Parameters: 
2022-08-29 20:31:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569921360203776 [0;39m <==    Updates: 0
2022-08-29 20:31:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569921360203776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:31:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569942340112384 [0;39m 生成今日电子书快照开始
2022-08-29 20:31:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569942340112384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:31:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569942340112384 [0;39m ==> Parameters: 
2022-08-29 20:31:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569942340112384 [0;39m <==    Updates: 0
2022-08-29 20:31:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569942340112384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:31:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569963328409600 [0;39m 生成今日电子书快照开始
2022-08-29 20:31:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569963328409600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:31:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569963328409600 [0;39m ==> Parameters: 
2022-08-29 20:31:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569963328409600 [0;39m <==    Updates: 0
2022-08-29 20:31:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569963328409600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:31:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21569984283152384 [0;39m 生成今日电子书快照开始
2022-08-29 20:31:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569984283152384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:31:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569984283152384 [0;39m ==> Parameters: 
2022-08-29 20:31:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21569984283152384 [0;39m <==    Updates: 0
2022-08-29 20:31:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21569984283152384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:31:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570005267255296 [0;39m 生成今日电子书快照开始
2022-08-29 20:31:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570005267255296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:31:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570005267255296 [0;39m ==> Parameters: 
2022-08-29 20:31:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570005267255296 [0;39m <==    Updates: 0
2022-08-29 20:31:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570005267255296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:31:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570026230386688 [0;39m 生成今日电子书快照开始
2022-08-29 20:31:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570026230386688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:31:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570026230386688 [0;39m ==> Parameters: 
2022-08-29 20:31:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570026230386688 [0;39m <==    Updates: 0
2022-08-29 20:31:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570026230386688 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-29 20:31:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21570026263941120 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:31:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570026263941120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:31:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570026263941120 [0;39m ==> Parameters: 
2022-08-29 20:31:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570026263941120 [0;39m <==    Updates: 8
2022-08-29 20:31:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21570026263941120 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-29 20:31:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570047239655424 [0;39m 生成今日电子书快照开始
2022-08-29 20:31:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570047239655424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:31:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570047239655424 [0;39m ==> Parameters: 
2022-08-29 20:31:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570047239655424 [0;39m <==    Updates: 0
2022-08-29 20:31:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570047239655424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:31:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570068177620992 [0;39m 生成今日电子书快照开始
2022-08-29 20:31:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570068177620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:31:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570068177620992 [0;39m ==> Parameters: 
2022-08-29 20:31:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570068177620992 [0;39m <==    Updates: 0
2022-08-29 20:31:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570068177620992 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-29 20:31:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570089165918208 [0;39m 生成今日电子书快照开始
2022-08-29 20:31:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570089165918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:31:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570089165918208 [0;39m ==> Parameters: 
2022-08-29 20:31:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570089165918208 [0;39m <==    Updates: 0
2022-08-29 20:31:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570089165918208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:31:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570110129049600 [0;39m 生成今日电子书快照开始
2022-08-29 20:31:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570110129049600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:31:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570110129049600 [0;39m ==> Parameters: 
2022-08-29 20:31:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570110129049600 [0;39m <==    Updates: 0
2022-08-29 20:31:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570110129049600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-29 20:32:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570131108958208 [0;39m 生成今日电子书快照开始
2022-08-29 20:32:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570131108958208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:32:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570131108958208 [0;39m ==> Parameters: 
2022-08-29 20:32:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570131108958208 [0;39m <==    Updates: 0
2022-08-29 20:32:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570131108958208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:32:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21570152097255424 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:32:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570152097255424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:32:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570152097255424 [0;39m ==> Parameters: 
2022-08-29 20:32:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570152097255424 [0;39m <==    Updates: 8
2022-08-29 20:32:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21570152097255424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:32:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570152101449728 [0;39m 生成今日电子书快照开始
2022-08-29 20:32:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570152101449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:32:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570152101449728 [0;39m ==> Parameters: 
2022-08-29 20:32:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570152101449728 [0;39m <==    Updates: 0
2022-08-29 20:32:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570152101449728 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:32:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570173018443776 [0;39m 生成今日电子书快照开始
2022-08-29 20:32:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570173018443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:32:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570173018443776 [0;39m ==> Parameters: 
2022-08-29 20:32:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570173018443776 [0;39m <==    Updates: 0
2022-08-29 20:32:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570173018443776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:32:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570194040295424 [0;39m 生成今日电子书快照开始
2022-08-29 20:32:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570194040295424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:32:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570194040295424 [0;39m ==> Parameters: 
2022-08-29 20:32:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570194040295424 [0;39m <==    Updates: 0
2022-08-29 20:32:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570194040295424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:32:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570214982455296 [0;39m 生成今日电子书快照开始
2022-08-29 20:32:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570214982455296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:32:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570214982455296 [0;39m ==> Parameters: 
2022-08-29 20:32:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570214982455296 [0;39m <==    Updates: 0
2022-08-29 20:32:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570214982455296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:32:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570235974946816 [0;39m 生成今日电子书快照开始
2022-08-29 20:32:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570235974946816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:32:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570235974946816 [0;39m ==> Parameters: 
2022-08-29 20:32:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570235974946816 [0;39m <==    Updates: 0
2022-08-29 20:32:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570235974946816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:32:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570256929689600 [0;39m 生成今日电子书快照开始
2022-08-29 20:32:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570256929689600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:32:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570256929689600 [0;39m ==> Parameters: 
2022-08-29 20:32:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570256929689600 [0;39m <==    Updates: 0
2022-08-29 20:32:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570256929689600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:32:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21570277922181120 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:32:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570277922181120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:32:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570277922181120 [0;39m ==> Parameters: 
2022-08-29 20:32:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570277922181120 [0;39m <==    Updates: 8
2022-08-29 20:32:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21570277922181120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:32:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570277930569728 [0;39m 生成今日电子书快照开始
2022-08-29 20:32:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570277930569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:32:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570277930569728 [0;39m ==> Parameters: 
2022-08-29 20:32:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570277930569728 [0;39m <==    Updates: 0
2022-08-29 20:32:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570277930569728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:32:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570298864340992 [0;39m 生成今日电子书快照开始
2022-08-29 20:32:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570298864340992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:32:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570298864340992 [0;39m ==> Parameters: 
2022-08-29 20:32:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570298864340992 [0;39m <==    Updates: 0
2022-08-29 20:32:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570298864340992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:32:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570319814889472 [0;39m 生成今日电子书快照开始
2022-08-29 20:32:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570319814889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:32:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570319814889472 [0;39m ==> Parameters: 
2022-08-29 20:32:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570319814889472 [0;39m <==    Updates: 0
2022-08-29 20:32:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570319814889472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:32:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570340824158208 [0;39m 生成今日电子书快照开始
2022-08-29 20:32:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570340824158208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:32:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570340824158208 [0;39m ==> Parameters: 
2022-08-29 20:32:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570340824158208 [0;39m <==    Updates: 0
2022-08-29 20:32:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570340824158208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:32:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570361808261120 [0;39m 生成今日电子书快照开始
2022-08-29 20:32:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570361808261120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:32:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570361808261120 [0;39m ==> Parameters: 
2022-08-29 20:32:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570361808261120 [0;39m <==    Updates: 0
2022-08-29 20:32:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570361808261120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:33:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570382763003904 [0;39m 生成今日电子书快照开始
2022-08-29 20:33:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570382763003904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:33:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570382763003904 [0;39m ==> Parameters: 
2022-08-29 20:33:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570382763003904 [0;39m <==    Updates: 0
2022-08-29 20:33:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570382763003904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:33:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21570403717746688 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:33:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570403717746688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:33:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570403717746688 [0;39m ==> Parameters: 
2022-08-29 20:33:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570403717746688 [0;39m <==    Updates: 8
2022-08-29 20:33:05.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21570403717746688 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-29 20:33:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570403730329600 [0;39m 生成今日电子书快照开始
2022-08-29 20:33:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570403730329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:33:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570403730329600 [0;39m ==> Parameters: 
2022-08-29 20:33:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570403730329600 [0;39m <==    Updates: 0
2022-08-29 20:33:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570403730329600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:33:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570424706043904 [0;39m 生成今日电子书快照开始
2022-08-29 20:33:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570424706043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:33:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570424706043904 [0;39m ==> Parameters: 
2022-08-29 20:33:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570424706043904 [0;39m <==    Updates: 0
2022-08-29 20:33:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570424706043904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:33:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570445690146816 [0;39m 生成今日电子书快照开始
2022-08-29 20:33:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570445690146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:33:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570445690146816 [0;39m ==> Parameters: 
2022-08-29 20:33:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570445690146816 [0;39m <==    Updates: 0
2022-08-29 20:33:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570445690146816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:33:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570466628112384 [0;39m 生成今日电子书快照开始
2022-08-29 20:33:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570466628112384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:33:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570466628112384 [0;39m ==> Parameters: 
2022-08-29 20:33:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570466628112384 [0;39m <==    Updates: 0
2022-08-29 20:33:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570466628112384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:33:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570487599632384 [0;39m 生成今日电子书快照开始
2022-08-29 20:33:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570487599632384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:33:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570487599632384 [0;39m ==> Parameters: 
2022-08-29 20:33:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570487599632384 [0;39m <==    Updates: 0
2022-08-29 20:33:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570487599632384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:33:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570508600512512 [0;39m 生成今日电子书快照开始
2022-08-29 20:33:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570508600512512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:33:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570508600512512 [0;39m ==> Parameters: 
2022-08-29 20:33:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570508600512512 [0;39m <==    Updates: 0
2022-08-29 20:33:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570508600512512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:33:35.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21570529588809728 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:33:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570529588809728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:33:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570529588809728 [0;39m ==> Parameters: 
2022-08-29 20:33:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570529588809728 [0;39m <==    Updates: 8
2022-08-29 20:33:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21570529588809728 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:33:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570529597198336 [0;39m 生成今日电子书快照开始
2022-08-29 20:33:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570529597198336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:33:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570529597198336 [0;39m ==> Parameters: 
2022-08-29 20:33:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570529597198336 [0;39m <==    Updates: 0
2022-08-29 20:33:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570529597198336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:33:40.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570550497415168 [0;39m 生成今日电子书快照开始
2022-08-29 20:33:40.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570550497415168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:33:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570550497415168 [0;39m ==> Parameters: 
2022-08-29 20:33:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570550497415168 [0;39m <==    Updates: 0
2022-08-29 20:33:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570550497415168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:33:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570571519266816 [0;39m 生成今日电子书快照开始
2022-08-29 20:33:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570571519266816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:33:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570571519266816 [0;39m ==> Parameters: 
2022-08-29 20:33:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570571519266816 [0;39m <==    Updates: 0
2022-08-29 20:33:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570571519266816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:33:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570592482398208 [0;39m 生成今日电子书快照开始
2022-08-29 20:33:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570592482398208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:33:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570592482398208 [0;39m ==> Parameters: 
2022-08-29 20:33:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570592482398208 [0;39m <==    Updates: 0
2022-08-29 20:33:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570592482398208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:33:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570613466501120 [0;39m 生成今日电子书快照开始
2022-08-29 20:33:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570613466501120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:33:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570613466501120 [0;39m ==> Parameters: 
2022-08-29 20:33:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570613466501120 [0;39m <==    Updates: 0
2022-08-29 20:33:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570613466501120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:34:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570634400272384 [0;39m 生成今日电子书快照开始
2022-08-29 20:34:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570634400272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:34:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570634400272384 [0;39m ==> Parameters: 
2022-08-29 20:34:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570634400272384 [0;39m <==    Updates: 0
2022-08-29 20:34:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570634400272384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:34:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21570655384375296 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:34:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570655384375296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:34:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570655384375296 [0;39m ==> Parameters: 
2022-08-29 20:34:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570655384375296 [0;39m <==    Updates: 8
2022-08-29 20:34:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21570655384375296 [0;39m 更新电子书下的文档数据结束，耗时：7 毫秒
2022-08-29 20:34:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570655422124032 [0;39m 生成今日电子书快照开始
2022-08-29 20:34:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570655422124032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:34:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570655422124032 [0;39m ==> Parameters: 
2022-08-29 20:34:05.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570655422124032 [0;39m <==    Updates: 0
2022-08-29 20:34:05.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570655422124032 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-29 20:34:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570676347506688 [0;39m 生成今日电子书快照开始
2022-08-29 20:34:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570676347506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:34:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570676347506688 [0;39m ==> Parameters: 
2022-08-29 20:34:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570676347506688 [0;39m <==    Updates: 0
2022-08-29 20:34:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570676347506688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:34:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570697306443776 [0;39m 生成今日电子书快照开始
2022-08-29 20:34:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570697306443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:34:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570697306443776 [0;39m ==> Parameters: 
2022-08-29 20:34:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570697306443776 [0;39m <==    Updates: 0
2022-08-29 20:34:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570697306443776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:34:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570718298935296 [0;39m 生成今日电子书快照开始
2022-08-29 20:34:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570718298935296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:34:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570718298935296 [0;39m ==> Parameters: 
2022-08-29 20:34:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570718298935296 [0;39m <==    Updates: 0
2022-08-29 20:34:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570718298935296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:34:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570739299815424 [0;39m 生成今日电子书快照开始
2022-08-29 20:34:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570739299815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:34:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570739299815424 [0;39m ==> Parameters: 
2022-08-29 20:34:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570739299815424 [0;39m <==    Updates: 0
2022-08-29 20:34:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570739299815424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:34:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570760229392384 [0;39m 生成今日电子书快照开始
2022-08-29 20:34:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570760229392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:34:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570760229392384 [0;39m ==> Parameters: 
2022-08-29 20:34:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570760229392384 [0;39m <==    Updates: 0
2022-08-29 20:34:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570760229392384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:34:35.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21570781234466816 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:34:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570781234466816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:34:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570781234466816 [0;39m ==> Parameters: 
2022-08-29 20:34:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570781234466816 [0;39m <==    Updates: 8
2022-08-29 20:34:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21570781234466816 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:34:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570781242855424 [0;39m 生成今日电子书快照开始
2022-08-29 20:34:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570781242855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:34:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570781242855424 [0;39m ==> Parameters: 
2022-08-29 20:34:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570781242855424 [0;39m <==    Updates: 0
2022-08-29 20:34:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570781242855424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:34:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570802189209600 [0;39m 生成今日电子书快照开始
2022-08-29 20:34:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570802189209600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:34:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570802189209600 [0;39m ==> Parameters: 
2022-08-29 20:34:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570802189209600 [0;39m <==    Updates: 0
2022-08-29 20:34:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570802189209600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:34:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570823173312512 [0;39m 生成今日电子书快照开始
2022-08-29 20:34:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570823173312512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:34:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570823173312512 [0;39m ==> Parameters: 
2022-08-29 20:34:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570823173312512 [0;39m <==    Updates: 0
2022-08-29 20:34:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570823173312512 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-29 20:34:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570844140638208 [0;39m 生成今日电子书快照开始
2022-08-29 20:34:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570844140638208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:34:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570844140638208 [0;39m ==> Parameters: 
2022-08-29 20:34:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570844140638208 [0;39m <==    Updates: 0
2022-08-29 20:34:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570844140638208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:34:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570865078603776 [0;39m 生成今日电子书快照开始
2022-08-29 20:34:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570865078603776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:34:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570865078603776 [0;39m ==> Parameters: 
2022-08-29 20:34:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570865078603776 [0;39m <==    Updates: 0
2022-08-29 20:34:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570865078603776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:35:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570886054318080 [0;39m 生成今日电子书快照开始
2022-08-29 20:35:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570886054318080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:35:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570886054318080 [0;39m ==> Parameters: 
2022-08-29 20:35:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570886054318080 [0;39m <==    Updates: 0
2022-08-29 20:35:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570886054318080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:35:05.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21570907021643776 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:35:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570907021643776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:35:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570907021643776 [0;39m ==> Parameters: 
2022-08-29 20:35:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21570907021643776 [0;39m <==    Updates: 8
2022-08-29 20:35:05.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21570907021643776 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:35:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570907030032384 [0;39m 生成今日电子书快照开始
2022-08-29 20:35:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570907030032384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:35:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570907030032384 [0;39m ==> Parameters: 
2022-08-29 20:35:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570907030032384 [0;39m <==    Updates: 0
2022-08-29 20:35:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570907030032384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:35:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570928018329600 [0;39m 生成今日电子书快照开始
2022-08-29 20:35:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570928018329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:35:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570928018329600 [0;39m ==> Parameters: 
2022-08-29 20:35:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570928018329600 [0;39m <==    Updates: 0
2022-08-29 20:35:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570928018329600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:35:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570949015015424 [0;39m 生成今日电子书快照开始
2022-08-29 20:35:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570949015015424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:35:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570949015015424 [0;39m ==> Parameters: 
2022-08-29 20:35:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570949015015424 [0;39m <==    Updates: 0
2022-08-29 20:35:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570949015015424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:35:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570969965563904 [0;39m 生成今日电子书快照开始
2022-08-29 20:35:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570969965563904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:35:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570969965563904 [0;39m ==> Parameters: 
2022-08-29 20:35:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570969965563904 [0;39m <==    Updates: 0
2022-08-29 20:35:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570969965563904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:35:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21570990945472512 [0;39m 生成今日电子书快照开始
2022-08-29 20:35:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570990945472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:35:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570990945472512 [0;39m ==> Parameters: 
2022-08-29 20:35:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21570990945472512 [0;39m <==    Updates: 0
2022-08-29 20:35:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21570990945472512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:35:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571011883438080 [0;39m 生成今日电子书快照开始
2022-08-29 20:35:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571011883438080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:35:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571011883438080 [0;39m ==> Parameters: 
2022-08-29 20:35:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571011883438080 [0;39m <==    Updates: 0
2022-08-29 20:35:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571011883438080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:35:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571032863346688 [0;39m 生成今日电子书快照开始
2022-08-29 20:35:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571032863346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:35:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571032863346688 [0;39m ==> Parameters: 
2022-08-29 20:35:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571032863346688 [0;39m <==    Updates: 0
2022-08-29 20:35:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571032863346688 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-29 20:35:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21571032896901120 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:35:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571032896901120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:35:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571032896901120 [0;39m ==> Parameters: 
2022-08-29 20:35:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571032896901120 [0;39m <==    Updates: 8
2022-08-29 20:35:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21571032896901120 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-29 20:35:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571053855838208 [0;39m 生成今日电子书快照开始
2022-08-29 20:35:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571053855838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:35:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571053855838208 [0;39m ==> Parameters: 
2022-08-29 20:35:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571053855838208 [0;39m <==    Updates: 0
2022-08-29 20:35:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571053855838208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:35:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571074789609472 [0;39m 生成今日电子书快照开始
2022-08-29 20:35:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571074789609472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:35:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571074789609472 [0;39m ==> Parameters: 
2022-08-29 20:35:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571074789609472 [0;39m <==    Updates: 0
2022-08-29 20:35:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571074789609472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:35:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571095815655424 [0;39m 生成今日电子书快照开始
2022-08-29 20:35:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571095815655424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:35:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571095815655424 [0;39m ==> Parameters: 
2022-08-29 20:35:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571095815655424 [0;39m <==    Updates: 0
2022-08-29 20:35:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571095815655424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:35:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571116782981120 [0;39m 生成今日电子书快照开始
2022-08-29 20:35:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571116782981120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:35:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571116782981120 [0;39m ==> Parameters: 
2022-08-29 20:35:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571116782981120 [0;39m <==    Updates: 0
2022-08-29 20:35:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571116782981120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:36:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571137733529600 [0;39m 生成今日电子书快照开始
2022-08-29 20:36:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571137733529600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:36:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571137733529600 [0;39m ==> Parameters: 
2022-08-29 20:36:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571137733529600 [0;39m <==    Updates: 0
2022-08-29 20:36:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571137733529600 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-29 20:36:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21571158688272384 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:36:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571158688272384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:36:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571158688272384 [0;39m ==> Parameters: 
2022-08-29 20:36:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571158688272384 [0;39m <==    Updates: 8
2022-08-29 20:36:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21571158688272384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:36:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571158696660992 [0;39m 生成今日电子书快照开始
2022-08-29 20:36:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571158696660992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:36:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571158696660992 [0;39m ==> Parameters: 
2022-08-29 20:36:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571158696660992 [0;39m <==    Updates: 0
2022-08-29 20:36:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571158696660992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:36:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571179680763904 [0;39m 生成今日电子书快照开始
2022-08-29 20:36:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571179680763904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:36:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571179680763904 [0;39m ==> Parameters: 
2022-08-29 20:36:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571179680763904 [0;39m <==    Updates: 0
2022-08-29 20:36:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571179680763904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:36:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571200656478208 [0;39m 生成今日电子书快照开始
2022-08-29 20:36:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571200656478208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:36:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571200656478208 [0;39m ==> Parameters: 
2022-08-29 20:36:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571200656478208 [0;39m <==    Updates: 0
2022-08-29 20:36:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571200656478208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:36:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571221648969728 [0;39m 生成今日电子书快照开始
2022-08-29 20:36:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571221648969728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:36:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571221648969728 [0;39m ==> Parameters: 
2022-08-29 20:36:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571221648969728 [0;39m <==    Updates: 0
2022-08-29 20:36:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571221648969728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:36:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571242599518208 [0;39m 生成今日电子书快照开始
2022-08-29 20:36:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571242599518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:36:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571242599518208 [0;39m ==> Parameters: 
2022-08-29 20:36:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571242599518208 [0;39m <==    Updates: 0
2022-08-29 20:36:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571242599518208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:36:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571263558455296 [0;39m 生成今日电子书快照开始
2022-08-29 20:36:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571263558455296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:36:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571263558455296 [0;39m ==> Parameters: 
2022-08-29 20:36:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571263558455296 [0;39m <==    Updates: 0
2022-08-29 20:36:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571263558455296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:36:35.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571284504809472 [0;39m 生成今日电子书快照开始
2022-08-29 20:36:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571284504809472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:36:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571284504809472 [0;39m ==> Parameters: 
2022-08-29 20:36:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571284504809472 [0;39m <==    Updates: 0
2022-08-29 20:36:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571284504809472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:36:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21571284513198080 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:36:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571284513198080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:36:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571284513198080 [0;39m ==> Parameters: 
2022-08-29 20:36:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571284513198080 [0;39m <==    Updates: 8
2022-08-29 20:36:35.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21571284513198080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:36:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571305493106688 [0;39m 生成今日电子书快照开始
2022-08-29 20:36:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571305493106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:36:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571305493106688 [0;39m ==> Parameters: 
2022-08-29 20:36:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571305493106688 [0;39m <==    Updates: 0
2022-08-29 20:36:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571305493106688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:36:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571326456238080 [0;39m 生成今日电子书快照开始
2022-08-29 20:36:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571326456238080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:36:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571326456238080 [0;39m ==> Parameters: 
2022-08-29 20:36:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571326456238080 [0;39m <==    Updates: 0
2022-08-29 20:36:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571326456238080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:36:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571347469701120 [0;39m 生成今日电子书快照开始
2022-08-29 20:36:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571347469701120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:36:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571347469701120 [0;39m ==> Parameters: 
2022-08-29 20:36:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571347469701120 [0;39m <==    Updates: 0
2022-08-29 20:36:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571347469701120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:36:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571368420249600 [0;39m 生成今日电子书快照开始
2022-08-29 20:36:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571368420249600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:36:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571368420249600 [0;39m ==> Parameters: 
2022-08-29 20:36:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571368420249600 [0;39m <==    Updates: 0
2022-08-29 20:36:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571368420249600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:37:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571389408546816 [0;39m 生成今日电子书快照开始
2022-08-29 20:37:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571389408546816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:37:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571389408546816 [0;39m ==> Parameters: 
2022-08-29 20:37:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571389408546816 [0;39m <==    Updates: 0
2022-08-29 20:37:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571389408546816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:37:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571410375872512 [0;39m 生成今日电子书快照开始
2022-08-29 20:37:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571410375872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:37:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571410375872512 [0;39m ==> Parameters: 
2022-08-29 20:37:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571410375872512 [0;39m <==    Updates: 0
2022-08-29 20:37:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571410375872512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:37:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21571410384261120 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:37:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571410384261120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:37:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571410384261120 [0;39m ==> Parameters: 
2022-08-29 20:37:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571410384261120 [0;39m <==    Updates: 8
2022-08-29 20:37:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21571410384261120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:37:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571431322226688 [0;39m 生成今日电子书快照开始
2022-08-29 20:37:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571431322226688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:37:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571431322226688 [0;39m ==> Parameters: 
2022-08-29 20:37:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571431322226688 [0;39m <==    Updates: 0
2022-08-29 20:37:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571431322226688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:37:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571452276969472 [0;39m 生成今日电子书快照开始
2022-08-29 20:37:15.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571452276969472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:37:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571452276969472 [0;39m ==> Parameters: 
2022-08-29 20:37:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571452276969472 [0;39m <==    Updates: 0
2022-08-29 20:37:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571452276969472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:37:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571473269460992 [0;39m 生成今日电子书快照开始
2022-08-29 20:37:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571473269460992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:37:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571473269460992 [0;39m ==> Parameters: 
2022-08-29 20:37:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571473269460992 [0;39m <==    Updates: 0
2022-08-29 20:37:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571473269460992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:37:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571494282924032 [0;39m 生成今日电子书快照开始
2022-08-29 20:37:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571494282924032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:37:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571494282924032 [0;39m ==> Parameters: 
2022-08-29 20:37:25.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571494282924032 [0;39m <==    Updates: 0
2022-08-29 20:37:25.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571494282924032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:37:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571515233472512 [0;39m 生成今日电子书快照开始
2022-08-29 20:37:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571515233472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:37:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571515233472512 [0;39m ==> Parameters: 
2022-08-29 20:37:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571515233472512 [0;39m <==    Updates: 0
2022-08-29 20:37:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571515233472512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:37:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21571536175632384 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:37:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571536175632384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:37:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571536175632384 [0;39m ==> Parameters: 
2022-08-29 20:37:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571536175632384 [0;39m <==    Updates: 8
2022-08-29 20:37:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21571536175632384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:37:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571536184020992 [0;39m 生成今日电子书快照开始
2022-08-29 20:37:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571536184020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:37:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571536184020992 [0;39m ==> Parameters: 
2022-08-29 20:37:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571536184020992 [0;39m <==    Updates: 0
2022-08-29 20:37:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571536184020992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:37:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571557151346688 [0;39m 生成今日电子书快照开始
2022-08-29 20:37:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571557151346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:37:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571557151346688 [0;39m ==> Parameters: 
2022-08-29 20:37:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571557151346688 [0;39m <==    Updates: 0
2022-08-29 20:37:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571557151346688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:37:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571578106089472 [0;39m 生成今日电子书快照开始
2022-08-29 20:37:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571578106089472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:37:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571578106089472 [0;39m ==> Parameters: 
2022-08-29 20:37:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571578106089472 [0;39m <==    Updates: 0
2022-08-29 20:37:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571578106089472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:37:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571599140524032 [0;39m 生成今日电子书快照开始
2022-08-29 20:37:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571599140524032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:37:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571599140524032 [0;39m ==> Parameters: 
2022-08-29 20:37:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571599140524032 [0;39m <==    Updates: 0
2022-08-29 20:37:50.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571599140524032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:37:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571620074295296 [0;39m 生成今日电子书快照开始
2022-08-29 20:37:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571620074295296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:37:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571620074295296 [0;39m ==> Parameters: 
2022-08-29 20:37:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571620074295296 [0;39m <==    Updates: 0
2022-08-29 20:37:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571620074295296 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-29 20:38:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571641045815296 [0;39m 生成今日电子书快照开始
2022-08-29 20:38:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571641045815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:38:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571641045815296 [0;39m ==> Parameters: 
2022-08-29 20:38:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571641045815296 [0;39m <==    Updates: 0
2022-08-29 20:38:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571641045815296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:38:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571662004752384 [0;39m 生成今日电子书快照开始
2022-08-29 20:38:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571662004752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:38:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571662004752384 [0;39m ==> Parameters: 
2022-08-29 20:38:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571662004752384 [0;39m <==    Updates: 0
2022-08-29 20:38:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571662004752384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:38:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21571662013140992 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:38:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571662013140992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:38:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571662013140992 [0;39m ==> Parameters: 
2022-08-29 20:38:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571662013140992 [0;39m <==    Updates: 8
2022-08-29 20:38:05.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21571662013140992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:38:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571682972078080 [0;39m 生成今日电子书快照开始
2022-08-29 20:38:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571682972078080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:38:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571682972078080 [0;39m ==> Parameters: 
2022-08-29 20:38:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571682972078080 [0;39m <==    Updates: 0
2022-08-29 20:38:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571682972078080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:38:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571703985541120 [0;39m 生成今日电子书快照开始
2022-08-29 20:38:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571703985541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:38:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571703985541120 [0;39m ==> Parameters: 
2022-08-29 20:38:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571703985541120 [0;39m <==    Updates: 0
2022-08-29 20:38:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571703985541120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:38:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571724910923776 [0;39m 生成今日电子书快照开始
2022-08-29 20:38:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571724910923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:38:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571724910923776 [0;39m ==> Parameters: 
2022-08-29 20:38:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571724910923776 [0;39m <==    Updates: 0
2022-08-29 20:38:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571724910923776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:38:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571745911803904 [0;39m 生成今日电子书快照开始
2022-08-29 20:38:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571745911803904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:38:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571745911803904 [0;39m ==> Parameters: 
2022-08-29 20:38:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571745911803904 [0;39m <==    Updates: 0
2022-08-29 20:38:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571745911803904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:38:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571766858158080 [0;39m 生成今日电子书快照开始
2022-08-29 20:38:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571766858158080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:38:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571766858158080 [0;39m ==> Parameters: 
2022-08-29 20:38:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571766858158080 [0;39m <==    Updates: 0
2022-08-29 20:38:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571766858158080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:38:35.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21571787867426816 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:38:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571787867426816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:38:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571787867426816 [0;39m ==> Parameters: 
2022-08-29 20:38:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571787867426816 [0;39m <==    Updates: 8
2022-08-29 20:38:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21571787867426816 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:38:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571787875815424 [0;39m 生成今日电子书快照开始
2022-08-29 20:38:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571787875815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:38:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571787875815424 [0;39m ==> Parameters: 
2022-08-29 20:38:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571787875815424 [0;39m <==    Updates: 0
2022-08-29 20:38:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571787875815424 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:38:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571808813780992 [0;39m 生成今日电子书快照开始
2022-08-29 20:38:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571808813780992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:38:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571808813780992 [0;39m ==> Parameters: 
2022-08-29 20:38:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571808813780992 [0;39m <==    Updates: 0
2022-08-29 20:38:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571808813780992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:38:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571829818855424 [0;39m 生成今日电子书快照开始
2022-08-29 20:38:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571829818855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:38:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571829818855424 [0;39m ==> Parameters: 
2022-08-29 20:38:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571829818855424 [0;39m <==    Updates: 0
2022-08-29 20:38:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571829818855424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:38:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571850769403904 [0;39m 生成今日电子书快照开始
2022-08-29 20:38:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571850769403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:38:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571850769403904 [0;39m ==> Parameters: 
2022-08-29 20:38:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571850769403904 [0;39m <==    Updates: 0
2022-08-29 20:38:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571850769403904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:38:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571871715758080 [0;39m 生成今日电子书快照开始
2022-08-29 20:38:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571871715758080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:38:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571871715758080 [0;39m ==> Parameters: 
2022-08-29 20:38:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571871715758080 [0;39m <==    Updates: 0
2022-08-29 20:38:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571871715758080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:39:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571892733415424 [0;39m 生成今日电子书快照开始
2022-08-29 20:39:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571892733415424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:39:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571892733415424 [0;39m ==> Parameters: 
2022-08-29 20:39:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571892733415424 [0;39m <==    Updates: 0
2022-08-29 20:39:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571892733415424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:39:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21571913700741120 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:39:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571913700741120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:39:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571913700741120 [0;39m ==> Parameters: 
2022-08-29 20:39:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21571913700741120 [0;39m <==    Updates: 8
2022-08-29 20:39:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21571913700741120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:39:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571913709129728 [0;39m 生成今日电子书快照开始
2022-08-29 20:39:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571913709129728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:39:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571913709129728 [0;39m ==> Parameters: 
2022-08-29 20:39:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571913709129728 [0;39m <==    Updates: 0
2022-08-29 20:39:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571913709129728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:39:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571934621929472 [0;39m 生成今日电子书快照开始
2022-08-29 20:39:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571934621929472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:39:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571934621929472 [0;39m ==> Parameters: 
2022-08-29 20:39:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571934621929472 [0;39m <==    Updates: 0
2022-08-29 20:39:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571934621929472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:39:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571955631198208 [0;39m 生成今日电子书快照开始
2022-08-29 20:39:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571955631198208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:39:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571955631198208 [0;39m ==> Parameters: 
2022-08-29 20:39:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571955631198208 [0;39m <==    Updates: 0
2022-08-29 20:39:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571955631198208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:39:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571976577552384 [0;39m 生成今日电子书快照开始
2022-08-29 20:39:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571976577552384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:39:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571976577552384 [0;39m ==> Parameters: 
2022-08-29 20:39:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571976577552384 [0;39m <==    Updates: 0
2022-08-29 20:39:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571976577552384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:39:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21571997540683776 [0;39m 生成今日电子书快照开始
2022-08-29 20:39:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571997540683776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:39:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571997540683776 [0;39m ==> Parameters: 
2022-08-29 20:39:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21571997540683776 [0;39m <==    Updates: 0
2022-08-29 20:39:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21571997540683776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:39:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572018516398080 [0;39m 生成今日电子书快照开始
2022-08-29 20:39:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572018516398080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:39:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572018516398080 [0;39m ==> Parameters: 
2022-08-29 20:39:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572018516398080 [0;39m <==    Updates: 0
2022-08-29 20:39:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572018516398080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:39:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21572039521472512 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:39:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572039521472512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:39:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572039521472512 [0;39m ==> Parameters: 
2022-08-29 20:39:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572039521472512 [0;39m <==    Updates: 8
2022-08-29 20:39:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21572039521472512 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-29 20:39:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572039538249728 [0;39m 生成今日电子书快照开始
2022-08-29 20:39:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572039538249728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:39:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572039538249728 [0;39m ==> Parameters: 
2022-08-29 20:39:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572039538249728 [0;39m <==    Updates: 0
2022-08-29 20:39:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572039538249728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:39:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572060505575424 [0;39m 生成今日电子书快照开始
2022-08-29 20:39:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572060505575424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:39:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572060505575424 [0;39m ==> Parameters: 
2022-08-29 20:39:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572060505575424 [0;39m <==    Updates: 0
2022-08-29 20:39:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572060505575424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:39:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572081447735296 [0;39m 生成今日电子书快照开始
2022-08-29 20:39:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572081447735296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:39:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572081447735296 [0;39m ==> Parameters: 
2022-08-29 20:39:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572081447735296 [0;39m <==    Updates: 0
2022-08-29 20:39:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572081447735296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:39:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572102419255296 [0;39m 生成今日电子书快照开始
2022-08-29 20:39:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572102419255296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:39:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572102419255296 [0;39m ==> Parameters: 
2022-08-29 20:39:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572102419255296 [0;39m <==    Updates: 0
2022-08-29 20:39:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572102419255296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:39:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572123399163904 [0;39m 生成今日电子书快照开始
2022-08-29 20:39:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572123399163904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:39:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572123399163904 [0;39m ==> Parameters: 
2022-08-29 20:39:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572123399163904 [0;39m <==    Updates: 0
2022-08-29 20:39:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572123399163904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:40:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572144353906688 [0;39m 生成今日电子书快照开始
2022-08-29 20:40:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572144353906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:40:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572144353906688 [0;39m ==> Parameters: 
2022-08-29 20:40:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572144353906688 [0;39m <==    Updates: 0
2022-08-29 20:40:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572144353906688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:40:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572165338009600 [0;39m 生成今日电子书快照开始
2022-08-29 20:40:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572165338009600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:40:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572165338009600 [0;39m ==> Parameters: 
2022-08-29 20:40:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572165338009600 [0;39m <==    Updates: 0
2022-08-29 20:40:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572165338009600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:40:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21572165346398208 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:40:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572165346398208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:40:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572165346398208 [0;39m ==> Parameters: 
2022-08-29 20:40:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572165346398208 [0;39m <==    Updates: 8
2022-08-29 20:40:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21572165346398208 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:40:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572186334695424 [0;39m 生成今日电子书快照开始
2022-08-29 20:40:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572186334695424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:40:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572186334695424 [0;39m ==> Parameters: 
2022-08-29 20:40:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572186334695424 [0;39m <==    Updates: 0
2022-08-29 20:40:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572186334695424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:40:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572207285243904 [0;39m 生成今日电子书快照开始
2022-08-29 20:40:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572207285243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:40:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572207285243904 [0;39m ==> Parameters: 
2022-08-29 20:40:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572207285243904 [0;39m <==    Updates: 0
2022-08-29 20:40:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572207285243904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:40:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572228252569600 [0;39m 生成今日电子书快照开始
2022-08-29 20:40:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572228252569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:40:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572228252569600 [0;39m ==> Parameters: 
2022-08-29 20:40:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572228252569600 [0;39m <==    Updates: 0
2022-08-29 20:40:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572228252569600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:40:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572249211506688 [0;39m 生成今日电子书快照开始
2022-08-29 20:40:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572249211506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:40:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572249211506688 [0;39m ==> Parameters: 
2022-08-29 20:40:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572249211506688 [0;39m <==    Updates: 0
2022-08-29 20:40:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572249211506688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:40:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572270178832384 [0;39m 生成今日电子书快照开始
2022-08-29 20:40:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572270178832384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:40:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572270178832384 [0;39m ==> Parameters: 
2022-08-29 20:40:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572270178832384 [0;39m <==    Updates: 0
2022-08-29 20:40:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572270178832384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:40:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21572291175518208 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:40:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572291175518208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:40:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572291175518208 [0;39m ==> Parameters: 
2022-08-29 20:40:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572291175518208 [0;39m <==    Updates: 8
2022-08-29 20:40:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21572291175518208 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:40:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572291183906816 [0;39m 生成今日电子书快照开始
2022-08-29 20:40:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572291183906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:40:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572291183906816 [0;39m ==> Parameters: 
2022-08-29 20:40:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572291183906816 [0;39m <==    Updates: 0
2022-08-29 20:40:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572291183906816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:40:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572312159621120 [0;39m 生成今日电子书快照开始
2022-08-29 20:40:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572312159621120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:40:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572312159621120 [0;39m ==> Parameters: 
2022-08-29 20:40:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572312159621120 [0;39m <==    Updates: 0
2022-08-29 20:40:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572312159621120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:40:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572333131141120 [0;39m 生成今日电子书快照开始
2022-08-29 20:40:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572333131141120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:40:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572333131141120 [0;39m ==> Parameters: 
2022-08-29 20:40:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572333131141120 [0;39m <==    Updates: 0
2022-08-29 20:40:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572333131141120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:40:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572354081689600 [0;39m 生成今日电子书快照开始
2022-08-29 20:40:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572354081689600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:40:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572354081689600 [0;39m ==> Parameters: 
2022-08-29 20:40:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572354081689600 [0;39m <==    Updates: 0
2022-08-29 20:40:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572354081689600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:40:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572375069986816 [0;39m 生成今日电子书快照开始
2022-08-29 20:40:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572375069986816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:40:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572375069986816 [0;39m ==> Parameters: 
2022-08-29 20:40:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572375069986816 [0;39m <==    Updates: 0
2022-08-29 20:40:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572375069986816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:41:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572396003758080 [0;39m 生成今日电子书快照开始
2022-08-29 20:41:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572396003758080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:41:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572396003758080 [0;39m ==> Parameters: 
2022-08-29 20:41:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572396003758080 [0;39m <==    Updates: 0
2022-08-29 20:41:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572396003758080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:41:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572417013026816 [0;39m 生成今日电子书快照开始
2022-08-29 20:41:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572417013026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:41:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572417013026816 [0;39m ==> Parameters: 
2022-08-29 20:41:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572417013026816 [0;39m <==    Updates: 0
2022-08-29 20:41:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572417013026816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:41:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21572417021415424 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:41:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572417021415424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:41:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572417021415424 [0;39m ==> Parameters: 
2022-08-29 20:41:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572417021415424 [0;39m <==    Updates: 8
2022-08-29 20:41:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21572417021415424 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:41:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572437938409472 [0;39m 生成今日电子书快照开始
2022-08-29 20:41:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572437938409472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:41:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572437938409472 [0;39m ==> Parameters: 
2022-08-29 20:41:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572437938409472 [0;39m <==    Updates: 0
2022-08-29 20:41:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572437938409472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:41:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572458972844032 [0;39m 生成今日电子书快照开始
2022-08-29 20:41:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572458972844032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:41:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572458972844032 [0;39m ==> Parameters: 
2022-08-29 20:41:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572458972844032 [0;39m <==    Updates: 0
2022-08-29 20:41:15.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572458972844032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:41:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572479940169728 [0;39m 生成今日电子书快照开始
2022-08-29 20:41:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572479940169728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:41:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572479940169728 [0;39m ==> Parameters: 
2022-08-29 20:41:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572479940169728 [0;39m <==    Updates: 0
2022-08-29 20:41:20.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572479940169728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:41:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572500852969472 [0;39m 生成今日电子书快照开始
2022-08-29 20:41:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572500852969472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:41:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572500852969472 [0;39m ==> Parameters: 
2022-08-29 20:41:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572500852969472 [0;39m <==    Updates: 0
2022-08-29 20:41:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572500852969472 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-29 20:41:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572521858043904 [0;39m 生成今日电子书快照开始
2022-08-29 20:41:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572521858043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:41:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572521858043904 [0;39m ==> Parameters: 
2022-08-29 20:41:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572521858043904 [0;39m <==    Updates: 0
2022-08-29 20:41:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572521858043904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:41:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21572542812786688 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:41:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572542812786688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:41:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572542812786688 [0;39m ==> Parameters: 
2022-08-29 20:41:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572542812786688 [0;39m <==    Updates: 8
2022-08-29 20:41:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21572542812786688 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-29 20:41:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572542825369600 [0;39m 生成今日电子书快照开始
2022-08-29 20:41:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572542825369600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:41:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572542825369600 [0;39m ==> Parameters: 
2022-08-29 20:41:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572542825369600 [0;39m <==    Updates: 0
2022-08-29 20:41:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572542825369600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:41:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572563805278208 [0;39m 生成今日电子书快照开始
2022-08-29 20:41:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572563805278208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:41:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572563805278208 [0;39m ==> Parameters: 
2022-08-29 20:41:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572563805278208 [0;39m <==    Updates: 0
2022-08-29 20:41:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572563805278208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:41:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572584793575424 [0;39m 生成今日电子书快照开始
2022-08-29 20:41:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572584793575424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:41:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572584793575424 [0;39m ==> Parameters: 
2022-08-29 20:41:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572584793575424 [0;39m <==    Updates: 0
2022-08-29 20:41:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572584793575424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:41:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572605731540992 [0;39m 生成今日电子书快照开始
2022-08-29 20:41:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572605731540992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:41:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572605731540992 [0;39m ==> Parameters: 
2022-08-29 20:41:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572605731540992 [0;39m <==    Updates: 0
2022-08-29 20:41:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572605731540992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:41:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572626719838208 [0;39m 生成今日电子书快照开始
2022-08-29 20:41:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572626719838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:41:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572626719838208 [0;39m ==> Parameters: 
2022-08-29 20:41:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572626719838208 [0;39m <==    Updates: 0
2022-08-29 20:41:55.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572626719838208 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-29 20:42:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572647653609472 [0;39m 生成今日电子书快照开始
2022-08-29 20:42:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572647653609472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:42:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572647653609472 [0;39m ==> Parameters: 
2022-08-29 20:42:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572647653609472 [0;39m <==    Updates: 0
2022-08-29 20:42:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572647653609472 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-29 20:42:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21572668675461120 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:42:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572668675461120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:42:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572668675461120 [0;39m ==> Parameters: 
2022-08-29 20:42:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572668675461120 [0;39m <==    Updates: 8
2022-08-29 20:42:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21572668675461120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:42:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572668683849728 [0;39m 生成今日电子书快照开始
2022-08-29 20:42:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572668683849728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:42:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572668683849728 [0;39m ==> Parameters: 
2022-08-29 20:42:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572668683849728 [0;39m <==    Updates: 0
2022-08-29 20:42:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572668683849728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:42:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572689605038080 [0;39m 生成今日电子书快照开始
2022-08-29 20:42:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572689605038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:42:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572689605038080 [0;39m ==> Parameters: 
2022-08-29 20:42:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572689605038080 [0;39m <==    Updates: 0
2022-08-29 20:42:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572689605038080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:42:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572710605918208 [0;39m 生成今日电子书快照开始
2022-08-29 20:42:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572710605918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:42:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572710605918208 [0;39m ==> Parameters: 
2022-08-29 20:42:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572710605918208 [0;39m <==    Updates: 0
2022-08-29 20:42:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572710605918208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:42:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572731573243904 [0;39m 生成今日电子书快照开始
2022-08-29 20:42:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572731573243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:42:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572731573243904 [0;39m ==> Parameters: 
2022-08-29 20:42:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572731573243904 [0;39m <==    Updates: 0
2022-08-29 20:42:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572731573243904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:42:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572752569929728 [0;39m 生成今日电子书快照开始
2022-08-29 20:42:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572752569929728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:42:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572752569929728 [0;39m ==> Parameters: 
2022-08-29 20:42:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572752569929728 [0;39m <==    Updates: 0
2022-08-29 20:42:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572752569929728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:42:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572773499506688 [0;39m 生成今日电子书快照开始
2022-08-29 20:42:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572773499506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:42:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572773499506688 [0;39m ==> Parameters: 
2022-08-29 20:42:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572773499506688 [0;39m <==    Updates: 0
2022-08-29 20:42:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572773499506688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:42:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21572794504581120 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:42:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572794504581120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:42:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572794504581120 [0;39m ==> Parameters: 
2022-08-29 20:42:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572794504581120 [0;39m <==    Updates: 8
2022-08-29 20:42:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21572794504581120 [0;39m 更新电子书下的文档数据结束，耗时：0 毫秒
2022-08-29 20:42:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572794504581121 [0;39m 生成今日电子书快照开始
2022-08-29 20:42:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572794504581121 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:42:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572794504581121 [0;39m ==> Parameters: 
2022-08-29 20:42:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572794504581121 [0;39m <==    Updates: 0
2022-08-29 20:42:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572794504581121 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:42:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572815484489728 [0;39m 生成今日电子书快照开始
2022-08-29 20:42:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572815484489728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:42:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572815484489728 [0;39m ==> Parameters: 
2022-08-29 20:42:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572815484489728 [0;39m <==    Updates: 0
2022-08-29 20:42:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572815484489728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:42:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572836426649600 [0;39m 生成今日电子书快照开始
2022-08-29 20:42:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572836426649600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:42:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572836426649600 [0;39m ==> Parameters: 
2022-08-29 20:42:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572836426649600 [0;39m <==    Updates: 0
2022-08-29 20:42:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572836426649600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:42:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572857381392384 [0;39m 生成今日电子书快照开始
2022-08-29 20:42:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572857381392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:42:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572857381392384 [0;39m ==> Parameters: 
2022-08-29 20:42:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572857381392384 [0;39m <==    Updates: 0
2022-08-29 20:42:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572857381392384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:42:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572878369689600 [0;39m 生成今日电子书快照开始
2022-08-29 20:42:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572878369689600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:42:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572878369689600 [0;39m ==> Parameters: 
2022-08-29 20:42:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572878369689600 [0;39m <==    Updates: 0
2022-08-29 20:42:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572878369689600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:43:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572899320238080 [0;39m 生成今日电子书快照开始
2022-08-29 20:43:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572899320238080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:43:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572899320238080 [0;39m ==> Parameters: 
2022-08-29 20:43:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572899320238080 [0;39m <==    Updates: 0
2022-08-29 20:43:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572899320238080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:43:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572920300146688 [0;39m 生成今日电子书快照开始
2022-08-29 20:43:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572920300146688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:43:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572920300146688 [0;39m ==> Parameters: 
2022-08-29 20:43:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572920300146688 [0;39m <==    Updates: 0
2022-08-29 20:43:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572920300146688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:43:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21572920312729600 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:43:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572920312729600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:43:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572920312729600 [0;39m ==> Parameters: 
2022-08-29 20:43:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21572920312729600 [0;39m <==    Updates: 8
2022-08-29 20:43:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21572920312729600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:43:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572941309415424 [0;39m 生成今日电子书快照开始
2022-08-29 20:43:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572941309415424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:43:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572941309415424 [0;39m ==> Parameters: 
2022-08-29 20:43:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572941309415424 [0;39m <==    Updates: 0
2022-08-29 20:43:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572941309415424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:43:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572962247380992 [0;39m 生成今日电子书快照开始
2022-08-29 20:43:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572962247380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:43:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572962247380992 [0;39m ==> Parameters: 
2022-08-29 20:43:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572962247380992 [0;39m <==    Updates: 0
2022-08-29 20:43:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572962247380992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:43:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21572983252455424 [0;39m 生成今日电子书快照开始
2022-08-29 20:43:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572983252455424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:43:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572983252455424 [0;39m ==> Parameters: 
2022-08-29 20:43:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21572983252455424 [0;39m <==    Updates: 0
2022-08-29 20:43:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21572983252455424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:43:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573004169449472 [0;39m 生成今日电子书快照开始
2022-08-29 20:43:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573004169449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:43:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573004169449472 [0;39m ==> Parameters: 
2022-08-29 20:43:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573004169449472 [0;39m <==    Updates: 0
2022-08-29 20:43:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573004169449472 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-29 20:43:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573025195495424 [0;39m 生成今日电子书快照开始
2022-08-29 20:43:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573025195495424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:43:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573025195495424 [0;39m ==> Parameters: 
2022-08-29 20:43:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573025195495424 [0;39m <==    Updates: 0
2022-08-29 20:43:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573025195495424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:43:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21573046137655296 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:43:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573046137655296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:43:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573046137655296 [0;39m ==> Parameters: 
2022-08-29 20:43:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573046137655296 [0;39m <==    Updates: 8
2022-08-29 20:43:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21573046137655296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:43:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573046146043904 [0;39m 生成今日电子书快照开始
2022-08-29 20:43:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573046146043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:43:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573046146043904 [0;39m ==> Parameters: 
2022-08-29 20:43:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573046146043904 [0;39m <==    Updates: 0
2022-08-29 20:43:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573046146043904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:43:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573067104980992 [0;39m 生成今日电子书快照开始
2022-08-29 20:43:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573067104980992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:43:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573067104980992 [0;39m ==> Parameters: 
2022-08-29 20:43:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573067104980992 [0;39m <==    Updates: 0
2022-08-29 20:43:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573067104980992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:43:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573088097472512 [0;39m 生成今日电子书快照开始
2022-08-29 20:43:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573088097472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:43:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573088097472512 [0;39m ==> Parameters: 
2022-08-29 20:43:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573088097472512 [0;39m <==    Updates: 0
2022-08-29 20:43:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573088097472512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:43:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573109052215296 [0;39m 生成今日电子书快照开始
2022-08-29 20:43:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573109052215296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:43:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573109052215296 [0;39m ==> Parameters: 
2022-08-29 20:43:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573109052215296 [0;39m <==    Updates: 0
2022-08-29 20:43:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573109052215296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:43:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573130027929600 [0;39m 生成今日电子书快照开始
2022-08-29 20:43:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573130027929600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:43:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573130027929600 [0;39m ==> Parameters: 
2022-08-29 20:43:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573130027929600 [0;39m <==    Updates: 0
2022-08-29 20:43:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573130027929600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:44:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573151024615424 [0;39m 生成今日电子书快照开始
2022-08-29 20:44:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573151024615424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:44:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573151024615424 [0;39m ==> Parameters: 
2022-08-29 20:44:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573151024615424 [0;39m <==    Updates: 0
2022-08-29 20:44:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573151024615424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:44:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573171991941120 [0;39m 生成今日电子书快照开始
2022-08-29 20:44:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573171991941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:44:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573171991941120 [0;39m ==> Parameters: 
2022-08-29 20:44:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573171991941120 [0;39m <==    Updates: 0
2022-08-29 20:44:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573171991941120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:44:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21573172000329728 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:44:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573172000329728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:44:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573172000329728 [0;39m ==> Parameters: 
2022-08-29 20:44:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573172000329728 [0;39m <==    Updates: 8
2022-08-29 20:44:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21573172000329728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:44:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573192976044032 [0;39m 生成今日电子书快照开始
2022-08-29 20:44:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573192976044032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:44:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573192976044032 [0;39m ==> Parameters: 
2022-08-29 20:44:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573192976044032 [0;39m <==    Updates: 0
2022-08-29 20:44:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573192976044032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:44:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573213922398208 [0;39m 生成今日电子书快照开始
2022-08-29 20:44:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573213922398208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:44:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573213922398208 [0;39m ==> Parameters: 
2022-08-29 20:44:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573213922398208 [0;39m <==    Updates: 0
2022-08-29 20:44:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573213922398208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:44:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573234864558080 [0;39m 生成今日电子书快照开始
2022-08-29 20:44:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573234864558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:44:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573234864558080 [0;39m ==> Parameters: 
2022-08-29 20:44:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573234864558080 [0;39m <==    Updates: 0
2022-08-29 20:44:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573234864558080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:44:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573255857049600 [0;39m 生成今日电子书快照开始
2022-08-29 20:44:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573255857049600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:44:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573255857049600 [0;39m ==> Parameters: 
2022-08-29 20:44:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573255857049600 [0;39m <==    Updates: 0
2022-08-29 20:44:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573255857049600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:44:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573276799209472 [0;39m 生成今日电子书快照开始
2022-08-29 20:44:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573276799209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:44:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573276799209472 [0;39m ==> Parameters: 
2022-08-29 20:44:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573276799209472 [0;39m <==    Updates: 0
2022-08-29 20:44:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573276799209472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:44:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573297779118080 [0;39m 生成今日电子书快照开始
2022-08-29 20:44:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573297779118080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:44:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573297779118080 [0;39m ==> Parameters: 
2022-08-29 20:44:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573297779118080 [0;39m <==    Updates: 0
2022-08-29 20:44:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573297779118080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:44:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21573297787506688 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:44:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573297787506688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:44:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573297787506688 [0;39m ==> Parameters: 
2022-08-29 20:44:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573297787506688 [0;39m <==    Updates: 8
2022-08-29 20:44:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21573297787506688 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:44:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573318767415296 [0;39m 生成今日电子书快照开始
2022-08-29 20:44:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573318767415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:44:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573318767415296 [0;39m ==> Parameters: 
2022-08-29 20:44:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573318767415296 [0;39m <==    Updates: 0
2022-08-29 20:44:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573318767415296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:44:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573339743129600 [0;39m 生成今日电子书快照开始
2022-08-29 20:44:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573339743129600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:44:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573339743129600 [0;39m ==> Parameters: 
2022-08-29 20:44:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573339743129600 [0;39m <==    Updates: 0
2022-08-29 20:44:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573339743129600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:44:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573360744009728 [0;39m 生成今日电子书快照开始
2022-08-29 20:44:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573360744009728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:44:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573360744009728 [0;39m ==> Parameters: 
2022-08-29 20:44:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573360744009728 [0;39m <==    Updates: 0
2022-08-29 20:44:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573360744009728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:44:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573381690363904 [0;39m 生成今日电子书快照开始
2022-08-29 20:44:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573381690363904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:44:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573381690363904 [0;39m ==> Parameters: 
2022-08-29 20:44:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573381690363904 [0;39m <==    Updates: 0
2022-08-29 20:44:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573381690363904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:45:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573402682855424 [0;39m 生成今日电子书快照开始
2022-08-29 20:45:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573402682855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:45:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573402682855424 [0;39m ==> Parameters: 
2022-08-29 20:45:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573402682855424 [0;39m <==    Updates: 0
2022-08-29 20:45:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573402682855424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:45:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573423616626688 [0;39m 生成今日电子书快照开始
2022-08-29 20:45:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573423616626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:45:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573423616626688 [0;39m ==> Parameters: 
2022-08-29 20:45:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573423616626688 [0;39m <==    Updates: 0
2022-08-29 20:45:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573423616626688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:45:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21573423629209600 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:45:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573423629209600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:45:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573423629209600 [0;39m ==> Parameters: 
2022-08-29 20:45:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573423629209600 [0;39m <==    Updates: 8
2022-08-29 20:45:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21573423629209600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:45:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573444630089728 [0;39m 生成今日电子书快照开始
2022-08-29 20:45:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573444630089728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:45:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573444630089728 [0;39m ==> Parameters: 
2022-08-29 20:45:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573444630089728 [0;39m <==    Updates: 0
2022-08-29 20:45:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573444630089728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:45:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573465589026816 [0;39m 生成今日电子书快照开始
2022-08-29 20:45:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573465589026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:45:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573465589026816 [0;39m ==> Parameters: 
2022-08-29 20:45:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573465589026816 [0;39m <==    Updates: 0
2022-08-29 20:45:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573465589026816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:45:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573486573129728 [0;39m 生成今日电子书快照开始
2022-08-29 20:45:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573486573129728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:45:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573486573129728 [0;39m ==> Parameters: 
2022-08-29 20:45:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573486573129728 [0;39m <==    Updates: 0
2022-08-29 20:45:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573486573129728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:45:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573507544649728 [0;39m 生成今日电子书快照开始
2022-08-29 20:45:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573507544649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:45:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573507544649728 [0;39m ==> Parameters: 
2022-08-29 20:45:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573507544649728 [0;39m <==    Updates: 0
2022-08-29 20:45:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573507544649728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:45:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573528486809600 [0;39m 生成今日电子书快照开始
2022-08-29 20:45:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573528486809600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:45:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573528486809600 [0;39m ==> Parameters: 
2022-08-29 20:45:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573528486809600 [0;39m <==    Updates: 0
2022-08-29 20:45:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573528486809600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:45:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573549458329600 [0;39m 生成今日电子书快照开始
2022-08-29 20:45:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573549458329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:45:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573549458329600 [0;39m ==> Parameters: 
2022-08-29 20:45:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573549458329600 [0;39m <==    Updates: 0
2022-08-29 20:45:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573549458329600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:45:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21573549466718208 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:45:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573549466718208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:45:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573549466718208 [0;39m ==> Parameters: 
2022-08-29 20:45:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573549466718208 [0;39m <==    Updates: 8
2022-08-29 20:45:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21573549466718208 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:45:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573570438238208 [0;39m 生成今日电子书快照开始
2022-08-29 20:45:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573570438238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:45:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573570438238208 [0;39m ==> Parameters: 
2022-08-29 20:45:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573570438238208 [0;39m <==    Updates: 0
2022-08-29 20:45:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573570438238208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:45:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573591392980992 [0;39m 生成今日电子书快照开始
2022-08-29 20:45:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573591392980992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:45:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573591392980992 [0;39m ==> Parameters: 
2022-08-29 20:45:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573591392980992 [0;39m <==    Updates: 0
2022-08-29 20:45:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573591392980992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:45:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573612368695296 [0;39m 生成今日电子书快照开始
2022-08-29 20:45:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573612368695296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:45:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573612368695296 [0;39m ==> Parameters: 
2022-08-29 20:45:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573612368695296 [0;39m <==    Updates: 0
2022-08-29 20:45:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573612368695296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:45:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573633348603904 [0;39m 生成今日电子书快照开始
2022-08-29 20:45:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573633348603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:45:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573633348603904 [0;39m ==> Parameters: 
2022-08-29 20:45:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573633348603904 [0;39m <==    Updates: 0
2022-08-29 20:45:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573633348603904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:46:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573654315929600 [0;39m 生成今日电子书快照开始
2022-08-29 20:46:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573654315929600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:46:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573654315929600 [0;39m ==> Parameters: 
2022-08-29 20:46:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573654315929600 [0;39m <==    Updates: 0
2022-08-29 20:46:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573654315929600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:46:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21573675270672384 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:46:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573675270672384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:46:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573675270672384 [0;39m ==> Parameters: 
2022-08-29 20:46:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573675270672384 [0;39m <==    Updates: 8
2022-08-29 20:46:05.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21573675270672384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:46:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573675279060992 [0;39m 生成今日电子书快照开始
2022-08-29 20:46:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573675279060992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:46:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573675279060992 [0;39m ==> Parameters: 
2022-08-29 20:46:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573675279060992 [0;39m <==    Updates: 0
2022-08-29 20:46:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573675279060992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:46:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573696275746816 [0;39m 生成今日电子书快照开始
2022-08-29 20:46:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573696275746816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:46:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573696275746816 [0;39m ==> Parameters: 
2022-08-29 20:46:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573696275746816 [0;39m <==    Updates: 0
2022-08-29 20:46:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573696275746816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:46:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573717247266816 [0;39m 生成今日电子书快照开始
2022-08-29 20:46:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573717247266816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:46:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573717247266816 [0;39m ==> Parameters: 
2022-08-29 20:46:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573717247266816 [0;39m <==    Updates: 0
2022-08-29 20:46:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573717247266816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:46:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573738222981120 [0;39m 生成今日电子书快照开始
2022-08-29 20:46:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573738222981120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:46:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573738222981120 [0;39m ==> Parameters: 
2022-08-29 20:46:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573738222981120 [0;39m <==    Updates: 0
2022-08-29 20:46:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573738222981120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:46:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573759190306816 [0;39m 生成今日电子书快照开始
2022-08-29 20:46:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573759190306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:46:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573759190306816 [0;39m ==> Parameters: 
2022-08-29 20:46:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573759190306816 [0;39m <==    Updates: 0
2022-08-29 20:46:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573759190306816 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-29 20:46:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573780119883776 [0;39m 生成今日电子书快照开始
2022-08-29 20:46:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573780119883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:46:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573780119883776 [0;39m ==> Parameters: 
2022-08-29 20:46:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573780119883776 [0;39m <==    Updates: 0
2022-08-29 20:46:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573780119883776 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-29 20:46:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21573801108180992 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:46:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573801108180992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:46:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573801108180992 [0;39m ==> Parameters: 
2022-08-29 20:46:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573801108180992 [0;39m <==    Updates: 8
2022-08-29 20:46:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21573801108180992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-29 20:46:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573801116569600 [0;39m 生成今日电子书快照开始
2022-08-29 20:46:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573801116569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:46:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573801116569600 [0;39m ==> Parameters: 
2022-08-29 20:46:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573801116569600 [0;39m <==    Updates: 0
2022-08-29 20:46:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573801116569600 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:46:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573822062923776 [0;39m 生成今日电子书快照开始
2022-08-29 20:46:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573822062923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:46:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573822062923776 [0;39m ==> Parameters: 
2022-08-29 20:46:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573822062923776 [0;39m <==    Updates: 0
2022-08-29 20:46:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573822062923776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:46:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573843084775424 [0;39m 生成今日电子书快照开始
2022-08-29 20:46:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573843084775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:46:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573843084775424 [0;39m ==> Parameters: 
2022-08-29 20:46:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573843084775424 [0;39m <==    Updates: 0
2022-08-29 20:46:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573843084775424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:46:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573864022740992 [0;39m 生成今日电子书快照开始
2022-08-29 20:46:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573864022740992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:46:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573864022740992 [0;39m ==> Parameters: 
2022-08-29 20:46:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573864022740992 [0;39m <==    Updates: 0
2022-08-29 20:46:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573864022740992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:46:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573885011038208 [0;39m 生成今日电子书快照开始
2022-08-29 20:46:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573885011038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:46:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573885011038208 [0;39m ==> Parameters: 
2022-08-29 20:46:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573885011038208 [0;39m <==    Updates: 0
2022-08-29 20:46:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573885011038208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:47:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573905978363904 [0;39m 生成今日电子书快照开始
2022-08-29 20:47:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573905978363904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:47:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573905978363904 [0;39m ==> Parameters: 
2022-08-29 20:47:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573905978363904 [0;39m <==    Updates: 0
2022-08-29 20:47:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573905978363904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:47:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21573926949883904 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:47:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573926949883904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:47:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573926949883904 [0;39m ==> Parameters: 
2022-08-29 20:47:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21573926949883904 [0;39m <==    Updates: 8
2022-08-29 20:47:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21573926949883904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:47:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573926958272512 [0;39m 生成今日电子书快照开始
2022-08-29 20:47:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573926958272512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:47:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573926958272512 [0;39m ==> Parameters: 
2022-08-29 20:47:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573926958272512 [0;39m <==    Updates: 0
2022-08-29 20:47:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573926958272512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:47:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573947917209600 [0;39m 生成今日电子书快照开始
2022-08-29 20:47:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573947917209600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:47:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573947917209600 [0;39m ==> Parameters: 
2022-08-29 20:47:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573947917209600 [0;39m <==    Updates: 0
2022-08-29 20:47:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573947917209600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:47:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573968863563776 [0;39m 生成今日电子书快照开始
2022-08-29 20:47:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573968863563776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:47:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573968863563776 [0;39m ==> Parameters: 
2022-08-29 20:47:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573968863563776 [0;39m <==    Updates: 0
2022-08-29 20:47:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573968863563776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:47:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21573989843472384 [0;39m 生成今日电子书快照开始
2022-08-29 20:47:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573989843472384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:47:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573989843472384 [0;39m ==> Parameters: 
2022-08-29 20:47:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21573989843472384 [0;39m <==    Updates: 0
2022-08-29 20:47:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21573989843472384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:47:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574010840158208 [0;39m 生成今日电子书快照开始
2022-08-29 20:47:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574010840158208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:47:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574010840158208 [0;39m ==> Parameters: 
2022-08-29 20:47:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574010840158208 [0;39m <==    Updates: 0
2022-08-29 20:47:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574010840158208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:47:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574031807483904 [0;39m 生成今日电子书快照开始
2022-08-29 20:47:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574031807483904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:47:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574031807483904 [0;39m ==> Parameters: 
2022-08-29 20:47:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574031807483904 [0;39m <==    Updates: 0
2022-08-29 20:47:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574031807483904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:47:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21574052783198208 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:47:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574052783198208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:47:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574052783198208 [0;39m ==> Parameters: 
2022-08-29 20:47:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574052783198208 [0;39m <==    Updates: 8
2022-08-29 20:47:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21574052783198208 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-29 20:47:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574052804169728 [0;39m 生成今日电子书快照开始
2022-08-29 20:47:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574052804169728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:47:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574052804169728 [0;39m ==> Parameters: 
2022-08-29 20:47:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574052804169728 [0;39m <==    Updates: 0
2022-08-29 20:47:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574052804169728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:47:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574073758912512 [0;39m 生成今日电子书快照开始
2022-08-29 20:47:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574073758912512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:47:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574073758912512 [0;39m ==> Parameters: 
2022-08-29 20:47:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574073758912512 [0;39m <==    Updates: 0
2022-08-29 20:47:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574073758912512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:47:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574094726238208 [0;39m 生成今日电子书快照开始
2022-08-29 20:47:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574094726238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:47:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574094726238208 [0;39m ==> Parameters: 
2022-08-29 20:47:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574094726238208 [0;39m <==    Updates: 0
2022-08-29 20:47:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574094726238208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:47:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574115668398080 [0;39m 生成今日电子书快照开始
2022-08-29 20:47:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574115668398080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:47:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574115668398080 [0;39m ==> Parameters: 
2022-08-29 20:47:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574115668398080 [0;39m <==    Updates: 0
2022-08-29 20:47:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574115668398080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:47:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574136686055424 [0;39m 生成今日电子书快照开始
2022-08-29 20:47:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574136686055424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:47:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574136686055424 [0;39m ==> Parameters: 
2022-08-29 20:47:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574136686055424 [0;39m <==    Updates: 0
2022-08-29 20:47:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574136686055424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:48:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574157611438080 [0;39m 生成今日电子书快照开始
2022-08-29 20:48:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574157611438080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:48:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574157611438080 [0;39m ==> Parameters: 
2022-08-29 20:48:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574157611438080 [0;39m <==    Updates: 0
2022-08-29 20:48:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574157611438080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:48:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21574178591346688 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:48:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574178591346688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:48:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574178591346688 [0;39m ==> Parameters: 
2022-08-29 20:48:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574178591346688 [0;39m <==    Updates: 8
2022-08-29 20:48:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21574178591346688 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:48:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574178599735296 [0;39m 生成今日电子书快照开始
2022-08-29 20:48:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574178599735296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:48:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574178599735296 [0;39m ==> Parameters: 
2022-08-29 20:48:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574178599735296 [0;39m <==    Updates: 0
2022-08-29 20:48:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574178599735296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:48:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574199554478080 [0;39m 生成今日电子书快照开始
2022-08-29 20:48:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574199554478080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:48:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574199554478080 [0;39m ==> Parameters: 
2022-08-29 20:48:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574199554478080 [0;39m <==    Updates: 0
2022-08-29 20:48:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574199554478080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:48:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574220567941120 [0;39m 生成今日电子书快照开始
2022-08-29 20:48:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574220567941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:48:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574220567941120 [0;39m ==> Parameters: 
2022-08-29 20:48:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574220567941120 [0;39m <==    Updates: 0
2022-08-29 20:48:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574220567941120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:48:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574241505906688 [0;39m 生成今日电子书快照开始
2022-08-29 20:48:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574241505906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:48:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574241505906688 [0;39m ==> Parameters: 
2022-08-29 20:48:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574241505906688 [0;39m <==    Updates: 0
2022-08-29 20:48:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574241505906688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:48:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574262515175424 [0;39m 生成今日电子书快照开始
2022-08-29 20:48:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574262515175424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:48:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574262515175424 [0;39m ==> Parameters: 
2022-08-29 20:48:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574262515175424 [0;39m <==    Updates: 0
2022-08-29 20:48:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574262515175424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:48:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574283457335296 [0;39m 生成今日电子书快照开始
2022-08-29 20:48:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574283457335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:48:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574283457335296 [0;39m ==> Parameters: 
2022-08-29 20:48:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574283457335296 [0;39m <==    Updates: 0
2022-08-29 20:48:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574283457335296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:48:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21574304433049600 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:48:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574304433049600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:48:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574304433049600 [0;39m ==> Parameters: 
2022-08-29 20:48:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574304433049600 [0;39m <==    Updates: 8
2022-08-29 20:48:35.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21574304433049600 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:48:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574304441438208 [0;39m 生成今日电子书快照开始
2022-08-29 20:48:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574304441438208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:48:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574304441438208 [0;39m ==> Parameters: 
2022-08-29 20:48:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574304441438208 [0;39m <==    Updates: 0
2022-08-29 20:48:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574304441438208 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:48:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574325400375296 [0;39m 生成今日电子书快照开始
2022-08-29 20:48:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574325400375296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:48:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574325400375296 [0;39m ==> Parameters: 
2022-08-29 20:48:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574325400375296 [0;39m <==    Updates: 0
2022-08-29 20:48:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574325400375296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:48:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574346350923776 [0;39m 生成今日电子书快照开始
2022-08-29 20:48:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574346350923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:48:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574346350923776 [0;39m ==> Parameters: 
2022-08-29 20:48:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574346350923776 [0;39m <==    Updates: 0
2022-08-29 20:48:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574346350923776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:48:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574367322443776 [0;39m 生成今日电子书快照开始
2022-08-29 20:48:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574367322443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:48:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574367322443776 [0;39m ==> Parameters: 
2022-08-29 20:48:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574367322443776 [0;39m <==    Updates: 0
2022-08-29 20:48:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574367322443776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:48:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574388323323904 [0;39m 生成今日电子书快照开始
2022-08-29 20:48:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574388323323904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:48:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574388323323904 [0;39m ==> Parameters: 
2022-08-29 20:48:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574388323323904 [0;39m <==    Updates: 0
2022-08-29 20:48:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574388323323904 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-29 20:49:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574409273872384 [0;39m 生成今日电子书快照开始
2022-08-29 20:49:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574409273872384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:49:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574409273872384 [0;39m ==> Parameters: 
2022-08-29 20:49:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574409273872384 [0;39m <==    Updates: 0
2022-08-29 20:49:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574409273872384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-29 20:49:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574430266363904 [0;39m 生成今日电子书快照开始
2022-08-29 20:49:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574430266363904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:49:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574430266363904 [0;39m ==> Parameters: 
2022-08-29 20:49:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574430266363904 [0;39m <==    Updates: 0
2022-08-29 20:49:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574430266363904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:49:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21574430274752512 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:49:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574430274752512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:49:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574430274752512 [0;39m ==> Parameters: 
2022-08-29 20:49:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574430274752512 [0;39m <==    Updates: 8
2022-08-29 20:49:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21574430274752512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:49:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574451225300992 [0;39m 生成今日电子书快照开始
2022-08-29 20:49:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574451225300992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:49:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574451225300992 [0;39m ==> Parameters: 
2022-08-29 20:49:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574451225300992 [0;39m <==    Updates: 0
2022-08-29 20:49:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574451225300992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:49:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574472209403904 [0;39m 生成今日电子书快照开始
2022-08-29 20:49:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574472209403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:49:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574472209403904 [0;39m ==> Parameters: 
2022-08-29 20:49:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574472209403904 [0;39m <==    Updates: 0
2022-08-29 20:49:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574472209403904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:49:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574493164146688 [0;39m 生成今日电子书快照开始
2022-08-29 20:49:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574493164146688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:49:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574493164146688 [0;39m ==> Parameters: 
2022-08-29 20:49:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574493164146688 [0;39m <==    Updates: 0
2022-08-29 20:49:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574493164146688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:49:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574514169221120 [0;39m 生成今日电子书快照开始
2022-08-29 20:49:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574514169221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:49:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574514169221120 [0;39m ==> Parameters: 
2022-08-29 20:49:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574514169221120 [0;39m <==    Updates: 0
2022-08-29 20:49:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574514169221120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:49:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574535115575296 [0;39m 生成今日电子书快照开始
2022-08-29 20:49:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574535115575296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:49:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574535115575296 [0;39m ==> Parameters: 
2022-08-29 20:49:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574535115575296 [0;39m <==    Updates: 0
2022-08-29 20:49:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574535115575296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:49:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21574556112261120 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:49:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574556112261120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:49:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574556112261120 [0;39m ==> Parameters: 
2022-08-29 20:49:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574556112261120 [0;39m <==    Updates: 8
2022-08-29 20:49:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21574556112261120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:49:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574556120649728 [0;39m 生成今日电子书快照开始
2022-08-29 20:49:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574556120649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:49:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574556120649728 [0;39m ==> Parameters: 
2022-08-29 20:49:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574556120649728 [0;39m <==    Updates: 0
2022-08-29 20:49:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574556120649728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:49:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574577037643776 [0;39m 生成今日电子书快照开始
2022-08-29 20:49:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574577037643776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:49:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574577037643776 [0;39m ==> Parameters: 
2022-08-29 20:49:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574577037643776 [0;39m <==    Updates: 0
2022-08-29 20:49:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574577037643776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:49:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574598013358080 [0;39m 生成今日电子书快照开始
2022-08-29 20:49:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574598013358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:49:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574598013358080 [0;39m ==> Parameters: 
2022-08-29 20:49:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574598013358080 [0;39m <==    Updates: 0
2022-08-29 20:49:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574598013358080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:49:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574619035209728 [0;39m 生成今日电子书快照开始
2022-08-29 20:49:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574619035209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:49:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574619035209728 [0;39m ==> Parameters: 
2022-08-29 20:49:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574619035209728 [0;39m <==    Updates: 0
2022-08-29 20:49:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574619035209728 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-29 20:49:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574639952203776 [0;39m 生成今日电子书快照开始
2022-08-29 20:49:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574639952203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:49:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574639952203776 [0;39m ==> Parameters: 
2022-08-29 20:49:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574639952203776 [0;39m <==    Updates: 0
2022-08-29 20:49:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574639952203776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:50:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574660969861120 [0;39m 生成今日电子书快照开始
2022-08-29 20:50:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574660969861120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:50:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574660969861120 [0;39m ==> Parameters: 
2022-08-29 20:50:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574660969861120 [0;39m <==    Updates: 0
2022-08-29 20:50:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574660969861120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:50:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574681949769728 [0;39m 生成今日电子书快照开始
2022-08-29 20:50:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574681949769728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:50:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574681949769728 [0;39m ==> Parameters: 
2022-08-29 20:50:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574681949769728 [0;39m <==    Updates: 0
2022-08-29 20:50:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574681949769728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:50:05.017 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21574681958158336 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:50:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574681958158336 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:50:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574681958158336 [0;39m ==> Parameters: 
2022-08-29 20:50:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574681958158336 [0;39m <==    Updates: 8
2022-08-29 20:50:05.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21574681958158336 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:50:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574702917095424 [0;39m 生成今日电子书快照开始
2022-08-29 20:50:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574702917095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:50:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574702917095424 [0;39m ==> Parameters: 
2022-08-29 20:50:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574702917095424 [0;39m <==    Updates: 0
2022-08-29 20:50:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574702917095424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:50:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574723876032512 [0;39m 生成今日电子书快照开始
2022-08-29 20:50:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574723876032512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:50:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574723876032512 [0;39m ==> Parameters: 
2022-08-29 20:50:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574723876032512 [0;39m <==    Updates: 0
2022-08-29 20:50:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574723876032512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:50:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574744813998080 [0;39m 生成今日电子书快照开始
2022-08-29 20:50:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574744813998080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:50:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574744813998080 [0;39m ==> Parameters: 
2022-08-29 20:50:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574744813998080 [0;39m <==    Updates: 0
2022-08-29 20:50:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574744813998080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:50:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574765831655424 [0;39m 生成今日电子书快照开始
2022-08-29 20:50:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574765831655424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:50:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574765831655424 [0;39m ==> Parameters: 
2022-08-29 20:50:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574765831655424 [0;39m <==    Updates: 0
2022-08-29 20:50:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574765831655424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:50:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574786803175424 [0;39m 生成今日电子书快照开始
2022-08-29 20:50:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574786803175424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:50:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574786803175424 [0;39m ==> Parameters: 
2022-08-29 20:50:30.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574786803175424 [0;39m <==    Updates: 0
2022-08-29 20:50:30.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574786803175424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-29 20:50:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m21574807732752384 [0;39m 更新电子书下的文档数据开始
2022-08-29 20:50:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574807732752384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-29 20:50:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574807732752384 [0;39m ==> Parameters: 
2022-08-29 20:50:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m21574807732752384 [0;39m <==    Updates: 8
2022-08-29 20:50:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m21574807732752384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-29 20:50:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m21574807741140992 [0;39m 生成今日电子书快照开始
2022-08-29 20:50:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574807741140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-29 20:50:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574807741140992 [0;39m ==> Parameters: 
2022-08-29 20:50:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m21574807741140992 [0;39m <==    Updates: 0
2022-08-29 20:50:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m21574807741140992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-29 20:50:38.124 INFO  com.zaxxer.hikari.HikariDataSource                :350 
                [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-08-29 20:50:38.134 INFO  com.zaxxer.hikari.HikariDataSource                :352 
                [32m                  [0;39m HikariPool-1 - Shutdown completed.
