2022-08-31 17:27:40.496 INFO  org.hibernate.validator.internal.util.Version     :21  
                [32m                  [0;39m HV000001: Hibernate Validator 6.2.3.Final
2022-08-31 17:27:40.523 INFO  com.zs.wikibb.WikibbApplication                   :55  
                [32m                  [0;39m Starting WikibbApplication using Java 1.8.0_221 on LAPTOP-OO2VPQLS with PID 39116 (D:\wikibb\target\classes started by 张硕 in D:\wikibb)
2022-08-31 17:27:40.524 INFO  com.zs.wikibb.WikibbApplication                   :640 
                [32m                  [0;39m No active profile set, falling back to 1 default profile: "default"
2022-08-31 17:27:40.588 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255 
                [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-08-31 17:27:40.591 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255 
                [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-08-31 17:27:42.705 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262 
                [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-08-31 17:27:42.707 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132 
                [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-08-31 17:27:42.734 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201 
                [32m                  [0;39m Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
2022-08-31 17:27:44.456 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108 
                [32m                  [0;39m Tomcat initialized with port(s): 8880 (http)
2022-08-31 17:27:44.473 INFO  org.apache.coyote.http11.Http11NioProtocol        :173 
                [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8880"]
2022-08-31 17:27:44.474 INFO  org.apache.catalina.core.StandardService          :173 
                [32m                  [0;39m Starting service [Tomcat]
2022-08-31 17:27:44.474 INFO  org.apache.catalina.core.StandardEngine           :173 
                [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.60]
2022-08-31 17:27:44.624 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173 
                [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-08-31 17:27:44.625 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290 
                [32m                  [0;39m Root WebApplicationContext: initialization completed in 4033 ms
2022-08-31 17:27:46.406 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58  
                [32m                  [0;39m LiveReload server is running on port 35729
2022-08-31 17:27:46.429 INFO  org.apache.coyote.http11.Http11NioProtocol        :173 
                [32m                  [0;39m Starting ProtocolHandler ["http-nio-8880"]
2022-08-31 17:27:46.445 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220 
                [32m                  [0;39m Tomcat started on port(s): 8880 (http) with context path ''
2022-08-31 17:27:46.471 INFO  com.zs.wikibb.WikibbApplication                   :61  
                [32m                  [0;39m Started WikibbApplication in 6.894 seconds (JVM running for 9.93)
2022-08-31 17:27:46.476 INFO  com.zs.wikibb.WikibbApplication                   :26  
                [32m                  [0;39m 启动成功！！
2022-08-31 17:27:46.476 INFO  com.zs.wikibb.WikibbApplication                   :27  
                [32m                  [0;39m 地址: 	http://127.0.0.1:8880
2022-08-31 17:27:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248559780958208 [0;39m 生成今日电子书快照开始
2022-08-31 17:27:50.033 INFO  com.zaxxer.hikari.HikariDataSource                :110 
                [32m22248559780958208 [0;39m HikariPool-1 - Starting...
2022-08-31 17:27:50.904 INFO  com.zaxxer.hikari.HikariDataSource                :123 
                [32m22248559780958208 [0;39m HikariPool-1 - Start completed.
2022-08-31 17:27:50.911 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248559780958208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:27:50.933 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248559780958208 [0;39m ==> Parameters: 
2022-08-31 17:27:50.981 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248559780958208 [0;39m <==    Updates: 8
2022-08-31 17:27:50.983 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248559780958208 [0;39m 生成今日电子书快照结束，耗时：973 毫秒
2022-08-31 17:27:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248580769255424 [0;39m 生成今日电子书快照开始
2022-08-31 17:27:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248580769255424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:27:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248580769255424 [0;39m ==> Parameters: 
2022-08-31 17:27:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248580769255424 [0;39m <==    Updates: 0
2022-08-31 17:27:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248580769255424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:27:56.997 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173 
                [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-08-31 17:27:56.998 INFO  org.springframework.web.servlet.DispatcherServlet :525 
                [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-08-31 17:27:57.000 INFO  org.springframework.web.servlet.DispatcherServlet :547 
                [32m                  [0;39m Completed initialization in 2 ms
2022-08-31 17:27:57.069 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:27:57.071 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/
2022-08-31 17:27:57.071 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m                  [0;39m 登录校验开始，token：null
2022-08-31 17:27:57.072 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :49  
                [32m                  [0;39m token为空，请求被拦截
2022-08-31 17:27:59.722 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:27:59.722 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/
2022-08-31 17:27:59.723 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m                  [0;39m 登录校验开始，token：null
2022-08-31 17:27:59.723 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :49  
                [32m                  [0;39m token为空，请求被拦截
2022-08-31 17:28:00.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248601682055168 [0;39m 生成今日电子书快照开始
2022-08-31 17:28:00.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248601682055168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:28:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248601682055168 [0;39m ==> Parameters: 
2022-08-31 17:28:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248601682055168 [0;39m <==    Updates: 0
2022-08-31 17:28:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248601682055168 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:28:05.000 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22248622653575168 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:28:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22248622653575168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:28:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22248622653575168 [0;39m ==> Parameters: 
2022-08-31 17:28:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22248622653575168 [0;39m <==    Updates: 8
2022-08-31 17:28:05.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22248622653575168 [0;39m 更新电子书下的文档数据结束，耗时：8 毫秒
2022-08-31 17:28:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248622691323904 [0;39m 生成今日电子书快照开始
2022-08-31 17:28:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248622691323904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:28:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248622691323904 [0;39m ==> Parameters: 
2022-08-31 17:28:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248622691323904 [0;39m <==    Updates: 0
2022-08-31 17:28:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248622691323904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:28:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248643692204032 [0;39m 生成今日电子书快照开始
2022-08-31 17:28:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248643692204032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:28:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248643692204032 [0;39m ==> Parameters: 
2022-08-31 17:28:10.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248643692204032 [0;39m <==    Updates: 0
2022-08-31 17:28:10.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248643692204032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:28:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248664630169600 [0;39m 生成今日电子书快照开始
2022-08-31 17:28:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248664630169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:28:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248664630169600 [0;39m ==> Parameters: 
2022-08-31 17:28:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248664630169600 [0;39m <==    Updates: 0
2022-08-31 17:28:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248664630169600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:28:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248685580718080 [0;39m 生成今日电子书快照开始
2022-08-31 17:28:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248685580718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:28:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248685580718080 [0;39m ==> Parameters: 
2022-08-31 17:28:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248685580718080 [0;39m <==    Updates: 0
2022-08-31 17:28:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248685580718080 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-31 17:28:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248706598375424 [0;39m 生成今日电子书快照开始
2022-08-31 17:28:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248706598375424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:28:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248706598375424 [0;39m ==> Parameters: 
2022-08-31 17:28:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248706598375424 [0;39m <==    Updates: 0
2022-08-31 17:28:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248706598375424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:28:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248727544729600 [0;39m 生成今日电子书快照开始
2022-08-31 17:28:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248727544729600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:28:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248727544729600 [0;39m ==> Parameters: 
2022-08-31 17:28:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248727544729600 [0;39m <==    Updates: 0
2022-08-31 17:28:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248727544729600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:28:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248748533026816 [0;39m 生成今日电子书快照开始
2022-08-31 17:28:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248748533026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:28:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248748533026816 [0;39m ==> Parameters: 
2022-08-31 17:28:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248748533026816 [0;39m <==    Updates: 0
2022-08-31 17:28:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248748533026816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:28:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22248748549804032 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:28:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22248748549804032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:28:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22248748549804032 [0;39m ==> Parameters: 
2022-08-31 17:28:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22248748549804032 [0;39m <==    Updates: 8
2022-08-31 17:28:35.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22248748549804032 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-31 17:28:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248769521324032 [0;39m 生成今日电子书快照开始
2022-08-31 17:28:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248769521324032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:28:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248769521324032 [0;39m ==> Parameters: 
2022-08-31 17:28:40.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248769521324032 [0;39m <==    Updates: 0
2022-08-31 17:28:40.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248769521324032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:28:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248790488649728 [0;39m 生成今日电子书快照开始
2022-08-31 17:28:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248790488649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:28:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248790488649728 [0;39m ==> Parameters: 
2022-08-31 17:28:45.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248790488649728 [0;39m <==    Updates: 0
2022-08-31 17:28:45.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248790488649728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:28:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248811455975424 [0;39m 生成今日电子书快照开始
2022-08-31 17:28:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248811455975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:28:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248811455975424 [0;39m ==> Parameters: 
2022-08-31 17:28:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248811455975424 [0;39m <==    Updates: 0
2022-08-31 17:28:50.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248811455975424 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:28:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248832377163776 [0;39m 生成今日电子书快照开始
2022-08-31 17:28:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248832377163776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:28:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248832377163776 [0;39m ==> Parameters: 
2022-08-31 17:28:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248832377163776 [0;39m <==    Updates: 0
2022-08-31 17:28:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248832377163776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-31 17:29:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248853403209728 [0;39m 生成今日电子书快照开始
2022-08-31 17:29:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248853403209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:29:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248853403209728 [0;39m ==> Parameters: 
2022-08-31 17:29:00.025 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248853403209728 [0;39m <==    Updates: 0
2022-08-31 17:29:00.025 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248853403209728 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-31 17:29:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22248874370535424 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:29:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22248874370535424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:29:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22248874370535424 [0;39m ==> Parameters: 
2022-08-31 17:29:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22248874370535424 [0;39m <==    Updates: 8
2022-08-31 17:29:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22248874370535424 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-31 17:29:05.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248874391506944 [0;39m 生成今日电子书快照开始
2022-08-31 17:29:05.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248874391506944 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:29:05.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248874391506944 [0;39m ==> Parameters: 
2022-08-31 17:29:05.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248874391506944 [0;39m <==    Updates: 0
2022-08-31 17:29:05.025 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248874391506944 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-31 17:29:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248895325278208 [0;39m 生成今日电子书快照开始
2022-08-31 17:29:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248895325278208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:29:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248895325278208 [0;39m ==> Parameters: 
2022-08-31 17:29:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248895325278208 [0;39m <==    Updates: 0
2022-08-31 17:29:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248895325278208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:29:12.617 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22248906251440130 [0;39m ------------- 开始 -------------
2022-08-31 17:29:12.617 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22248906251440129 [0;39m ------------- 开始 -------------
2022-08-31 17:29:12.617 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22248906251440128 [0;39m ------------- 开始 -------------
2022-08-31 17:29:12.617 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22248906251440129 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2022-08-31 17:29:12.617 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22248906251440128 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2022-08-31 17:29:12.617 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22248906251440130 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2022-08-31 17:29:12.618 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22248906251440128 [0;39m 类名方法: com.zs.wikibb.controller.CategoryController.all
2022-08-31 17:29:12.618 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22248906251440130 [0;39m 类名方法: com.zs.wikibb.controller.EbookSnapshotController.getStatistic
2022-08-31 17:29:12.618 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22248906251440129 [0;39m 类名方法: com.zs.wikibb.controller.EbookSnapshotController.get30Statistic
2022-08-31 17:29:12.618 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22248906251440128 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:29:12.618 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22248906251440130 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:29:12.618 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22248906251440129 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:29:12.642 INFO  com.zs.wikibb.websocket.WebSocketServer           :32  
                [32m                  [0;39m 有新连接：token：jDz2dFKboN，session id：0，当前连接数：1
2022-08-31 17:29:12.664 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22248906251440130 [0;39m 请求参数: []
2022-08-31 17:29:12.664 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22248906251440129 [0;39m 请求参数: []
2022-08-31 17:29:12.664 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22248906251440128 [0;39m 请求参数: []
2022-08-31 17:29:12.675 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m22248906251440129 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-08-31 17:29:12.675 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m22248906251440130 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-08-31 17:29:12.676 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m22248906251440129 [0;39m ==> Parameters: 
2022-08-31 17:29:12.676 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m22248906251440130 [0;39m ==> Parameters: 
2022-08-31 17:29:12.701 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22248906251440128 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-08-31 17:29:12.702 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22248906251440128 [0;39m ==> Parameters: 
2022-08-31 17:29:12.707 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22248906251440129 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-08-31 17:29:12.707 TRACE c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :143 
                [32m22248906251440130 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-08-31 17:29:12.707 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==    Columns: id, parent, name, sort
2022-08-31 17:29:12.708 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 100, 0, 前端开发, 100
2022-08-31 17:29:12.724 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22248906251440129 [0;39m <==        Row: 2022-08-01, 13, 0
2022-08-31 17:29:12.724 TRACE c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :143 
                [32m22248906251440130 [0;39m <==        Row: 2022-08-31, 372, 60, 372, 60
2022-08-31 17:29:12.725 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 101, 100, Vue, 101
2022-08-31 17:29:12.726 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-08-31 17:29:12.726 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 200, 0, Java, 200
2022-08-31 17:29:12.726 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m22248906251440130 [0;39m <==      Total: 1
2022-08-31 17:29:12.726 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22248906251440129 [0;39m <==        Row: 2022-08-17, 342, 54
2022-08-31 17:29:12.726 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 201, 200, 基础应用, 201
2022-08-31 17:29:12.727 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 202, 200, 框架应用, 202
2022-08-31 17:29:12.727 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22248906251440129 [0;39m <==        Row: 2022-08-18, 11, 0
2022-08-31 17:29:12.727 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 181311914796781568, 200, SpringBoot+Vue3 前后端分离知识库系统, 231
2022-08-31 17:29:12.727 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 300, 0, Python, 300
2022-08-31 17:29:12.727 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22248906251440129 [0;39m <==        Row: 2022-08-19, 19, 6
2022-08-31 17:29:12.728 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 301, 300, 基础应用, 301
2022-08-31 17:29:12.728 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22248906251440129 [0;39m <==        Row: 2022-08-26, 372, 60
2022-08-31 17:29:12.728 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2022-08-31 17:29:12.729 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22248906251440129 [0;39m <==        Row: 2022-08-29, 372, 60
2022-08-31 17:29:12.729 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 400, 0, 数据库, 400
2022-08-31 17:29:12.729 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m22248906251440129 [0;39m <==      Total: 6
2022-08-31 17:29:12.729 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 401, 400, MySQL, 401
2022-08-31 17:29:12.730 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 500, 0, 其它, 500
2022-08-31 17:29:12.730 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 501, 500, 服务器, 501
2022-08-31 17:29:12.731 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 502, 500, 开发工具, 502
2022-08-31 17:29:12.733 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22248906251440128 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2022-08-31 17:29:12.735 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22248906251440128 [0;39m <==      Total: 16
2022-08-31 17:29:12.770 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22248906251440128 [0;39m 返回结果: {"content":[{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":181311914796781568,"name":"SpringBoot+Vue3 前后端分离知识库系统","parent":200,"sort":231},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2022-08-31 17:29:12.770 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22248906251440128 [0;39m ------------- 结束 耗时：155 ms -------------
2022-08-31 17:29:12.771 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22248906251440130 [0;39m 返回结果: {"content":[{"date":1661875200000,"viewCount":372,"viewIncrease":372,"voteCount":60,"voteIncrease":60}],"success":true}
2022-08-31 17:29:12.771 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22248906251440129 [0;39m 返回结果: {"content":[{"date":1659283200000,"viewCount":0,"viewIncrease":13,"voteCount":0,"voteIncrease":0},{"date":1660665600000,"viewCount":0,"viewIncrease":342,"voteCount":0,"voteIncrease":54},{"date":1660752000000,"viewCount":0,"viewIncrease":11,"voteCount":0,"voteIncrease":0},{"date":1660838400000,"viewCount":0,"viewIncrease":19,"voteCount":0,"voteIncrease":6},{"date":1661443200000,"viewCount":0,"viewIncrease":372,"voteCount":0,"voteIncrease":60},{"date":1661702400000,"viewCount":0,"viewIncrease":372,"voteCount":0,"voteIncrease":60}],"success":true}
2022-08-31 17:29:12.771 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22248906251440130 [0;39m ------------- 结束 耗时：156 ms -------------
2022-08-31 17:29:12.771 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22248906251440129 [0;39m ------------- 结束 耗时：156 ms -------------
2022-08-31 17:29:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248916317769728 [0;39m 生成今日电子书快照开始
2022-08-31 17:29:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248916317769728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:29:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248916317769728 [0;39m ==> Parameters: 
2022-08-31 17:29:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248916317769728 [0;39m <==    Updates: 0
2022-08-31 17:29:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248916317769728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:29:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248937276706816 [0;39m 生成今日电子书快照开始
2022-08-31 17:29:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248937276706816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:29:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248937276706816 [0;39m ==> Parameters: 
2022-08-31 17:29:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248937276706816 [0;39m <==    Updates: 0
2022-08-31 17:29:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248937276706816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:29:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248958265004032 [0;39m 生成今日电子书快照开始
2022-08-31 17:29:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248958265004032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:29:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248958265004032 [0;39m ==> Parameters: 
2022-08-31 17:29:25.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248958265004032 [0;39m <==    Updates: 0
2022-08-31 17:29:25.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248958265004032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:29:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22248979236524032 [0;39m 生成今日电子书快照开始
2022-08-31 17:29:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248979236524032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:29:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248979236524032 [0;39m ==> Parameters: 
2022-08-31 17:29:30.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22248979236524032 [0;39m <==    Updates: 0
2022-08-31 17:29:30.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22248979236524032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:29:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249000203849728 [0;39m 生成今日电子书快照开始
2022-08-31 17:29:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249000203849728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:29:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249000203849728 [0;39m ==> Parameters: 
2022-08-31 17:29:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249000203849728 [0;39m <==    Updates: 0
2022-08-31 17:29:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249000203849728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:29:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22249000216432640 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:29:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249000216432640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:29:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249000216432640 [0;39m ==> Parameters: 
2022-08-31 17:29:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249000216432640 [0;39m <==    Updates: 8
2022-08-31 17:29:35.020 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22249000216432640 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:29:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249021133426688 [0;39m 生成今日电子书快照开始
2022-08-31 17:29:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249021133426688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:29:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249021133426688 [0;39m ==> Parameters: 
2022-08-31 17:29:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249021133426688 [0;39m <==    Updates: 0
2022-08-31 17:29:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249021133426688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:29:40.922 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249024979603456 [0;39m ------------- 开始 -------------
2022-08-31 17:29:40.923 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249024979603456 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-31 17:29:40.923 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249024979603456 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-31 17:29:40.923 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249024979603456 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:29:40.926 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249024979603456 [0;39m 请求参数: [{"categoryId2":181311914796781568,"page":1,"size":1000}]
2022-08-31 17:29:41.186 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249024979603456 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-08-31 17:29:41.187 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249024979603456 [0;39m ==> Parameters: 181311914796781568(Long)
2022-08-31 17:29:41.189 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22249024979603456 [0;39m <==    Columns: count(0)
2022-08-31 17:29:41.189 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22249024979603456 [0;39m <==        Row: 1
2022-08-31 17:29:41.190 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249024979603456 [0;39m <==      Total: 1
2022-08-31 17:29:41.191 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249024979603456 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2022-08-31 17:29:41.192 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249024979603456 [0;39m ==> Parameters: 181311914796781568(Long), 1000(Integer)
2022-08-31 17:29:41.193 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249024979603456 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-31 17:29:41.194 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249024979603456 [0;39m <==        Row: 202714600712572928, Wiki个人知识库, 200, 181311914796781568, 本文档讲述了知识库的开发过程以及遇到的问题！, /image/cover2.png, 12, 259, 38
2022-08-31 17:29:41.194 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249024979603456 [0;39m <==      Total: 1
2022-08-31 17:29:41.196 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m22249024979603456 [0;39m 总行数：1
2022-08-31 17:29:41.196 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m22249024979603456 [0;39m 总页数：1
2022-08-31 17:29:41.206 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249024979603456 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":181311914796781568,"cover":"/image/cover2.png","description":"本文档讲述了知识库的开发过程以及遇到的问题！","docCount":12,"id":202714600712572928,"name":"Wiki个人知识库","viewCount":259,"voteCount":38}],"total":1},"success":true}
2022-08-31 17:29:41.206 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249024979603456 [0;39m ------------- 结束 耗时：284 ms -------------
2022-08-31 17:29:41.488 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249027353579520 [0;39m ------------- 开始 -------------
2022-08-31 17:29:41.489 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249027353579520 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-31 17:29:41.489 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249027353579520 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-31 17:29:41.489 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249027353579520 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:29:41.489 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249027353579520 [0;39m 请求参数: [{"categoryId2":202,"page":1,"size":1000}]
2022-08-31 17:29:41.492 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249027353579520 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-08-31 17:29:41.492 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249027353579520 [0;39m ==> Parameters: 202(Long)
2022-08-31 17:29:41.493 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22249027353579520 [0;39m <==    Columns: count(0)
2022-08-31 17:29:41.493 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22249027353579520 [0;39m <==        Row: 1
2022-08-31 17:29:41.494 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249027353579520 [0;39m <==      Total: 1
2022-08-31 17:29:41.494 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249027353579520 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2022-08-31 17:29:41.495 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249027353579520 [0;39m ==> Parameters: 202(Long), 1000(Integer)
2022-08-31 17:29:41.495 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249027353579520 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-31 17:29:41.496 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249027353579520 [0;39m <==        Row: 20420687550353408, Dubbo分布式框架, 200, 202, 一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现, null, 1, 0, 0
2022-08-31 17:29:41.496 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249027353579520 [0;39m <==      Total: 1
2022-08-31 17:29:41.497 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m22249027353579520 [0;39m 总行数：1
2022-08-31 17:29:41.497 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m22249027353579520 [0;39m 总页数：1
2022-08-31 17:29:41.497 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249027353579520 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现","docCount":1,"id":20420687550353408,"name":"Dubbo分布式框架","viewCount":0,"voteCount":0}],"total":1},"success":true}
2022-08-31 17:29:41.497 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249027353579520 [0;39m ------------- 结束 耗时：9 ms -------------
2022-08-31 17:29:44.927 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249041777790976 [0;39m ------------- 开始 -------------
2022-08-31 17:29:44.927 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249041777790976 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:29:44.927 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249041777790976 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:29:44.927 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249041777790976 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:29:44.928 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249041777790976 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:29:44.934 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22249041777790976 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:29:44.935 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22249041777790976 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:29:44.936 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22249041777790976 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:29:44.936 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22249041777790976 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 0, 0
2022-08-31 17:29:44.937 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22249041777790976 [0;39m <==      Total: 1
2022-08-31 17:29:44.944 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249041777790976 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":0,"voteCount":0}],"success":true}
2022-08-31 17:29:44.944 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249041777790976 [0;39m ------------- 结束 耗时：17 ms -------------
2022-08-31 17:29:44.957 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249041903620096 [0;39m ------------- 开始 -------------
2022-08-31 17:29:44.957 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249041903620096 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/20420961950109696 GET
2022-08-31 17:29:44.958 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249041903620096 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-31 17:29:44.958 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249041903620096 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:29:44.958 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249041903620096 [0;39m 请求参数: [20420961950109696]
2022-08-31 17:29:44.959 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22249041903620096 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-31 17:29:44.959 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22249041903620096 [0;39m ==> Parameters: 20420961950109696(Long)
2022-08-31 17:29:44.963 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m22249041903620096 [0;39m <==    Columns: id, content
2022-08-31 17:29:44.964 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m22249041903620096 [0;39m <==        Row: 20420961950109696, <<BLOB>>
2022-08-31 17:29:44.964 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22249041903620096 [0;39m <==      Total: 1
2022-08-31 17:29:44.966 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22249041903620096 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-31 17:29:44.966 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22249041903620096 [0;39m ==> Parameters: 20420961950109696(Long)
2022-08-31 17:29:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249042092363776 [0;39m 生成今日电子书快照开始
2022-08-31 17:29:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249042092363776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:29:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249042092363776 [0;39m ==> Parameters: 
2022-08-31 17:29:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249042092363776 [0;39m <==    Updates: 0
2022-08-31 17:29:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249042092363776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:29:45.026 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22249041903620096 [0;39m <==    Updates: 1
2022-08-31 17:29:45.027 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249041903620096 [0;39m 返回结果: {"content":"<p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><p><br></p><blockquote><h2 style=\"text-align:center;\" id=\"clhau\">在学习Dubbo分布式框架爱之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2></blockquote>","success":true}
2022-08-31 17:29:45.027 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249041903620096 [0;39m ------------- 结束 耗时：70 ms -------------
2022-08-31 17:29:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249063068078080 [0;39m 生成今日电子书快照开始
2022-08-31 17:29:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249063068078080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:29:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249063068078080 [0;39m ==> Parameters: 
2022-08-31 17:29:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249063068078080 [0;39m <==    Updates: 0
2022-08-31 17:29:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249063068078080 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:29:55.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249084031209472 [0;39m 生成今日电子书快照开始
2022-08-31 17:29:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249084031209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:29:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249084031209472 [0;39m ==> Parameters: 
2022-08-31 17:29:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249084031209472 [0;39m <==    Updates: 0
2022-08-31 17:29:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249084031209472 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:30:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249105061449728 [0;39m 生成今日电子书快照开始
2022-08-31 17:30:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249105061449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:30:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249105061449728 [0;39m ==> Parameters: 
2022-08-31 17:30:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249105061449728 [0;39m <==    Updates: 0
2022-08-31 17:30:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249105061449728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:30:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22249126020386816 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:30:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249126020386816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:30:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249126020386816 [0;39m ==> Parameters: 
2022-08-31 17:30:05.112 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249126020386816 [0;39m <==    Updates: 8
2022-08-31 17:30:05.113 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22249126020386816 [0;39m 更新电子书下的文档数据结束，耗时：101 毫秒
2022-08-31 17:30:05.113 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249126444011520 [0;39m 生成今日电子书快照开始
2022-08-31 17:30:05.113 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249126444011520 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:30:05.114 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249126444011520 [0;39m ==> Parameters: 
2022-08-31 17:30:05.143 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249126444011520 [0;39m <==    Updates: 0
2022-08-31 17:30:05.144 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249126444011520 [0;39m 生成今日电子书快照结束，耗时：31 毫秒
2022-08-31 17:30:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249146945769472 [0;39m 生成今日电子书快照开始
2022-08-31 17:30:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249146945769472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:30:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249146945769472 [0;39m ==> Parameters: 
2022-08-31 17:30:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249146945769472 [0;39m <==    Updates: 0
2022-08-31 17:30:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249146945769472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:30:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249167963426816 [0;39m 生成今日电子书快照开始
2022-08-31 17:30:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249167963426816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:30:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249167963426816 [0;39m ==> Parameters: 
2022-08-31 17:30:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249167963426816 [0;39m <==    Updates: 0
2022-08-31 17:30:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249167963426816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:30:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249188947529728 [0;39m 生成今日电子书快照开始
2022-08-31 17:30:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249188947529728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:30:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249188947529728 [0;39m ==> Parameters: 
2022-08-31 17:30:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249188947529728 [0;39m <==    Updates: 0
2022-08-31 17:30:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249188947529728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:30:22.569 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249199659782144 [0;39m ------------- 开始 -------------
2022-08-31 17:30:22.569 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249199659782144 [0;39m 请求地址: http://127.0.0.1:8880/user_wiki/login POST
2022-08-31 17:30:22.570 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249199659782144 [0;39m 类名方法: com.zs.wikibb.controller.UserwikiController.login
2022-08-31 17:30:22.570 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249199659782144 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:30:22.571 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249199659782144 [0;39m 请求参数: [{"loginName":"test"}]
2022-08-31 17:30:22.576 DEBUG c.zs.wikibb.mapper.UserwikiMapper.selectByExample :137 
                [32m22249199659782144 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from userwiki WHERE ( login_name = ? )
2022-08-31 17:30:22.577 DEBUG c.zs.wikibb.mapper.UserwikiMapper.selectByExample :137 
                [32m22249199659782144 [0;39m ==> Parameters: test(String)
2022-08-31 17:30:22.579 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m22249199659782144 [0;39m <==    Columns: id, login_name, name, password
2022-08-31 17:30:22.579 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m22249199659782144 [0;39m <==        Row: 1, test, 测试, e70e2222a9d67c4f2eae107533359aa4
2022-08-31 17:30:22.580 DEBUG c.zs.wikibb.mapper.UserwikiMapper.selectByExample :137 
                [32m22249199659782144 [0;39m <==      Total: 1
2022-08-31 17:30:22.585 INFO  com.zs.wikibb.controller.UserwikiController       :86  
                [32m22249199659782144 [0;39m 生成单点登录token，并放入redis中
2022-08-31 17:30:24.103 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249199659782144 [0;39m 返回结果: {"content":{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"},"success":true}
2022-08-31 17:30:24.104 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249199659782144 [0;39m ------------- 结束 耗时：1535 ms -------------
2022-08-31 17:30:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249209919049728 [0;39m 生成今日电子书快照开始
2022-08-31 17:30:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249209919049728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:30:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249209919049728 [0;39m ==> Parameters: 
2022-08-31 17:30:25.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249209919049728 [0;39m <==    Updates: 0
2022-08-31 17:30:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249209919049728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:30:26.545 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249216336334848 [0;39m ------------- 开始 -------------
2022-08-31 17:30:26.545 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249216336334848 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2022-08-31 17:30:26.546 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249216336334848 [0;39m 类名方法: com.zs.wikibb.controller.CategoryController.all
2022-08-31 17:30:26.546 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249216336334848 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:30:26.546 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249216336334848 [0;39m 请求参数: []
2022-08-31 17:30:26.547 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22249216336334848 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-08-31 17:30:26.548 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22249216336334848 [0;39m ==> Parameters: 
2022-08-31 17:30:26.569 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==    Columns: id, parent, name, sort
2022-08-31 17:30:26.570 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 100, 0, 前端开发, 100
2022-08-31 17:30:26.570 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 101, 100, Vue, 101
2022-08-31 17:30:26.571 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-08-31 17:30:26.571 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 200, 0, Java, 200
2022-08-31 17:30:26.571 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 201, 200, 基础应用, 201
2022-08-31 17:30:26.572 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 202, 200, 框架应用, 202
2022-08-31 17:30:26.572 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 181311914796781568, 200, SpringBoot+Vue3 前后端分离知识库系统, 231
2022-08-31 17:30:26.573 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 300, 0, Python, 300
2022-08-31 17:30:26.573 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 301, 300, 基础应用, 301
2022-08-31 17:30:26.573 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2022-08-31 17:30:26.574 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 400, 0, 数据库, 400
2022-08-31 17:30:26.574 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 401, 400, MySQL, 401
2022-08-31 17:30:26.574 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 500, 0, 其它, 500
2022-08-31 17:30:26.575 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 501, 500, 服务器, 501
2022-08-31 17:30:26.575 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 502, 500, 开发工具, 502
2022-08-31 17:30:26.575 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249216336334848 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2022-08-31 17:30:26.575 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22249216336334848 [0;39m <==      Total: 16
2022-08-31 17:30:26.576 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249216336334848 [0;39m 返回结果: {"content":[{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":181311914796781568,"name":"SpringBoot+Vue3 前后端分离知识库系统","parent":200,"sort":231},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2022-08-31 17:30:26.576 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249216336334848 [0;39m ------------- 结束 耗时：31 ms -------------
2022-08-31 17:30:26.591 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249216529272832 [0;39m ------------- 开始 -------------
2022-08-31 17:30:26.591 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249216529272832 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-31 17:30:26.591 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249216529272832 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-31 17:30:26.591 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249216529272832 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:30:26.591 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249216529272832 [0;39m 请求参数: [{"page":1,"size":4}]
2022-08-31 17:30:26.593 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249216529272832 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-08-31 17:30:26.593 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249216529272832 [0;39m ==> Parameters: 
2022-08-31 17:30:26.594 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22249216529272832 [0;39m <==    Columns: count(0)
2022-08-31 17:30:26.594 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22249216529272832 [0;39m <==        Row: 8
2022-08-31 17:30:26.594 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249216529272832 [0;39m <==      Total: 1
2022-08-31 17:30:26.595 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249216529272832 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-08-31 17:30:26.595 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249216529272832 [0;39m ==> Parameters: 4(Integer)
2022-08-31 17:30:26.596 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249216529272832 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-31 17:30:26.596 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249216529272832 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover1.png, 4, 62, 10
2022-08-31 17:30:26.596 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249216529272832 [0;39m <==        Row: 2, Vue 入门教程, 100, 503, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover2.png, 7, 39, 10
2022-08-31 17:30:26.597 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249216529272832 [0;39m <==        Row: 3, Python 入门教程, 200, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 2, 1
2022-08-31 17:30:26.597 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249216529272832 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, /image/cover2.png, 1, 1, 0
2022-08-31 17:30:26.598 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249216529272832 [0;39m <==      Total: 4
2022-08-31 17:30:26.599 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m22249216529272832 [0;39m 总行数：8
2022-08-31 17:30:26.599 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m22249216529272832 [0;39m 总页数：2
2022-08-31 17:30:26.599 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249216529272832 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover1.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":4,"id":1,"name":"Spring Boot 入门教程","viewCount":62,"voteCount":10},{"category1Id":100,"category2Id":503,"cover":"/image/cover2.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":7,"id":2,"name":"Vue 入门教程","viewCount":39,"voteCount":10},{"category1Id":200,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python 入门教程","viewCount":2,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":1,"voteCount":0}],"total":8},"success":true}
2022-08-31 17:30:26.600 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249216529272832 [0;39m ------------- 结束 耗时：9 ms -------------
2022-08-31 17:30:28.553 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249224758497280 [0;39m ------------- 开始 -------------
2022-08-31 17:30:28.554 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249224758497280 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-31 17:30:28.554 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249224758497280 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-31 17:30:28.554 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249224758497280 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:30:28.555 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249224758497280 [0;39m 请求参数: [{"page":2,"size":4}]
2022-08-31 17:30:28.557 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249224758497280 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-08-31 17:30:28.557 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249224758497280 [0;39m ==> Parameters: 
2022-08-31 17:30:28.559 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22249224758497280 [0;39m <==    Columns: count(0)
2022-08-31 17:30:28.559 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22249224758497280 [0;39m <==        Row: 8
2022-08-31 17:30:28.559 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249224758497280 [0;39m <==      Total: 1
2022-08-31 17:30:28.560 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249224758497280 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?, ?
2022-08-31 17:30:28.560 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249224758497280 [0;39m ==> Parameters: 4(Long), 4(Integer)
2022-08-31 17:30:28.562 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249224758497280 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-31 17:30:28.562 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249224758497280 [0;39m <==        Row: 5, Oracle入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 0, 0
2022-08-31 17:30:28.562 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249224758497280 [0;39m <==        Row: 6, Vue CLI 入门教程, 100, 101, Vue CLI 用于快速搭建基于VUE的前端, /image/cover1.png, 1, 9, 1
2022-08-31 17:30:28.563 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249224758497280 [0;39m <==        Row: 20420687550353408, Dubbo分布式框架, 200, 202, 一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现, null, 1, 1, 0
2022-08-31 17:30:28.563 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249224758497280 [0;39m <==        Row: 202714600712572928, Wiki个人知识库, 200, 181311914796781568, 本文档讲述了知识库的开发过程以及遇到的问题！, /image/cover2.png, 12, 259, 38
2022-08-31 17:30:28.564 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249224758497280 [0;39m <==      Total: 4
2022-08-31 17:30:28.564 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m22249224758497280 [0;39m 总行数：8
2022-08-31 17:30:28.564 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m22249224758497280 [0;39m 总页数：2
2022-08-31 17:30:28.565 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249224758497280 [0;39m 返回结果: {"content":{"list":[{"category1Id":400,"category2Id":401,"cover":"/image/cover1.png","description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle入门教程","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"Vue CLI 用于快速搭建基于VUE的前端","docCount":1,"id":6,"name":"Vue CLI 入门教程","viewCount":9,"voteCount":1},{"category1Id":200,"category2Id":202,"description":"一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现","docCount":1,"id":20420687550353408,"name":"Dubbo分布式框架","viewCount":1,"voteCount":0},{"category1Id":200,"category2Id":181311914796781568,"cover":"/image/cover2.png","description":"本文档讲述了知识库的开发过程以及遇到的问题！","docCount":12,"id":202714600712572928,"name":"Wiki个人知识库","viewCount":259,"voteCount":38}],"total":8},"success":true}
2022-08-31 17:30:28.565 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249224758497280 [0;39m ------------- 结束 耗时：12 ms -------------
2022-08-31 17:30:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249230890569728 [0;39m 生成今日电子书快照开始
2022-08-31 17:30:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249230890569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:30:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249230890569728 [0;39m ==> Parameters: 
2022-08-31 17:30:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249230890569728 [0;39m <==    Updates: 0
2022-08-31 17:30:30.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249230890569728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:30:30.260 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249231918174208 [0;39m ------------- 开始 -------------
2022-08-31 17:30:30.260 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249231918174208 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:30:30.260 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249231918174208 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:30:30.261 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249231918174208 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:30:30.261 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249231918174208 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:30:30.262 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22249231918174208 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:30:30.263 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22249231918174208 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:30:30.264 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22249231918174208 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:30:30.264 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22249231918174208 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 17:30:30.265 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22249231918174208 [0;39m <==      Total: 1
2022-08-31 17:30:30.266 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249231918174208 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 17:30:30.266 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249231918174208 [0;39m ------------- 结束 耗时：6 ms -------------
2022-08-31 17:30:32.024 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249239316926464 [0;39m ------------- 开始 -------------
2022-08-31 17:30:32.025 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249239316926464 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2022-08-31 17:30:32.025 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249239316926464 [0;39m 类名方法: com.zs.wikibb.controller.CategoryController.all
2022-08-31 17:30:32.025 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249239316926464 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:30:32.025 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249239316926464 [0;39m 请求参数: []
2022-08-31 17:30:32.026 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22249239316926464 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-08-31 17:30:32.027 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22249239316926464 [0;39m ==> Parameters: 
2022-08-31 17:30:32.028 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==    Columns: id, parent, name, sort
2022-08-31 17:30:32.029 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 100, 0, 前端开发, 100
2022-08-31 17:30:32.029 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 101, 100, Vue, 101
2022-08-31 17:30:32.029 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-08-31 17:30:32.029 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 200, 0, Java, 200
2022-08-31 17:30:32.030 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 201, 200, 基础应用, 201
2022-08-31 17:30:32.030 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 202, 200, 框架应用, 202
2022-08-31 17:30:32.030 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 181311914796781568, 200, SpringBoot+Vue3 前后端分离知识库系统, 231
2022-08-31 17:30:32.030 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 300, 0, Python, 300
2022-08-31 17:30:32.031 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 301, 300, 基础应用, 301
2022-08-31 17:30:32.031 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2022-08-31 17:30:32.031 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 400, 0, 数据库, 400
2022-08-31 17:30:32.031 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 401, 400, MySQL, 401
2022-08-31 17:30:32.032 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 500, 0, 其它, 500
2022-08-31 17:30:32.032 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 501, 500, 服务器, 501
2022-08-31 17:30:32.032 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 502, 500, 开发工具, 502
2022-08-31 17:30:32.032 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22249239316926464 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2022-08-31 17:30:32.032 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22249239316926464 [0;39m <==      Total: 16
2022-08-31 17:30:32.033 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249239316926464 [0;39m 返回结果: {"content":[{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":181311914796781568,"name":"SpringBoot+Vue3 前后端分离知识库系统","parent":200,"sort":231},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2022-08-31 17:30:32.034 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249239316926464 [0;39m ------------- 结束 耗时：10 ms -------------
2022-08-31 17:30:32.044 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249239400812544 [0;39m ------------- 开始 -------------
2022-08-31 17:30:32.044 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249239400812544 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-31 17:30:32.045 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249239400812544 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-31 17:30:32.045 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249239400812544 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:30:32.045 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249239400812544 [0;39m 请求参数: [{"page":1,"size":4}]
2022-08-31 17:30:32.048 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249239400812544 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-08-31 17:30:32.049 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249239400812544 [0;39m ==> Parameters: 
2022-08-31 17:30:32.050 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22249239400812544 [0;39m <==    Columns: count(0)
2022-08-31 17:30:32.050 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22249239400812544 [0;39m <==        Row: 8
2022-08-31 17:30:32.051 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249239400812544 [0;39m <==      Total: 1
2022-08-31 17:30:32.051 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249239400812544 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-08-31 17:30:32.052 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249239400812544 [0;39m ==> Parameters: 4(Integer)
2022-08-31 17:30:32.053 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249239400812544 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-31 17:30:32.053 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249239400812544 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover1.png, 4, 62, 10
2022-08-31 17:30:32.053 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249239400812544 [0;39m <==        Row: 2, Vue 入门教程, 100, 503, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover2.png, 7, 39, 10
2022-08-31 17:30:32.054 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249239400812544 [0;39m <==        Row: 3, Python 入门教程, 200, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 2, 1
2022-08-31 17:30:32.054 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249239400812544 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, /image/cover2.png, 1, 1, 0
2022-08-31 17:30:32.054 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249239400812544 [0;39m <==      Total: 4
2022-08-31 17:30:32.054 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m22249239400812544 [0;39m 总行数：8
2022-08-31 17:30:32.055 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m22249239400812544 [0;39m 总页数：2
2022-08-31 17:30:32.055 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249239400812544 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover1.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":4,"id":1,"name":"Spring Boot 入门教程","viewCount":62,"voteCount":10},{"category1Id":100,"category2Id":503,"cover":"/image/cover2.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":7,"id":2,"name":"Vue 入门教程","viewCount":39,"voteCount":10},{"category1Id":200,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python 入门教程","viewCount":2,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":1,"voteCount":0}],"total":8},"success":true}
2022-08-31 17:30:32.056 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249239400812544 [0;39m ------------- 结束 耗时：12 ms -------------
2022-08-31 17:30:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22249251866284032 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:30:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249251866284032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:30:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249251866284032 [0;39m ==> Parameters: 
2022-08-31 17:30:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249251866284032 [0;39m <==    Updates: 8
2022-08-31 17:30:35.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22249251866284032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:30:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249251874672640 [0;39m 生成今日电子书快照开始
2022-08-31 17:30:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249251874672640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:30:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249251874672640 [0;39m ==> Parameters: 
2022-08-31 17:30:35.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249251874672640 [0;39m <==    Updates: 0
2022-08-31 17:30:35.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249251874672640 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:30:36.970 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249260061954048 [0;39m ------------- 开始 -------------
2022-08-31 17:30:36.970 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249260061954048 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-31 17:30:36.970 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249260061954048 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-31 17:30:36.970 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249260061954048 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:30:36.970 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249260061954048 [0;39m 请求参数: [{"page":2,"size":4}]
2022-08-31 17:30:36.972 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249260061954048 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-08-31 17:30:36.973 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249260061954048 [0;39m ==> Parameters: 
2022-08-31 17:30:36.981 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22249260061954048 [0;39m <==    Columns: count(0)
2022-08-31 17:30:36.981 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22249260061954048 [0;39m <==        Row: 8
2022-08-31 17:30:36.981 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249260061954048 [0;39m <==      Total: 1
2022-08-31 17:30:36.982 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249260061954048 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?, ?
2022-08-31 17:30:36.983 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249260061954048 [0;39m ==> Parameters: 4(Long), 4(Integer)
2022-08-31 17:30:36.984 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249260061954048 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-31 17:30:36.984 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249260061954048 [0;39m <==        Row: 5, Oracle入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 0, 0
2022-08-31 17:30:36.985 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249260061954048 [0;39m <==        Row: 6, Vue CLI 入门教程, 100, 101, Vue CLI 用于快速搭建基于VUE的前端, /image/cover1.png, 1, 9, 1
2022-08-31 17:30:36.986 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249260061954048 [0;39m <==        Row: 20420687550353408, Dubbo分布式框架, 200, 202, 一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现, null, 1, 1, 0
2022-08-31 17:30:36.986 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249260061954048 [0;39m <==        Row: 202714600712572928, Wiki个人知识库, 200, 181311914796781568, 本文档讲述了知识库的开发过程以及遇到的问题！, /image/cover2.png, 12, 259, 38
2022-08-31 17:30:36.987 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249260061954048 [0;39m <==      Total: 4
2022-08-31 17:30:36.987 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m22249260061954048 [0;39m 总行数：8
2022-08-31 17:30:36.987 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m22249260061954048 [0;39m 总页数：2
2022-08-31 17:30:36.989 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249260061954048 [0;39m 返回结果: {"content":{"list":[{"category1Id":400,"category2Id":401,"cover":"/image/cover1.png","description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle入门教程","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"Vue CLI 用于快速搭建基于VUE的前端","docCount":1,"id":6,"name":"Vue CLI 入门教程","viewCount":9,"voteCount":1},{"category1Id":200,"category2Id":202,"description":"一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现","docCount":1,"id":20420687550353408,"name":"Dubbo分布式框架","viewCount":1,"voteCount":0},{"category1Id":200,"category2Id":181311914796781568,"cover":"/image/cover2.png","description":"本文档讲述了知识库的开发过程以及遇到的问题！","docCount":12,"id":202714600712572928,"name":"Wiki个人知识库","viewCount":259,"voteCount":38}],"total":8},"success":true}
2022-08-31 17:30:36.990 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249260061954048 [0;39m ------------- 结束 耗时：20 ms -------------
2022-08-31 17:30:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249272783278080 [0;39m 生成今日电子书快照开始
2022-08-31 17:30:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249272783278080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:30:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249272783278080 [0;39m ==> Parameters: 
2022-08-31 17:30:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249272783278080 [0;39m <==    Updates: 0
2022-08-31 17:30:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249272783278080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:30:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249293754798080 [0;39m 生成今日电子书快照开始
2022-08-31 17:30:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249293754798080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:30:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249293754798080 [0;39m ==> Parameters: 
2022-08-31 17:30:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249293754798080 [0;39m <==    Updates: 0
2022-08-31 17:30:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249293754798080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:30:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249314734706688 [0;39m 生成今日电子书快照开始
2022-08-31 17:30:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249314734706688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:30:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249314734706688 [0;39m ==> Parameters: 
2022-08-31 17:30:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249314734706688 [0;39m <==    Updates: 0
2022-08-31 17:30:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249314734706688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:30:51.300 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22249216336334848 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:30:51.301 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22249216336334848 [0;39m ------------- LoginInterceptor 结束 耗时：0 ms -------------
2022-08-31 17:30:51.304 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22249024979603456 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:30:51.305 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m22249024979603456 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/ebook/save
2022-08-31 17:30:51.305 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m22249024979603456 [0;39m 登录校验开始，token：22249199726891008
2022-08-31 17:30:51.347 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m22249024979603456 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"}
2022-08-31 17:30:51.361 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249320422182912 [0;39m ------------- 开始 -------------
2022-08-31 17:30:51.362 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249320422182912 [0;39m 请求地址: http://127.0.0.1:8880/ebook/save POST
2022-08-31 17:30:51.362 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249320422182912 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.save
2022-08-31 17:30:51.362 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249320422182912 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:30:51.364 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249320422182912 [0;39m 请求参数: [{"category1Id":200,"category2Id":202,"description":"一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现","docCount":1,"id":20420687550353408,"name":"Srping Cloud微服务架构","viewCount":1,"voteCount":0}]
2022-08-31 17:30:51.367 DEBUG c.zs.wikibb.mapper.EbookMapper.updateByPrimaryKey :137 
                [32m22249320422182912 [0;39m ==>  Preparing: update ebook set `name` = ?, category1_id = ?, category2_id = ?, description = ?, cover = ?, doc_count = ?, view_count = ?, vote_count = ? where id = ?
2022-08-31 17:30:51.368 DEBUG c.zs.wikibb.mapper.EbookMapper.updateByPrimaryKey :137 
                [32m22249320422182912 [0;39m ==> Parameters: Srping Cloud微服务架构(String), 200(Long), 202(Long), 一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现(String), null, 1(Integer), 1(Integer), 0(Integer), 20420687550353408(Long)
2022-08-31 17:30:51.479 DEBUG c.zs.wikibb.mapper.EbookMapper.updateByPrimaryKey :137 
                [32m22249320422182912 [0;39m <==    Updates: 1
2022-08-31 17:30:51.479 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249320422182912 [0;39m 返回结果: {"success":true}
2022-08-31 17:30:51.479 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249320422182912 [0;39m ------------- 结束 耗时：118 ms -------------
2022-08-31 17:30:51.480 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22249320422182912 [0;39m ------------- LoginInterceptor 结束 耗时：175 ms -------------
2022-08-31 17:30:51.507 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249321034551296 [0;39m ------------- 开始 -------------
2022-08-31 17:30:51.507 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249321034551296 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-31 17:30:51.508 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249321034551296 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-31 17:30:51.508 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249321034551296 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:30:51.508 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249321034551296 [0;39m 请求参数: [{"page":2,"size":4}]
2022-08-31 17:30:51.510 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249321034551296 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-08-31 17:30:51.510 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249321034551296 [0;39m ==> Parameters: 
2022-08-31 17:30:51.511 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22249321034551296 [0;39m <==    Columns: count(0)
2022-08-31 17:30:51.511 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22249321034551296 [0;39m <==        Row: 8
2022-08-31 17:30:51.511 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22249321034551296 [0;39m <==      Total: 1
2022-08-31 17:30:51.512 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249321034551296 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?, ?
2022-08-31 17:30:51.512 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249321034551296 [0;39m ==> Parameters: 4(Long), 4(Integer)
2022-08-31 17:30:51.513 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249321034551296 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-31 17:30:51.513 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249321034551296 [0;39m <==        Row: 5, Oracle入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 0, 0
2022-08-31 17:30:51.514 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249321034551296 [0;39m <==        Row: 6, Vue CLI 入门教程, 100, 101, Vue CLI 用于快速搭建基于VUE的前端, /image/cover1.png, 1, 9, 1
2022-08-31 17:30:51.514 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249321034551296 [0;39m <==        Row: 20420687550353408, Srping Cloud微服务架构, 200, 202, 一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现, null, 1, 1, 0
2022-08-31 17:30:51.515 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22249321034551296 [0;39m <==        Row: 202714600712572928, Wiki个人知识库, 200, 181311914796781568, 本文档讲述了知识库的开发过程以及遇到的问题！, /image/cover2.png, 12, 259, 38
2022-08-31 17:30:51.515 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22249321034551296 [0;39m <==      Total: 4
2022-08-31 17:30:51.516 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m22249321034551296 [0;39m 总行数：8
2022-08-31 17:30:51.516 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m22249321034551296 [0;39m 总页数：2
2022-08-31 17:30:51.517 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249321034551296 [0;39m 返回结果: {"content":{"list":[{"category1Id":400,"category2Id":401,"cover":"/image/cover1.png","description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle入门教程","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"Vue CLI 用于快速搭建基于VUE的前端","docCount":1,"id":6,"name":"Vue CLI 入门教程","viewCount":9,"voteCount":1},{"category1Id":200,"category2Id":202,"description":"一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现","docCount":1,"id":20420687550353408,"name":"Srping Cloud微服务架构","viewCount":1,"voteCount":0},{"category1Id":200,"category2Id":181311914796781568,"cover":"/image/cover2.png","description":"本文档讲述了知识库的开发过程以及遇到的问题！","docCount":12,"id":202714600712572928,"name":"Wiki个人知识库","viewCount":259,"voteCount":38}],"total":8},"success":true}
2022-08-31 17:30:51.517 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249321034551296 [0;39m ------------- 结束 耗时：10 ms -------------
2022-08-31 17:30:54.531 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249333718126592 [0;39m ------------- 开始 -------------
2022-08-31 17:30:54.532 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249333718126592 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:30:54.532 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249333718126592 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:30:54.532 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249333718126592 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:30:54.532 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249333718126592 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:30:54.534 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22249333718126592 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:30:54.534 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22249333718126592 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:30:54.535 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22249333718126592 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:30:54.536 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22249333718126592 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 17:30:54.536 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22249333718126592 [0;39m <==      Total: 1
2022-08-31 17:30:54.537 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249333718126592 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 17:30:54.537 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249333718126592 [0;39m ------------- 结束 耗时：6 ms -------------
2022-08-31 17:30:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249335710420992 [0;39m 生成今日电子书快照开始
2022-08-31 17:30:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249335710420992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:30:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249335710420992 [0;39m ==> Parameters: 
2022-08-31 17:30:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249335710420992 [0;39m <==    Updates: 0
2022-08-31 17:30:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249335710420992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:30:55.696 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249338604490752 [0;39m ------------- 开始 -------------
2022-08-31 17:30:55.697 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249338604490752 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/20420961950109696 GET
2022-08-31 17:30:55.697 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249338604490752 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-31 17:30:55.697 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249338604490752 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:30:55.697 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249338604490752 [0;39m 请求参数: [20420961950109696]
2022-08-31 17:30:55.698 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22249338604490752 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-31 17:30:55.699 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22249338604490752 [0;39m ==> Parameters: 20420961950109696(Long)
2022-08-31 17:30:55.699 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m22249338604490752 [0;39m <==    Columns: id, content
2022-08-31 17:30:55.700 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m22249338604490752 [0;39m <==        Row: 20420961950109696, <<BLOB>>
2022-08-31 17:30:55.700 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22249338604490752 [0;39m <==      Total: 1
2022-08-31 17:30:55.701 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22249338604490752 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-31 17:30:55.701 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22249338604490752 [0;39m ==> Parameters: 20420961950109696(Long)
2022-08-31 17:30:55.725 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22249338604490752 [0;39m <==    Updates: 1
2022-08-31 17:30:55.725 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249338604490752 [0;39m 返回结果: {"content":"<p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><p><br></p><blockquote><h2 style=\"text-align:center;\" id=\"clhau\">在学习Dubbo分布式框架爱之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2></blockquote>","success":true}
2022-08-31 17:30:55.725 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249338604490752 [0;39m ------------- 结束 耗时：29 ms -------------
2022-08-31 17:31:00.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249356656775168 [0;39m 生成今日电子书快照开始
2022-08-31 17:31:00.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249356656775168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:31:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249356656775168 [0;39m ==> Parameters: 
2022-08-31 17:31:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249356656775168 [0;39m <==    Updates: 0
2022-08-31 17:31:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249356656775168 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:31:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22249377661849600 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:31:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249377661849600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:31:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249377661849600 [0;39m ==> Parameters: 
2022-08-31 17:31:05.108 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249377661849600 [0;39m <==    Updates: 8
2022-08-31 17:31:05.108 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22249377661849600 [0;39m 更新电子书下的文档数据结束，耗时：100 毫秒
2022-08-31 17:31:05.108 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249378081280000 [0;39m 生成今日电子书快照开始
2022-08-31 17:31:05.108 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249378081280000 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:31:05.109 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249378081280000 [0;39m ==> Parameters: 
2022-08-31 17:31:05.138 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249378081280000 [0;39m <==    Updates: 0
2022-08-31 17:31:05.138 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249378081280000 [0;39m 生成今日电子书快照结束，耗时：30 毫秒
2022-08-31 17:31:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249398671118336 [0;39m 生成今日电子书快照开始
2022-08-31 17:31:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249398671118336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:31:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249398671118336 [0;39m ==> Parameters: 
2022-08-31 17:31:10.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249398671118336 [0;39m <==    Updates: 0
2022-08-31 17:31:10.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249398671118336 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:31:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249419638444032 [0;39m 生成今日电子书快照开始
2022-08-31 17:31:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249419638444032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:31:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249419638444032 [0;39m ==> Parameters: 
2022-08-31 17:31:15.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249419638444032 [0;39m <==    Updates: 0
2022-08-31 17:31:15.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249419638444032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:31:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249440547049472 [0;39m 生成今日电子书快照开始
2022-08-31 17:31:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249440547049472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:31:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249440547049472 [0;39m ==> Parameters: 
2022-08-31 17:31:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249440547049472 [0;39m <==    Updates: 0
2022-08-31 17:31:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249440547049472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:31:25.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249461514375168 [0;39m 生成今日电子书快照开始
2022-08-31 17:31:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249461514375168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:31:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249461514375168 [0;39m ==> Parameters: 
2022-08-31 17:31:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249461514375168 [0;39m <==    Updates: 0
2022-08-31 17:31:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249461514375168 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:31:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249482540421120 [0;39m 生成今日电子书快照开始
2022-08-31 17:31:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249482540421120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:31:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249482540421120 [0;39m ==> Parameters: 
2022-08-31 17:31:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249482540421120 [0;39m <==    Updates: 0
2022-08-31 17:31:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249482540421120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:31:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22249503490969600 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:31:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249503490969600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:31:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249503490969600 [0;39m ==> Parameters: 
2022-08-31 17:31:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249503490969600 [0;39m <==    Updates: 8
2022-08-31 17:31:35.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22249503490969600 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:31:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249503499358208 [0;39m 生成今日电子书快照开始
2022-08-31 17:31:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249503499358208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:31:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249503499358208 [0;39m ==> Parameters: 
2022-08-31 17:31:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249503499358208 [0;39m <==    Updates: 0
2022-08-31 17:31:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249503499358208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:31:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249524496044032 [0;39m 生成今日电子书快照开始
2022-08-31 17:31:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249524496044032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:31:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249524496044032 [0;39m ==> Parameters: 
2022-08-31 17:31:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249524496044032 [0;39m <==    Updates: 0
2022-08-31 17:31:40.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249524496044032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:31:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249545450786816 [0;39m 生成今日电子书快照开始
2022-08-31 17:31:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249545450786816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:31:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249545450786816 [0;39m ==> Parameters: 
2022-08-31 17:31:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249545450786816 [0;39m <==    Updates: 0
2022-08-31 17:31:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249545450786816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:31:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249566413918208 [0;39m 生成今日电子书快照开始
2022-08-31 17:31:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249566413918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:31:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249566413918208 [0;39m ==> Parameters: 
2022-08-31 17:31:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249566413918208 [0;39m <==    Updates: 0
2022-08-31 17:31:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249566413918208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:31:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249587402215424 [0;39m 生成今日电子书快照开始
2022-08-31 17:31:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249587402215424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:31:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249587402215424 [0;39m ==> Parameters: 
2022-08-31 17:31:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249587402215424 [0;39m <==    Updates: 0
2022-08-31 17:31:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249587402215424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:32:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249608369541120 [0;39m 生成今日电子书快照开始
2022-08-31 17:32:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249608369541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:32:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249608369541120 [0;39m ==> Parameters: 
2022-08-31 17:32:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249608369541120 [0;39m <==    Updates: 0
2022-08-31 17:32:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249608369541120 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:32:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249629328478208 [0;39m 生成今日电子书快照开始
2022-08-31 17:32:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249629328478208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:32:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249629328478208 [0;39m ==> Parameters: 
2022-08-31 17:32:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249629328478208 [0;39m <==    Updates: 0
2022-08-31 17:32:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249629328478208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:32:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22249629336866816 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:32:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249629336866816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:32:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249629336866816 [0;39m ==> Parameters: 
2022-08-31 17:32:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249629336866816 [0;39m <==    Updates: 8
2022-08-31 17:32:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22249629336866816 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:32:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249650262249472 [0;39m 生成今日电子书快照开始
2022-08-31 17:32:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249650262249472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:32:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249650262249472 [0;39m ==> Parameters: 
2022-08-31 17:32:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249650262249472 [0;39m <==    Updates: 0
2022-08-31 17:32:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249650262249472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:32:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249671267323904 [0;39m 生成今日电子书快照开始
2022-08-31 17:32:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249671267323904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:32:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249671267323904 [0;39m ==> Parameters: 
2022-08-31 17:32:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249671267323904 [0;39m <==    Updates: 0
2022-08-31 17:32:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249671267323904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:32:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249692255621120 [0;39m 生成今日电子书快照开始
2022-08-31 17:32:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249692255621120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:32:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249692255621120 [0;39m ==> Parameters: 
2022-08-31 17:32:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249692255621120 [0;39m <==    Updates: 0
2022-08-31 17:32:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249692255621120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:32:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249713227141120 [0;39m 生成今日电子书快照开始
2022-08-31 17:32:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249713227141120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:32:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249713227141120 [0;39m ==> Parameters: 
2022-08-31 17:32:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249713227141120 [0;39m <==    Updates: 0
2022-08-31 17:32:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249713227141120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:32:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249734198661120 [0;39m 生成今日电子书快照开始
2022-08-31 17:32:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249734198661120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:32:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249734198661120 [0;39m ==> Parameters: 
2022-08-31 17:32:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249734198661120 [0;39m <==    Updates: 0
2022-08-31 17:32:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249734198661120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:32:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249755174375424 [0;39m 生成今日电子书快照开始
2022-08-31 17:32:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249755174375424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:32:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249755174375424 [0;39m ==> Parameters: 
2022-08-31 17:32:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249755174375424 [0;39m <==    Updates: 0
2022-08-31 17:32:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249755174375424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:32:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22249755182764032 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:32:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249755182764032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:32:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249755182764032 [0;39m ==> Parameters: 
2022-08-31 17:32:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249755182764032 [0;39m <==    Updates: 8
2022-08-31 17:32:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22249755182764032 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:32:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249776091369472 [0;39m 生成今日电子书快照开始
2022-08-31 17:32:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249776091369472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:32:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249776091369472 [0;39m ==> Parameters: 
2022-08-31 17:32:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249776091369472 [0;39m <==    Updates: 0
2022-08-31 17:32:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249776091369472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:32:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249797109026816 [0;39m 生成今日电子书快照开始
2022-08-31 17:32:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249797109026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:32:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249797109026816 [0;39m ==> Parameters: 
2022-08-31 17:32:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249797109026816 [0;39m <==    Updates: 0
2022-08-31 17:32:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249797109026816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:32:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249818088935424 [0;39m 生成今日电子书快照开始
2022-08-31 17:32:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249818088935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:32:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249818088935424 [0;39m ==> Parameters: 
2022-08-31 17:32:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249818088935424 [0;39m <==    Updates: 0
2022-08-31 17:32:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249818088935424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:32:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249839056261120 [0;39m 生成今日电子书快照开始
2022-08-31 17:32:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249839056261120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:32:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249839056261120 [0;39m ==> Parameters: 
2022-08-31 17:32:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249839056261120 [0;39m <==    Updates: 0
2022-08-31 17:32:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249839056261120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:32:55.584 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22249239316926464 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:32:55.585 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22249239316926464 [0;39m ------------- LoginInterceptor 结束 耗时：0 ms -------------
2022-08-31 17:32:55.586 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22249239400812544 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:32:55.587 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m22249239400812544 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-31 17:32:55.587 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m22249239400812544 [0;39m 登录校验开始，token：22249199726891008
2022-08-31 17:32:55.619 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m22249239400812544 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"}
2022-08-31 17:32:55.623 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249841614786560 [0;39m ------------- 开始 -------------
2022-08-31 17:32:55.624 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249841614786560 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-31 17:32:55.624 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249841614786560 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-31 17:32:55.624 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249841614786560 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:32:55.626 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249841614786560 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"ys69d\">在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构</h2></blockquote><p><font size=\"4\">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技\n</font></p><p><font size=\"3\">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函\n</font></p><p><font size=\"3\">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><p><br></p><blockquote><h2 style=\"text-align:center;\" id=\"clhau\">在学习Dubbo分布式框架爱之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2></blockquote>","ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}]
2022-08-31 17:32:55.644 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22249841614786560 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-31 17:32:55.644 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22249841614786560 [0;39m ==> Parameters: 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 1(Integer), 0(Integer), 20420961950109696(Long)
2022-08-31 17:32:55.646 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22249841614786560 [0;39m <==    Updates: 1
2022-08-31 17:32:55.646 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22249841614786560 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-31 17:32:55.647 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22249841614786560 [0;39m ==> Parameters: <blockquote><h2 id="ys69d">在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构</h2></blockquote><p><font size="4">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技
</font></p><p><font size="3">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函
</font></p><p><font size="3">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p><p><br></p><blockquote><h2 style="text-align:center;" id="clhau">在学习Dubbo分布式框架爱之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2></blockquote>(String), 20420961950109696(Long)
2022-08-31 17:32:55.648 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22249841614786560 [0;39m <==    Updates: 1
2022-08-31 17:32:55.708 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249841614786560 [0;39m 返回结果: {"success":true}
2022-08-31 17:32:55.709 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249841614786560 [0;39m ------------- 结束 耗时：86 ms -------------
2022-08-31 17:32:55.710 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22249841614786560 [0;39m ------------- LoginInterceptor 结束 耗时：123 ms -------------
2022-08-31 17:32:55.717 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249842009051136 [0;39m ------------- 开始 -------------
2022-08-31 17:32:55.717 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249842009051136 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:32:55.717 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249842009051136 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:32:55.718 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249842009051136 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:32:55.718 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249842009051136 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:32:55.719 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22249842009051136 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:32:55.720 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22249842009051136 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:32:55.721 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22249842009051136 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:32:55.721 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22249842009051136 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 17:32:55.721 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22249842009051136 [0;39m <==      Total: 1
2022-08-31 17:32:55.722 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249842009051136 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 17:32:55.722 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249842009051136 [0;39m ------------- 结束 耗时：5 ms -------------
2022-08-31 17:33:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249860019392512 [0;39m 生成今日电子书快照开始
2022-08-31 17:33:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249860019392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:33:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249860019392512 [0;39m ==> Parameters: 
2022-08-31 17:33:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249860019392512 [0;39m <==    Updates: 0
2022-08-31 17:33:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249860019392512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:33:03.862 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22249216336334848 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:33:03.862 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m22249216336334848 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-31 17:33:03.862 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m22249216336334848 [0;39m 登录校验开始，token：22249199726891008
2022-08-31 17:33:03.896 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m22249216336334848 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"}
2022-08-31 17:33:03.897 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249876318457856 [0;39m ------------- 开始 -------------
2022-08-31 17:33:03.897 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249876318457856 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-31 17:33:03.897 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249876318457856 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-31 17:33:03.897 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249876318457856 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:33:03.898 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249876318457856 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"ys69d\">在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构</h2></blockquote><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技\n</font></p><p><font size=\"3\">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函\n</font></p><p><font size=\"3\">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><p><br></p><blockquote><h2 style=\"text-align:center;\" id=\"clhau\">在学习Dubbo分布式框架爱之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2></blockquote>","ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}]
2022-08-31 17:33:03.898 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22249876318457856 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-31 17:33:03.899 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22249876318457856 [0;39m ==> Parameters: 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 1(Integer), 0(Integer), 20420961950109696(Long)
2022-08-31 17:33:03.900 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22249876318457856 [0;39m <==    Updates: 1
2022-08-31 17:33:03.900 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22249876318457856 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-31 17:33:03.901 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22249876318457856 [0;39m ==> Parameters: <blockquote><h2 id="ys69d">在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构</h2></blockquote><p><font size="4" style="background-color: rgb(139, 170, 74);">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技
</font></p><p><font size="3">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函
</font></p><p><font size="3">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p><p><br></p><blockquote><h2 style="text-align:center;" id="clhau">在学习Dubbo分布式框架爱之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2></blockquote>(String), 20420961950109696(Long)
2022-08-31 17:33:03.906 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22249876318457856 [0;39m <==    Updates: 1
2022-08-31 17:33:03.915 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249876318457856 [0;39m 返回结果: {"success":true}
2022-08-31 17:33:03.916 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249876318457856 [0;39m ------------- 结束 耗时：19 ms -------------
2022-08-31 17:33:03.916 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22249876318457856 [0;39m ------------- LoginInterceptor 结束 耗时：54 ms -------------
2022-08-31 17:33:03.922 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22249876423315456 [0;39m ------------- 开始 -------------
2022-08-31 17:33:03.923 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22249876423315456 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:33:03.923 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22249876423315456 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:33:03.923 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22249876423315456 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:33:03.923 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22249876423315456 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:33:03.924 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22249876423315456 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:33:03.925 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22249876423315456 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:33:03.925 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22249876423315456 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:33:03.926 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22249876423315456 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 17:33:03.926 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22249876423315456 [0;39m <==      Total: 1
2022-08-31 17:33:03.927 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22249876423315456 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 17:33:03.927 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22249876423315456 [0;39m ------------- 结束 耗时：5 ms -------------
2022-08-31 17:33:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249880978329600 [0;39m 生成今日电子书快照开始
2022-08-31 17:33:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249880978329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:33:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249880978329600 [0;39m ==> Parameters: 
2022-08-31 17:33:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249880978329600 [0;39m <==    Updates: 0
2022-08-31 17:33:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249880978329600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:33:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22249880990912512 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:33:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249880990912512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:33:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249880990912512 [0;39m ==> Parameters: 
2022-08-31 17:33:05.029 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22249880990912512 [0;39m <==    Updates: 8
2022-08-31 17:33:05.030 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22249880990912512 [0;39m 更新电子书下的文档数据结束，耗时：19 毫秒
2022-08-31 17:33:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249901975015424 [0;39m 生成今日电子书快照开始
2022-08-31 17:33:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249901975015424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:33:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249901975015424 [0;39m ==> Parameters: 
2022-08-31 17:33:10.068 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249901975015424 [0;39m <==    Updates: 0
2022-08-31 17:33:10.069 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249901975015424 [0;39m 生成今日电子书快照结束，耗时：54 毫秒
2022-08-31 17:33:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249922942341120 [0;39m 生成今日电子书快照开始
2022-08-31 17:33:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249922942341120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:33:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249922942341120 [0;39m ==> Parameters: 
2022-08-31 17:33:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249922942341120 [0;39m <==    Updates: 0
2022-08-31 17:33:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249922942341120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:33:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249943888695296 [0;39m 生成今日电子书快照开始
2022-08-31 17:33:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249943888695296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:33:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249943888695296 [0;39m ==> Parameters: 
2022-08-31 17:33:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249943888695296 [0;39m <==    Updates: 0
2022-08-31 17:33:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249943888695296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:33:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249964889575424 [0;39m 生成今日电子书快照开始
2022-08-31 17:33:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249964889575424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:33:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249964889575424 [0;39m ==> Parameters: 
2022-08-31 17:33:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249964889575424 [0;39m <==    Updates: 0
2022-08-31 17:33:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249964889575424 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 17:33:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22249985865289728 [0;39m 生成今日电子书快照开始
2022-08-31 17:33:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249985865289728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:33:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249985865289728 [0;39m ==> Parameters: 
2022-08-31 17:33:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22249985865289728 [0;39m <==    Updates: 0
2022-08-31 17:33:30.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22249985865289728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:33:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22250006828421120 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:33:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250006828421120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:33:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250006828421120 [0;39m ==> Parameters: 
2022-08-31 17:33:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250006828421120 [0;39m <==    Updates: 8
2022-08-31 17:33:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22250006828421120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:33:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250006836809728 [0;39m 生成今日电子书快照开始
2022-08-31 17:33:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250006836809728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:33:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250006836809728 [0;39m ==> Parameters: 
2022-08-31 17:33:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250006836809728 [0;39m <==    Updates: 0
2022-08-31 17:33:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250006836809728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:33:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250027766386688 [0;39m 生成今日电子书快照开始
2022-08-31 17:33:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250027766386688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:33:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250027766386688 [0;39m ==> Parameters: 
2022-08-31 17:33:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250027766386688 [0;39m <==    Updates: 0
2022-08-31 17:33:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250027766386688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:33:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250048779849728 [0;39m 生成今日电子书快照开始
2022-08-31 17:33:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250048779849728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:33:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250048779849728 [0;39m ==> Parameters: 
2022-08-31 17:33:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250048779849728 [0;39m <==    Updates: 0
2022-08-31 17:33:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250048779849728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:33:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250069701038080 [0;39m 生成今日电子书快照开始
2022-08-31 17:33:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250069701038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:33:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250069701038080 [0;39m ==> Parameters: 
2022-08-31 17:33:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250069701038080 [0;39m <==    Updates: 0
2022-08-31 17:33:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250069701038080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:33:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250090706112512 [0;39m 生成今日电子书快照开始
2022-08-31 17:33:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250090706112512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:33:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250090706112512 [0;39m ==> Parameters: 
2022-08-31 17:33:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250090706112512 [0;39m <==    Updates: 0
2022-08-31 17:33:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250090706112512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:34:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250111694409728 [0;39m 生成今日电子书快照开始
2022-08-31 17:34:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250111694409728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:34:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250111694409728 [0;39m ==> Parameters: 
2022-08-31 17:34:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250111694409728 [0;39m <==    Updates: 0
2022-08-31 17:34:00.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250111694409728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:34:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250132653346816 [0;39m 生成今日电子书快照开始
2022-08-31 17:34:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250132653346816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:34:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250132653346816 [0;39m ==> Parameters: 
2022-08-31 17:34:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250132653346816 [0;39m <==    Updates: 0
2022-08-31 17:34:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250132653346816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:34:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22250132665929728 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:34:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250132665929728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:34:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250132665929728 [0;39m ==> Parameters: 
2022-08-31 17:34:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250132665929728 [0;39m <==    Updates: 8
2022-08-31 17:34:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22250132665929728 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-31 17:34:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250153595506688 [0;39m 生成今日电子书快照开始
2022-08-31 17:34:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250153595506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:34:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250153595506688 [0;39m ==> Parameters: 
2022-08-31 17:34:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250153595506688 [0;39m <==    Updates: 0
2022-08-31 17:34:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250153595506688 [0;39m 生成今日电子书快照结束，耗时：12 毫秒
2022-08-31 17:34:14.459 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22249333718126592 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:34:14.459 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m22249333718126592 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-31 17:34:14.459 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m22249333718126592 [0;39m 登录校验开始，token：22249199726891008
2022-08-31 17:34:14.492 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m22249333718126592 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"}
2022-08-31 17:34:14.493 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22250172419543040 [0;39m ------------- 开始 -------------
2022-08-31 17:34:14.493 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22250172419543040 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-31 17:34:14.493 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22250172419543040 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-31 17:34:14.493 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22250172419543040 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:34:14.494 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22250172419543040 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"ys69d\">在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构</h2></blockquote><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技\n</font></p><p><font size=\"3\">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函\n</font></p><p><font size=\"3\">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">2.&nbsp; RPC特点？</font><br></p><p><font size=\"3\">1. 简单：使用简单，建立分布式应用更容易。\n</font></p><p><font size=\"3\">2. 高效：调用过程看起来十分清晰，效率高。\n</font></p><p><font size=\"3\">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><p><br></p><blockquote><h2 style=\"text-align:center;\" id=\"clhau\">在学习Dubbo分布式框架爱之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2></blockquote>","ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}]
2022-08-31 17:34:14.494 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22250172419543040 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-31 17:34:14.495 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22250172419543040 [0;39m ==> Parameters: 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 1(Integer), 0(Integer), 20420961950109696(Long)
2022-08-31 17:34:14.496 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22250172419543040 [0;39m <==    Updates: 1
2022-08-31 17:34:14.496 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22250172419543040 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-31 17:34:14.497 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22250172419543040 [0;39m ==> Parameters: <blockquote><h2 id="ys69d">在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构</h2></blockquote><p><font size="4" style="background-color: rgb(139, 170, 74);">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技
</font></p><p><font size="3">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函
</font></p><p><font size="3">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size="4" style="background-color: rgb(139, 170, 74);">2.&nbsp; RPC特点？</font><br></p><p><font size="3">1. 简单：使用简单，建立分布式应用更容易。
</font></p><p><font size="3">2. 高效：调用过程看起来十分清晰，效率高。
</font></p><p><font size="3">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p><p><br></p><blockquote><h2 style="text-align:center;" id="clhau">在学习Dubbo分布式框架爱之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2></blockquote>(String), 20420961950109696(Long)
2022-08-31 17:34:14.500 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22250172419543040 [0;39m <==    Updates: 1
2022-08-31 17:34:14.551 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22250172419543040 [0;39m 返回结果: {"success":true}
2022-08-31 17:34:14.551 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22250172419543040 [0;39m ------------- 结束 耗时：58 ms -------------
2022-08-31 17:34:14.552 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22250172419543040 [0;39m ------------- LoginInterceptor 结束 耗时：93 ms -------------
2022-08-31 17:34:14.558 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22250172692172800 [0;39m ------------- 开始 -------------
2022-08-31 17:34:14.559 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22250172692172800 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:34:14.559 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22250172692172800 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:34:14.559 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22250172692172800 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:34:14.559 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22250172692172800 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:34:14.560 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22250172692172800 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:34:14.560 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22250172692172800 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:34:14.561 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22250172692172800 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:34:14.561 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22250172692172800 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 17:34:14.561 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22250172692172800 [0;39m <==      Total: 1
2022-08-31 17:34:14.562 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22250172692172800 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 17:34:14.562 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22250172692172800 [0;39m ------------- 结束 耗时：4 ms -------------
2022-08-31 17:34:15.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250174546055168 [0;39m 生成今日电子书快照开始
2022-08-31 17:34:15.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250174546055168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:34:15.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250174546055168 [0;39m ==> Parameters: 
2022-08-31 17:34:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250174546055168 [0;39m <==    Updates: 0
2022-08-31 17:34:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250174546055168 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:34:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250195542740992 [0;39m 生成今日电子书快照开始
2022-08-31 17:34:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250195542740992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:34:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250195542740992 [0;39m ==> Parameters: 
2022-08-31 17:34:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250195542740992 [0;39m <==    Updates: 0
2022-08-31 17:34:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250195542740992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:34:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250216493289472 [0;39m 生成今日电子书快照开始
2022-08-31 17:34:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250216493289472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:34:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250216493289472 [0;39m ==> Parameters: 
2022-08-31 17:34:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250216493289472 [0;39m <==    Updates: 0
2022-08-31 17:34:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250216493289472 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-31 17:34:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250237498363904 [0;39m 生成今日电子书快照开始
2022-08-31 17:34:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250237498363904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:34:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250237498363904 [0;39m ==> Parameters: 
2022-08-31 17:34:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250237498363904 [0;39m <==    Updates: 0
2022-08-31 17:34:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250237498363904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 17:34:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22250258453106688 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:34:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250258453106688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:34:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250258453106688 [0;39m ==> Parameters: 
2022-08-31 17:34:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250258453106688 [0;39m <==    Updates: 8
2022-08-31 17:34:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22250258453106688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:34:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250258457300992 [0;39m 生成今日电子书快照开始
2022-08-31 17:34:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250258457300992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:34:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250258457300992 [0;39m ==> Parameters: 
2022-08-31 17:34:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250258457300992 [0;39m <==    Updates: 0
2022-08-31 17:34:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250258457300992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:34:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250279424626688 [0;39m 生成今日电子书快照开始
2022-08-31 17:34:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250279424626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:34:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250279424626688 [0;39m ==> Parameters: 
2022-08-31 17:34:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250279424626688 [0;39m <==    Updates: 0
2022-08-31 17:34:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250279424626688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:34:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250300433895424 [0;39m 生成今日电子书快照开始
2022-08-31 17:34:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250300433895424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:34:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250300433895424 [0;39m ==> Parameters: 
2022-08-31 17:34:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250300433895424 [0;39m <==    Updates: 0
2022-08-31 17:34:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250300433895424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:34:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250321367666688 [0;39m 生成今日电子书快照开始
2022-08-31 17:34:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250321367666688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:34:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250321367666688 [0;39m ==> Parameters: 
2022-08-31 17:34:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250321367666688 [0;39m <==    Updates: 0
2022-08-31 17:34:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250321367666688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:34:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250342364352512 [0;39m 生成今日电子书快照开始
2022-08-31 17:34:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250342364352512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:34:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250342364352512 [0;39m ==> Parameters: 
2022-08-31 17:34:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250342364352512 [0;39m <==    Updates: 0
2022-08-31 17:34:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250342364352512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:35:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250363310706688 [0;39m 生成今日电子书快照开始
2022-08-31 17:35:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250363310706688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:35:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250363310706688 [0;39m ==> Parameters: 
2022-08-31 17:35:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250363310706688 [0;39m <==    Updates: 0
2022-08-31 17:35:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250363310706688 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:35:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250384294809600 [0;39m 生成今日电子书快照开始
2022-08-31 17:35:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250384294809600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:35:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250384294809600 [0;39m ==> Parameters: 
2022-08-31 17:35:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250384294809600 [0;39m <==    Updates: 0
2022-08-31 17:35:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250384294809600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:35:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22250384307392512 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:35:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250384307392512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:35:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250384307392512 [0;39m ==> Parameters: 
2022-08-31 17:35:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250384307392512 [0;39m <==    Updates: 8
2022-08-31 17:35:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22250384307392512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:35:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250405257940992 [0;39m 生成今日电子书快照开始
2022-08-31 17:35:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250405257940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:35:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250405257940992 [0;39m ==> Parameters: 
2022-08-31 17:35:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250405257940992 [0;39m <==    Updates: 0
2022-08-31 17:35:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250405257940992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:35:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250426263015424 [0;39m 生成今日电子书快照开始
2022-08-31 17:35:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250426263015424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:35:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250426263015424 [0;39m ==> Parameters: 
2022-08-31 17:35:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250426263015424 [0;39m <==    Updates: 0
2022-08-31 17:35:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250426263015424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:35:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250447184203776 [0;39m 生成今日电子书快照开始
2022-08-31 17:35:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250447184203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:35:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250447184203776 [0;39m ==> Parameters: 
2022-08-31 17:35:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250447184203776 [0;39m <==    Updates: 0
2022-08-31 17:35:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250447184203776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:35:25.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250468147335168 [0;39m 生成今日电子书快照开始
2022-08-31 17:35:25.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250468147335168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:35:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250468147335168 [0;39m ==> Parameters: 
2022-08-31 17:35:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250468147335168 [0;39m <==    Updates: 0
2022-08-31 17:35:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250468147335168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:35:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250489173381120 [0;39m 生成今日电子书快照开始
2022-08-31 17:35:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250489173381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:35:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250489173381120 [0;39m ==> Parameters: 
2022-08-31 17:35:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250489173381120 [0;39m <==    Updates: 0
2022-08-31 17:35:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250489173381120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:35:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250510111346688 [0;39m 生成今日电子书快照开始
2022-08-31 17:35:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250510111346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:35:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250510111346688 [0;39m ==> Parameters: 
2022-08-31 17:35:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250510111346688 [0;39m <==    Updates: 0
2022-08-31 17:35:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250510111346688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:35:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22250510123929600 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:35:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250510123929600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:35:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250510123929600 [0;39m ==> Parameters: 
2022-08-31 17:35:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250510123929600 [0;39m <==    Updates: 8
2022-08-31 17:35:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22250510123929600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:35:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250531095449600 [0;39m 生成今日电子书快照开始
2022-08-31 17:35:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250531095449600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:35:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250531095449600 [0;39m ==> Parameters: 
2022-08-31 17:35:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250531095449600 [0;39m <==    Updates: 0
2022-08-31 17:35:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250531095449600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:35:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250552050192384 [0;39m 生成今日电子书快照开始
2022-08-31 17:35:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250552050192384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:35:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250552050192384 [0;39m ==> Parameters: 
2022-08-31 17:35:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250552050192384 [0;39m <==    Updates: 0
2022-08-31 17:35:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250552050192384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:35:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250573025906688 [0;39m 生成今日电子书快照开始
2022-08-31 17:35:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250573025906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:35:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250573025906688 [0;39m ==> Parameters: 
2022-08-31 17:35:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250573025906688 [0;39m <==    Updates: 0
2022-08-31 17:35:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250573025906688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:35:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250594010009600 [0;39m 生成今日电子书快照开始
2022-08-31 17:35:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250594010009600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:35:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250594010009600 [0;39m ==> Parameters: 
2022-08-31 17:35:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250594010009600 [0;39m <==    Updates: 0
2022-08-31 17:35:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250594010009600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:36:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250614956363776 [0;39m 生成今日电子书快照开始
2022-08-31 17:36:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250614956363776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:36:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250614956363776 [0;39m ==> Parameters: 
2022-08-31 17:36:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250614956363776 [0;39m <==    Updates: 0
2022-08-31 17:36:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250614956363776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:36:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22250635986604032 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:36:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250635986604032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:36:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250635986604032 [0;39m ==> Parameters: 
2022-08-31 17:36:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250635986604032 [0;39m <==    Updates: 8
2022-08-31 17:36:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22250635986604032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:36:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250635994992640 [0;39m 生成今日电子书快照开始
2022-08-31 17:36:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250635994992640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:36:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250635994992640 [0;39m ==> Parameters: 
2022-08-31 17:36:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250635994992640 [0;39m <==    Updates: 0
2022-08-31 17:36:05.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250635994992640 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:36:08.180 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22249231918174208 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:36:08.180 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m22249231918174208 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-31 17:36:08.180 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m22249231918174208 [0;39m 登录校验开始，token：22249199726891008
2022-08-31 17:36:08.213 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m22249231918174208 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"}
2022-08-31 17:36:08.214 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22250649399988224 [0;39m ------------- 开始 -------------
2022-08-31 17:36:08.214 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22250649399988224 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-31 17:36:08.215 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22250649399988224 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-31 17:36:08.215 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22250649399988224 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:36:08.215 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22250649399988224 [0;39m 请求参数: [{"content":"<blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id=\"ys69d\"><br></h2><h2 id=\"ys69d\">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技\n</font></p><p><font size=\"3\">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函\n</font></p><p><font size=\"3\">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">2.&nbsp; RPC特点？</font><br></p><p><font size=\"3\">1. 简单：使用简单，建立分布式应用更容易。\n</font></p><p><font size=\"3\">2. 高效：调用过程看起来十分清晰，效率高。\n</font></p><p><font size=\"3\">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><p><br></p><blockquote><h2 style=\"text-align:center;\" id=\"clhau\"><br></h2></blockquote>","ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}]
2022-08-31 17:36:08.216 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22250649399988224 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-31 17:36:08.216 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22250649399988224 [0;39m ==> Parameters: 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 1(Integer), 0(Integer), 20420961950109696(Long)
2022-08-31 17:36:08.217 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22250649399988224 [0;39m <==    Updates: 1
2022-08-31 17:36:08.217 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22250649399988224 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-31 17:36:08.217 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22250649399988224 [0;39m ==> Parameters: <blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id="ys69d"><br></h2><h2 id="ys69d">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size="4" style="background-color: rgb(139, 170, 74);">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技
</font></p><p><font size="3">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函
</font></p><p><font size="3">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size="4" style="background-color: rgb(139, 170, 74);">2.&nbsp; RPC特点？</font><br></p><p><font size="3">1. 简单：使用简单，建立分布式应用更容易。
</font></p><p><font size="3">2. 高效：调用过程看起来十分清晰，效率高。
</font></p><p><font size="3">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p><p><br></p><blockquote><h2 style="text-align:center;" id="clhau"><br></h2></blockquote>(String), 20420961950109696(Long)
2022-08-31 17:36:08.218 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22250649399988224 [0;39m <==    Updates: 1
2022-08-31 17:36:08.285 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22250649399988224 [0;39m 返回结果: {"success":true}
2022-08-31 17:36:08.285 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22250649399988224 [0;39m ------------- 结束 耗时：71 ms -------------
2022-08-31 17:36:08.286 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22250649399988224 [0;39m ------------- LoginInterceptor 结束 耗时：106 ms -------------
2022-08-31 17:36:08.293 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22250649731338240 [0;39m ------------- 开始 -------------
2022-08-31 17:36:08.294 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22250649731338240 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:36:08.294 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22250649731338240 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:36:08.294 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22250649731338240 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:36:08.294 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22250649731338240 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:36:08.295 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22250649731338240 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:36:08.295 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22250649731338240 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:36:08.296 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22250649731338240 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:36:08.297 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22250649731338240 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 17:36:08.297 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22250649731338240 [0;39m <==      Total: 1
2022-08-31 17:36:08.298 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22250649731338240 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 17:36:08.298 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22250649731338240 [0;39m ------------- 结束 耗时：5 ms -------------
2022-08-31 17:36:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250656916180992 [0;39m 生成今日电子书快照开始
2022-08-31 17:36:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250656916180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:36:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250656916180992 [0;39m ==> Parameters: 
2022-08-31 17:36:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250656916180992 [0;39m <==    Updates: 0
2022-08-31 17:36:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250656916180992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:36:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250677896089600 [0;39m 生成今日电子书快照开始
2022-08-31 17:36:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250677896089600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:36:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250677896089600 [0;39m ==> Parameters: 
2022-08-31 17:36:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250677896089600 [0;39m <==    Updates: 0
2022-08-31 17:36:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250677896089600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:36:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250698859220992 [0;39m 生成今日电子书快照开始
2022-08-31 17:36:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250698859220992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:36:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250698859220992 [0;39m ==> Parameters: 
2022-08-31 17:36:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250698859220992 [0;39m <==    Updates: 0
2022-08-31 17:36:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250698859220992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:36:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250719818158080 [0;39m 生成今日电子书快照开始
2022-08-31 17:36:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250719818158080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:36:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250719818158080 [0;39m ==> Parameters: 
2022-08-31 17:36:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250719818158080 [0;39m <==    Updates: 0
2022-08-31 17:36:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250719818158080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:36:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250740819038208 [0;39m 生成今日电子书快照开始
2022-08-31 17:36:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250740819038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:36:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250740819038208 [0;39m ==> Parameters: 
2022-08-31 17:36:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250740819038208 [0;39m <==    Updates: 0
2022-08-31 17:36:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250740819038208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:36:35.000 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22250761748615168 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:36:35.000 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250761748615168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:36:35.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250761748615168 [0;39m ==> Parameters: 
2022-08-31 17:36:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250761748615168 [0;39m <==    Updates: 8
2022-08-31 17:36:35.002 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22250761748615168 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:36:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250761757003776 [0;39m 生成今日电子书快照开始
2022-08-31 17:36:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250761757003776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:36:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250761757003776 [0;39m ==> Parameters: 
2022-08-31 17:36:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250761757003776 [0;39m <==    Updates: 0
2022-08-31 17:36:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250761757003776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:36:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250782778855424 [0;39m 生成今日电子书快照开始
2022-08-31 17:36:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250782778855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:36:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250782778855424 [0;39m ==> Parameters: 
2022-08-31 17:36:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250782778855424 [0;39m <==    Updates: 0
2022-08-31 17:36:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250782778855424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:36:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250803704238080 [0;39m 生成今日电子书快照开始
2022-08-31 17:36:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250803704238080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:36:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250803704238080 [0;39m ==> Parameters: 
2022-08-31 17:36:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250803704238080 [0;39m <==    Updates: 0
2022-08-31 17:36:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250803704238080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:36:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250824700923904 [0;39m 生成今日电子书快照开始
2022-08-31 17:36:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250824700923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:36:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250824700923904 [0;39m ==> Parameters: 
2022-08-31 17:36:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250824700923904 [0;39m <==    Updates: 0
2022-08-31 17:36:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250824700923904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:36:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250845643083776 [0;39m 生成今日电子书快照开始
2022-08-31 17:36:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250845643083776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:36:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250845643083776 [0;39m ==> Parameters: 
2022-08-31 17:36:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250845643083776 [0;39m <==    Updates: 0
2022-08-31 17:36:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250845643083776 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 17:37:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250866639769600 [0;39m 生成今日电子书快照开始
2022-08-31 17:37:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250866639769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:37:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250866639769600 [0;39m ==> Parameters: 
2022-08-31 17:37:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250866639769600 [0;39m <==    Updates: 0
2022-08-31 17:37:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250866639769600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:37:05.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250887577735168 [0;39m 生成今日电子书快照开始
2022-08-31 17:37:05.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250887577735168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:37:05.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250887577735168 [0;39m ==> Parameters: 
2022-08-31 17:37:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250887577735168 [0;39m <==    Updates: 0
2022-08-31 17:37:05.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250887577735168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:37:05.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22250887586123776 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:37:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250887586123776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:37:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250887586123776 [0;39m ==> Parameters: 
2022-08-31 17:37:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22250887586123776 [0;39m <==    Updates: 8
2022-08-31 17:37:05.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22250887586123776 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:37:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250908603781120 [0;39m 生成今日电子书快照开始
2022-08-31 17:37:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250908603781120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:37:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250908603781120 [0;39m ==> Parameters: 
2022-08-31 17:37:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250908603781120 [0;39m <==    Updates: 0
2022-08-31 17:37:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250908603781120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:37:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250929545940992 [0;39m 生成今日电子书快照开始
2022-08-31 17:37:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250929545940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:37:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250929545940992 [0;39m ==> Parameters: 
2022-08-31 17:37:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250929545940992 [0;39m <==    Updates: 0
2022-08-31 17:37:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250929545940992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:37:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250950496489472 [0;39m 生成今日电子书快照开始
2022-08-31 17:37:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250950496489472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:37:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250950496489472 [0;39m ==> Parameters: 
2022-08-31 17:37:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250950496489472 [0;39m <==    Updates: 0
2022-08-31 17:37:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250950496489472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:37:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250971509952512 [0;39m 生成今日电子书快照开始
2022-08-31 17:37:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250971509952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:37:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250971509952512 [0;39m ==> Parameters: 
2022-08-31 17:37:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250971509952512 [0;39m <==    Updates: 0
2022-08-31 17:37:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250971509952512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:37:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22250992473083904 [0;39m 生成今日电子书快照开始
2022-08-31 17:37:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250992473083904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:37:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250992473083904 [0;39m ==> Parameters: 
2022-08-31 17:37:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22250992473083904 [0;39m <==    Updates: 0
2022-08-31 17:37:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22250992473083904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:37:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22251013440409600 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:37:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251013440409600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:37:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251013440409600 [0;39m ==> Parameters: 
2022-08-31 17:37:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251013440409600 [0;39m <==    Updates: 8
2022-08-31 17:37:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22251013440409600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:37:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251013448798208 [0;39m 生成今日电子书快照开始
2022-08-31 17:37:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251013448798208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:37:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251013448798208 [0;39m ==> Parameters: 
2022-08-31 17:37:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251013448798208 [0;39m <==    Updates: 0
2022-08-31 17:37:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251013448798208 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 17:37:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251034411929600 [0;39m 生成今日电子书快照开始
2022-08-31 17:37:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251034411929600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:37:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251034411929600 [0;39m ==> Parameters: 
2022-08-31 17:37:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251034411929600 [0;39m <==    Updates: 0
2022-08-31 17:37:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251034411929600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:37:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251055370866688 [0;39m 生成今日电子书快照开始
2022-08-31 17:37:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251055370866688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:37:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251055370866688 [0;39m ==> Parameters: 
2022-08-31 17:37:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251055370866688 [0;39m <==    Updates: 0
2022-08-31 17:37:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251055370866688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:37:49.395 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22249842009051136 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:37:49.395 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m22249842009051136 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-31 17:37:49.395 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m22249842009051136 [0;39m 登录校验开始，token：22249199726891008
2022-08-31 17:37:49.430 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m22249842009051136 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"}
2022-08-31 17:37:49.431 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22251073934856192 [0;39m ------------- 开始 -------------
2022-08-31 17:37:49.431 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22251073934856192 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-31 17:37:49.431 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22251073934856192 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-31 17:37:49.432 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22251073934856192 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:37:49.432 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22251073934856192 [0;39m 请求参数: [{"content":"<blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id=\"ys69d\"><br></h2><h2 id=\"ys69d\">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技\n</font></p><p><font size=\"3\">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函\n</font></p><p><font size=\"3\">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">2.&nbsp; RPC特点？</font><br></p><p><font size=\"3\">1. 简单：使用简单，建立分布式应用更容易。\n</font></p><p><font size=\"3\">2. 高效：调用过程看起来十分清晰，效率高。\n</font></p><p><font size=\"3\">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><p><font size=\"5\">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size=\"3\">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp;<font color=\"#c24f4a\"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p>","ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}]
2022-08-31 17:37:49.433 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22251073934856192 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-31 17:37:49.433 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22251073934856192 [0;39m ==> Parameters: 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 1(Integer), 0(Integer), 20420961950109696(Long)
2022-08-31 17:37:49.434 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22251073934856192 [0;39m <==    Updates: 1
2022-08-31 17:37:49.434 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22251073934856192 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-31 17:37:49.435 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22251073934856192 [0;39m ==> Parameters: <blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id="ys69d"><br></h2><h2 id="ys69d">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size="4" style="background-color: rgb(139, 170, 74);">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技
</font></p><p><font size="3">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函
</font></p><p><font size="3">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size="4" style="background-color: rgb(139, 170, 74);">2.&nbsp; RPC特点？</font><br></p><p><font size="3">1. 简单：使用简单，建立分布式应用更容易。
</font></p><p><font size="3">2. 高效：调用过程看起来十分清晰，效率高。
</font></p><p><font size="3">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p><p><font size="5">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size="3">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size="3">&nbsp; &nbsp; &nbsp;<font color="#c24f4a"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p>(String), 20420961950109696(Long)
2022-08-31 17:37:49.441 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22251073934856192 [0;39m <==    Updates: 1
2022-08-31 17:37:49.525 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22251073934856192 [0;39m 返回结果: {"success":true}
2022-08-31 17:37:49.525 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22251073934856192 [0;39m ------------- 结束 耗时：94 ms -------------
2022-08-31 17:37:49.525 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22251073934856192 [0;39m ------------- LoginInterceptor 结束 耗时：130 ms -------------
2022-08-31 17:37:49.534 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22251074366869504 [0;39m ------------- 开始 -------------
2022-08-31 17:37:49.534 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22251074366869504 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:37:49.535 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22251074366869504 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:37:49.535 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22251074366869504 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:37:49.536 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22251074366869504 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:37:49.537 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22251074366869504 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:37:49.538 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22251074366869504 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:37:49.539 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22251074366869504 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:37:49.539 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22251074366869504 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 17:37:49.540 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22251074366869504 [0;39m <==      Total: 1
2022-08-31 17:37:49.540 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22251074366869504 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 17:37:49.540 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22251074366869504 [0;39m ------------- 结束 耗时：6 ms -------------
2022-08-31 17:37:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251076388524032 [0;39m 生成今日电子书快照开始
2022-08-31 17:37:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251076388524032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:37:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251076388524032 [0;39m ==> Parameters: 
2022-08-31 17:37:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251076388524032 [0;39m <==    Updates: 0
2022-08-31 17:37:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251076388524032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:37:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251097339072512 [0;39m 生成今日电子书快照开始
2022-08-31 17:37:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251097339072512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:37:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251097339072512 [0;39m ==> Parameters: 
2022-08-31 17:37:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251097339072512 [0;39m <==    Updates: 0
2022-08-31 17:37:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251097339072512 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-31 17:38:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251118323175424 [0;39m 生成今日电子书快照开始
2022-08-31 17:38:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251118323175424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:38:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251118323175424 [0;39m ==> Parameters: 
2022-08-31 17:38:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251118323175424 [0;39m <==    Updates: 0
2022-08-31 17:38:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251118323175424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:38:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22251139286306816 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:38:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251139286306816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:38:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251139286306816 [0;39m ==> Parameters: 
2022-08-31 17:38:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251139286306816 [0;39m <==    Updates: 8
2022-08-31 17:38:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22251139286306816 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:38:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251139294695424 [0;39m 生成今日电子书快照开始
2022-08-31 17:38:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251139294695424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:38:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251139294695424 [0;39m ==> Parameters: 
2022-08-31 17:38:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251139294695424 [0;39m <==    Updates: 0
2022-08-31 17:38:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251139294695424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:38:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251160245243904 [0;39m 生成今日电子书快照开始
2022-08-31 17:38:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251160245243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:38:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251160245243904 [0;39m ==> Parameters: 
2022-08-31 17:38:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251160245243904 [0;39m <==    Updates: 0
2022-08-31 17:38:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251160245243904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:38:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251181225152512 [0;39m 生成今日电子书快照开始
2022-08-31 17:38:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251181225152512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:38:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251181225152512 [0;39m ==> Parameters: 
2022-08-31 17:38:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251181225152512 [0;39m <==    Updates: 0
2022-08-31 17:38:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251181225152512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:38:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251202179895296 [0;39m 生成今日电子书快照开始
2022-08-31 17:38:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251202179895296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:38:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251202179895296 [0;39m ==> Parameters: 
2022-08-31 17:38:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251202179895296 [0;39m <==    Updates: 0
2022-08-31 17:38:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251202179895296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:38:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251223172386816 [0;39m 生成今日电子书快照开始
2022-08-31 17:38:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251223172386816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:38:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251223172386816 [0;39m ==> Parameters: 
2022-08-31 17:38:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251223172386816 [0;39m <==    Updates: 0
2022-08-31 17:38:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251223172386816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:38:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251244139712512 [0;39m 生成今日电子书快照开始
2022-08-31 17:38:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251244139712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:38:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251244139712512 [0;39m ==> Parameters: 
2022-08-31 17:38:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251244139712512 [0;39m <==    Updates: 0
2022-08-31 17:38:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251244139712512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:38:35.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251265065095168 [0;39m 生成今日电子书快照开始
2022-08-31 17:38:35.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251265065095168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:38:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251265065095168 [0;39m ==> Parameters: 
2022-08-31 17:38:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251265065095168 [0;39m <==    Updates: 0
2022-08-31 17:38:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251265065095168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:38:35.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22251265073483776 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:38:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251265073483776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:38:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251265073483776 [0;39m ==> Parameters: 
2022-08-31 17:38:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251265073483776 [0;39m <==    Updates: 8
2022-08-31 17:38:35.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22251265073483776 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:38:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251286070169600 [0;39m 生成今日电子书快照开始
2022-08-31 17:38:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251286070169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:38:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251286070169600 [0;39m ==> Parameters: 
2022-08-31 17:38:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251286070169600 [0;39m <==    Updates: 0
2022-08-31 17:38:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251286070169600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:38:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251307045883904 [0;39m 生成今日电子书快照开始
2022-08-31 17:38:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251307045883904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:38:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251307045883904 [0;39m ==> Parameters: 
2022-08-31 17:38:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251307045883904 [0;39m <==    Updates: 0
2022-08-31 17:38:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251307045883904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:38:50.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251327983849472 [0;39m 生成今日电子书快照开始
2022-08-31 17:38:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251327983849472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:38:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251327983849472 [0;39m ==> Parameters: 
2022-08-31 17:38:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251327983849472 [0;39m <==    Updates: 0
2022-08-31 17:38:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251327983849472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:38:55.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251348955369472 [0;39m 生成今日电子书快照开始
2022-08-31 17:38:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251348955369472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:38:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251348955369472 [0;39m ==> Parameters: 
2022-08-31 17:38:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251348955369472 [0;39m <==    Updates: 0
2022-08-31 17:38:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251348955369472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:39:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251369981415424 [0;39m 生成今日电子书快照开始
2022-08-31 17:39:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251369981415424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:39:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251369981415424 [0;39m ==> Parameters: 
2022-08-31 17:39:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251369981415424 [0;39m <==    Updates: 0
2022-08-31 17:39:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251369981415424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:39:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22251390919380992 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:39:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251390919380992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:39:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251390919380992 [0;39m ==> Parameters: 
2022-08-31 17:39:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251390919380992 [0;39m <==    Updates: 8
2022-08-31 17:39:05.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22251390919380992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:39:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251390927769600 [0;39m 生成今日电子书快照开始
2022-08-31 17:39:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251390927769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:39:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251390927769600 [0;39m ==> Parameters: 
2022-08-31 17:39:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251390927769600 [0;39m <==    Updates: 0
2022-08-31 17:39:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251390927769600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:39:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251411911872512 [0;39m 生成今日电子书快照开始
2022-08-31 17:39:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251411911872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:39:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251411911872512 [0;39m ==> Parameters: 
2022-08-31 17:39:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251411911872512 [0;39m <==    Updates: 0
2022-08-31 17:39:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251411911872512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:39:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251432862420992 [0;39m 生成今日电子书快照开始
2022-08-31 17:39:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251432862420992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:39:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251432862420992 [0;39m ==> Parameters: 
2022-08-31 17:39:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251432862420992 [0;39m <==    Updates: 0
2022-08-31 17:39:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251432862420992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:39:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251453854912512 [0;39m 生成今日电子书快照开始
2022-08-31 17:39:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251453854912512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:39:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251453854912512 [0;39m ==> Parameters: 
2022-08-31 17:39:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251453854912512 [0;39m <==    Updates: 0
2022-08-31 17:39:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251453854912512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:39:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251474834821120 [0;39m 生成今日电子书快照开始
2022-08-31 17:39:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251474834821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:39:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251474834821120 [0;39m ==> Parameters: 
2022-08-31 17:39:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251474834821120 [0;39m <==    Updates: 0
2022-08-31 17:39:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251474834821120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:39:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251495789563904 [0;39m 生成今日电子书快照开始
2022-08-31 17:39:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251495789563904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:39:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251495789563904 [0;39m ==> Parameters: 
2022-08-31 17:39:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251495789563904 [0;39m <==    Updates: 0
2022-08-31 17:39:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251495789563904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:39:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22251516777861120 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:39:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251516777861120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:39:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251516777861120 [0;39m ==> Parameters: 
2022-08-31 17:39:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251516777861120 [0;39m <==    Updates: 8
2022-08-31 17:39:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22251516777861120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:39:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251516786249728 [0;39m 生成今日电子书快照开始
2022-08-31 17:39:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251516786249728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:39:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251516786249728 [0;39m ==> Parameters: 
2022-08-31 17:39:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251516786249728 [0;39m <==    Updates: 0
2022-08-31 17:39:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251516786249728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:39:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251537728409600 [0;39m 生成今日电子书快照开始
2022-08-31 17:39:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251537728409600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:39:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251537728409600 [0;39m ==> Parameters: 
2022-08-31 17:39:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251537728409600 [0;39m <==    Updates: 0
2022-08-31 17:39:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251537728409600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:39:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251558670569472 [0;39m 生成今日电子书快照开始
2022-08-31 17:39:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251558670569472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:39:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251558670569472 [0;39m ==> Parameters: 
2022-08-31 17:39:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251558670569472 [0;39m <==    Updates: 0
2022-08-31 17:39:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251558670569472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:39:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251579667255296 [0;39m 生成今日电子书快照开始
2022-08-31 17:39:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251579667255296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:39:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251579667255296 [0;39m ==> Parameters: 
2022-08-31 17:39:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251579667255296 [0;39m <==    Updates: 0
2022-08-31 17:39:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251579667255296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:39:55.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251600609415168 [0;39m 生成今日电子书快照开始
2022-08-31 17:39:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251600609415168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:39:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251600609415168 [0;39m ==> Parameters: 
2022-08-31 17:39:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251600609415168 [0;39m <==    Updates: 0
2022-08-31 17:39:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251600609415168 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-31 17:40:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251621635461120 [0;39m 生成今日电子书快照开始
2022-08-31 17:40:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251621635461120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:40:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251621635461120 [0;39m ==> Parameters: 
2022-08-31 17:40:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251621635461120 [0;39m <==    Updates: 0
2022-08-31 17:40:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251621635461120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:40:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22251642590203904 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:40:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251642590203904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:40:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251642590203904 [0;39m ==> Parameters: 
2022-08-31 17:40:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251642590203904 [0;39m <==    Updates: 8
2022-08-31 17:40:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22251642590203904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:40:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251642598592512 [0;39m 生成今日电子书快照开始
2022-08-31 17:40:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251642598592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:40:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251642598592512 [0;39m ==> Parameters: 
2022-08-31 17:40:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251642598592512 [0;39m <==    Updates: 0
2022-08-31 17:40:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251642598592512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 17:40:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251663532363776 [0;39m 生成今日电子书快照开始
2022-08-31 17:40:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251663532363776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:40:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251663532363776 [0;39m ==> Parameters: 
2022-08-31 17:40:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251663532363776 [0;39m <==    Updates: 0
2022-08-31 17:40:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251663532363776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:40:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251684541632512 [0;39m 生成今日电子书快照开始
2022-08-31 17:40:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251684541632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:40:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251684541632512 [0;39m ==> Parameters: 
2022-08-31 17:40:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251684541632512 [0;39m <==    Updates: 0
2022-08-31 17:40:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251684541632512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:40:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251705529929728 [0;39m 生成今日电子书快照开始
2022-08-31 17:40:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251705529929728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:40:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251705529929728 [0;39m ==> Parameters: 
2022-08-31 17:40:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251705529929728 [0;39m <==    Updates: 0
2022-08-31 17:40:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251705529929728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:40:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251726493061120 [0;39m 生成今日电子书快照开始
2022-08-31 17:40:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251726493061120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:40:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251726493061120 [0;39m ==> Parameters: 
2022-08-31 17:40:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251726493061120 [0;39m <==    Updates: 0
2022-08-31 17:40:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251726493061120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:40:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251747464581120 [0;39m 生成今日电子书快照开始
2022-08-31 17:40:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251747464581120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:40:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251747464581120 [0;39m ==> Parameters: 
2022-08-31 17:40:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251747464581120 [0;39m <==    Updates: 0
2022-08-31 17:40:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251747464581120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:40:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251768436101120 [0;39m 生成今日电子书快照开始
2022-08-31 17:40:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251768436101120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:40:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251768436101120 [0;39m ==> Parameters: 
2022-08-31 17:40:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251768436101120 [0;39m <==    Updates: 0
2022-08-31 17:40:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251768436101120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:40:35.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22251768444489728 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:40:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251768444489728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:40:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251768444489728 [0;39m ==> Parameters: 
2022-08-31 17:40:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251768444489728 [0;39m <==    Updates: 8
2022-08-31 17:40:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22251768444489728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:40:37.261 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22249321034551296 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:40:37.261 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m22249321034551296 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-31 17:40:37.261 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m22249321034551296 [0;39m 登录校验开始，token：22249199726891008
2022-08-31 17:40:37.296 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m22249321034551296 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"}
2022-08-31 17:40:37.297 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22251778015891456 [0;39m ------------- 开始 -------------
2022-08-31 17:40:37.297 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22251778015891456 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-31 17:40:37.297 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22251778015891456 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-31 17:40:37.297 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22251778015891456 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:40:37.297 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22251778015891456 [0;39m 请求参数: [{"content":"<blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id=\"ys69d\"><br></h2><h2 id=\"ys69d\">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技\n</font></p><p><font size=\"3\">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函\n</font></p><p><font size=\"3\">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">2.&nbsp; RPC特点？</font><br></p><p><font size=\"3\">1. 简单：使用简单，建立分布式应用更容易。\n</font></p><p><font size=\"3\">2. 高效：调用过程看起来十分清晰，效率高。\n</font></p><p><font size=\"3\">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><hr><p><font size=\"5\">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size=\"3\">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp;<font color=\"#c24f4a\"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color=\"#000000\" size=\"5\">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp;<font size=\"4\"> </font><font size=\"3\">Spring Cloud 是一个很好的生态来解决上面的问题！！</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; <b>&nbsp; 1. spring Cloud NetFlix&nbsp; </b>&nbsp;一站式解决方案！</font></p><p><font size=\"3\"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper</b></font></p><p><font size=\"3\"><b>&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b>Spring Cloud Alibaba&nbsp;</b></font><font size=\"5\"></font></p>","ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}]
2022-08-31 17:40:37.298 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22251778015891456 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-31 17:40:37.299 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22251778015891456 [0;39m ==> Parameters: 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 1(Integer), 0(Integer), 20420961950109696(Long)
2022-08-31 17:40:37.299 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22251778015891456 [0;39m <==    Updates: 1
2022-08-31 17:40:37.300 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22251778015891456 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-31 17:40:37.300 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22251778015891456 [0;39m ==> Parameters: <blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id="ys69d"><br></h2><h2 id="ys69d">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size="4" style="background-color: rgb(139, 170, 74);">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技
</font></p><p><font size="3">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函
</font></p><p><font size="3">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size="4" style="background-color: rgb(139, 170, 74);">2.&nbsp; RPC特点？</font><br></p><p><font size="3">1. 简单：使用简单，建立分布式应用更容易。
</font></p><p><font size="3">2. 高效：调用过程看起来十分清晰，效率高。
</font></p><p><font size="3">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p><hr><p><font size="5">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size="3">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size="3">&nbsp; &nbsp; &nbsp;<font color="#c24f4a"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color="#000000" size="5">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp;<font size="4"> </font><font size="3">Spring Cloud 是一个很好的生态来解决上面的问题！！</font></p><p><font size="3">&nbsp; &nbsp; &nbsp; <b>&nbsp; 1. spring Cloud NetFlix&nbsp; </b>&nbsp;一站式解决方案！</font></p><p><font size="3"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper</b></font></p><p><font size="3"><b>&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b>Spring Cloud Alibaba&nbsp;</b></font><font size="5"></font></p>(String), 20420961950109696(Long)
2022-08-31 17:40:37.309 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22251778015891456 [0;39m <==    Updates: 1
2022-08-31 17:40:37.355 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22251778015891456 [0;39m 返回结果: {"success":true}
2022-08-31 17:40:37.355 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22251778015891456 [0;39m ------------- 结束 耗时：58 ms -------------
2022-08-31 17:40:37.356 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22251778015891456 [0;39m ------------- LoginInterceptor 结束 耗时：95 ms -------------
2022-08-31 17:40:37.364 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22251778296909824 [0;39m ------------- 开始 -------------
2022-08-31 17:40:37.364 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22251778296909824 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:40:37.364 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22251778296909824 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:40:37.364 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22251778296909824 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:40:37.365 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22251778296909824 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:40:37.365 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22251778296909824 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:40:37.365 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22251778296909824 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:40:37.366 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22251778296909824 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:40:37.366 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22251778296909824 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 17:40:37.367 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22251778296909824 [0;39m <==      Total: 1
2022-08-31 17:40:37.367 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22251778296909824 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 17:40:37.367 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22251778296909824 [0;39m ------------- 结束 耗时：3 ms -------------
2022-08-31 17:40:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251789399232512 [0;39m 生成今日电子书快照开始
2022-08-31 17:40:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251789399232512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:40:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251789399232512 [0;39m ==> Parameters: 
2022-08-31 17:40:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251789399232512 [0;39m <==    Updates: 0
2022-08-31 17:40:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251789399232512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:40:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251810345586688 [0;39m 生成今日电子书快照开始
2022-08-31 17:40:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251810345586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:40:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251810345586688 [0;39m ==> Parameters: 
2022-08-31 17:40:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251810345586688 [0;39m <==    Updates: 0
2022-08-31 17:40:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251810345586688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:40:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251831342272512 [0;39m 生成今日电子书快照开始
2022-08-31 17:40:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251831342272512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:40:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251831342272512 [0;39m ==> Parameters: 
2022-08-31 17:40:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251831342272512 [0;39m <==    Updates: 0
2022-08-31 17:40:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251831342272512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:40:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251852326375424 [0;39m 生成今日电子书快照开始
2022-08-31 17:40:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251852326375424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:40:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251852326375424 [0;39m ==> Parameters: 
2022-08-31 17:40:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251852326375424 [0;39m <==    Updates: 0
2022-08-31 17:40:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251852326375424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:41:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251873281118208 [0;39m 生成今日电子书快照开始
2022-08-31 17:41:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251873281118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:41:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251873281118208 [0;39m ==> Parameters: 
2022-08-31 17:41:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251873281118208 [0;39m <==    Updates: 0
2022-08-31 17:41:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251873281118208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:41:05.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251894210695168 [0;39m 生成今日电子书快照开始
2022-08-31 17:41:05.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251894210695168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:41:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251894210695168 [0;39m ==> Parameters: 
2022-08-31 17:41:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251894210695168 [0;39m <==    Updates: 0
2022-08-31 17:41:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251894210695168 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:41:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22251894231666688 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:41:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251894231666688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:41:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251894231666688 [0;39m ==> Parameters: 
2022-08-31 17:41:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22251894231666688 [0;39m <==    Updates: 8
2022-08-31 17:41:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22251894231666688 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:41:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251915253518336 [0;39m 生成今日电子书快照开始
2022-08-31 17:41:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251915253518336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:41:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251915253518336 [0;39m ==> Parameters: 
2022-08-31 17:41:10.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251915253518336 [0;39m <==    Updates: 0
2022-08-31 17:41:10.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251915253518336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:41:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251936216649728 [0;39m 生成今日电子书快照开始
2022-08-31 17:41:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251936216649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:41:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251936216649728 [0;39m ==> Parameters: 
2022-08-31 17:41:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251936216649728 [0;39m <==    Updates: 0
2022-08-31 17:41:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251936216649728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:41:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251957158809600 [0;39m 生成今日电子书快照开始
2022-08-31 17:41:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251957158809600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:41:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251957158809600 [0;39m ==> Parameters: 
2022-08-31 17:41:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251957158809600 [0;39m <==    Updates: 0
2022-08-31 17:41:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251957158809600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:41:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251978130329600 [0;39m 生成今日电子书快照开始
2022-08-31 17:41:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251978130329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:41:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251978130329600 [0;39m ==> Parameters: 
2022-08-31 17:41:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251978130329600 [0;39m <==    Updates: 0
2022-08-31 17:41:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251978130329600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:41:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22251999110238208 [0;39m 生成今日电子书快照开始
2022-08-31 17:41:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251999110238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:41:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251999110238208 [0;39m ==> Parameters: 
2022-08-31 17:41:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22251999110238208 [0;39m <==    Updates: 0
2022-08-31 17:41:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22251999110238208 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:41:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252020090146816 [0;39m 生成今日电子书快照开始
2022-08-31 17:41:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252020090146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:41:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252020090146816 [0;39m ==> Parameters: 
2022-08-31 17:41:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252020090146816 [0;39m <==    Updates: 0
2022-08-31 17:41:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252020090146816 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:41:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22252020115312640 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:41:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252020115312640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:41:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252020115312640 [0;39m ==> Parameters: 
2022-08-31 17:41:35.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252020115312640 [0;39m <==    Updates: 8
2022-08-31 17:41:35.022 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22252020115312640 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-31 17:41:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252041044889600 [0;39m 生成今日电子书快照开始
2022-08-31 17:41:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252041044889600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:41:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252041044889600 [0;39m ==> Parameters: 
2022-08-31 17:41:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252041044889600 [0;39m <==    Updates: 0
2022-08-31 17:41:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252041044889600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:41:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252062003826688 [0;39m 生成今日电子书快照开始
2022-08-31 17:41:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252062003826688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:41:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252062003826688 [0;39m ==> Parameters: 
2022-08-31 17:41:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252062003826688 [0;39m <==    Updates: 0
2022-08-31 17:41:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252062003826688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:41:49.975 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22249338604490752 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:41:49.975 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m22249338604490752 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-31 17:41:49.975 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m22249338604490752 [0;39m 登录校验开始，token：22249199726891008
2022-08-31 17:41:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252082966958080 [0;39m 生成今日电子书快照开始
2022-08-31 17:41:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252082966958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:41:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252082966958080 [0;39m ==> Parameters: 
2022-08-31 17:41:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252082966958080 [0;39m <==    Updates: 0
2022-08-31 17:41:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252082966958080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:41:50.008 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m22249338604490752 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"}
2022-08-31 17:41:50.009 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22252082992123904 [0;39m ------------- 开始 -------------
2022-08-31 17:41:50.009 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22252082992123904 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-31 17:41:50.009 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22252082992123904 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-31 17:41:50.010 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22252082992123904 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:41:50.010 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22252082992123904 [0;39m 请求参数: [{"content":"<blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id=\"ys69d\"><br></h2><h2 id=\"ys69d\">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技\n</font></p><p><font size=\"3\">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函\n</font></p><p><font size=\"3\">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">2.&nbsp; RPC特点？</font><br></p><p><font size=\"3\">1. 简单：使用简单，建立分布式应用更容易。\n</font></p><p><font size=\"3\">2. 高效：调用过程看起来十分清晰，效率高。\n</font></p><p><font size=\"3\">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><hr><p><font size=\"5\">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size=\"3\">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp;<font color=\"#c24f4a\"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color=\"#000000\" size=\"5\">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp;<font size=\"4\"> </font><font size=\"3\">Spring Cloud 是一个很好的生态来解决上面的问题！！</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; <b>&nbsp; 1. spring Cloud NetFlix&nbsp; </b>&nbsp;一站式解决方案！</font></p><p><font size=\"3\"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p><font size=\"3\"><b>&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b>Spring Cloud Alibaba&nbsp;&nbsp;</b><b style=\"color: rgb(194, 79, 74);\">new&nbsp; &nbsp;</b><font color=\"#000000\">一站式解决方案</font></font><font size=\"5\"></font></p>","ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}]
2022-08-31 17:41:50.011 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22252082992123904 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-31 17:41:50.012 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22252082992123904 [0;39m ==> Parameters: 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 1(Integer), 0(Integer), 20420961950109696(Long)
2022-08-31 17:41:50.013 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22252082992123904 [0;39m <==    Updates: 1
2022-08-31 17:41:50.013 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22252082992123904 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-31 17:41:50.014 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22252082992123904 [0;39m ==> Parameters: <blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id="ys69d"><br></h2><h2 id="ys69d">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size="4" style="background-color: rgb(139, 170, 74);">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技
</font></p><p><font size="3">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函
</font></p><p><font size="3">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size="4" style="background-color: rgb(139, 170, 74);">2.&nbsp; RPC特点？</font><br></p><p><font size="3">1. 简单：使用简单，建立分布式应用更容易。
</font></p><p><font size="3">2. 高效：调用过程看起来十分清晰，效率高。
</font></p><p><font size="3">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p><hr><p><font size="5">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size="3">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size="3">&nbsp; &nbsp; &nbsp;<font color="#c24f4a"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color="#000000" size="5">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp;<font size="4"> </font><font size="3">Spring Cloud 是一个很好的生态来解决上面的问题！！</font></p><p><font size="3">&nbsp; &nbsp; &nbsp; <b>&nbsp; 1. spring Cloud NetFlix&nbsp; </b>&nbsp;一站式解决方案！</font></p><p><font size="3"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p><font size="3"><b>&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b>Spring Cloud Alibaba&nbsp;&nbsp;</b><b style="color: rgb(194, 79, 74);">new&nbsp; &nbsp;</b><font color="#000000">一站式解决方案</font></font><font size="5"></font></p>(String), 20420961950109696(Long)
2022-08-31 17:41:50.019 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22252082992123904 [0;39m <==    Updates: 1
2022-08-31 17:41:50.071 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22252082992123904 [0;39m 返回结果: {"success":true}
2022-08-31 17:41:50.072 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22252082992123904 [0;39m ------------- 结束 耗时：63 ms -------------
2022-08-31 17:41:50.072 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22252082992123904 [0;39m ------------- LoginInterceptor 结束 耗时：97 ms -------------
2022-08-31 17:41:50.079 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22252083285725184 [0;39m ------------- 开始 -------------
2022-08-31 17:41:50.079 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22252083285725184 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:41:50.079 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22252083285725184 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:41:50.080 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22252083285725184 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:41:50.080 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22252083285725184 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:41:50.081 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22252083285725184 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:41:50.081 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22252083285725184 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:41:50.082 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22252083285725184 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:41:50.082 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22252083285725184 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 17:41:50.083 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22252083285725184 [0;39m <==      Total: 1
2022-08-31 17:41:50.083 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22252083285725184 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 17:41:50.083 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22252083285725184 [0;39m ------------- 结束 耗时：4 ms -------------
2022-08-31 17:41:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252103967838208 [0;39m 生成今日电子书快照开始
2022-08-31 17:41:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252103967838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:41:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252103967838208 [0;39m ==> Parameters: 
2022-08-31 17:41:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252103967838208 [0;39m <==    Updates: 0
2022-08-31 17:41:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252103967838208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:42:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252124956135424 [0;39m 生成今日电子书快照开始
2022-08-31 17:42:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252124956135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:42:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252124956135424 [0;39m ==> Parameters: 
2022-08-31 17:42:00.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252124956135424 [0;39m <==    Updates: 0
2022-08-31 17:42:00.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252124956135424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-31 17:42:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252145919266816 [0;39m 生成今日电子书快照开始
2022-08-31 17:42:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252145919266816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:42:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252145919266816 [0;39m ==> Parameters: 
2022-08-31 17:42:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252145919266816 [0;39m <==    Updates: 0
2022-08-31 17:42:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252145919266816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:42:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22252145927655424 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:42:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252145927655424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:42:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252145927655424 [0;39m ==> Parameters: 
2022-08-31 17:42:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252145927655424 [0;39m <==    Updates: 8
2022-08-31 17:42:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22252145927655424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:42:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252166848843776 [0;39m 生成今日电子书快照开始
2022-08-31 17:42:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252166848843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:42:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252166848843776 [0;39m ==> Parameters: 
2022-08-31 17:42:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252166848843776 [0;39m <==    Updates: 0
2022-08-31 17:42:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252166848843776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:42:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252187874889728 [0;39m 生成今日电子书快照开始
2022-08-31 17:42:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252187874889728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:42:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252187874889728 [0;39m ==> Parameters: 
2022-08-31 17:42:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252187874889728 [0;39m <==    Updates: 0
2022-08-31 17:42:15.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252187874889728 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:42:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252208791883776 [0;39m 生成今日电子书快照开始
2022-08-31 17:42:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252208791883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:42:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252208791883776 [0;39m ==> Parameters: 
2022-08-31 17:42:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252208791883776 [0;39m <==    Updates: 0
2022-08-31 17:42:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252208791883776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:42:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252229792763904 [0;39m 生成今日电子书快照开始
2022-08-31 17:42:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252229792763904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:42:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252229792763904 [0;39m ==> Parameters: 
2022-08-31 17:42:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252229792763904 [0;39m <==    Updates: 0
2022-08-31 17:42:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252229792763904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:42:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252250772672512 [0;39m 生成今日电子书快照开始
2022-08-31 17:42:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252250772672512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:42:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252250772672512 [0;39m ==> Parameters: 
2022-08-31 17:42:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252250772672512 [0;39m <==    Updates: 0
2022-08-31 17:42:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252250772672512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:42:35.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22252271760969728 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:42:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252271760969728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:42:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252271760969728 [0;39m ==> Parameters: 
2022-08-31 17:42:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252271760969728 [0;39m <==    Updates: 8
2022-08-31 17:42:35.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22252271760969728 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-31 17:42:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252271773552640 [0;39m 生成今日电子书快照开始
2022-08-31 17:42:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252271773552640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:42:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252271773552640 [0;39m ==> Parameters: 
2022-08-31 17:42:35.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252271773552640 [0;39m <==    Updates: 0
2022-08-31 17:42:35.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252271773552640 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:42:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252292707323904 [0;39m 生成今日电子书快照开始
2022-08-31 17:42:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252292707323904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:42:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252292707323904 [0;39m ==> Parameters: 
2022-08-31 17:42:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252292707323904 [0;39m <==    Updates: 0
2022-08-31 17:42:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252292707323904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:42:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252313662066688 [0;39m 生成今日电子书快照开始
2022-08-31 17:42:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252313662066688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:42:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252313662066688 [0;39m ==> Parameters: 
2022-08-31 17:42:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252313662066688 [0;39m <==    Updates: 0
2022-08-31 17:42:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252313662066688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:42:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252334629392384 [0;39m 生成今日电子书快照开始
2022-08-31 17:42:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252334629392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:42:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252334629392384 [0;39m ==> Parameters: 
2022-08-31 17:42:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252334629392384 [0;39m <==    Updates: 0
2022-08-31 17:42:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252334629392384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:42:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252355651244032 [0;39m 生成今日电子书快照开始
2022-08-31 17:42:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252355651244032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:42:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252355651244032 [0;39m ==> Parameters: 
2022-08-31 17:42:55.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252355651244032 [0;39m <==    Updates: 0
2022-08-31 17:42:55.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252355651244032 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:43:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252376601792512 [0;39m 生成今日电子书快照开始
2022-08-31 17:43:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252376601792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:43:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252376601792512 [0;39m ==> Parameters: 
2022-08-31 17:43:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252376601792512 [0;39m <==    Updates: 0
2022-08-31 17:43:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252376601792512 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-31 17:43:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252397581701120 [0;39m 生成今日电子书快照开始
2022-08-31 17:43:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252397581701120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:43:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252397581701120 [0;39m ==> Parameters: 
2022-08-31 17:43:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252397581701120 [0;39m <==    Updates: 0
2022-08-31 17:43:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252397581701120 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:43:05.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22252397602672640 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:43:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252397602672640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:43:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252397602672640 [0;39m ==> Parameters: 
2022-08-31 17:43:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252397602672640 [0;39m <==    Updates: 8
2022-08-31 17:43:05.021 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22252397602672640 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-31 17:43:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252418515472384 [0;39m 生成今日电子书快照开始
2022-08-31 17:43:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252418515472384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:43:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252418515472384 [0;39m ==> Parameters: 
2022-08-31 17:43:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252418515472384 [0;39m <==    Updates: 0
2022-08-31 17:43:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252418515472384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:43:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252439499575296 [0;39m 生成今日电子书快照开始
2022-08-31 17:43:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252439499575296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:43:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252439499575296 [0;39m ==> Parameters: 
2022-08-31 17:43:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252439499575296 [0;39m <==    Updates: 0
2022-08-31 17:43:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252439499575296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:43:18.553 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22249841614786560 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:43:18.553 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m22249841614786560 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-31 17:43:18.553 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m22249841614786560 [0;39m 登录校验开始，token：22249199726891008
2022-08-31 17:43:18.587 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m22249841614786560 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"}
2022-08-31 17:43:18.589 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22252454523572224 [0;39m ------------- 开始 -------------
2022-08-31 17:43:18.589 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22252454523572224 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-31 17:43:18.590 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22252454523572224 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-31 17:43:18.590 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22252454523572224 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:43:18.590 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22252454523572224 [0;39m 请求参数: [{"content":"<blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id=\"ys69d\"><br></h2><h2 id=\"ys69d\">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技\n</font></p><p><font size=\"3\">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函\n</font></p><p><font size=\"3\">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">2.&nbsp; RPC特点？</font><br></p><p><font size=\"3\">1. 简单：使用简单，建立分布式应用更容易。\n</font></p><p><font size=\"3\">2. 高效：调用过程看起来十分清晰，效率高。\n</font></p><p><font size=\"3\">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><hr><p><font size=\"5\">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size=\"3\">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp;<font color=\"#c24f4a\"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color=\"#000000\" size=\"5\">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp;<font size=\"4\"> <i style=\"background-color: rgb(139, 170, 74);\">&nbsp; Spring Cloud 是一个很好的生态来解决上面的问题！！</i></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; </font><b style=\"\"><font size=\"3\">&nbsp;</font><font size=\"4\"> 1. spring Cloud NetFlix&nbsp; </font></b><font size=\"4\">&nbsp;一站式解决方案！</font></p><p><font size=\"4\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font><font size=\"3\"> api网关，zuul组件</font><br></p><p><font size=\"4\"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p><font size=\"4\"><b style=\"\">&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b style=\"\">Spring Cloud Alibaba&nbsp;&nbsp;</b><b style=\"color: rgb(194, 79, 74);\">new&nbsp; &nbsp;</b><font color=\"#000000\" style=\"\">一站式解决方案</font></font><font size=\"5\"></font></p>","ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}]
2022-08-31 17:43:18.591 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22252454523572224 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-31 17:43:18.592 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22252454523572224 [0;39m ==> Parameters: 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 1(Integer), 0(Integer), 20420961950109696(Long)
2022-08-31 17:43:18.592 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22252454523572224 [0;39m <==    Updates: 1
2022-08-31 17:43:18.593 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22252454523572224 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-31 17:43:18.593 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22252454523572224 [0;39m ==> Parameters: <blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id="ys69d"><br></h2><h2 id="ys69d">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size="4" style="background-color: rgb(139, 170, 74);">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技
</font></p><p><font size="3">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函
</font></p><p><font size="3">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size="4" style="background-color: rgb(139, 170, 74);">2.&nbsp; RPC特点？</font><br></p><p><font size="3">1. 简单：使用简单，建立分布式应用更容易。
</font></p><p><font size="3">2. 高效：调用过程看起来十分清晰，效率高。
</font></p><p><font size="3">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p><hr><p><font size="5">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size="3">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size="3">&nbsp; &nbsp; &nbsp;<font color="#c24f4a"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color="#000000" size="5">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp;<font size="4"> <i style="background-color: rgb(139, 170, 74);">&nbsp; Spring Cloud 是一个很好的生态来解决上面的问题！！</i></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; </font><b style=""><font size="3">&nbsp;</font><font size="4"> 1. spring Cloud NetFlix&nbsp; </font></b><font size="4">&nbsp;一站式解决方案！</font></p><p><font size="4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font><font size="3"> api网关，zuul组件</font><br></p><p><font size="4"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p><font size="4"><b style="">&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b style="">Spring Cloud Alibaba&nbsp;&nbsp;</b><b style="color: rgb(194, 79, 74);">new&nbsp; &nbsp;</b><font color="#000000" style="">一站式解决方案</font></font><font size="5"></font></p>(String), 20420961950109696(Long)
2022-08-31 17:43:18.594 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22252454523572224 [0;39m <==    Updates: 1
2022-08-31 17:43:18.607 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22252454523572224 [0;39m 返回结果: {"success":true}
2022-08-31 17:43:18.608 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22252454523572224 [0;39m ------------- 结束 耗时：19 ms -------------
2022-08-31 17:43:18.608 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22252454523572224 [0;39m ------------- LoginInterceptor 结束 耗时：55 ms -------------
2022-08-31 17:43:18.614 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22252454628429824 [0;39m ------------- 开始 -------------
2022-08-31 17:43:18.614 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22252454628429824 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:43:18.614 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22252454628429824 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:43:18.614 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22252454628429824 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:43:18.615 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22252454628429824 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:43:18.615 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22252454628429824 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:43:18.616 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22252454628429824 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:43:18.616 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22252454628429824 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:43:18.616 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22252454628429824 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 17:43:18.617 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22252454628429824 [0;39m <==      Total: 1
2022-08-31 17:43:18.617 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22252454628429824 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 17:43:18.618 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22252454628429824 [0;39m ------------- 结束 耗时：4 ms -------------
2022-08-31 17:43:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252460462706688 [0;39m 生成今日电子书快照开始
2022-08-31 17:43:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252460462706688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:43:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252460462706688 [0;39m ==> Parameters: 
2022-08-31 17:43:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252460462706688 [0;39m <==    Updates: 0
2022-08-31 17:43:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252460462706688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:43:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252481471975424 [0;39m 生成今日电子书快照开始
2022-08-31 17:43:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252481471975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:43:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252481471975424 [0;39m ==> Parameters: 
2022-08-31 17:43:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252481471975424 [0;39m <==    Updates: 0
2022-08-31 17:43:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252481471975424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:43:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252502405746688 [0;39m 生成今日电子书快照开始
2022-08-31 17:43:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252502405746688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:43:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252502405746688 [0;39m ==> Parameters: 
2022-08-31 17:43:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252502405746688 [0;39m <==    Updates: 0
2022-08-31 17:43:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252502405746688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:43:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22252523377266688 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:43:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252523377266688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:43:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252523377266688 [0;39m ==> Parameters: 
2022-08-31 17:43:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252523377266688 [0;39m <==    Updates: 8
2022-08-31 17:43:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22252523377266688 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-31 17:43:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252523389849600 [0;39m 生成今日电子书快照开始
2022-08-31 17:43:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252523389849600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:43:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252523389849600 [0;39m ==> Parameters: 
2022-08-31 17:43:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252523389849600 [0;39m <==    Updates: 0
2022-08-31 17:43:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252523389849600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:43:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252544369758208 [0;39m 生成今日电子书快照开始
2022-08-31 17:43:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252544369758208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:43:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252544369758208 [0;39m ==> Parameters: 
2022-08-31 17:43:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252544369758208 [0;39m <==    Updates: 0
2022-08-31 17:43:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252544369758208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:43:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252565353861120 [0;39m 生成今日电子书快照开始
2022-08-31 17:43:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252565353861120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:43:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252565353861120 [0;39m ==> Parameters: 
2022-08-31 17:43:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252565353861120 [0;39m <==    Updates: 0
2022-08-31 17:43:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252565353861120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:43:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252586283438080 [0;39m 生成今日电子书快照开始
2022-08-31 17:43:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252586283438080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:43:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252586283438080 [0;39m ==> Parameters: 
2022-08-31 17:43:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252586283438080 [0;39m <==    Updates: 0
2022-08-31 17:43:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252586283438080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:43:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252607259152384 [0;39m 生成今日电子书快照开始
2022-08-31 17:43:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252607259152384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:43:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252607259152384 [0;39m ==> Parameters: 
2022-08-31 17:43:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252607259152384 [0;39m <==    Updates: 0
2022-08-31 17:43:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252607259152384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:44:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252628264226816 [0;39m 生成今日电子书快照开始
2022-08-31 17:44:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252628264226816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:44:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252628264226816 [0;39m ==> Parameters: 
2022-08-31 17:44:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252628264226816 [0;39m <==    Updates: 0
2022-08-31 17:44:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252628264226816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:44:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22252649231552512 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:44:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252649231552512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:44:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252649231552512 [0;39m ==> Parameters: 
2022-08-31 17:44:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252649231552512 [0;39m <==    Updates: 8
2022-08-31 17:44:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22252649231552512 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-31 17:44:05.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252649265106944 [0;39m 生成今日电子书快照开始
2022-08-31 17:44:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252649265106944 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:44:05.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252649265106944 [0;39m ==> Parameters: 
2022-08-31 17:44:05.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252649265106944 [0;39m <==    Updates: 0
2022-08-31 17:44:05.025 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252649265106944 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-31 17:44:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252670169518080 [0;39m 生成今日电子书快照开始
2022-08-31 17:44:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252670169518080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:44:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252670169518080 [0;39m ==> Parameters: 
2022-08-31 17:44:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252670169518080 [0;39m <==    Updates: 0
2022-08-31 17:44:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252670169518080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:44:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252691149426688 [0;39m 生成今日电子书快照开始
2022-08-31 17:44:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252691149426688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:44:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252691149426688 [0;39m ==> Parameters: 
2022-08-31 17:44:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252691149426688 [0;39m <==    Updates: 0
2022-08-31 17:44:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252691149426688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:44:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252712141918208 [0;39m 生成今日电子书快照开始
2022-08-31 17:44:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252712141918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:44:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252712141918208 [0;39m ==> Parameters: 
2022-08-31 17:44:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252712141918208 [0;39m <==    Updates: 0
2022-08-31 17:44:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252712141918208 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-31 17:44:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252733092466688 [0;39m 生成今日电子书快照开始
2022-08-31 17:44:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252733092466688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:44:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252733092466688 [0;39m ==> Parameters: 
2022-08-31 17:44:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252733092466688 [0;39m <==    Updates: 0
2022-08-31 17:44:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252733092466688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:44:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252754080763904 [0;39m 生成今日电子书快照开始
2022-08-31 17:44:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252754080763904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:44:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252754080763904 [0;39m ==> Parameters: 
2022-08-31 17:44:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252754080763904 [0;39m <==    Updates: 0
2022-08-31 17:44:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252754080763904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:44:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252775064866816 [0;39m 生成今日电子书快照开始
2022-08-31 17:44:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252775064866816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:44:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252775064866816 [0;39m ==> Parameters: 
2022-08-31 17:44:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252775064866816 [0;39m <==    Updates: 0
2022-08-31 17:44:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252775064866816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:44:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22252775073255424 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:44:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252775073255424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:44:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252775073255424 [0;39m ==> Parameters: 
2022-08-31 17:44:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252775073255424 [0;39m <==    Updates: 8
2022-08-31 17:44:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22252775073255424 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:44:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252796040581120 [0;39m 生成今日电子书快照开始
2022-08-31 17:44:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252796040581120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:44:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252796040581120 [0;39m ==> Parameters: 
2022-08-31 17:44:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252796040581120 [0;39m <==    Updates: 0
2022-08-31 17:44:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252796040581120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:44:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252817003712512 [0;39m 生成今日电子书快照开始
2022-08-31 17:44:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252817003712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:44:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252817003712512 [0;39m ==> Parameters: 
2022-08-31 17:44:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252817003712512 [0;39m <==    Updates: 0
2022-08-31 17:44:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252817003712512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:44:50.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252837933289472 [0;39m 生成今日电子书快照开始
2022-08-31 17:44:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252837933289472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:44:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252837933289472 [0;39m ==> Parameters: 
2022-08-31 17:44:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252837933289472 [0;39m <==    Updates: 0
2022-08-31 17:44:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252837933289472 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:44:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252858967724032 [0;39m 生成今日电子书快照开始
2022-08-31 17:44:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252858967724032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:44:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252858967724032 [0;39m ==> Parameters: 
2022-08-31 17:44:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252858967724032 [0;39m <==    Updates: 0
2022-08-31 17:44:55.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252858967724032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:45:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252879909883904 [0;39m 生成今日电子书快照开始
2022-08-31 17:45:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252879909883904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:45:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252879909883904 [0;39m ==> Parameters: 
2022-08-31 17:45:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252879909883904 [0;39m <==    Updates: 0
2022-08-31 17:45:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252879909883904 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-31 17:45:05.000 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22252900843655168 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:45:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252900843655168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:45:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252900843655168 [0;39m ==> Parameters: 
2022-08-31 17:45:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22252900843655168 [0;39m <==    Updates: 8
2022-08-31 17:45:05.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22252900843655168 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:45:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252900856238080 [0;39m 生成今日电子书快照开始
2022-08-31 17:45:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252900856238080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:45:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252900856238080 [0;39m ==> Parameters: 
2022-08-31 17:45:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252900856238080 [0;39m <==    Updates: 0
2022-08-31 17:45:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252900856238080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:45:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252921823563776 [0;39m 生成今日电子书快照开始
2022-08-31 17:45:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252921823563776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:45:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252921823563776 [0;39m ==> Parameters: 
2022-08-31 17:45:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252921823563776 [0;39m <==    Updates: 0
2022-08-31 17:45:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252921823563776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:45:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252942832832512 [0;39m 生成今日电子书快照开始
2022-08-31 17:45:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252942832832512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:45:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252942832832512 [0;39m ==> Parameters: 
2022-08-31 17:45:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252942832832512 [0;39m <==    Updates: 0
2022-08-31 17:45:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252942832832512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:45:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252963762409472 [0;39m 生成今日电子书快照开始
2022-08-31 17:45:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252963762409472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:45:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252963762409472 [0;39m ==> Parameters: 
2022-08-31 17:45:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252963762409472 [0;39m <==    Updates: 0
2022-08-31 17:45:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252963762409472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:45:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22252984767483904 [0;39m 生成今日电子书快照开始
2022-08-31 17:45:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252984767483904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:45:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252984767483904 [0;39m ==> Parameters: 
2022-08-31 17:45:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22252984767483904 [0;39m <==    Updates: 0
2022-08-31 17:45:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22252984767483904 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:45:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253005755781120 [0;39m 生成今日电子书快照开始
2022-08-31 17:45:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253005755781120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:45:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253005755781120 [0;39m ==> Parameters: 
2022-08-31 17:45:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253005755781120 [0;39m <==    Updates: 0
2022-08-31 17:45:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253005755781120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:45:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253026727301120 [0;39m 生成今日电子书快照开始
2022-08-31 17:45:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253026727301120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:45:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253026727301120 [0;39m ==> Parameters: 
2022-08-31 17:45:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253026727301120 [0;39m <==    Updates: 0
2022-08-31 17:45:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253026727301120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:45:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22253026739884032 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:45:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253026739884032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:45:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253026739884032 [0;39m ==> Parameters: 
2022-08-31 17:45:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253026739884032 [0;39m <==    Updates: 8
2022-08-31 17:45:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22253026739884032 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:45:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253047652683776 [0;39m 生成今日电子书快照开始
2022-08-31 17:45:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253047652683776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:45:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253047652683776 [0;39m ==> Parameters: 
2022-08-31 17:45:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253047652683776 [0;39m <==    Updates: 0
2022-08-31 17:45:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253047652683776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:45:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253068628398080 [0;39m 生成今日电子书快照开始
2022-08-31 17:45:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253068628398080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:45:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253068628398080 [0;39m ==> Parameters: 
2022-08-31 17:45:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253068628398080 [0;39m <==    Updates: 0
2022-08-31 17:45:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253068628398080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:45:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253089612500992 [0;39m 生成今日电子书快照开始
2022-08-31 17:45:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253089612500992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:45:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253089612500992 [0;39m ==> Parameters: 
2022-08-31 17:45:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253089612500992 [0;39m <==    Updates: 0
2022-08-31 17:45:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253089612500992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:45:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253110617575424 [0;39m 生成今日电子书快照开始
2022-08-31 17:45:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253110617575424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:45:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253110617575424 [0;39m ==> Parameters: 
2022-08-31 17:45:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253110617575424 [0;39m <==    Updates: 0
2022-08-31 17:45:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253110617575424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:46:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253131568123904 [0;39m 生成今日电子书快照开始
2022-08-31 17:46:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253131568123904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:46:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253131568123904 [0;39m ==> Parameters: 
2022-08-31 17:46:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253131568123904 [0;39m <==    Updates: 0
2022-08-31 17:46:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253131568123904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:46:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22253152539643904 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:46:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253152539643904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:46:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253152539643904 [0;39m ==> Parameters: 
2022-08-31 17:46:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253152539643904 [0;39m <==    Updates: 8
2022-08-31 17:46:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22253152539643904 [0;39m 更新电子书下的文档数据结束，耗时：7 毫秒
2022-08-31 17:46:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253152573198336 [0;39m 生成今日电子书快照开始
2022-08-31 17:46:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253152573198336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:46:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253152573198336 [0;39m ==> Parameters: 
2022-08-31 17:46:05.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253152573198336 [0;39m <==    Updates: 0
2022-08-31 17:46:05.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253152573198336 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:46:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253173523746816 [0;39m 生成今日电子书快照开始
2022-08-31 17:46:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253173523746816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:46:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253173523746816 [0;39m ==> Parameters: 
2022-08-31 17:46:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253173523746816 [0;39m <==    Updates: 0
2022-08-31 17:46:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253173523746816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:46:14.858 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22249876423315456 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:46:14.858 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m22249876423315456 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-31 17:46:14.858 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m22249876423315456 [0;39m 登录校验开始，token：22249199726891008
2022-08-31 17:46:14.891 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m22249876423315456 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"}
2022-08-31 17:46:14.892 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22253193991950336 [0;39m ------------- 开始 -------------
2022-08-31 17:46:14.893 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22253193991950336 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-31 17:46:14.893 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22253193991950336 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-31 17:46:14.893 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22253193991950336 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:46:14.893 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22253193991950336 [0;39m 请求参数: [{"content":"<blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id=\"ys69d\"><br></h2><h2 id=\"ys69d\">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技\n</font></p><p><font size=\"3\">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函\n</font></p><p><font size=\"3\">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">2.&nbsp; RPC特点？</font><br></p><p><font size=\"3\">1. 简单：使用简单，建立分布式应用更容易。\n</font></p><p><font size=\"3\">2. 高效：调用过程看起来十分清晰，效率高。\n</font></p><p><font size=\"3\">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><hr><p><font size=\"5\">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size=\"3\">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp;<font color=\"#c24f4a\"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color=\"#000000\" size=\"5\">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp;<font size=\"4\"> <i style=\"background-color: rgb(139, 170, 74);\">&nbsp; Spring Cloud 是一个很好的生态来解决上面的问题！！</i></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; </font><b style=\"\"><font size=\"3\">&nbsp;</font><font size=\"4\"> 1. spring Cloud NetFlix&nbsp; </font></b><font size=\"4\">&nbsp;一站式解决方案！</font></p><p><font size=\"4\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font face=\"黑体\">&nbsp; &nbsp;</font></font><font face=\"黑体\"><font size=\"3\">api网关，zuul组件</font><br></font></p><p><font face=\"黑体\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Feign通信 ---HttpClinet ---Http通信方式，同步，阻塞<font size=\"3\"><br></font></font></p><p><font face=\"黑体\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Eureka<br></font></p><p><font face=\"黑体\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;熔断机制：Hystrix</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 。。。。<br></p><p><font size=\"4\"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; API:meiy<font size=\"4\"><br></font></p><p><font size=\"4\"><b style=\"\">&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b style=\"\">Spring Cloud Alibaba&nbsp;&nbsp;</b><b style=\"color: rgb(194, 79, 74);\">new&nbsp; &nbsp;</b><font color=\"#000000\" style=\"\">一站式解决方案</font></font><font size=\"5\"></font></p>","ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}]
2022-08-31 17:46:14.894 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22253193991950336 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-31 17:46:14.895 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22253193991950336 [0;39m ==> Parameters: 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 1(Integer), 0(Integer), 20420961950109696(Long)
2022-08-31 17:46:14.896 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22253193991950336 [0;39m <==    Updates: 1
2022-08-31 17:46:14.896 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22253193991950336 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-31 17:46:14.897 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22253193991950336 [0;39m ==> Parameters: <blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id="ys69d"><br></h2><h2 id="ys69d">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size="4" style="background-color: rgb(139, 170, 74);">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技
</font></p><p><font size="3">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函
</font></p><p><font size="3">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size="4" style="background-color: rgb(139, 170, 74);">2.&nbsp; RPC特点？</font><br></p><p><font size="3">1. 简单：使用简单，建立分布式应用更容易。
</font></p><p><font size="3">2. 高效：调用过程看起来十分清晰，效率高。
</font></p><p><font size="3">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p><hr><p><font size="5">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size="3">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size="3">&nbsp; &nbsp; &nbsp;<font color="#c24f4a"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color="#000000" size="5">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp;<font size="4"> <i style="background-color: rgb(139, 170, 74);">&nbsp; Spring Cloud 是一个很好的生态来解决上面的问题！！</i></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; </font><b style=""><font size="3">&nbsp;</font><font size="4"> 1. spring Cloud NetFlix&nbsp; </font></b><font size="4">&nbsp;一站式解决方案！</font></p><p><font size="4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font face="黑体">&nbsp; &nbsp;</font></font><font face="黑体"><font size="3">api网关，zuul组件</font><br></font></p><p><font face="黑体">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Feign通信 ---HttpClinet ---Http通信方式，同步，阻塞<font size="3"><br></font></font></p><p><font face="黑体">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Eureka<br></font></p><p><font face="黑体">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;熔断机制：Hystrix</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 。。。。<br></p><p><font size="4"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; API:meiy<font size="4"><br></font></p><p><font size="4"><b style="">&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b style="">Spring Cloud Alibaba&nbsp;&nbsp;</b><b style="color: rgb(194, 79, 74);">new&nbsp; &nbsp;</b><font color="#000000" style="">一站式解决方案</font></font><font size="5"></font></p>(String), 20420961950109696(Long)
2022-08-31 17:46:14.899 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22253193991950336 [0;39m <==    Updates: 1
2022-08-31 17:46:14.917 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22253193991950336 [0;39m 返回结果: {"success":true}
2022-08-31 17:46:14.917 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22253193991950336 [0;39m ------------- 结束 耗时：25 ms -------------
2022-08-31 17:46:14.918 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22253193991950336 [0;39m ------------- LoginInterceptor 结束 耗时：60 ms -------------
2022-08-31 17:46:14.925 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22253194130362368 [0;39m ------------- 开始 -------------
2022-08-31 17:46:14.925 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22253194130362368 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:46:14.925 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22253194130362368 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:46:14.925 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22253194130362368 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:46:14.925 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22253194130362368 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:46:14.926 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22253194130362368 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:46:14.926 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22253194130362368 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:46:14.927 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22253194130362368 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:46:14.928 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22253194130362368 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 17:46:14.928 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22253194130362368 [0;39m <==      Total: 1
2022-08-31 17:46:14.929 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22253194130362368 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 17:46:14.929 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22253194130362368 [0;39m ------------- 结束 耗时：4 ms -------------
2022-08-31 17:46:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253194453323776 [0;39m 生成今日电子书快照开始
2022-08-31 17:46:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253194453323776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:46:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253194453323776 [0;39m ==> Parameters: 
2022-08-31 17:46:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253194453323776 [0;39m <==    Updates: 0
2022-08-31 17:46:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253194453323776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:46:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253215445815296 [0;39m 生成今日电子书快照开始
2022-08-31 17:46:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253215445815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:46:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253215445815296 [0;39m ==> Parameters: 
2022-08-31 17:46:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253215445815296 [0;39m <==    Updates: 0
2022-08-31 17:46:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253215445815296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:46:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253236455084032 [0;39m 生成今日电子书快照开始
2022-08-31 17:46:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253236455084032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:46:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253236455084032 [0;39m ==> Parameters: 
2022-08-31 17:46:25.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253236455084032 [0;39m <==    Updates: 0
2022-08-31 17:46:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253236455084032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:46:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253257405632512 [0;39m 生成今日电子书快照开始
2022-08-31 17:46:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253257405632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:46:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253257405632512 [0;39m ==> Parameters: 
2022-08-31 17:46:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253257405632512 [0;39m <==    Updates: 0
2022-08-31 17:46:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253257405632512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:46:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253278368763904 [0;39m 生成今日电子书快照开始
2022-08-31 17:46:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253278368763904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:46:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253278368763904 [0;39m ==> Parameters: 
2022-08-31 17:46:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253278368763904 [0;39m <==    Updates: 0
2022-08-31 17:46:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253278368763904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:46:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22253278377152512 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:46:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253278377152512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:46:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253278377152512 [0;39m ==> Parameters: 
2022-08-31 17:46:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253278377152512 [0;39m <==    Updates: 8
2022-08-31 17:46:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22253278377152512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:46:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253299331895296 [0;39m 生成今日电子书快照开始
2022-08-31 17:46:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253299331895296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:46:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253299331895296 [0;39m ==> Parameters: 
2022-08-31 17:46:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253299331895296 [0;39m <==    Updates: 0
2022-08-31 17:46:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253299331895296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:46:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253320282443776 [0;39m 生成今日电子书快照开始
2022-08-31 17:46:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253320282443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:46:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253320282443776 [0;39m ==> Parameters: 
2022-08-31 17:46:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253320282443776 [0;39m <==    Updates: 0
2022-08-31 17:46:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253320282443776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:46:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253341270740992 [0;39m 生成今日电子书快照开始
2022-08-31 17:46:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253341270740992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:46:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253341270740992 [0;39m ==> Parameters: 
2022-08-31 17:46:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253341270740992 [0;39m <==    Updates: 0
2022-08-31 17:46:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253341270740992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:46:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253362229678080 [0;39m 生成今日电子书快照开始
2022-08-31 17:46:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253362229678080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:46:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253362229678080 [0;39m ==> Parameters: 
2022-08-31 17:46:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253362229678080 [0;39m <==    Updates: 0
2022-08-31 17:46:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253362229678080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:47:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253383222169600 [0;39m 生成今日电子书快照开始
2022-08-31 17:47:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253383222169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:47:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253383222169600 [0;39m ==> Parameters: 
2022-08-31 17:47:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253383222169600 [0;39m <==    Updates: 0
2022-08-31 17:47:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253383222169600 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:47:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253404189495296 [0;39m 生成今日电子书快照开始
2022-08-31 17:47:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253404189495296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:47:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253404189495296 [0;39m ==> Parameters: 
2022-08-31 17:47:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253404189495296 [0;39m <==    Updates: 0
2022-08-31 17:47:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253404189495296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:47:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22253404202078208 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:47:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253404202078208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:47:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253404202078208 [0;39m ==> Parameters: 
2022-08-31 17:47:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253404202078208 [0;39m <==    Updates: 8
2022-08-31 17:47:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22253404202078208 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:47:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253425186181120 [0;39m 生成今日电子书快照开始
2022-08-31 17:47:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253425186181120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:47:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253425186181120 [0;39m ==> Parameters: 
2022-08-31 17:47:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253425186181120 [0;39m <==    Updates: 0
2022-08-31 17:47:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253425186181120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:47:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253446161895424 [0;39m 生成今日电子书快照开始
2022-08-31 17:47:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253446161895424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:47:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253446161895424 [0;39m ==> Parameters: 
2022-08-31 17:47:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253446161895424 [0;39m <==    Updates: 0
2022-08-31 17:47:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253446161895424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:47:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253467087278080 [0;39m 生成今日电子书快照开始
2022-08-31 17:47:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253467087278080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:47:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253467087278080 [0;39m ==> Parameters: 
2022-08-31 17:47:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253467087278080 [0;39m <==    Updates: 0
2022-08-31 17:47:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253467087278080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:47:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253488058798080 [0;39m 生成今日电子书快照开始
2022-08-31 17:47:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253488058798080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:47:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253488058798080 [0;39m ==> Parameters: 
2022-08-31 17:47:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253488058798080 [0;39m <==    Updates: 0
2022-08-31 17:47:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253488058798080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:47:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253509068066816 [0;39m 生成今日电子书快照开始
2022-08-31 17:47:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253509068066816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:47:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253509068066816 [0;39m ==> Parameters: 
2022-08-31 17:47:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253509068066816 [0;39m <==    Updates: 0
2022-08-31 17:47:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253509068066816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:47:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22253530035392512 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:47:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253530035392512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:47:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253530035392512 [0;39m ==> Parameters: 
2022-08-31 17:47:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253530035392512 [0;39m <==    Updates: 8
2022-08-31 17:47:35.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22253530035392512 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-31 17:47:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253530068946944 [0;39m 生成今日电子书快照开始
2022-08-31 17:47:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253530068946944 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:47:35.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253530068946944 [0;39m ==> Parameters: 
2022-08-31 17:47:35.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253530068946944 [0;39m <==    Updates: 0
2022-08-31 17:47:35.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253530068946944 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:47:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253551019495424 [0;39m 生成今日电子书快照开始
2022-08-31 17:47:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253551019495424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:47:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253551019495424 [0;39m ==> Parameters: 
2022-08-31 17:47:40.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253551019495424 [0;39m <==    Updates: 0
2022-08-31 17:47:40.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253551019495424 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:47:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253571957460992 [0;39m 生成今日电子书快照开始
2022-08-31 17:47:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253571957460992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:47:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253571957460992 [0;39m ==> Parameters: 
2022-08-31 17:47:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253571957460992 [0;39m <==    Updates: 0
2022-08-31 17:47:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253571957460992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:47:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253592924786688 [0;39m 生成今日电子书快照开始
2022-08-31 17:47:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253592924786688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:47:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253592924786688 [0;39m ==> Parameters: 
2022-08-31 17:47:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253592924786688 [0;39m <==    Updates: 0
2022-08-31 17:47:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253592924786688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:47:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253613938249728 [0;39m 生成今日电子书快照开始
2022-08-31 17:47:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253613938249728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:47:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253613938249728 [0;39m ==> Parameters: 
2022-08-31 17:47:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253613938249728 [0;39m <==    Updates: 0
2022-08-31 17:47:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253613938249728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:48:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253634909769728 [0;39m 生成今日电子书快照开始
2022-08-31 17:48:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253634909769728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:48:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253634909769728 [0;39m ==> Parameters: 
2022-08-31 17:48:00.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253634909769728 [0;39m <==    Updates: 0
2022-08-31 17:48:00.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253634909769728 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:48:00.517 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22250172692172800 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:48:00.518 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m22250172692172800 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-31 17:48:00.518 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m22250172692172800 [0;39m 登录校验开始，token：22249199726891008
2022-08-31 17:48:00.551 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m22250172692172800 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"}
2022-08-31 17:48:00.552 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22253637162110976 [0;39m ------------- 开始 -------------
2022-08-31 17:48:00.553 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22253637162110976 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-31 17:48:00.553 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22253637162110976 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-31 17:48:00.554 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22253637162110976 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:48:00.554 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22253637162110976 [0;39m 请求参数: [{"content":"<blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id=\"ys69d\"><br></h2><h2 id=\"ys69d\">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技\n</font></p><p><font size=\"3\">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函\n</font></p><p><font size=\"3\">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">2.&nbsp; RPC特点？</font><br></p><p><font size=\"3\">1. 简单：使用简单，建立分布式应用更容易。\n</font></p><p><font size=\"3\">2. 高效：调用过程看起来十分清晰，效率高。\n</font></p><p><font size=\"3\">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><hr><p><font size=\"5\">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size=\"3\">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp;<font color=\"#c24f4a\"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color=\"#000000\" size=\"5\">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp;<font size=\"4\"> <i style=\"background-color: rgb(139, 170, 74);\">&nbsp; Spring Cloud 是一个很好的生态来解决上面的问题！！</i></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; </font><b style=\"\"><font size=\"3\">&nbsp;</font><font size=\"4\"> 1. spring Cloud NetFlix&nbsp; </font></b><font size=\"4\">&nbsp;一站式解决方案！</font></p><p><font size=\"4\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font face=\"黑体\">&nbsp; &nbsp;</font></font><font face=\"黑体\" size=\"3\">api网关，zuul组件<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Feign通信 ---HttpClinet ---Http通信方式，同步，阻塞<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Eureka<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;熔断机制：Hystrix</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 。。。。<br></p><p><font size=\"4\"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;<font face=\"黑体\">&nbsp;&nbsp; API:没有，找第三方组件，或者自己实现</font></font><font face=\"黑体\" size=\"3\"><br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;通信：Duboo RPC通信<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Zookeeper</font><br></p><p><font size=\"4\"><b style=\"\">&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b style=\"\">Spring Cloud Alibaba&nbsp;&nbsp;</b><b style=\"color: rgb(194, 79, 74);\">new&nbsp; &nbsp;</b><font color=\"#000000\" style=\"\">一站式解决方案</font></font><font size=\"5\"></font></p>","ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}]
2022-08-31 17:48:00.555 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22253637162110976 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-31 17:48:00.556 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22253637162110976 [0;39m ==> Parameters: 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 1(Integer), 0(Integer), 20420961950109696(Long)
2022-08-31 17:48:00.557 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22253637162110976 [0;39m <==    Updates: 1
2022-08-31 17:48:00.557 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22253637162110976 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-31 17:48:00.557 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22253637162110976 [0;39m ==> Parameters: <blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id="ys69d"><br></h2><h2 id="ys69d">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size="4" style="background-color: rgb(139, 170, 74);">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技
</font></p><p><font size="3">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函
</font></p><p><font size="3">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size="4" style="background-color: rgb(139, 170, 74);">2.&nbsp; RPC特点？</font><br></p><p><font size="3">1. 简单：使用简单，建立分布式应用更容易。
</font></p><p><font size="3">2. 高效：调用过程看起来十分清晰，效率高。
</font></p><p><font size="3">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p><hr><p><font size="5">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size="3">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size="3">&nbsp; &nbsp; &nbsp;<font color="#c24f4a"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color="#000000" size="5">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp;<font size="4"> <i style="background-color: rgb(139, 170, 74);">&nbsp; Spring Cloud 是一个很好的生态来解决上面的问题！！</i></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; </font><b style=""><font size="3">&nbsp;</font><font size="4"> 1. spring Cloud NetFlix&nbsp; </font></b><font size="4">&nbsp;一站式解决方案！</font></p><p><font size="4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font face="黑体">&nbsp; &nbsp;</font></font><font face="黑体" size="3">api网关，zuul组件<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Feign通信 ---HttpClinet ---Http通信方式，同步，阻塞<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Eureka<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;熔断机制：Hystrix</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 。。。。<br></p><p><font size="4"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;<font face="黑体">&nbsp;&nbsp; API:没有，找第三方组件，或者自己实现</font></font><font face="黑体" size="3"><br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;通信：Duboo RPC通信<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Zookeeper</font><br></p><p><font size="4"><b style="">&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b style="">Spring Cloud Alibaba&nbsp;&nbsp;</b><b style="color: rgb(194, 79, 74);">new&nbsp; &nbsp;</b><font color="#000000" style="">一站式解决方案</font></font><font size="5"></font></p>(String), 20420961950109696(Long)
2022-08-31 17:48:00.559 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22253637162110976 [0;39m <==    Updates: 1
2022-08-31 17:48:00.571 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22253637162110976 [0;39m 返回结果: {"success":true}
2022-08-31 17:48:00.571 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22253637162110976 [0;39m ------------- 结束 耗时：19 ms -------------
2022-08-31 17:48:00.571 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22253637162110976 [0;39m ------------- LoginInterceptor 结束 耗时：53 ms -------------
2022-08-31 17:48:00.578 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22253637271162880 [0;39m ------------- 开始 -------------
2022-08-31 17:48:00.578 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22253637271162880 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:48:00.578 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22253637271162880 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:48:00.578 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22253637271162880 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:48:00.579 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22253637271162880 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:48:00.579 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22253637271162880 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:48:00.579 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22253637271162880 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:48:00.580 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22253637271162880 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:48:00.581 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22253637271162880 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 17:48:00.581 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22253637271162880 [0;39m <==      Total: 1
2022-08-31 17:48:00.582 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22253637271162880 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 17:48:00.583 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22253637271162880 [0;39m ------------- 结束 耗时：5 ms -------------
2022-08-31 17:48:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253655830958080 [0;39m 生成今日电子书快照开始
2022-08-31 17:48:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253655830958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:48:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253655830958080 [0;39m ==> Parameters: 
2022-08-31 17:48:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253655830958080 [0;39m <==    Updates: 0
2022-08-31 17:48:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253655830958080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:48:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22253655843540992 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:48:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253655843540992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:48:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253655843540992 [0;39m ==> Parameters: 
2022-08-31 17:48:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253655843540992 [0;39m <==    Updates: 8
2022-08-31 17:48:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22253655843540992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:48:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253676806672384 [0;39m 生成今日电子书快照开始
2022-08-31 17:48:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253676806672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:48:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253676806672384 [0;39m ==> Parameters: 
2022-08-31 17:48:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253676806672384 [0;39m <==    Updates: 0
2022-08-31 17:48:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253676806672384 [0;39m 生成今日电子书快照结束，耗时：0 毫秒
2022-08-31 17:48:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253697824329728 [0;39m 生成今日电子书快照开始
2022-08-31 17:48:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253697824329728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:48:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253697824329728 [0;39m ==> Parameters: 
2022-08-31 17:48:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253697824329728 [0;39m <==    Updates: 0
2022-08-31 17:48:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253697824329728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:48:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253718753906688 [0;39m 生成今日电子书快照开始
2022-08-31 17:48:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253718753906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:48:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253718753906688 [0;39m ==> Parameters: 
2022-08-31 17:48:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253718753906688 [0;39m <==    Updates: 0
2022-08-31 17:48:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253718753906688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:48:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253739750592512 [0;39m 生成今日电子书快照开始
2022-08-31 17:48:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253739750592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:48:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253739750592512 [0;39m ==> Parameters: 
2022-08-31 17:48:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253739750592512 [0;39m <==    Updates: 0
2022-08-31 17:48:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253739750592512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:48:27.727 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22252083285725184 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:48:27.727 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m22252083285725184 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-31 17:48:27.727 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m22252083285725184 [0;39m 登录校验开始，token：22249199726891008
2022-08-31 17:48:27.761 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m22252083285725184 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"}
2022-08-31 17:48:27.761 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22253751284928512 [0;39m ------------- 开始 -------------
2022-08-31 17:48:27.762 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22253751284928512 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-31 17:48:27.762 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22253751284928512 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-31 17:48:27.762 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22253751284928512 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:48:27.762 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22253751284928512 [0;39m 请求参数: [{"content":"<blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id=\"ys69d\"><br></h2><h2 id=\"ys69d\">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技\n</font></p><p><font size=\"3\">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函\n</font></p><p><font size=\"3\">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">2.&nbsp; RPC特点？</font><br></p><p><font size=\"3\">1. 简单：使用简单，建立分布式应用更容易。\n</font></p><p><font size=\"3\">2. 高效：调用过程看起来十分清晰，效率高。\n</font></p><p><font size=\"3\">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><hr><p><font size=\"5\">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size=\"3\">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp;<font color=\"#c24f4a\"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color=\"#000000\" size=\"5\">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp;<font size=\"4\"> <i style=\"background-color: rgb(139, 170, 74);\">&nbsp; Spring Cloud 是一个很好的生态来解决上面的问题！！</i></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; </font><b style=\"\"><font size=\"3\">&nbsp;</font><font size=\"4\"> 1. spring Cloud NetFlix&nbsp; </font></b><font size=\"4\">&nbsp;一站式解决方案！</font></p><p><font size=\"4\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font face=\"黑体\">&nbsp; &nbsp;</font></font><font face=\"黑体\" size=\"3\">api网关，zuul组件<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Feign通信 ---HttpClinet ---Http通信方式，同步，阻塞<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Eureka<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;熔断机制：Hystrix</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 。。。。<br></p><p><font size=\"4\"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;<font face=\"黑体\">&nbsp;&nbsp; API:没有，找第三方组件，或者自己实现</font></font><font face=\"黑体\" size=\"3\"><br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;通信：Duboo RPC通信<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Zookeeper</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\" face=\"黑体\">没有：借助 Hystrix</font><font face=\"黑体\" size=\"3\"><br></font></p><p><font size=\"4\"><b style=\"\">&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b style=\"\">Spring Cloud Alibaba&nbsp;&nbsp;</b><b style=\"color: rgb(194, 79, 74);\">new&nbsp; &nbsp;</b><font color=\"#000000\" style=\"\">一站式解决方案</font></font><font size=\"5\"></font></p>","ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}]
2022-08-31 17:48:27.763 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22253751284928512 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-31 17:48:27.763 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22253751284928512 [0;39m ==> Parameters: 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 1(Integer), 0(Integer), 20420961950109696(Long)
2022-08-31 17:48:27.764 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22253751284928512 [0;39m <==    Updates: 1
2022-08-31 17:48:27.764 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22253751284928512 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-31 17:48:27.765 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22253751284928512 [0;39m ==> Parameters: <blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id="ys69d"><br></h2><h2 id="ys69d">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size="4" style="background-color: rgb(139, 170, 74);">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技
</font></p><p><font size="3">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函
</font></p><p><font size="3">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size="4" style="background-color: rgb(139, 170, 74);">2.&nbsp; RPC特点？</font><br></p><p><font size="3">1. 简单：使用简单，建立分布式应用更容易。
</font></p><p><font size="3">2. 高效：调用过程看起来十分清晰，效率高。
</font></p><p><font size="3">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p><hr><p><font size="5">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size="3">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size="3">&nbsp; &nbsp; &nbsp;<font color="#c24f4a"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color="#000000" size="5">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp;<font size="4"> <i style="background-color: rgb(139, 170, 74);">&nbsp; Spring Cloud 是一个很好的生态来解决上面的问题！！</i></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; </font><b style=""><font size="3">&nbsp;</font><font size="4"> 1. spring Cloud NetFlix&nbsp; </font></b><font size="4">&nbsp;一站式解决方案！</font></p><p><font size="4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font face="黑体">&nbsp; &nbsp;</font></font><font face="黑体" size="3">api网关，zuul组件<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Feign通信 ---HttpClinet ---Http通信方式，同步，阻塞<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Eureka<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;熔断机制：Hystrix</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 。。。。<br></p><p><font size="4"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;<font face="黑体">&nbsp;&nbsp; API:没有，找第三方组件，或者自己实现</font></font><font face="黑体" size="3"><br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;通信：Duboo RPC通信<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Zookeeper</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3" face="黑体">没有：借助 Hystrix</font><font face="黑体" size="3"><br></font></p><p><font size="4"><b style="">&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b style="">Spring Cloud Alibaba&nbsp;&nbsp;</b><b style="color: rgb(194, 79, 74);">new&nbsp; &nbsp;</b><font color="#000000" style="">一站式解决方案</font></font><font size="5"></font></p>(String), 20420961950109696(Long)
2022-08-31 17:48:27.769 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22253751284928512 [0;39m <==    Updates: 1
2022-08-31 17:48:27.796 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22253751284928512 [0;39m 返回结果: {"success":true}
2022-08-31 17:48:27.796 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22253751284928512 [0;39m ------------- 结束 耗时：35 ms -------------
2022-08-31 17:48:27.797 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22253751284928512 [0;39m ------------- LoginInterceptor 结束 耗时：70 ms -------------
2022-08-31 17:48:27.803 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22253751461089280 [0;39m ------------- 开始 -------------
2022-08-31 17:48:27.804 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22253751461089280 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:48:27.804 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22253751461089280 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:48:27.804 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22253751461089280 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:48:27.804 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22253751461089280 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:48:27.805 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22253751461089280 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:48:27.806 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22253751461089280 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:48:27.807 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22253751461089280 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:48:27.807 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22253751461089280 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 17:48:27.807 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22253751461089280 [0;39m <==      Total: 1
2022-08-31 17:48:27.808 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22253751461089280 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 17:48:27.808 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22253751461089280 [0;39m ------------- 结束 耗时：5 ms -------------
2022-08-31 17:48:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253760692752384 [0;39m 生成今日电子书快照开始
2022-08-31 17:48:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253760692752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:48:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253760692752384 [0;39m ==> Parameters: 
2022-08-31 17:48:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253760692752384 [0;39m <==    Updates: 0
2022-08-31 17:48:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253760692752384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:48:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253781702021120 [0;39m 生成今日电子书快照开始
2022-08-31 17:48:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253781702021120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:48:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253781702021120 [0;39m ==> Parameters: 
2022-08-31 17:48:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253781702021120 [0;39m <==    Updates: 0
2022-08-31 17:48:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253781702021120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:48:35.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22253781710409728 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:48:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253781710409728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:48:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253781710409728 [0;39m ==> Parameters: 
2022-08-31 17:48:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253781710409728 [0;39m <==    Updates: 8
2022-08-31 17:48:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22253781710409728 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:48:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253802660958208 [0;39m 生成今日电子书快照开始
2022-08-31 17:48:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253802660958208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:48:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253802660958208 [0;39m ==> Parameters: 
2022-08-31 17:48:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253802660958208 [0;39m <==    Updates: 0
2022-08-31 17:48:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253802660958208 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-31 17:48:41.358 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22252454523572224 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:48:41.358 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m22252454523572224 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-31 17:48:41.359 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m22252454523572224 [0;39m 登录校验开始，token：22249199726891008
2022-08-31 17:48:41.392 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m22252454523572224 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"}
2022-08-31 17:48:41.393 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22253808461680640 [0;39m ------------- 开始 -------------
2022-08-31 17:48:41.393 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22253808461680640 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-31 17:48:41.393 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22253808461680640 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-31 17:48:41.393 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22253808461680640 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:48:41.393 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22253808461680640 [0;39m 请求参数: [{"content":"<blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id=\"ys69d\"><br></h2><h2 id=\"ys69d\">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技\n</font></p><p><font size=\"3\">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函\n</font></p><p><font size=\"3\">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">2.&nbsp; RPC特点？</font><br></p><p><font size=\"3\">1. 简单：使用简单，建立分布式应用更容易。\n</font></p><p><font size=\"3\">2. 高效：调用过程看起来十分清晰，效率高。\n</font></p><p><font size=\"3\">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><hr><p><font size=\"5\">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size=\"3\">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp;<font color=\"#c24f4a\"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color=\"#000000\" size=\"5\">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp;<font size=\"4\"> <i style=\"background-color: rgb(139, 170, 74);\">&nbsp; Spring Cloud 是一个很好的生态来解决上面的问题！！</i></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; </font><b style=\"\"><font size=\"3\">&nbsp;</font><font size=\"4\"> 1. spring Cloud NetFlix&nbsp; </font></b><font size=\"4\">&nbsp;一站式解决方案！</font></p><p><font size=\"4\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font face=\"黑体\">&nbsp; &nbsp;</font></font><font face=\"黑体\" size=\"3\">api网关，zuul组件<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Feign通信 ---HttpClinet ---Http通信方式，同步，阻塞<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Eureka<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;熔断机制：Hystrix</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 。。。。<br></p><p><font size=\"4\"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;<font face=\"黑体\">&nbsp;API:没有，找第三方组件，或者自己实现</font></font><font face=\"黑体\" size=\"3\"><br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;通信：Duboo RPC通信<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Zookeeper</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\" face=\"黑体\">没有：借助 Hystrix</font><font face=\"黑体\" size=\"3\"><br></font></p><p><font size=\"4\"><b style=\"\">&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b style=\"\">Spring Cloud Alibaba&nbsp;&nbsp;</b><b style=\"color: rgb(194, 79, 74);\">new&nbsp; &nbsp;</b><font color=\"#000000\" style=\"\">一站式解决方案</font></font><font size=\"5\"></font></p>","ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}]
2022-08-31 17:48:41.396 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22253808461680640 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-31 17:48:41.397 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22253808461680640 [0;39m ==> Parameters: 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 1(Integer), 0(Integer), 20420961950109696(Long)
2022-08-31 17:48:41.398 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22253808461680640 [0;39m <==    Updates: 1
2022-08-31 17:48:41.399 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22253808461680640 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-31 17:48:41.399 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22253808461680640 [0;39m ==> Parameters: <blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id="ys69d"><br></h2><h2 id="ys69d">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size="4" style="background-color: rgb(139, 170, 74);">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技
</font></p><p><font size="3">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函
</font></p><p><font size="3">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size="4" style="background-color: rgb(139, 170, 74);">2.&nbsp; RPC特点？</font><br></p><p><font size="3">1. 简单：使用简单，建立分布式应用更容易。
</font></p><p><font size="3">2. 高效：调用过程看起来十分清晰，效率高。
</font></p><p><font size="3">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p><hr><p><font size="5">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size="3">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size="3">&nbsp; &nbsp; &nbsp;<font color="#c24f4a"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color="#000000" size="5">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp;<font size="4"> <i style="background-color: rgb(139, 170, 74);">&nbsp; Spring Cloud 是一个很好的生态来解决上面的问题！！</i></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; </font><b style=""><font size="3">&nbsp;</font><font size="4"> 1. spring Cloud NetFlix&nbsp; </font></b><font size="4">&nbsp;一站式解决方案！</font></p><p><font size="4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font face="黑体">&nbsp; &nbsp;</font></font><font face="黑体" size="3">api网关，zuul组件<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Feign通信 ---HttpClinet ---Http通信方式，同步，阻塞<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Eureka<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;熔断机制：Hystrix</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 。。。。<br></p><p><font size="4"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;<font face="黑体">&nbsp;API:没有，找第三方组件，或者自己实现</font></font><font face="黑体" size="3"><br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;通信：Duboo RPC通信<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Zookeeper</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3" face="黑体">没有：借助 Hystrix</font><font face="黑体" size="3"><br></font></p><p><font size="4"><b style="">&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b style="">Spring Cloud Alibaba&nbsp;&nbsp;</b><b style="color: rgb(194, 79, 74);">new&nbsp; &nbsp;</b><font color="#000000" style="">一站式解决方案</font></font><font size="5"></font></p>(String), 20420961950109696(Long)
2022-08-31 17:48:41.405 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22253808461680640 [0;39m <==    Updates: 1
2022-08-31 17:48:41.424 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22253808461680640 [0;39m 返回结果: {"success":true}
2022-08-31 17:48:41.424 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22253808461680640 [0;39m ------------- 结束 耗时：31 ms -------------
2022-08-31 17:48:41.425 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22253808461680640 [0;39m ------------- LoginInterceptor 结束 耗时：67 ms -------------
2022-08-31 17:48:41.431 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22253808621064192 [0;39m ------------- 开始 -------------
2022-08-31 17:48:41.432 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22253808621064192 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:48:41.432 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22253808621064192 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:48:41.432 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22253808621064192 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:48:41.432 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22253808621064192 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:48:41.433 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22253808621064192 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:48:41.434 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22253808621064192 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:48:41.435 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22253808621064192 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:48:41.435 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22253808621064192 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 17:48:41.435 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22253808621064192 [0;39m <==      Total: 1
2022-08-31 17:48:41.435 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22253808621064192 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 17:48:41.435 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22253808621064192 [0;39m ------------- 结束 耗时：4 ms -------------
2022-08-31 17:48:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253823628283904 [0;39m 生成今日电子书快照开始
2022-08-31 17:48:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253823628283904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:48:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253823628283904 [0;39m ==> Parameters: 
2022-08-31 17:48:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253823628283904 [0;39m <==    Updates: 0
2022-08-31 17:48:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253823628283904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:48:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253844629164032 [0;39m 生成今日电子书快照开始
2022-08-31 17:48:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253844629164032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:48:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253844629164032 [0;39m ==> Parameters: 
2022-08-31 17:48:50.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253844629164032 [0;39m <==    Updates: 0
2022-08-31 17:48:50.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253844629164032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:48:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253865554546688 [0;39m 生成今日电子书快照开始
2022-08-31 17:48:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253865554546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:48:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253865554546688 [0;39m ==> Parameters: 
2022-08-31 17:48:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253865554546688 [0;39m <==    Updates: 0
2022-08-31 17:48:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253865554546688 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:49:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253886534455296 [0;39m 生成今日电子书快照开始
2022-08-31 17:49:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253886534455296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:49:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253886534455296 [0;39m ==> Parameters: 
2022-08-31 17:49:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253886534455296 [0;39m <==    Updates: 0
2022-08-31 17:49:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253886534455296 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:49:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253907522752512 [0;39m 生成今日电子书快照开始
2022-08-31 17:49:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253907522752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:49:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253907522752512 [0;39m ==> Parameters: 
2022-08-31 17:49:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253907522752512 [0;39m <==    Updates: 0
2022-08-31 17:49:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253907522752512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:49:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22253907539529728 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:49:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253907539529728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:49:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253907539529728 [0;39m ==> Parameters: 
2022-08-31 17:49:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22253907539529728 [0;39m <==    Updates: 8
2022-08-31 17:49:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22253907539529728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:49:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253928477495296 [0;39m 生成今日电子书快照开始
2022-08-31 17:49:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253928477495296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:49:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253928477495296 [0;39m ==> Parameters: 
2022-08-31 17:49:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253928477495296 [0;39m <==    Updates: 0
2022-08-31 17:49:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253928477495296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:49:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253949453209600 [0;39m 生成今日电子书快照开始
2022-08-31 17:49:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253949453209600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:49:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253949453209600 [0;39m ==> Parameters: 
2022-08-31 17:49:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253949453209600 [0;39m <==    Updates: 0
2022-08-31 17:49:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253949453209600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:49:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253970428923904 [0;39m 生成今日电子书快照开始
2022-08-31 17:49:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253970428923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:49:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253970428923904 [0;39m ==> Parameters: 
2022-08-31 17:49:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253970428923904 [0;39m <==    Updates: 0
2022-08-31 17:49:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253970428923904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 17:49:20.133 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22251074366869504 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 17:49:20.134 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m22251074366869504 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-31 17:49:20.134 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m22251074366869504 [0;39m 登录校验开始，token：22249199726891008
2022-08-31 17:49:20.167 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m22251074366869504 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"}
2022-08-31 17:49:20.167 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22253971091623936 [0;39m ------------- 开始 -------------
2022-08-31 17:49:20.168 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22253971091623936 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-31 17:49:20.168 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22253971091623936 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-31 17:49:20.168 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22253971091623936 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:49:20.168 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22253971091623936 [0;39m 请求参数: [{"content":"<blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id=\"ys69d\"><br></h2><h2 id=\"ys69d\">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技\n</font></p><p><font size=\"3\">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函\n</font></p><p><font size=\"3\">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">2.&nbsp; RPC特点？</font><br></p><p><font size=\"3\">1. 简单：使用简单，建立分布式应用更容易。\n</font></p><p><font size=\"3\">2. 高效：调用过程看起来十分清晰，效率高。\n</font></p><p><font size=\"3\">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><hr><p><font size=\"5\">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size=\"3\">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp;<font color=\"#c24f4a\"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color=\"#000000\" size=\"5\">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp;<font size=\"4\"> <i style=\"background-color: rgb(139, 170, 74);\">&nbsp; Spring Cloud 是一个很好的生态来解决上面的问题！！</i></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; </font><b style=\"\"><font size=\"3\">&nbsp;</font><font size=\"4\"> 1. spring Cloud NetFlix&nbsp; </font></b><font size=\"4\">&nbsp;一站式解决方案！</font></p><p><font size=\"4\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font face=\"黑体\">&nbsp; &nbsp;</font></font><font face=\"黑体\" size=\"3\">api网关，zuul组件<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Feign通信 ---HttpClinet ---Http通信方式，同步，阻塞<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Eureka<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;熔断机制：Hystrix</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 。。。。<br></p><p><font size=\"4\"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;<font face=\"黑体\">&nbsp;API:没有，找第三方组件，或者自己实现</font></font><font face=\"黑体\" size=\"3\"><br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;通信：Duboo RPC通信<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Zookeeper</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\" face=\"黑体\">没有：借助 Hystrix</font><font face=\"黑体\" size=\"3\"><br></font></p><p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=\"3\" face=\"黑体\"><br></font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font size=\"4\"><i style=\"background-color: rgb(139, 170, 74);\">Dubbo 这个方案并不完善~~</i></font><br></p><p><font size=\"4\"><b style=\"\">&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b style=\"\">Spring Cloud Alibaba&nbsp;&nbsp;</b><b style=\"color: rgb(194, 79, 74);\">new&nbsp; &nbsp;</b><font color=\"#000000\" style=\"\">一站式解决方案</font></font><font size=\"5\"></font></p>","ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}]
2022-08-31 17:49:20.169 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22253971091623936 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-31 17:49:20.169 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22253971091623936 [0;39m ==> Parameters: 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 1(Integer), 0(Integer), 20420961950109696(Long)
2022-08-31 17:49:20.170 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22253971091623936 [0;39m <==    Updates: 1
2022-08-31 17:49:20.170 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22253971091623936 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-31 17:49:20.170 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22253971091623936 [0;39m ==> Parameters: <blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id="ys69d"><br></h2><h2 id="ys69d">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size="4" style="background-color: rgb(139, 170, 74);">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技
</font></p><p><font size="3">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函
</font></p><p><font size="3">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size="4" style="background-color: rgb(139, 170, 74);">2.&nbsp; RPC特点？</font><br></p><p><font size="3">1. 简单：使用简单，建立分布式应用更容易。
</font></p><p><font size="3">2. 高效：调用过程看起来十分清晰，效率高。
</font></p><p><font size="3">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p><hr><p><font size="5">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size="3">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size="3">&nbsp; &nbsp; &nbsp;<font color="#c24f4a"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color="#000000" size="5">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp;<font size="4"> <i style="background-color: rgb(139, 170, 74);">&nbsp; Spring Cloud 是一个很好的生态来解决上面的问题！！</i></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; </font><b style=""><font size="3">&nbsp;</font><font size="4"> 1. spring Cloud NetFlix&nbsp; </font></b><font size="4">&nbsp;一站式解决方案！</font></p><p><font size="4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font face="黑体">&nbsp; &nbsp;</font></font><font face="黑体" size="3">api网关，zuul组件<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Feign通信 ---HttpClinet ---Http通信方式，同步，阻塞<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Eureka<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;熔断机制：Hystrix</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 。。。。<br></p><p><font size="4"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;<font face="黑体">&nbsp;API:没有，找第三方组件，或者自己实现</font></font><font face="黑体" size="3"><br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;通信：Duboo RPC通信<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Zookeeper</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3" face="黑体">没有：借助 Hystrix</font><font face="黑体" size="3"><br></font></p><p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="黑体"><br></font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font size="4"><i style="background-color: rgb(139, 170, 74);">Dubbo 这个方案并不完善~~</i></font><br></p><p><font size="4"><b style="">&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b style="">Spring Cloud Alibaba&nbsp;&nbsp;</b><b style="color: rgb(194, 79, 74);">new&nbsp; &nbsp;</b><font color="#000000" style="">一站式解决方案</font></font><font size="5"></font></p>(String), 20420961950109696(Long)
2022-08-31 17:49:20.172 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22253971091623936 [0;39m <==    Updates: 1
2022-08-31 17:49:20.236 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22253971091623936 [0;39m 返回结果: {"success":true}
2022-08-31 17:49:20.236 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22253971091623936 [0;39m ------------- 结束 耗时：69 ms -------------
2022-08-31 17:49:20.236 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22253971091623936 [0;39m ------------- LoginInterceptor 结束 耗时：102 ms -------------
2022-08-31 17:49:20.243 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22253971410391040 [0;39m ------------- 开始 -------------
2022-08-31 17:49:20.243 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22253971410391040 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 17:49:20.243 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22253971410391040 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 17:49:20.243 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22253971410391040 [0;39m 远程地址: 127.0.0.1
2022-08-31 17:49:20.243 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22253971410391040 [0;39m 请求参数: [20420687550353408]
2022-08-31 17:49:20.245 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22253971410391040 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 17:49:20.245 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22253971410391040 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 17:49:20.246 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22253971410391040 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 17:49:20.247 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22253971410391040 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 17:49:20.248 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22253971410391040 [0;39m <==      Total: 1
2022-08-31 17:49:20.250 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22253971410391040 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 17:49:20.250 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22253971410391040 [0;39m ------------- 结束 耗时：7 ms -------------
2022-08-31 17:49:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22253991366889472 [0;39m 生成今日电子书快照开始
2022-08-31 17:49:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253991366889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:49:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253991366889472 [0;39m ==> Parameters: 
2022-08-31 17:49:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22253991366889472 [0;39m <==    Updates: 0
2022-08-31 17:49:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22253991366889472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:49:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254012363575296 [0;39m 生成今日电子书快照开始
2022-08-31 17:49:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254012363575296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:49:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254012363575296 [0;39m ==> Parameters: 
2022-08-31 17:49:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254012363575296 [0;39m <==    Updates: 0
2022-08-31 17:49:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254012363575296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:49:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254033326706688 [0;39m 生成今日电子书快照开始
2022-08-31 17:49:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254033326706688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:49:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254033326706688 [0;39m ==> Parameters: 
2022-08-31 17:49:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254033326706688 [0;39m <==    Updates: 0
2022-08-31 17:49:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254033326706688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:49:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22254033339289600 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:49:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254033339289600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:49:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254033339289600 [0;39m ==> Parameters: 
2022-08-31 17:49:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254033339289600 [0;39m <==    Updates: 8
2022-08-31 17:49:35.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22254033339289600 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:49:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254054331781120 [0;39m 生成今日电子书快照开始
2022-08-31 17:49:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254054331781120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:49:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254054331781120 [0;39m ==> Parameters: 
2022-08-31 17:49:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254054331781120 [0;39m <==    Updates: 0
2022-08-31 17:49:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254054331781120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:49:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254075261358080 [0;39m 生成今日电子书快照开始
2022-08-31 17:49:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254075261358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:49:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254075261358080 [0;39m ==> Parameters: 
2022-08-31 17:49:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254075261358080 [0;39m <==    Updates: 0
2022-08-31 17:49:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254075261358080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:49:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254096279015424 [0;39m 生成今日电子书快照开始
2022-08-31 17:49:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254096279015424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:49:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254096279015424 [0;39m ==> Parameters: 
2022-08-31 17:49:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254096279015424 [0;39m <==    Updates: 0
2022-08-31 17:49:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254096279015424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:49:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254117242146816 [0;39m 生成今日电子书快照开始
2022-08-31 17:49:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254117242146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:49:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254117242146816 [0;39m ==> Parameters: 
2022-08-31 17:49:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254117242146816 [0;39m <==    Updates: 0
2022-08-31 17:49:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254117242146816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:50:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254138188500992 [0;39m 生成今日电子书快照开始
2022-08-31 17:50:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254138188500992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:50:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254138188500992 [0;39m ==> Parameters: 
2022-08-31 17:50:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254138188500992 [0;39m <==    Updates: 0
2022-08-31 17:50:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254138188500992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:50:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22254159180992512 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:50:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254159180992512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:50:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254159180992512 [0;39m ==> Parameters: 
2022-08-31 17:50:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254159180992512 [0;39m <==    Updates: 8
2022-08-31 17:50:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22254159180992512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:50:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254159189381120 [0;39m 生成今日电子书快照开始
2022-08-31 17:50:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254159189381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:50:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254159189381120 [0;39m ==> Parameters: 
2022-08-31 17:50:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254159189381120 [0;39m <==    Updates: 0
2022-08-31 17:50:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254159189381120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:50:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254180144123904 [0;39m 生成今日电子书快照开始
2022-08-31 17:50:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254180144123904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:50:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254180144123904 [0;39m ==> Parameters: 
2022-08-31 17:50:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254180144123904 [0;39m <==    Updates: 0
2022-08-31 17:50:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254180144123904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:50:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254201107255296 [0;39m 生成今日电子书快照开始
2022-08-31 17:50:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254201107255296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:50:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254201107255296 [0;39m ==> Parameters: 
2022-08-31 17:50:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254201107255296 [0;39m <==    Updates: 0
2022-08-31 17:50:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254201107255296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:50:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254222112329728 [0;39m 生成今日电子书快照开始
2022-08-31 17:50:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254222112329728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:50:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254222112329728 [0;39m ==> Parameters: 
2022-08-31 17:50:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254222112329728 [0;39m <==    Updates: 0
2022-08-31 17:50:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254222112329728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:50:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254243058683904 [0;39m 生成今日电子书快照开始
2022-08-31 17:50:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254243058683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:50:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254243058683904 [0;39m ==> Parameters: 
2022-08-31 17:50:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254243058683904 [0;39m <==    Updates: 0
2022-08-31 17:50:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254243058683904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:50:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254264038592512 [0;39m 生成今日电子书快照开始
2022-08-31 17:50:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254264038592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:50:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254264038592512 [0;39m ==> Parameters: 
2022-08-31 17:50:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254264038592512 [0;39m <==    Updates: 0
2022-08-31 17:50:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254264038592512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:50:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254285018501120 [0;39m 生成今日电子书快照开始
2022-08-31 17:50:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254285018501120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:50:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254285018501120 [0;39m ==> Parameters: 
2022-08-31 17:50:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254285018501120 [0;39m <==    Updates: 0
2022-08-31 17:50:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254285018501120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:50:35.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22254285026889728 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:50:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254285026889728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:50:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254285026889728 [0;39m ==> Parameters: 
2022-08-31 17:50:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254285026889728 [0;39m <==    Updates: 8
2022-08-31 17:50:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22254285026889728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:50:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254305981632512 [0;39m 生成今日电子书快照开始
2022-08-31 17:50:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254305981632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:50:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254305981632512 [0;39m ==> Parameters: 
2022-08-31 17:50:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254305981632512 [0;39m <==    Updates: 0
2022-08-31 17:50:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254305981632512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:50:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254326927986688 [0;39m 生成今日电子书快照开始
2022-08-31 17:50:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254326927986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:50:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254326927986688 [0;39m ==> Parameters: 
2022-08-31 17:50:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254326927986688 [0;39m <==    Updates: 0
2022-08-31 17:50:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254326927986688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:50:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254347886923776 [0;39m 生成今日电子书快照开始
2022-08-31 17:50:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254347886923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:50:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254347886923776 [0;39m ==> Parameters: 
2022-08-31 17:50:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254347886923776 [0;39m <==    Updates: 0
2022-08-31 17:50:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254347886923776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:50:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254368917164032 [0;39m 生成今日电子书快照开始
2022-08-31 17:50:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254368917164032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:50:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254368917164032 [0;39m ==> Parameters: 
2022-08-31 17:50:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254368917164032 [0;39m <==    Updates: 0
2022-08-31 17:50:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254368917164032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:51:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254389842546688 [0;39m 生成今日电子书快照开始
2022-08-31 17:51:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254389842546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:51:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254389842546688 [0;39m ==> Parameters: 
2022-08-31 17:51:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254389842546688 [0;39m <==    Updates: 0
2022-08-31 17:51:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254389842546688 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-31 17:51:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22254410839232512 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:51:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254410839232512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:51:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254410839232512 [0;39m ==> Parameters: 
2022-08-31 17:51:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254410839232512 [0;39m <==    Updates: 8
2022-08-31 17:51:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22254410839232512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:51:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254410843426816 [0;39m 生成今日电子书快照开始
2022-08-31 17:51:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254410843426816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:51:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254410843426816 [0;39m ==> Parameters: 
2022-08-31 17:51:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254410843426816 [0;39m <==    Updates: 0
2022-08-31 17:51:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254410843426816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:51:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254431798169600 [0;39m 生成今日电子书快照开始
2022-08-31 17:51:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254431798169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:51:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254431798169600 [0;39m ==> Parameters: 
2022-08-31 17:51:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254431798169600 [0;39m <==    Updates: 0
2022-08-31 17:51:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254431798169600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:51:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254452757106688 [0;39m 生成今日电子书快照开始
2022-08-31 17:51:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254452757106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:51:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254452757106688 [0;39m ==> Parameters: 
2022-08-31 17:51:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254452757106688 [0;39m <==    Updates: 0
2022-08-31 17:51:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254452757106688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:51:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254473716043776 [0;39m 生成今日电子书快照开始
2022-08-31 17:51:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254473716043776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:51:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254473716043776 [0;39m ==> Parameters: 
2022-08-31 17:51:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254473716043776 [0;39m <==    Updates: 0
2022-08-31 17:51:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254473716043776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:51:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254494729506816 [0;39m 生成今日电子书快照开始
2022-08-31 17:51:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254494729506816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:51:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254494729506816 [0;39m ==> Parameters: 
2022-08-31 17:51:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254494729506816 [0;39m <==    Updates: 0
2022-08-31 17:51:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254494729506816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 17:51:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254515705221120 [0;39m 生成今日电子书快照开始
2022-08-31 17:51:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254515705221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:51:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254515705221120 [0;39m ==> Parameters: 
2022-08-31 17:51:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254515705221120 [0;39m <==    Updates: 0
2022-08-31 17:51:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254515705221120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:51:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254536643186688 [0;39m 生成今日电子书快照开始
2022-08-31 17:51:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254536643186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:51:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254536643186688 [0;39m ==> Parameters: 
2022-08-31 17:51:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254536643186688 [0;39m <==    Updates: 0
2022-08-31 17:51:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254536643186688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:51:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22254536651575296 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:51:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254536651575296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:51:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254536651575296 [0;39m ==> Parameters: 
2022-08-31 17:51:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254536651575296 [0;39m <==    Updates: 8
2022-08-31 17:51:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22254536651575296 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:51:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254557644066816 [0;39m 生成今日电子书快照开始
2022-08-31 17:51:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254557644066816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:51:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254557644066816 [0;39m ==> Parameters: 
2022-08-31 17:51:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254557644066816 [0;39m <==    Updates: 0
2022-08-31 17:51:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254557644066816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:51:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254578590420992 [0;39m 生成今日电子书快照开始
2022-08-31 17:51:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254578590420992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:51:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254578590420992 [0;39m ==> Parameters: 
2022-08-31 17:51:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254578590420992 [0;39m <==    Updates: 0
2022-08-31 17:51:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254578590420992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:51:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254599574523904 [0;39m 生成今日电子书快照开始
2022-08-31 17:51:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254599574523904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:51:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254599574523904 [0;39m ==> Parameters: 
2022-08-31 17:51:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254599574523904 [0;39m <==    Updates: 0
2022-08-31 17:51:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254599574523904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:51:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254620546043904 [0;39m 生成今日电子书快照开始
2022-08-31 17:51:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254620546043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:51:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254620546043904 [0;39m ==> Parameters: 
2022-08-31 17:51:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254620546043904 [0;39m <==    Updates: 0
2022-08-31 17:51:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254620546043904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:52:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254641530146816 [0;39m 生成今日电子书快照开始
2022-08-31 17:52:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254641530146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:52:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254641530146816 [0;39m ==> Parameters: 
2022-08-31 17:52:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254641530146816 [0;39m <==    Updates: 0
2022-08-31 17:52:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254641530146816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:52:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22254662476500992 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:52:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254662476500992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:52:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254662476500992 [0;39m ==> Parameters: 
2022-08-31 17:52:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254662476500992 [0;39m <==    Updates: 8
2022-08-31 17:52:05.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22254662476500992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:52:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254662484889600 [0;39m 生成今日电子书快照开始
2022-08-31 17:52:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254662484889600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:52:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254662484889600 [0;39m ==> Parameters: 
2022-08-31 17:52:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254662484889600 [0;39m <==    Updates: 0
2022-08-31 17:52:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254662484889600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:52:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254683485769728 [0;39m 生成今日电子书快照开始
2022-08-31 17:52:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254683485769728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:52:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254683485769728 [0;39m ==> Parameters: 
2022-08-31 17:52:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254683485769728 [0;39m <==    Updates: 0
2022-08-31 17:52:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254683485769728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:52:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254704402763776 [0;39m 生成今日电子书快照开始
2022-08-31 17:52:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254704402763776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:52:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254704402763776 [0;39m ==> Parameters: 
2022-08-31 17:52:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254704402763776 [0;39m <==    Updates: 0
2022-08-31 17:52:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254704402763776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:52:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254725412032512 [0;39m 生成今日电子书快照开始
2022-08-31 17:52:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254725412032512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:52:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254725412032512 [0;39m ==> Parameters: 
2022-08-31 17:52:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254725412032512 [0;39m <==    Updates: 0
2022-08-31 17:52:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254725412032512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:52:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254746391941120 [0;39m 生成今日电子书快照开始
2022-08-31 17:52:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254746391941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:52:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254746391941120 [0;39m ==> Parameters: 
2022-08-31 17:52:25.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254746391941120 [0;39m <==    Updates: 0
2022-08-31 17:52:25.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254746391941120 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-31 17:52:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254767346683904 [0;39m 生成今日电子书快照开始
2022-08-31 17:52:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254767346683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:52:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254767346683904 [0;39m ==> Parameters: 
2022-08-31 17:52:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254767346683904 [0;39m <==    Updates: 0
2022-08-31 17:52:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254767346683904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:52:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22254788326592512 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:52:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254788326592512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:52:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254788326592512 [0;39m ==> Parameters: 
2022-08-31 17:52:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254788326592512 [0;39m <==    Updates: 8
2022-08-31 17:52:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22254788326592512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:52:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254788334981120 [0;39m 生成今日电子书快照开始
2022-08-31 17:52:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254788334981120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:52:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254788334981120 [0;39m ==> Parameters: 
2022-08-31 17:52:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254788334981120 [0;39m <==    Updates: 0
2022-08-31 17:52:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254788334981120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 17:52:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254809298112512 [0;39m 生成今日电子书快照开始
2022-08-31 17:52:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254809298112512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:52:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254809298112512 [0;39m ==> Parameters: 
2022-08-31 17:52:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254809298112512 [0;39m <==    Updates: 0
2022-08-31 17:52:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254809298112512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:52:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254830282215424 [0;39m 生成今日电子书快照开始
2022-08-31 17:52:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254830282215424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:52:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254830282215424 [0;39m ==> Parameters: 
2022-08-31 17:52:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254830282215424 [0;39m <==    Updates: 0
2022-08-31 17:52:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254830282215424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:52:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254851249541120 [0;39m 生成今日电子书快照开始
2022-08-31 17:52:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254851249541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:52:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254851249541120 [0;39m ==> Parameters: 
2022-08-31 17:52:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254851249541120 [0;39m <==    Updates: 0
2022-08-31 17:52:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254851249541120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:52:55.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254872170729472 [0;39m 生成今日电子书快照开始
2022-08-31 17:52:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254872170729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:52:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254872170729472 [0;39m ==> Parameters: 
2022-08-31 17:52:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254872170729472 [0;39m <==    Updates: 0
2022-08-31 17:52:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254872170729472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:53:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254893167415296 [0;39m 生成今日电子书快照开始
2022-08-31 17:53:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254893167415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:53:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254893167415296 [0;39m ==> Parameters: 
2022-08-31 17:53:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254893167415296 [0;39m <==    Updates: 0
2022-08-31 17:53:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254893167415296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:53:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22254914159906816 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:53:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254914159906816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:53:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254914159906816 [0;39m ==> Parameters: 
2022-08-31 17:53:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22254914159906816 [0;39m <==    Updates: 8
2022-08-31 17:53:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22254914159906816 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:53:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254914172489728 [0;39m 生成今日电子书快照开始
2022-08-31 17:53:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254914172489728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:53:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254914172489728 [0;39m ==> Parameters: 
2022-08-31 17:53:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254914172489728 [0;39m <==    Updates: 0
2022-08-31 17:53:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254914172489728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:53:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254935093678080 [0;39m 生成今日电子书快照开始
2022-08-31 17:53:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254935093678080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:53:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254935093678080 [0;39m ==> Parameters: 
2022-08-31 17:53:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254935093678080 [0;39m <==    Updates: 0
2022-08-31 17:53:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254935093678080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:53:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254956081975296 [0;39m 生成今日电子书快照开始
2022-08-31 17:53:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254956081975296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:53:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254956081975296 [0;39m ==> Parameters: 
2022-08-31 17:53:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254956081975296 [0;39m <==    Updates: 0
2022-08-31 17:53:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254956081975296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:53:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254977053495296 [0;39m 生成今日电子书快照开始
2022-08-31 17:53:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254977053495296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:53:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254977053495296 [0;39m ==> Parameters: 
2022-08-31 17:53:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254977053495296 [0;39m <==    Updates: 0
2022-08-31 17:53:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254977053495296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:53:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22254998050181120 [0;39m 生成今日电子书快照开始
2022-08-31 17:53:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254998050181120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:53:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254998050181120 [0;39m ==> Parameters: 
2022-08-31 17:53:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22254998050181120 [0;39m <==    Updates: 0
2022-08-31 17:53:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22254998050181120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:53:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255018979758080 [0;39m 生成今日电子书快照开始
2022-08-31 17:53:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255018979758080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:53:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255018979758080 [0;39m ==> Parameters: 
2022-08-31 17:53:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255018979758080 [0;39m <==    Updates: 0
2022-08-31 17:53:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255018979758080 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:53:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22255039955472384 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:53:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255039955472384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:53:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255039955472384 [0;39m ==> Parameters: 
2022-08-31 17:53:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255039955472384 [0;39m <==    Updates: 8
2022-08-31 17:53:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22255039955472384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:53:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255039963860992 [0;39m 生成今日电子书快照开始
2022-08-31 17:53:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255039963860992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:53:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255039963860992 [0;39m ==> Parameters: 
2022-08-31 17:53:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255039963860992 [0;39m <==    Updates: 0
2022-08-31 17:53:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255039963860992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 17:53:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255060935380992 [0;39m 生成今日电子书快照开始
2022-08-31 17:53:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255060935380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:53:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255060935380992 [0;39m ==> Parameters: 
2022-08-31 17:53:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255060935380992 [0;39m <==    Updates: 0
2022-08-31 17:53:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255060935380992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:53:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255081944649728 [0;39m 生成今日电子书快照开始
2022-08-31 17:53:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255081944649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:53:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255081944649728 [0;39m ==> Parameters: 
2022-08-31 17:53:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255081944649728 [0;39m <==    Updates: 0
2022-08-31 17:53:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255081944649728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:53:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255102865838080 [0;39m 生成今日电子书快照开始
2022-08-31 17:53:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255102865838080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:53:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255102865838080 [0;39m ==> Parameters: 
2022-08-31 17:53:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255102865838080 [0;39m <==    Updates: 0
2022-08-31 17:53:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255102865838080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:53:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255123849940992 [0;39m 生成今日电子书快照开始
2022-08-31 17:53:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255123849940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:53:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255123849940992 [0;39m ==> Parameters: 
2022-08-31 17:53:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255123849940992 [0;39m <==    Updates: 0
2022-08-31 17:53:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255123849940992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:54:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255144859209728 [0;39m 生成今日电子书快照开始
2022-08-31 17:54:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255144859209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:54:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255144859209728 [0;39m ==> Parameters: 
2022-08-31 17:54:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255144859209728 [0;39m <==    Updates: 0
2022-08-31 17:54:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255144859209728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:54:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255165784592384 [0;39m 生成今日电子书快照开始
2022-08-31 17:54:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255165784592384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:54:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255165784592384 [0;39m ==> Parameters: 
2022-08-31 17:54:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255165784592384 [0;39m <==    Updates: 0
2022-08-31 17:54:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255165784592384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:54:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22255165792980992 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:54:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255165792980992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:54:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255165792980992 [0;39m ==> Parameters: 
2022-08-31 17:54:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255165792980992 [0;39m <==    Updates: 8
2022-08-31 17:54:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22255165792980992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:54:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255186751918080 [0;39m 生成今日电子书快照开始
2022-08-31 17:54:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255186751918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:54:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255186751918080 [0;39m ==> Parameters: 
2022-08-31 17:54:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255186751918080 [0;39m <==    Updates: 0
2022-08-31 17:54:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255186751918080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:54:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255207777964032 [0;39m 生成今日电子书快照开始
2022-08-31 17:54:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255207777964032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:54:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255207777964032 [0;39m ==> Parameters: 
2022-08-31 17:54:15.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255207777964032 [0;39m <==    Updates: 0
2022-08-31 17:54:15.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255207777964032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:54:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255228690763776 [0;39m 生成今日电子书快照开始
2022-08-31 17:54:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255228690763776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:54:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255228690763776 [0;39m ==> Parameters: 
2022-08-31 17:54:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255228690763776 [0;39m <==    Updates: 0
2022-08-31 17:54:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255228690763776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:54:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255249695838208 [0;39m 生成今日电子书快照开始
2022-08-31 17:54:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255249695838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:54:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255249695838208 [0;39m ==> Parameters: 
2022-08-31 17:54:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255249695838208 [0;39m <==    Updates: 0
2022-08-31 17:54:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255249695838208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:54:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255270658969600 [0;39m 生成今日电子书快照开始
2022-08-31 17:54:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255270658969600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:54:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255270658969600 [0;39m ==> Parameters: 
2022-08-31 17:54:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255270658969600 [0;39m <==    Updates: 0
2022-08-31 17:54:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255270658969600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:54:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255291634683904 [0;39m 生成今日电子书快照开始
2022-08-31 17:54:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255291634683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:54:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255291634683904 [0;39m ==> Parameters: 
2022-08-31 17:54:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255291634683904 [0;39m <==    Updates: 0
2022-08-31 17:54:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255291634683904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:54:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22255291651461120 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:54:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255291651461120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:54:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255291651461120 [0;39m ==> Parameters: 
2022-08-31 17:54:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255291651461120 [0;39m <==    Updates: 8
2022-08-31 17:54:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22255291651461120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:54:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255312589426688 [0;39m 生成今日电子书快照开始
2022-08-31 17:54:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255312589426688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:54:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255312589426688 [0;39m ==> Parameters: 
2022-08-31 17:54:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255312589426688 [0;39m <==    Updates: 0
2022-08-31 17:54:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255312589426688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:54:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255333569335296 [0;39m 生成今日电子书快照开始
2022-08-31 17:54:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255333569335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:54:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255333569335296 [0;39m ==> Parameters: 
2022-08-31 17:54:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255333569335296 [0;39m <==    Updates: 0
2022-08-31 17:54:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255333569335296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:54:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255354528272384 [0;39m 生成今日电子书快照开始
2022-08-31 17:54:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255354528272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:54:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255354528272384 [0;39m ==> Parameters: 
2022-08-31 17:54:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255354528272384 [0;39m <==    Updates: 0
2022-08-31 17:54:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255354528272384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:54:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255375503986688 [0;39m 生成今日电子书快照开始
2022-08-31 17:54:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255375503986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:54:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255375503986688 [0;39m ==> Parameters: 
2022-08-31 17:54:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255375503986688 [0;39m <==    Updates: 0
2022-08-31 17:54:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255375503986688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:55:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255396488089600 [0;39m 生成今日电子书快照开始
2022-08-31 17:55:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255396488089600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:55:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255396488089600 [0;39m ==> Parameters: 
2022-08-31 17:55:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255396488089600 [0;39m <==    Updates: 0
2022-08-31 17:55:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255396488089600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:55:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22255417480581120 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:55:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255417480581120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:55:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255417480581120 [0;39m ==> Parameters: 
2022-08-31 17:55:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255417480581120 [0;39m <==    Updates: 8
2022-08-31 17:55:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22255417480581120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:55:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255417488969728 [0;39m 生成今日电子书快照开始
2022-08-31 17:55:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255417488969728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:55:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255417488969728 [0;39m ==> Parameters: 
2022-08-31 17:55:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255417488969728 [0;39m <==    Updates: 0
2022-08-31 17:55:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255417488969728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:55:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255438460489728 [0;39m 生成今日电子书快照开始
2022-08-31 17:55:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255438460489728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:55:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255438460489728 [0;39m ==> Parameters: 
2022-08-31 17:55:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255438460489728 [0;39m <==    Updates: 0
2022-08-31 17:55:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255438460489728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:55:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255459377483776 [0;39m 生成今日电子书快照开始
2022-08-31 17:55:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255459377483776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:55:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255459377483776 [0;39m ==> Parameters: 
2022-08-31 17:55:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255459377483776 [0;39m <==    Updates: 0
2022-08-31 17:55:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255459377483776 [0;39m 生成今日电子书快照结束，耗时：0 毫秒
2022-08-31 17:55:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255480407724032 [0;39m 生成今日电子书快照开始
2022-08-31 17:55:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255480407724032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:55:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255480407724032 [0;39m ==> Parameters: 
2022-08-31 17:55:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255480407724032 [0;39m <==    Updates: 0
2022-08-31 17:55:20.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255480407724032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:55:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255501349883904 [0;39m 生成今日电子书快照开始
2022-08-31 17:55:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255501349883904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:55:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255501349883904 [0;39m ==> Parameters: 
2022-08-31 17:55:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255501349883904 [0;39m <==    Updates: 0
2022-08-31 17:55:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255501349883904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:55:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255522317209600 [0;39m 生成今日电子书快照开始
2022-08-31 17:55:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255522317209600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:55:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255522317209600 [0;39m ==> Parameters: 
2022-08-31 17:55:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255522317209600 [0;39m <==    Updates: 0
2022-08-31 17:55:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255522317209600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:55:35.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255543259369472 [0;39m 生成今日电子书快照开始
2022-08-31 17:55:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255543259369472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:55:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255543259369472 [0;39m ==> Parameters: 
2022-08-31 17:55:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255543259369472 [0;39m <==    Updates: 0
2022-08-31 17:55:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255543259369472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:55:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22255543271952384 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:55:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255543271952384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:55:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255543271952384 [0;39m ==> Parameters: 
2022-08-31 17:55:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255543271952384 [0;39m <==    Updates: 8
2022-08-31 17:55:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22255543271952384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:55:40.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255564226695168 [0;39m 生成今日电子书快照开始
2022-08-31 17:55:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255564226695168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:55:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255564226695168 [0;39m ==> Parameters: 
2022-08-31 17:55:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255564226695168 [0;39m <==    Updates: 0
2022-08-31 17:55:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255564226695168 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:55:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255585244352512 [0;39m 生成今日电子书快照开始
2022-08-31 17:55:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255585244352512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:55:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255585244352512 [0;39m ==> Parameters: 
2022-08-31 17:55:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255585244352512 [0;39m <==    Updates: 0
2022-08-31 17:55:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255585244352512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:55:50.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255606173929472 [0;39m 生成今日电子书快照开始
2022-08-31 17:55:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255606173929472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:55:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255606173929472 [0;39m ==> Parameters: 
2022-08-31 17:55:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255606173929472 [0;39m <==    Updates: 0
2022-08-31 17:55:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255606173929472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:55:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255627158032384 [0;39m 生成今日电子书快照开始
2022-08-31 17:55:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255627158032384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:55:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255627158032384 [0;39m ==> Parameters: 
2022-08-31 17:55:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255627158032384 [0;39m <==    Updates: 0
2022-08-31 17:55:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255627158032384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:56:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255648125358080 [0;39m 生成今日电子书快照开始
2022-08-31 17:56:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255648125358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:56:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255648125358080 [0;39m ==> Parameters: 
2022-08-31 17:56:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255648125358080 [0;39m <==    Updates: 0
2022-08-31 17:56:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255648125358080 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 17:56:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255669138821120 [0;39m 生成今日电子书快照开始
2022-08-31 17:56:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255669138821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:56:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255669138821120 [0;39m ==> Parameters: 
2022-08-31 17:56:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255669138821120 [0;39m <==    Updates: 0
2022-08-31 17:56:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255669138821120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:56:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22255669151404032 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:56:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255669151404032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:56:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255669151404032 [0;39m ==> Parameters: 
2022-08-31 17:56:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255669151404032 [0;39m <==    Updates: 8
2022-08-31 17:56:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22255669151404032 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:56:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255690064203776 [0;39m 生成今日电子书快照开始
2022-08-31 17:56:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255690064203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:56:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255690064203776 [0;39m ==> Parameters: 
2022-08-31 17:56:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255690064203776 [0;39m <==    Updates: 0
2022-08-31 17:56:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255690064203776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:56:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255711052500992 [0;39m 生成今日电子书快照开始
2022-08-31 17:56:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255711052500992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:56:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255711052500992 [0;39m ==> Parameters: 
2022-08-31 17:56:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255711052500992 [0;39m <==    Updates: 0
2022-08-31 17:56:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255711052500992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:56:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255732036603904 [0;39m 生成今日电子书快照开始
2022-08-31 17:56:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255732036603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:56:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255732036603904 [0;39m ==> Parameters: 
2022-08-31 17:56:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255732036603904 [0;39m <==    Updates: 0
2022-08-31 17:56:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255732036603904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:56:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255752978763776 [0;39m 生成今日电子书快照开始
2022-08-31 17:56:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255752978763776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:56:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255752978763776 [0;39m ==> Parameters: 
2022-08-31 17:56:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255752978763776 [0;39m <==    Updates: 0
2022-08-31 17:56:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255752978763776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:56:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255773988032512 [0;39m 生成今日电子书快照开始
2022-08-31 17:56:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255773988032512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:56:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255773988032512 [0;39m ==> Parameters: 
2022-08-31 17:56:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255773988032512 [0;39m <==    Updates: 0
2022-08-31 17:56:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255773988032512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:56:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22255794930192384 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:56:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255794930192384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:56:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255794930192384 [0;39m ==> Parameters: 
2022-08-31 17:56:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255794930192384 [0;39m <==    Updates: 8
2022-08-31 17:56:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22255794930192384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:56:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255794938580992 [0;39m 生成今日电子书快照开始
2022-08-31 17:56:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255794938580992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:56:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255794938580992 [0;39m ==> Parameters: 
2022-08-31 17:56:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255794938580992 [0;39m <==    Updates: 0
2022-08-31 17:56:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255794938580992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:56:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255815947849728 [0;39m 生成今日电子书快照开始
2022-08-31 17:56:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255815947849728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:56:40.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255815947849728 [0;39m ==> Parameters: 
2022-08-31 17:56:40.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255815947849728 [0;39m <==    Updates: 0
2022-08-31 17:56:40.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255815947849728 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-31 17:56:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255836881620992 [0;39m 生成今日电子书快照开始
2022-08-31 17:56:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255836881620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:56:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255836881620992 [0;39m ==> Parameters: 
2022-08-31 17:56:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255836881620992 [0;39m <==    Updates: 0
2022-08-31 17:56:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255836881620992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:56:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255857890889728 [0;39m 生成今日电子书快照开始
2022-08-31 17:56:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255857890889728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:56:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255857890889728 [0;39m ==> Parameters: 
2022-08-31 17:56:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255857890889728 [0;39m <==    Updates: 0
2022-08-31 17:56:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255857890889728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:56:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255878845632512 [0;39m 生成今日电子书快照开始
2022-08-31 17:56:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255878845632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:56:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255878845632512 [0;39m ==> Parameters: 
2022-08-31 17:56:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255878845632512 [0;39m <==    Updates: 0
2022-08-31 17:56:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255878845632512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:57:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255899796180992 [0;39m 生成今日电子书快照开始
2022-08-31 17:57:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255899796180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:57:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255899796180992 [0;39m ==> Parameters: 
2022-08-31 17:57:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255899796180992 [0;39m <==    Updates: 0
2022-08-31 17:57:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255899796180992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:57:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22255920771895296 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:57:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255920771895296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:57:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255920771895296 [0;39m ==> Parameters: 
2022-08-31 17:57:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22255920771895296 [0;39m <==    Updates: 8
2022-08-31 17:57:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22255920771895296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 17:57:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255920780283904 [0;39m 生成今日电子书快照开始
2022-08-31 17:57:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255920780283904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:57:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255920780283904 [0;39m ==> Parameters: 
2022-08-31 17:57:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255920780283904 [0;39m <==    Updates: 0
2022-08-31 17:57:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255920780283904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:57:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255941760192512 [0;39m 生成今日电子书快照开始
2022-08-31 17:57:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255941760192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:57:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255941760192512 [0;39m ==> Parameters: 
2022-08-31 17:57:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255941760192512 [0;39m <==    Updates: 0
2022-08-31 17:57:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255941760192512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:57:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255962710740992 [0;39m 生成今日电子书快照开始
2022-08-31 17:57:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255962710740992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:57:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255962710740992 [0;39m ==> Parameters: 
2022-08-31 17:57:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255962710740992 [0;39m <==    Updates: 0
2022-08-31 17:57:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255962710740992 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-31 17:57:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22255983661289472 [0;39m 生成今日电子书快照开始
2022-08-31 17:57:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255983661289472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:57:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255983661289472 [0;39m ==> Parameters: 
2022-08-31 17:57:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22255983661289472 [0;39m <==    Updates: 0
2022-08-31 17:57:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22255983661289472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:57:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256004637003776 [0;39m 生成今日电子书快照开始
2022-08-31 17:57:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256004637003776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:57:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256004637003776 [0;39m ==> Parameters: 
2022-08-31 17:57:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256004637003776 [0;39m <==    Updates: 0
2022-08-31 17:57:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256004637003776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:57:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256025612718080 [0;39m 生成今日电子书快照开始
2022-08-31 17:57:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256025612718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:57:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256025612718080 [0;39m ==> Parameters: 
2022-08-31 17:57:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256025612718080 [0;39m <==    Updates: 0
2022-08-31 17:57:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256025612718080 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-31 17:57:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256046626181120 [0;39m 生成今日电子书快照开始
2022-08-31 17:57:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256046626181120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:57:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256046626181120 [0;39m ==> Parameters: 
2022-08-31 17:57:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256046626181120 [0;39m <==    Updates: 0
2022-08-31 17:57:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256046626181120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:57:35.017 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22256046642958336 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:57:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256046642958336 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:57:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256046642958336 [0;39m ==> Parameters: 
2022-08-31 17:57:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256046642958336 [0;39m <==    Updates: 8
2022-08-31 17:57:35.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22256046642958336 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:57:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256067580923904 [0;39m 生成今日电子书快照开始
2022-08-31 17:57:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256067580923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:57:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256067580923904 [0;39m ==> Parameters: 
2022-08-31 17:57:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256067580923904 [0;39m <==    Updates: 0
2022-08-31 17:57:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256067580923904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:57:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256088573415424 [0;39m 生成今日电子书快照开始
2022-08-31 17:57:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256088573415424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:57:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256088573415424 [0;39m ==> Parameters: 
2022-08-31 17:57:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256088573415424 [0;39m <==    Updates: 0
2022-08-31 17:57:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256088573415424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:57:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256109536546816 [0;39m 生成今日电子书快照开始
2022-08-31 17:57:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256109536546816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:57:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256109536546816 [0;39m ==> Parameters: 
2022-08-31 17:57:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256109536546816 [0;39m <==    Updates: 0
2022-08-31 17:57:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256109536546816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:57:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256130508066816 [0;39m 生成今日电子书快照开始
2022-08-31 17:57:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256130508066816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:57:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256130508066816 [0;39m ==> Parameters: 
2022-08-31 17:57:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256130508066816 [0;39m <==    Updates: 0
2022-08-31 17:57:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256130508066816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:58:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256151437643776 [0;39m 生成今日电子书快照开始
2022-08-31 17:58:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256151437643776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:58:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256151437643776 [0;39m ==> Parameters: 
2022-08-31 17:58:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256151437643776 [0;39m <==    Updates: 0
2022-08-31 17:58:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256151437643776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:58:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256172438523904 [0;39m 生成今日电子书快照开始
2022-08-31 17:58:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256172438523904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:58:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256172438523904 [0;39m ==> Parameters: 
2022-08-31 17:58:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256172438523904 [0;39m <==    Updates: 0
2022-08-31 17:58:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256172438523904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:58:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22256172446912512 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:58:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256172446912512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:58:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256172446912512 [0;39m ==> Parameters: 
2022-08-31 17:58:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256172446912512 [0;39m <==    Updates: 8
2022-08-31 17:58:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22256172446912512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:58:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256193414238208 [0;39m 生成今日电子书快照开始
2022-08-31 17:58:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256193414238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:58:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256193414238208 [0;39m ==> Parameters: 
2022-08-31 17:58:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256193414238208 [0;39m <==    Updates: 0
2022-08-31 17:58:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256193414238208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 17:58:15.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256214343815168 [0;39m 生成今日电子书快照开始
2022-08-31 17:58:15.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256214343815168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:58:15.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256214343815168 [0;39m ==> Parameters: 
2022-08-31 17:58:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256214343815168 [0;39m <==    Updates: 0
2022-08-31 17:58:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256214343815168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:58:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256235378249728 [0;39m 生成今日电子书快照开始
2022-08-31 17:58:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256235378249728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:58:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256235378249728 [0;39m ==> Parameters: 
2022-08-31 17:58:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256235378249728 [0;39m <==    Updates: 0
2022-08-31 17:58:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256235378249728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:58:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256256295243776 [0;39m 生成今日电子书快照开始
2022-08-31 17:58:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256256295243776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:58:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256256295243776 [0;39m ==> Parameters: 
2022-08-31 17:58:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256256295243776 [0;39m <==    Updates: 0
2022-08-31 17:58:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256256295243776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:58:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256277266763776 [0;39m 生成今日电子书快照开始
2022-08-31 17:58:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256277266763776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:58:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256277266763776 [0;39m ==> Parameters: 
2022-08-31 17:58:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256277266763776 [0;39m <==    Updates: 0
2022-08-31 17:58:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256277266763776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:58:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256298242478080 [0;39m 生成今日电子书快照开始
2022-08-31 17:58:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256298242478080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:58:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256298242478080 [0;39m ==> Parameters: 
2022-08-31 17:58:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256298242478080 [0;39m <==    Updates: 0
2022-08-31 17:58:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256298242478080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:58:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22256298259255296 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:58:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256298259255296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:58:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256298259255296 [0;39m ==> Parameters: 
2022-08-31 17:58:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256298259255296 [0;39m <==    Updates: 8
2022-08-31 17:58:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22256298259255296 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:58:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256319251746816 [0;39m 生成今日电子书快照开始
2022-08-31 17:58:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256319251746816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:58:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256319251746816 [0;39m ==> Parameters: 
2022-08-31 17:58:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256319251746816 [0;39m <==    Updates: 0
2022-08-31 17:58:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256319251746816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:58:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256340223266816 [0;39m 生成今日电子书快照开始
2022-08-31 17:58:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256340223266816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:58:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256340223266816 [0;39m ==> Parameters: 
2022-08-31 17:58:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256340223266816 [0;39m <==    Updates: 0
2022-08-31 17:58:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256340223266816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:58:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256361190592512 [0;39m 生成今日电子书快照开始
2022-08-31 17:58:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256361190592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:58:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256361190592512 [0;39m ==> Parameters: 
2022-08-31 17:58:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256361190592512 [0;39m <==    Updates: 0
2022-08-31 17:58:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256361190592512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:58:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256382141140992 [0;39m 生成今日电子书快照开始
2022-08-31 17:58:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256382141140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:58:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256382141140992 [0;39m ==> Parameters: 
2022-08-31 17:58:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256382141140992 [0;39m <==    Updates: 0
2022-08-31 17:58:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256382141140992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:59:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256403146215424 [0;39m 生成今日电子书快照开始
2022-08-31 17:59:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256403146215424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:59:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256403146215424 [0;39m ==> Parameters: 
2022-08-31 17:59:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256403146215424 [0;39m <==    Updates: 0
2022-08-31 17:59:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256403146215424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:59:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256424113541120 [0;39m 生成今日电子书快照开始
2022-08-31 17:59:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256424113541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:59:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256424113541120 [0;39m ==> Parameters: 
2022-08-31 17:59:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256424113541120 [0;39m <==    Updates: 0
2022-08-31 17:59:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256424113541120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:59:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22256424121929728 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:59:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256424121929728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:59:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256424121929728 [0;39m ==> Parameters: 
2022-08-31 17:59:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256424121929728 [0;39m <==    Updates: 8
2022-08-31 17:59:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22256424121929728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 17:59:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256445093449728 [0;39m 生成今日电子书快照开始
2022-08-31 17:59:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256445093449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:59:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256445093449728 [0;39m ==> Parameters: 
2022-08-31 17:59:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256445093449728 [0;39m <==    Updates: 0
2022-08-31 17:59:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256445093449728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:59:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256466035609600 [0;39m 生成今日电子书快照开始
2022-08-31 17:59:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256466035609600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:59:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256466035609600 [0;39m ==> Parameters: 
2022-08-31 17:59:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256466035609600 [0;39m <==    Updates: 0
2022-08-31 17:59:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256466035609600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:59:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256487036489728 [0;39m 生成今日电子书快照开始
2022-08-31 17:59:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256487036489728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:59:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256487036489728 [0;39m ==> Parameters: 
2022-08-31 17:59:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256487036489728 [0;39m <==    Updates: 0
2022-08-31 17:59:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256487036489728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:59:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256507974455296 [0;39m 生成今日电子书快照开始
2022-08-31 17:59:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256507974455296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:59:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256507974455296 [0;39m ==> Parameters: 
2022-08-31 17:59:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256507974455296 [0;39m <==    Updates: 0
2022-08-31 17:59:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256507974455296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:59:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256528929198080 [0;39m 生成今日电子书快照开始
2022-08-31 17:59:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256528929198080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:59:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256528929198080 [0;39m ==> Parameters: 
2022-08-31 17:59:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256528929198080 [0;39m <==    Updates: 0
2022-08-31 17:59:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256528929198080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 17:59:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22256549913300992 [0;39m 更新电子书下的文档数据开始
2022-08-31 17:59:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256549913300992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 17:59:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256549913300992 [0;39m ==> Parameters: 
2022-08-31 17:59:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256549913300992 [0;39m <==    Updates: 8
2022-08-31 17:59:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22256549913300992 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-31 17:59:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256549925883904 [0;39m 生成今日电子书快照开始
2022-08-31 17:59:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256549925883904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:59:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256549925883904 [0;39m ==> Parameters: 
2022-08-31 17:59:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256549925883904 [0;39m <==    Updates: 0
2022-08-31 17:59:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256549925883904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:59:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256570868043776 [0;39m 生成今日电子书快照开始
2022-08-31 17:59:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256570868043776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:59:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256570868043776 [0;39m ==> Parameters: 
2022-08-31 17:59:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256570868043776 [0;39m <==    Updates: 0
2022-08-31 17:59:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256570868043776 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 17:59:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256591898284032 [0;39m 生成今日电子书快照开始
2022-08-31 17:59:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256591898284032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:59:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256591898284032 [0;39m ==> Parameters: 
2022-08-31 17:59:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256591898284032 [0;39m <==    Updates: 0
2022-08-31 17:59:45.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256591898284032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 17:59:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256612832055296 [0;39m 生成今日电子书快照开始
2022-08-31 17:59:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256612832055296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:59:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256612832055296 [0;39m ==> Parameters: 
2022-08-31 17:59:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256612832055296 [0;39m <==    Updates: 0
2022-08-31 17:59:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256612832055296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 17:59:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256633803575296 [0;39m 生成今日电子书快照开始
2022-08-31 17:59:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256633803575296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 17:59:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256633803575296 [0;39m ==> Parameters: 
2022-08-31 17:59:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256633803575296 [0;39m <==    Updates: 0
2022-08-31 17:59:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256633803575296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:00:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256654787678208 [0;39m 生成今日电子书快照开始
2022-08-31 18:00:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256654787678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:00:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256654787678208 [0;39m ==> Parameters: 
2022-08-31 18:00:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256654787678208 [0;39m <==    Updates: 0
2022-08-31 18:00:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256654787678208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:00:05.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256675721449472 [0;39m 生成今日电子书快照开始
2022-08-31 18:00:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256675721449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:00:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256675721449472 [0;39m ==> Parameters: 
2022-08-31 18:00:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256675721449472 [0;39m <==    Updates: 0
2022-08-31 18:00:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256675721449472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:00:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22256675734032384 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:00:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256675734032384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:00:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256675734032384 [0;39m ==> Parameters: 
2022-08-31 18:00:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256675734032384 [0;39m <==    Updates: 8
2022-08-31 18:00:05.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22256675734032384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:00:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256696739106816 [0;39m 生成今日电子书快照开始
2022-08-31 18:00:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256696739106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:00:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256696739106816 [0;39m ==> Parameters: 
2022-08-31 18:00:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256696739106816 [0;39m <==    Updates: 0
2022-08-31 18:00:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256696739106816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:00:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256717719015424 [0;39m 生成今日电子书快照开始
2022-08-31 18:00:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256717719015424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:00:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256717719015424 [0;39m ==> Parameters: 
2022-08-31 18:00:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256717719015424 [0;39m <==    Updates: 0
2022-08-31 18:00:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256717719015424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:00:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256738694729728 [0;39m 生成今日电子书快照开始
2022-08-31 18:00:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256738694729728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:00:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256738694729728 [0;39m ==> Parameters: 
2022-08-31 18:00:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256738694729728 [0;39m <==    Updates: 0
2022-08-31 18:00:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256738694729728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:00:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256759624306688 [0;39m 生成今日电子书快照开始
2022-08-31 18:00:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256759624306688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:00:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256759624306688 [0;39m ==> Parameters: 
2022-08-31 18:00:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256759624306688 [0;39m <==    Updates: 0
2022-08-31 18:00:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256759624306688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:00:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256780600020992 [0;39m 生成今日电子书快照开始
2022-08-31 18:00:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256780600020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:00:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256780600020992 [0;39m ==> Parameters: 
2022-08-31 18:00:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256780600020992 [0;39m <==    Updates: 0
2022-08-31 18:00:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256780600020992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:00:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256801567346688 [0;39m 生成今日电子书快照开始
2022-08-31 18:00:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256801567346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:00:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256801567346688 [0;39m ==> Parameters: 
2022-08-31 18:00:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256801567346688 [0;39m <==    Updates: 0
2022-08-31 18:00:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256801567346688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 18:00:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22256801575735296 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:00:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256801575735296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:00:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256801575735296 [0;39m ==> Parameters: 
2022-08-31 18:00:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256801575735296 [0;39m <==    Updates: 8
2022-08-31 18:00:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22256801575735296 [0;39m 更新电子书下的文档数据结束，耗时：0 毫秒
2022-08-31 18:00:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256822555643904 [0;39m 生成今日电子书快照开始
2022-08-31 18:00:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256822555643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:00:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256822555643904 [0;39m ==> Parameters: 
2022-08-31 18:00:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256822555643904 [0;39m <==    Updates: 0
2022-08-31 18:00:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256822555643904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:00:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256843522969600 [0;39m 生成今日电子书快照开始
2022-08-31 18:00:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256843522969600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:00:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256843522969600 [0;39m ==> Parameters: 
2022-08-31 18:00:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256843522969600 [0;39m <==    Updates: 0
2022-08-31 18:00:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256843522969600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:00:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256864481906688 [0;39m 生成今日电子书快照开始
2022-08-31 18:00:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256864481906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:00:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256864481906688 [0;39m ==> Parameters: 
2022-08-31 18:00:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256864481906688 [0;39m <==    Updates: 0
2022-08-31 18:00:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256864481906688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:00:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256885486981120 [0;39m 生成今日电子书快照开始
2022-08-31 18:00:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256885486981120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:00:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256885486981120 [0;39m ==> Parameters: 
2022-08-31 18:00:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256885486981120 [0;39m <==    Updates: 0
2022-08-31 18:00:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256885486981120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:01:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256906420752384 [0;39m 生成今日电子书快照开始
2022-08-31 18:01:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256906420752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:01:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256906420752384 [0;39m ==> Parameters: 
2022-08-31 18:01:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256906420752384 [0;39m <==    Updates: 0
2022-08-31 18:01:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256906420752384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:01:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22256927434215424 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:01:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256927434215424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:01:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256927434215424 [0;39m ==> Parameters: 
2022-08-31 18:01:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22256927434215424 [0;39m <==    Updates: 8
2022-08-31 18:01:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22256927434215424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:01:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256927438409728 [0;39m 生成今日电子书快照开始
2022-08-31 18:01:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256927438409728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:01:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256927438409728 [0;39m ==> Parameters: 
2022-08-31 18:01:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256927438409728 [0;39m <==    Updates: 0
2022-08-31 18:01:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256927438409728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:01:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256948409929728 [0;39m 生成今日电子书快照开始
2022-08-31 18:01:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256948409929728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:01:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256948409929728 [0;39m ==> Parameters: 
2022-08-31 18:01:10.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256948409929728 [0;39m <==    Updates: 0
2022-08-31 18:01:10.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256948409929728 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 18:01:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256969339506688 [0;39m 生成今日电子书快照开始
2022-08-31 18:01:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256969339506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:01:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256969339506688 [0;39m ==> Parameters: 
2022-08-31 18:01:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256969339506688 [0;39m <==    Updates: 0
2022-08-31 18:01:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256969339506688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:01:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22256990348775424 [0;39m 生成今日电子书快照开始
2022-08-31 18:01:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256990348775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:01:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256990348775424 [0;39m ==> Parameters: 
2022-08-31 18:01:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22256990348775424 [0;39m <==    Updates: 0
2022-08-31 18:01:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22256990348775424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:01:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257011307712512 [0;39m 生成今日电子书快照开始
2022-08-31 18:01:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257011307712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:01:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257011307712512 [0;39m ==> Parameters: 
2022-08-31 18:01:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257011307712512 [0;39m <==    Updates: 0
2022-08-31 18:01:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257011307712512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 18:01:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257032237289472 [0;39m 生成今日电子书快照开始
2022-08-31 18:01:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257032237289472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:01:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257032237289472 [0;39m ==> Parameters: 
2022-08-31 18:01:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257032237289472 [0;39m <==    Updates: 0
2022-08-31 18:01:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257032237289472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:01:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257053242363904 [0;39m 生成今日电子书快照开始
2022-08-31 18:01:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257053242363904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:01:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257053242363904 [0;39m ==> Parameters: 
2022-08-31 18:01:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257053242363904 [0;39m <==    Updates: 0
2022-08-31 18:01:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257053242363904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:01:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22257053250752512 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:01:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257053250752512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:01:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257053250752512 [0;39m ==> Parameters: 
2022-08-31 18:01:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257053250752512 [0;39m <==    Updates: 8
2022-08-31 18:01:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22257053250752512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:01:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257074188718080 [0;39m 生成今日电子书快照开始
2022-08-31 18:01:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257074188718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:01:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257074188718080 [0;39m ==> Parameters: 
2022-08-31 18:01:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257074188718080 [0;39m <==    Updates: 0
2022-08-31 18:01:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257074188718080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:01:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257095185403904 [0;39m 生成今日电子书快照开始
2022-08-31 18:01:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257095185403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:01:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257095185403904 [0;39m ==> Parameters: 
2022-08-31 18:01:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257095185403904 [0;39m <==    Updates: 0
2022-08-31 18:01:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257095185403904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:01:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257116169506816 [0;39m 生成今日电子书快照开始
2022-08-31 18:01:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257116169506816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:01:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257116169506816 [0;39m ==> Parameters: 
2022-08-31 18:01:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257116169506816 [0;39m <==    Updates: 0
2022-08-31 18:01:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257116169506816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:01:55.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257137094889472 [0;39m 生成今日电子书快照开始
2022-08-31 18:01:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257137094889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:01:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257137094889472 [0;39m ==> Parameters: 
2022-08-31 18:01:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257137094889472 [0;39m <==    Updates: 0
2022-08-31 18:01:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257137094889472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:02:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257158070603776 [0;39m 生成今日电子书快照开始
2022-08-31 18:02:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257158070603776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:02:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257158070603776 [0;39m ==> Parameters: 
2022-08-31 18:02:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257158070603776 [0;39m <==    Updates: 0
2022-08-31 18:02:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257158070603776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:02:05.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22257179042123776 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:02:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257179042123776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:02:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257179042123776 [0;39m ==> Parameters: 
2022-08-31 18:02:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257179042123776 [0;39m <==    Updates: 8
2022-08-31 18:02:05.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22257179042123776 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:02:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257179050512384 [0;39m 生成今日电子书快照开始
2022-08-31 18:02:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257179050512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:02:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257179050512384 [0;39m ==> Parameters: 
2022-08-31 18:02:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257179050512384 [0;39m <==    Updates: 0
2022-08-31 18:02:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257179050512384 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 18:02:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257200038809600 [0;39m 生成今日电子书快照开始
2022-08-31 18:02:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257200038809600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:02:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257200038809600 [0;39m ==> Parameters: 
2022-08-31 18:02:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257200038809600 [0;39m <==    Updates: 0
2022-08-31 18:02:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257200038809600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:02:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257221039689728 [0;39m 生成今日电子书快照开始
2022-08-31 18:02:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257221039689728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:02:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257221039689728 [0;39m ==> Parameters: 
2022-08-31 18:02:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257221039689728 [0;39m <==    Updates: 0
2022-08-31 18:02:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257221039689728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:02:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257241986043904 [0;39m 生成今日电子书快照开始
2022-08-31 18:02:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257241986043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:02:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257241986043904 [0;39m ==> Parameters: 
2022-08-31 18:02:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257241986043904 [0;39m <==    Updates: 0
2022-08-31 18:02:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257241986043904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:02:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257262924009472 [0;39m 生成今日电子书快照开始
2022-08-31 18:02:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257262924009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:02:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257262924009472 [0;39m ==> Parameters: 
2022-08-31 18:02:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257262924009472 [0;39m <==    Updates: 0
2022-08-31 18:02:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257262924009472 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-31 18:02:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257283941666816 [0;39m 生成今日电子书快照开始
2022-08-31 18:02:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257283941666816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:02:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257283941666816 [0;39m ==> Parameters: 
2022-08-31 18:02:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257283941666816 [0;39m <==    Updates: 0
2022-08-31 18:02:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257283941666816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:02:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257304888020992 [0;39m 生成今日电子书快照开始
2022-08-31 18:02:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257304888020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:02:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257304888020992 [0;39m ==> Parameters: 
2022-08-31 18:02:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257304888020992 [0;39m <==    Updates: 0
2022-08-31 18:02:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257304888020992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:02:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22257304908992512 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:02:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257304908992512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:02:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257304908992512 [0;39m ==> Parameters: 
2022-08-31 18:02:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257304908992512 [0;39m <==    Updates: 8
2022-08-31 18:02:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22257304908992512 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-31 18:02:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257325855346688 [0;39m 生成今日电子书快照开始
2022-08-31 18:02:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257325855346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:02:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257325855346688 [0;39m ==> Parameters: 
2022-08-31 18:02:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257325855346688 [0;39m <==    Updates: 0
2022-08-31 18:02:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257325855346688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:02:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257346835255296 [0;39m 生成今日电子书快照开始
2022-08-31 18:02:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257346835255296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:02:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257346835255296 [0;39m ==> Parameters: 
2022-08-31 18:02:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257346835255296 [0;39m <==    Updates: 0
2022-08-31 18:02:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257346835255296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:02:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257367827746816 [0;39m 生成今日电子书快照开始
2022-08-31 18:02:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257367827746816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:02:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257367827746816 [0;39m ==> Parameters: 
2022-08-31 18:02:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257367827746816 [0;39m <==    Updates: 0
2022-08-31 18:02:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257367827746816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:02:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257388795072512 [0;39m 生成今日电子书快照开始
2022-08-31 18:02:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257388795072512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:02:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257388795072512 [0;39m ==> Parameters: 
2022-08-31 18:02:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257388795072512 [0;39m <==    Updates: 0
2022-08-31 18:02:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257388795072512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:03:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257409724649472 [0;39m 生成今日电子书快照开始
2022-08-31 18:03:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257409724649472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:03:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257409724649472 [0;39m ==> Parameters: 
2022-08-31 18:03:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257409724649472 [0;39m <==    Updates: 0
2022-08-31 18:03:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257409724649472 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-31 18:03:05.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22257430700363776 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:03:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257430700363776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:03:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257430700363776 [0;39m ==> Parameters: 
2022-08-31 18:03:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257430700363776 [0;39m <==    Updates: 8
2022-08-31 18:03:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22257430700363776 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-31 18:03:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257430725529600 [0;39m 生成今日电子书快照开始
2022-08-31 18:03:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257430725529600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:03:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257430725529600 [0;39m ==> Parameters: 
2022-08-31 18:03:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257430725529600 [0;39m <==    Updates: 0
2022-08-31 18:03:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257430725529600 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-31 18:03:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257451705438208 [0;39m 生成今日电子书快照开始
2022-08-31 18:03:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257451705438208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:03:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257451705438208 [0;39m ==> Parameters: 
2022-08-31 18:03:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257451705438208 [0;39m <==    Updates: 0
2022-08-31 18:03:10.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257451705438208 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-31 18:03:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257472651792384 [0;39m 生成今日电子书快照开始
2022-08-31 18:03:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257472651792384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:03:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257472651792384 [0;39m ==> Parameters: 
2022-08-31 18:03:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257472651792384 [0;39m <==    Updates: 0
2022-08-31 18:03:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257472651792384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:03:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257493656866816 [0;39m 生成今日电子书快照开始
2022-08-31 18:03:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257493656866816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:03:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257493656866816 [0;39m ==> Parameters: 
2022-08-31 18:03:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257493656866816 [0;39m <==    Updates: 0
2022-08-31 18:03:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257493656866816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:03:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257514632581120 [0;39m 生成今日电子书快照开始
2022-08-31 18:03:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257514632581120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:03:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257514632581120 [0;39m ==> Parameters: 
2022-08-31 18:03:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257514632581120 [0;39m <==    Updates: 0
2022-08-31 18:03:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257514632581120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:03:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257535599906816 [0;39m 生成今日电子书快照开始
2022-08-31 18:03:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257535599906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:03:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257535599906816 [0;39m ==> Parameters: 
2022-08-31 18:03:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257535599906816 [0;39m <==    Updates: 0
2022-08-31 18:03:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257535599906816 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 18:03:35.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22257556558843904 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:03:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257556558843904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:03:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257556558843904 [0;39m ==> Parameters: 
2022-08-31 18:03:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257556558843904 [0;39m <==    Updates: 8
2022-08-31 18:03:35.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22257556558843904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 18:03:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257556567232512 [0;39m 生成今日电子书快照开始
2022-08-31 18:03:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257556567232512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:03:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257556567232512 [0;39m ==> Parameters: 
2022-08-31 18:03:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257556567232512 [0;39m <==    Updates: 0
2022-08-31 18:03:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257556567232512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:03:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257577505198080 [0;39m 生成今日电子书快照开始
2022-08-31 18:03:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257577505198080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:03:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257577505198080 [0;39m ==> Parameters: 
2022-08-31 18:03:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257577505198080 [0;39m <==    Updates: 0
2022-08-31 18:03:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257577505198080 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 18:03:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257598485106688 [0;39m 生成今日电子书快照开始
2022-08-31 18:03:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257598485106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:03:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257598485106688 [0;39m ==> Parameters: 
2022-08-31 18:03:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257598485106688 [0;39m <==    Updates: 0
2022-08-31 18:03:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257598485106688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:03:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257619444043776 [0;39m 生成今日电子书快照开始
2022-08-31 18:03:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257619444043776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:03:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257619444043776 [0;39m ==> Parameters: 
2022-08-31 18:03:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257619444043776 [0;39m <==    Updates: 0
2022-08-31 18:03:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257619444043776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:03:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257640474284032 [0;39m 生成今日电子书快照开始
2022-08-31 18:03:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257640474284032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:03:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257640474284032 [0;39m ==> Parameters: 
2022-08-31 18:03:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257640474284032 [0;39m <==    Updates: 0
2022-08-31 18:03:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257640474284032 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 18:04:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257661445804032 [0;39m 生成今日电子书快照开始
2022-08-31 18:04:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257661445804032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:04:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257661445804032 [0;39m ==> Parameters: 
2022-08-31 18:04:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257661445804032 [0;39m <==    Updates: 0
2022-08-31 18:04:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257661445804032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:04:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257682387963904 [0;39m 生成今日电子书快照开始
2022-08-31 18:04:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257682387963904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:04:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257682387963904 [0;39m ==> Parameters: 
2022-08-31 18:04:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257682387963904 [0;39m <==    Updates: 0
2022-08-31 18:04:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257682387963904 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-31 18:04:05.017 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22257682421518336 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:04:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257682421518336 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:04:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257682421518336 [0;39m ==> Parameters: 
2022-08-31 18:04:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257682421518336 [0;39m <==    Updates: 8
2022-08-31 18:04:05.021 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22257682421518336 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-31 18:04:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257703384649728 [0;39m 生成今日电子书快照开始
2022-08-31 18:04:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257703384649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:04:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257703384649728 [0;39m ==> Parameters: 
2022-08-31 18:04:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257703384649728 [0;39m <==    Updates: 0
2022-08-31 18:04:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257703384649728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:04:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257724297449472 [0;39m 生成今日电子书快照开始
2022-08-31 18:04:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257724297449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:04:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257724297449472 [0;39m ==> Parameters: 
2022-08-31 18:04:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257724297449472 [0;39m <==    Updates: 0
2022-08-31 18:04:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257724297449472 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-31 18:04:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257745285746688 [0;39m 生成今日电子书快照开始
2022-08-31 18:04:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257745285746688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:04:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257745285746688 [0;39m ==> Parameters: 
2022-08-31 18:04:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257745285746688 [0;39m <==    Updates: 0
2022-08-31 18:04:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257745285746688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:04:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257766265655296 [0;39m 生成今日电子书快照开始
2022-08-31 18:04:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257766265655296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:04:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257766265655296 [0;39m ==> Parameters: 
2022-08-31 18:04:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257766265655296 [0;39m <==    Updates: 0
2022-08-31 18:04:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257766265655296 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 18:04:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257787228786688 [0;39m 生成今日电子书快照开始
2022-08-31 18:04:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257787228786688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:04:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257787228786688 [0;39m ==> Parameters: 
2022-08-31 18:04:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257787228786688 [0;39m <==    Updates: 0
2022-08-31 18:04:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257787228786688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:04:35.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257808183529472 [0;39m 生成今日电子书快照开始
2022-08-31 18:04:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257808183529472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:04:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257808183529472 [0;39m ==> Parameters: 
2022-08-31 18:04:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257808183529472 [0;39m <==    Updates: 0
2022-08-31 18:04:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257808183529472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:04:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22257808191918080 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:04:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257808191918080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:04:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257808191918080 [0;39m ==> Parameters: 
2022-08-31 18:04:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257808191918080 [0;39m <==    Updates: 8
2022-08-31 18:04:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22257808191918080 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 18:04:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257829192798208 [0;39m 生成今日电子书快照开始
2022-08-31 18:04:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257829192798208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:04:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257829192798208 [0;39m ==> Parameters: 
2022-08-31 18:04:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257829192798208 [0;39m <==    Updates: 0
2022-08-31 18:04:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257829192798208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:04:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257850160123904 [0;39m 生成今日电子书快照开始
2022-08-31 18:04:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257850160123904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:04:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257850160123904 [0;39m ==> Parameters: 
2022-08-31 18:04:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257850160123904 [0;39m <==    Updates: 0
2022-08-31 18:04:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257850160123904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:04:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257871106478080 [0;39m 生成今日电子书快照开始
2022-08-31 18:04:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257871106478080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:04:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257871106478080 [0;39m ==> Parameters: 
2022-08-31 18:04:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257871106478080 [0;39m <==    Updates: 0
2022-08-31 18:04:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257871106478080 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-31 18:04:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257892098969600 [0;39m 生成今日电子书快照开始
2022-08-31 18:04:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257892098969600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:04:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257892098969600 [0;39m ==> Parameters: 
2022-08-31 18:04:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257892098969600 [0;39m <==    Updates: 0
2022-08-31 18:04:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257892098969600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-31 18:05:00.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257913036935168 [0;39m 生成今日电子书快照开始
2022-08-31 18:05:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257913036935168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:05:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257913036935168 [0;39m ==> Parameters: 
2022-08-31 18:05:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257913036935168 [0;39m <==    Updates: 0
2022-08-31 18:05:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257913036935168 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-31 18:05:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257934042009600 [0;39m 生成今日电子书快照开始
2022-08-31 18:05:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257934042009600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:05:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257934042009600 [0;39m ==> Parameters: 
2022-08-31 18:05:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257934042009600 [0;39m <==    Updates: 0
2022-08-31 18:05:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257934042009600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:05:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22257934054592512 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:05:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257934054592512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:05:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257934054592512 [0;39m ==> Parameters: 
2022-08-31 18:05:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22257934054592512 [0;39m <==    Updates: 8
2022-08-31 18:05:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22257934054592512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 18:05:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257954992558080 [0;39m 生成今日电子书快照开始
2022-08-31 18:05:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257954992558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:05:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257954992558080 [0;39m ==> Parameters: 
2022-08-31 18:05:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257954992558080 [0;39m <==    Updates: 0
2022-08-31 18:05:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257954992558080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:05:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257975985049600 [0;39m 生成今日电子书快照开始
2022-08-31 18:05:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257975985049600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:05:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257975985049600 [0;39m ==> Parameters: 
2022-08-31 18:05:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257975985049600 [0;39m <==    Updates: 0
2022-08-31 18:05:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257975985049600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:05:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22257996927209472 [0;39m 生成今日电子书快照开始
2022-08-31 18:05:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257996927209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:05:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257996927209472 [0;39m ==> Parameters: 
2022-08-31 18:05:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22257996927209472 [0;39m <==    Updates: 0
2022-08-31 18:05:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22257996927209472 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-31 18:05:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258017915506688 [0;39m 生成今日电子书快照开始
2022-08-31 18:05:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258017915506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:05:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258017915506688 [0;39m ==> Parameters: 
2022-08-31 18:05:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258017915506688 [0;39m <==    Updates: 0
2022-08-31 18:05:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258017915506688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:05:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258038920581120 [0;39m 生成今日电子书快照开始
2022-08-31 18:05:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258038920581120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:05:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258038920581120 [0;39m ==> Parameters: 
2022-08-31 18:05:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258038920581120 [0;39m <==    Updates: 0
2022-08-31 18:05:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258038920581120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:05:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258059854352384 [0;39m 生成今日电子书快照开始
2022-08-31 18:05:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258059854352384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:05:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258059854352384 [0;39m ==> Parameters: 
2022-08-31 18:05:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258059854352384 [0;39m <==    Updates: 0
2022-08-31 18:05:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258059854352384 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-31 18:05:35.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22258059887906816 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:05:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258059887906816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:05:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258059887906816 [0;39m ==> Parameters: 
2022-08-31 18:05:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258059887906816 [0;39m <==    Updates: 8
2022-08-31 18:05:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22258059887906816 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-31 18:05:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258080834260992 [0;39m 生成今日电子书快照开始
2022-08-31 18:05:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258080834260992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:05:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258080834260992 [0;39m ==> Parameters: 
2022-08-31 18:05:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258080834260992 [0;39m <==    Updates: 0
2022-08-31 18:05:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258080834260992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:05:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258101826752512 [0;39m 生成今日电子书快照开始
2022-08-31 18:05:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258101826752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:05:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258101826752512 [0;39m ==> Parameters: 
2022-08-31 18:05:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258101826752512 [0;39m <==    Updates: 0
2022-08-31 18:05:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258101826752512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:05:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258122777300992 [0;39m 生成今日电子书快照开始
2022-08-31 18:05:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258122777300992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:05:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258122777300992 [0;39m ==> Parameters: 
2022-08-31 18:05:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258122777300992 [0;39m <==    Updates: 0
2022-08-31 18:05:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258122777300992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:05:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258143773986816 [0;39m 生成今日电子书快照开始
2022-08-31 18:05:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258143773986816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:05:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258143773986816 [0;39m ==> Parameters: 
2022-08-31 18:05:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258143773986816 [0;39m <==    Updates: 0
2022-08-31 18:05:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258143773986816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:06:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258164749701120 [0;39m 生成今日电子书快照开始
2022-08-31 18:06:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258164749701120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:06:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258164749701120 [0;39m ==> Parameters: 
2022-08-31 18:06:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258164749701120 [0;39m <==    Updates: 0
2022-08-31 18:06:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258164749701120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:06:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258185683472384 [0;39m 生成今日电子书快照开始
2022-08-31 18:06:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258185683472384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:06:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258185683472384 [0;39m ==> Parameters: 
2022-08-31 18:06:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258185683472384 [0;39m <==    Updates: 0
2022-08-31 18:06:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258185683472384 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 18:06:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22258185704443904 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:06:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258185704443904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:06:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258185704443904 [0;39m ==> Parameters: 
2022-08-31 18:06:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258185704443904 [0;39m <==    Updates: 8
2022-08-31 18:06:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22258185704443904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 18:06:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258206646603776 [0;39m 生成今日电子书快照开始
2022-08-31 18:06:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258206646603776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:06:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258206646603776 [0;39m ==> Parameters: 
2022-08-31 18:06:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258206646603776 [0;39m <==    Updates: 0
2022-08-31 18:06:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258206646603776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:06:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258227655872512 [0;39m 生成今日电子书快照开始
2022-08-31 18:06:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258227655872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:06:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258227655872512 [0;39m ==> Parameters: 
2022-08-31 18:06:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258227655872512 [0;39m <==    Updates: 0
2022-08-31 18:06:15.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258227655872512 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-31 18:06:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258248602226688 [0;39m 生成今日电子书快照开始
2022-08-31 18:06:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258248602226688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:06:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258248602226688 [0;39m ==> Parameters: 
2022-08-31 18:06:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258248602226688 [0;39m <==    Updates: 0
2022-08-31 18:06:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258248602226688 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-31 18:06:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258269556969472 [0;39m 生成今日电子书快照开始
2022-08-31 18:06:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258269556969472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:06:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258269556969472 [0;39m ==> Parameters: 
2022-08-31 18:06:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258269556969472 [0;39m <==    Updates: 0
2022-08-31 18:06:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258269556969472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:06:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258290566238208 [0;39m 生成今日电子书快照开始
2022-08-31 18:06:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258290566238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:06:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258290566238208 [0;39m ==> Parameters: 
2022-08-31 18:06:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258290566238208 [0;39m <==    Updates: 0
2022-08-31 18:06:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258290566238208 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-31 18:06:35.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22258311500009472 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:06:35.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258311500009472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:06:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258311500009472 [0;39m ==> Parameters: 
2022-08-31 18:06:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258311500009472 [0;39m <==    Updates: 8
2022-08-31 18:06:35.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22258311500009472 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 18:06:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258311508398080 [0;39m 生成今日电子书快照开始
2022-08-31 18:06:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258311508398080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:06:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258311508398080 [0;39m ==> Parameters: 
2022-08-31 18:06:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258311508398080 [0;39m <==    Updates: 0
2022-08-31 18:06:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258311508398080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:06:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258332500889600 [0;39m 生成今日电子书快照开始
2022-08-31 18:06:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258332500889600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:06:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258332500889600 [0;39m ==> Parameters: 
2022-08-31 18:06:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258332500889600 [0;39m <==    Updates: 0
2022-08-31 18:06:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258332500889600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:06:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258353476603904 [0;39m 生成今日电子书快照开始
2022-08-31 18:06:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258353476603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:06:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258353476603904 [0;39m ==> Parameters: 
2022-08-31 18:06:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258353476603904 [0;39m <==    Updates: 0
2022-08-31 18:06:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258353476603904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:06:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258374427152384 [0;39m 生成今日电子书快照开始
2022-08-31 18:06:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258374427152384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:06:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258374427152384 [0;39m ==> Parameters: 
2022-08-31 18:06:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258374427152384 [0;39m <==    Updates: 0
2022-08-31 18:06:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258374427152384 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-31 18:06:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258395390283776 [0;39m 生成今日电子书快照开始
2022-08-31 18:06:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258395390283776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:06:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258395390283776 [0;39m ==> Parameters: 
2022-08-31 18:06:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258395390283776 [0;39m <==    Updates: 0
2022-08-31 18:06:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258395390283776 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-31 18:07:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258416391163904 [0;39m 生成今日电子书快照开始
2022-08-31 18:07:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258416391163904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:07:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258416391163904 [0;39m ==> Parameters: 
2022-08-31 18:07:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258416391163904 [0;39m <==    Updates: 0
2022-08-31 18:07:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258416391163904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:07:05.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22258437337518080 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:07:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258437337518080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:07:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258437337518080 [0;39m ==> Parameters: 
2022-08-31 18:07:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258437337518080 [0;39m <==    Updates: 8
2022-08-31 18:07:05.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22258437337518080 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 18:07:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258437345906688 [0;39m 生成今日电子书快照开始
2022-08-31 18:07:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258437345906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:07:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258437345906688 [0;39m ==> Parameters: 
2022-08-31 18:07:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258437345906688 [0;39m <==    Updates: 0
2022-08-31 18:07:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258437345906688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:07:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258458304843776 [0;39m 生成今日电子书快照开始
2022-08-31 18:07:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258458304843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:07:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258458304843776 [0;39m ==> Parameters: 
2022-08-31 18:07:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258458304843776 [0;39m <==    Updates: 0
2022-08-31 18:07:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258458304843776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:07:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258479276363776 [0;39m 生成今日电子书快照开始
2022-08-31 18:07:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258479276363776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:07:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258479276363776 [0;39m ==> Parameters: 
2022-08-31 18:07:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258479276363776 [0;39m <==    Updates: 0
2022-08-31 18:07:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258479276363776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:07:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258500302409728 [0;39m 生成今日电子书快照开始
2022-08-31 18:07:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258500302409728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:07:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258500302409728 [0;39m ==> Parameters: 
2022-08-31 18:07:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258500302409728 [0;39m <==    Updates: 0
2022-08-31 18:07:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258500302409728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:07:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258521257152512 [0;39m 生成今日电子书快照开始
2022-08-31 18:07:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258521257152512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:07:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258521257152512 [0;39m ==> Parameters: 
2022-08-31 18:07:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258521257152512 [0;39m <==    Updates: 0
2022-08-31 18:07:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258521257152512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:07:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258542220283904 [0;39m 生成今日电子书快照开始
2022-08-31 18:07:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258542220283904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:07:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258542220283904 [0;39m ==> Parameters: 
2022-08-31 18:07:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258542220283904 [0;39m <==    Updates: 0
2022-08-31 18:07:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258542220283904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:07:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258563208581120 [0;39m 生成今日电子书快照开始
2022-08-31 18:07:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258563208581120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:07:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258563208581120 [0;39m ==> Parameters: 
2022-08-31 18:07:35.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258563208581120 [0;39m <==    Updates: 0
2022-08-31 18:07:35.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258563208581120 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-31 18:07:35.022 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22258563246329856 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:07:35.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258563246329856 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:07:35.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258563246329856 [0;39m ==> Parameters: 
2022-08-31 18:07:35.026 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258563246329856 [0;39m <==    Updates: 8
2022-08-31 18:07:35.026 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22258563246329856 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-31 18:07:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258584167518208 [0;39m 生成今日电子书快照开始
2022-08-31 18:07:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258584167518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:07:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258584167518208 [0;39m ==> Parameters: 
2022-08-31 18:07:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258584167518208 [0;39m <==    Updates: 0
2022-08-31 18:07:40.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258584167518208 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-31 18:07:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258605105483776 [0;39m 生成今日电子书快照开始
2022-08-31 18:07:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258605105483776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:07:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258605105483776 [0;39m ==> Parameters: 
2022-08-31 18:07:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258605105483776 [0;39m <==    Updates: 0
2022-08-31 18:07:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258605105483776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:07:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258626102169600 [0;39m 生成今日电子书快照开始
2022-08-31 18:07:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258626102169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:07:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258626102169600 [0;39m ==> Parameters: 
2022-08-31 18:07:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258626102169600 [0;39m <==    Updates: 0
2022-08-31 18:07:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258626102169600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:07:55.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258647044329472 [0;39m 生成今日电子书快照开始
2022-08-31 18:07:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258647044329472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:07:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258647044329472 [0;39m ==> Parameters: 
2022-08-31 18:07:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258647044329472 [0;39m <==    Updates: 0
2022-08-31 18:07:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258647044329472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:08:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258668020043776 [0;39m 生成今日电子书快照开始
2022-08-31 18:08:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258668020043776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:08:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258668020043776 [0;39m ==> Parameters: 
2022-08-31 18:08:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258668020043776 [0;39m <==    Updates: 0
2022-08-31 18:08:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258668020043776 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 18:08:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22258689020923904 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:08:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258689020923904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:08:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258689020923904 [0;39m ==> Parameters: 
2022-08-31 18:08:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258689020923904 [0;39m <==    Updates: 8
2022-08-31 18:08:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22258689020923904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 18:08:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258689033506816 [0;39m 生成今日电子书快照开始
2022-08-31 18:08:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258689033506816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:08:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258689033506816 [0;39m ==> Parameters: 
2022-08-31 18:08:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258689033506816 [0;39m <==    Updates: 0
2022-08-31 18:08:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258689033506816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:08:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258709996638208 [0;39m 生成今日电子书快照开始
2022-08-31 18:08:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258709996638208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:08:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258709996638208 [0;39m ==> Parameters: 
2022-08-31 18:08:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258709996638208 [0;39m <==    Updates: 0
2022-08-31 18:08:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258709996638208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:08:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258730976546816 [0;39m 生成今日电子书快照开始
2022-08-31 18:08:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258730976546816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:08:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258730976546816 [0;39m ==> Parameters: 
2022-08-31 18:08:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258730976546816 [0;39m <==    Updates: 0
2022-08-31 18:08:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258730976546816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:08:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258751935483904 [0;39m 生成今日电子书快照开始
2022-08-31 18:08:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258751935483904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:08:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258751935483904 [0;39m ==> Parameters: 
2022-08-31 18:08:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258751935483904 [0;39m <==    Updates: 0
2022-08-31 18:08:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258751935483904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:08:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258772890226688 [0;39m 生成今日电子书快照开始
2022-08-31 18:08:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258772890226688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:08:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258772890226688 [0;39m ==> Parameters: 
2022-08-31 18:08:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258772890226688 [0;39m <==    Updates: 0
2022-08-31 18:08:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258772890226688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:08:30.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258793840775168 [0;39m 生成今日电子书快照开始
2022-08-31 18:08:30.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258793840775168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:08:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258793840775168 [0;39m ==> Parameters: 
2022-08-31 18:08:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258793840775168 [0;39m <==    Updates: 0
2022-08-31 18:08:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258793840775168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:08:35.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22258814875209728 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:08:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258814875209728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:08:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258814875209728 [0;39m ==> Parameters: 
2022-08-31 18:08:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258814875209728 [0;39m <==    Updates: 8
2022-08-31 18:08:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22258814875209728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:08:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258814883598336 [0;39m 生成今日电子书快照开始
2022-08-31 18:08:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258814883598336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:08:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258814883598336 [0;39m ==> Parameters: 
2022-08-31 18:08:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258814883598336 [0;39m <==    Updates: 0
2022-08-31 18:08:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258814883598336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:08:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258835792203776 [0;39m 生成今日电子书快照开始
2022-08-31 18:08:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258835792203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:08:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258835792203776 [0;39m ==> Parameters: 
2022-08-31 18:08:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258835792203776 [0;39m <==    Updates: 0
2022-08-31 18:08:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258835792203776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:08:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258856797278208 [0;39m 生成今日电子书快照开始
2022-08-31 18:08:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258856797278208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:08:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258856797278208 [0;39m ==> Parameters: 
2022-08-31 18:08:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258856797278208 [0;39m <==    Updates: 0
2022-08-31 18:08:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258856797278208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:08:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258877739438080 [0;39m 生成今日电子书快照开始
2022-08-31 18:08:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258877739438080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:08:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258877739438080 [0;39m ==> Parameters: 
2022-08-31 18:08:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258877739438080 [0;39m <==    Updates: 0
2022-08-31 18:08:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258877739438080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:08:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258898719346688 [0;39m 生成今日电子书快照开始
2022-08-31 18:08:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258898719346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:08:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258898719346688 [0;39m ==> Parameters: 
2022-08-31 18:08:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258898719346688 [0;39m <==    Updates: 0
2022-08-31 18:08:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258898719346688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:09:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258919720226816 [0;39m 生成今日电子书快照开始
2022-08-31 18:09:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258919720226816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:09:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258919720226816 [0;39m ==> Parameters: 
2022-08-31 18:09:00.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258919720226816 [0;39m <==    Updates: 0
2022-08-31 18:09:00.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258919720226816 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-31 18:09:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22258940691746816 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:09:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258940691746816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:09:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258940691746816 [0;39m ==> Parameters: 
2022-08-31 18:09:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22258940691746816 [0;39m <==    Updates: 8
2022-08-31 18:09:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22258940691746816 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:09:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258940695941120 [0;39m 生成今日电子书快照开始
2022-08-31 18:09:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258940695941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:09:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258940695941120 [0;39m ==> Parameters: 
2022-08-31 18:09:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258940695941120 [0;39m <==    Updates: 0
2022-08-31 18:09:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258940695941120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:09:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258961621323776 [0;39m 生成今日电子书快照开始
2022-08-31 18:09:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258961621323776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:09:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258961621323776 [0;39m ==> Parameters: 
2022-08-31 18:09:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258961621323776 [0;39m <==    Updates: 0
2022-08-31 18:09:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258961621323776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:09:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22258982609620992 [0;39m 生成今日电子书快照开始
2022-08-31 18:09:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258982609620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:09:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258982609620992 [0;39m ==> Parameters: 
2022-08-31 18:09:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22258982609620992 [0;39m <==    Updates: 0
2022-08-31 18:09:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22258982609620992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:09:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259003572752384 [0;39m 生成今日电子书快照开始
2022-08-31 18:09:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259003572752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:09:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259003572752384 [0;39m ==> Parameters: 
2022-08-31 18:09:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259003572752384 [0;39m <==    Updates: 0
2022-08-31 18:09:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259003572752384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:09:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259024565243904 [0;39m 生成今日电子书快照开始
2022-08-31 18:09:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259024565243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:09:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259024565243904 [0;39m ==> Parameters: 
2022-08-31 18:09:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259024565243904 [0;39m <==    Updates: 0
2022-08-31 18:09:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259024565243904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:09:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259045503209472 [0;39m 生成今日电子书快照开始
2022-08-31 18:09:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259045503209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:09:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259045503209472 [0;39m ==> Parameters: 
2022-08-31 18:09:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259045503209472 [0;39m <==    Updates: 0
2022-08-31 18:09:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259045503209472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:09:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259066537644032 [0;39m 生成今日电子书快照开始
2022-08-31 18:09:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259066537644032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:09:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259066537644032 [0;39m ==> Parameters: 
2022-08-31 18:09:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259066537644032 [0;39m <==    Updates: 0
2022-08-31 18:09:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259066537644032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:09:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22259066546032640 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:09:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259066546032640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:09:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259066546032640 [0;39m ==> Parameters: 
2022-08-31 18:09:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259066546032640 [0;39m <==    Updates: 8
2022-08-31 18:09:35.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22259066546032640 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:09:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259087500775424 [0;39m 生成今日电子书快照开始
2022-08-31 18:09:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259087500775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:09:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259087500775424 [0;39m ==> Parameters: 
2022-08-31 18:09:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259087500775424 [0;39m <==    Updates: 0
2022-08-31 18:09:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259087500775424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:09:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259108434546688 [0;39m 生成今日电子书快照开始
2022-08-31 18:09:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259108434546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:09:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259108434546688 [0;39m ==> Parameters: 
2022-08-31 18:09:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259108434546688 [0;39m <==    Updates: 0
2022-08-31 18:09:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259108434546688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:09:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259129443815424 [0;39m 生成今日电子书快照开始
2022-08-31 18:09:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259129443815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:09:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259129443815424 [0;39m ==> Parameters: 
2022-08-31 18:09:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259129443815424 [0;39m <==    Updates: 0
2022-08-31 18:09:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259129443815424 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 18:09:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259150377586688 [0;39m 生成今日电子书快照开始
2022-08-31 18:09:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259150377586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:09:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259150377586688 [0;39m ==> Parameters: 
2022-08-31 18:09:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259150377586688 [0;39m <==    Updates: 0
2022-08-31 18:09:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259150377586688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:10:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259171340718080 [0;39m 生成今日电子书快照开始
2022-08-31 18:10:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259171340718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:10:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259171340718080 [0;39m ==> Parameters: 
2022-08-31 18:10:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259171340718080 [0;39m <==    Updates: 0
2022-08-31 18:10:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259171340718080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:10:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259192312238080 [0;39m 生成今日电子书快照开始
2022-08-31 18:10:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259192312238080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:10:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259192312238080 [0;39m ==> Parameters: 
2022-08-31 18:10:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259192312238080 [0;39m <==    Updates: 0
2022-08-31 18:10:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259192312238080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:10:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22259192324820992 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:10:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259192324820992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:10:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259192324820992 [0;39m ==> Parameters: 
2022-08-31 18:10:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259192324820992 [0;39m <==    Updates: 8
2022-08-31 18:10:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22259192324820992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:10:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259213300535296 [0;39m 生成今日电子书快照开始
2022-08-31 18:10:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259213300535296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:10:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259213300535296 [0;39m ==> Parameters: 
2022-08-31 18:10:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259213300535296 [0;39m <==    Updates: 0
2022-08-31 18:10:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259213300535296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:10:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259234263666688 [0;39m 生成今日电子书快照开始
2022-08-31 18:10:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259234263666688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:10:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259234263666688 [0;39m ==> Parameters: 
2022-08-31 18:10:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259234263666688 [0;39m <==    Updates: 0
2022-08-31 18:10:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259234263666688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:10:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259255277129728 [0;39m 生成今日电子书快照开始
2022-08-31 18:10:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259255277129728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:10:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259255277129728 [0;39m ==> Parameters: 
2022-08-31 18:10:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259255277129728 [0;39m <==    Updates: 0
2022-08-31 18:10:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259255277129728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:10:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259276227678208 [0;39m 生成今日电子书快照开始
2022-08-31 18:10:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259276227678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:10:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259276227678208 [0;39m ==> Parameters: 
2022-08-31 18:10:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259276227678208 [0;39m <==    Updates: 0
2022-08-31 18:10:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259276227678208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:10:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259297161449472 [0;39m 生成今日电子书快照开始
2022-08-31 18:10:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259297161449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:10:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259297161449472 [0;39m ==> Parameters: 
2022-08-31 18:10:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259297161449472 [0;39m <==    Updates: 0
2022-08-31 18:10:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259297161449472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:10:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22259318158135296 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:10:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259318158135296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:10:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259318158135296 [0;39m ==> Parameters: 
2022-08-31 18:10:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259318158135296 [0;39m <==    Updates: 8
2022-08-31 18:10:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22259318158135296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 18:10:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259318166523904 [0;39m 生成今日电子书快照开始
2022-08-31 18:10:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259318166523904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:10:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259318166523904 [0;39m ==> Parameters: 
2022-08-31 18:10:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259318166523904 [0;39m <==    Updates: 0
2022-08-31 18:10:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259318166523904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:10:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259339121266688 [0;39m 生成今日电子书快照开始
2022-08-31 18:10:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259339121266688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:10:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259339121266688 [0;39m ==> Parameters: 
2022-08-31 18:10:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259339121266688 [0;39m <==    Updates: 0
2022-08-31 18:10:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259339121266688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:10:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259360096980992 [0;39m 生成今日电子书快照开始
2022-08-31 18:10:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259360096980992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:10:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259360096980992 [0;39m ==> Parameters: 
2022-08-31 18:10:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259360096980992 [0;39m <==    Updates: 0
2022-08-31 18:10:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259360096980992 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 18:10:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259381089472512 [0;39m 生成今日电子书快照开始
2022-08-31 18:10:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259381089472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:10:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259381089472512 [0;39m ==> Parameters: 
2022-08-31 18:10:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259381089472512 [0;39m <==    Updates: 0
2022-08-31 18:10:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259381089472512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:10:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259402065186816 [0;39m 生成今日电子书快照开始
2022-08-31 18:10:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259402065186816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:10:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259402065186816 [0;39m ==> Parameters: 
2022-08-31 18:10:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259402065186816 [0;39m <==    Updates: 0
2022-08-31 18:10:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259402065186816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 18:11:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259423024123904 [0;39m 生成今日电子书快照开始
2022-08-31 18:11:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259423024123904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:11:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259423024123904 [0;39m ==> Parameters: 
2022-08-31 18:11:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259423024123904 [0;39m <==    Updates: 0
2022-08-31 18:11:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259423024123904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:11:05.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22259443970478080 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:11:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259443970478080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:11:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259443970478080 [0;39m ==> Parameters: 
2022-08-31 18:11:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259443970478080 [0;39m <==    Updates: 8
2022-08-31 18:11:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22259443970478080 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-31 18:11:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259443983060992 [0;39m 生成今日电子书快照开始
2022-08-31 18:11:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259443983060992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:11:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259443983060992 [0;39m ==> Parameters: 
2022-08-31 18:11:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259443983060992 [0;39m <==    Updates: 0
2022-08-31 18:11:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259443983060992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 18:11:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259464975552512 [0;39m 生成今日电子书快照开始
2022-08-31 18:11:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259464975552512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:11:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259464975552512 [0;39m ==> Parameters: 
2022-08-31 18:11:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259464975552512 [0;39m <==    Updates: 0
2022-08-31 18:11:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259464975552512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:11:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259485917712384 [0;39m 生成今日电子书快照开始
2022-08-31 18:11:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259485917712384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:11:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259485917712384 [0;39m ==> Parameters: 
2022-08-31 18:11:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259485917712384 [0;39m <==    Updates: 0
2022-08-31 18:11:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259485917712384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:11:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259506910203904 [0;39m 生成今日电子书快照开始
2022-08-31 18:11:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259506910203904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:11:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259506910203904 [0;39m ==> Parameters: 
2022-08-31 18:11:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259506910203904 [0;39m <==    Updates: 0
2022-08-31 18:11:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259506910203904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:11:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259527890112512 [0;39m 生成今日电子书快照开始
2022-08-31 18:11:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259527890112512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:11:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259527890112512 [0;39m ==> Parameters: 
2022-08-31 18:11:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259527890112512 [0;39m <==    Updates: 0
2022-08-31 18:11:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259527890112512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:11:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259548819689472 [0;39m 生成今日电子书快照开始
2022-08-31 18:11:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259548819689472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:11:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259548819689472 [0;39m ==> Parameters: 
2022-08-31 18:11:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259548819689472 [0;39m <==    Updates: 0
2022-08-31 18:11:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259548819689472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:11:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22259569841541120 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:11:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259569841541120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:11:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259569841541120 [0;39m ==> Parameters: 
2022-08-31 18:11:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259569841541120 [0;39m <==    Updates: 8
2022-08-31 18:11:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22259569841541120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 18:11:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259569849929728 [0;39m 生成今日电子书快照开始
2022-08-31 18:11:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259569849929728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:11:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259569849929728 [0;39m ==> Parameters: 
2022-08-31 18:11:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259569849929728 [0;39m <==    Updates: 0
2022-08-31 18:11:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259569849929728 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 18:11:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259590817255424 [0;39m 生成今日电子书快照开始
2022-08-31 18:11:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259590817255424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:11:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259590817255424 [0;39m ==> Parameters: 
2022-08-31 18:11:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259590817255424 [0;39m <==    Updates: 0
2022-08-31 18:11:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259590817255424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:11:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259611771998208 [0;39m 生成今日电子书快照开始
2022-08-31 18:11:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259611771998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:11:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259611771998208 [0;39m ==> Parameters: 
2022-08-31 18:11:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259611771998208 [0;39m <==    Updates: 0
2022-08-31 18:11:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259611771998208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:11:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259632772878336 [0;39m 生成今日电子书快照开始
2022-08-31 18:11:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259632772878336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:11:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259632772878336 [0;39m ==> Parameters: 
2022-08-31 18:11:50.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259632772878336 [0;39m <==    Updates: 0
2022-08-31 18:11:50.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259632772878336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:11:55.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259653677289472 [0;39m 生成今日电子书快照开始
2022-08-31 18:11:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259653677289472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:11:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259653677289472 [0;39m ==> Parameters: 
2022-08-31 18:11:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259653677289472 [0;39m <==    Updates: 0
2022-08-31 18:11:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259653677289472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:12:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259674661392384 [0;39m 生成今日电子书快照开始
2022-08-31 18:12:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259674661392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:12:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259674661392384 [0;39m ==> Parameters: 
2022-08-31 18:12:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259674661392384 [0;39m <==    Updates: 0
2022-08-31 18:12:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259674661392384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:12:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22259695662272512 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:12:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259695662272512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:12:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259695662272512 [0;39m ==> Parameters: 
2022-08-31 18:12:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259695662272512 [0;39m <==    Updates: 8
2022-08-31 18:12:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22259695662272512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 18:12:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259695670661120 [0;39m 生成今日电子书快照开始
2022-08-31 18:12:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259695670661120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:12:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259695670661120 [0;39m ==> Parameters: 
2022-08-31 18:12:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259695670661120 [0;39m <==    Updates: 0
2022-08-31 18:12:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259695670661120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:12:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259716625403904 [0;39m 生成今日电子书快照开始
2022-08-31 18:12:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259716625403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:12:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259716625403904 [0;39m ==> Parameters: 
2022-08-31 18:12:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259716625403904 [0;39m <==    Updates: 0
2022-08-31 18:12:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259716625403904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:12:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259737626284032 [0;39m 生成今日电子书快照开始
2022-08-31 18:12:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259737626284032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:12:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259737626284032 [0;39m ==> Parameters: 
2022-08-31 18:12:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259737626284032 [0;39m <==    Updates: 0
2022-08-31 18:12:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259737626284032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:12:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259758543278080 [0;39m 生成今日电子书快照开始
2022-08-31 18:12:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259758543278080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:12:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259758543278080 [0;39m ==> Parameters: 
2022-08-31 18:12:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259758543278080 [0;39m <==    Updates: 0
2022-08-31 18:12:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259758543278080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:12:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259779506409472 [0;39m 生成今日电子书快照开始
2022-08-31 18:12:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259779506409472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:12:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259779506409472 [0;39m ==> Parameters: 
2022-08-31 18:12:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259779506409472 [0;39m <==    Updates: 0
2022-08-31 18:12:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259779506409472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:12:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259800494706688 [0;39m 生成今日电子书快照开始
2022-08-31 18:12:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259800494706688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:12:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259800494706688 [0;39m ==> Parameters: 
2022-08-31 18:12:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259800494706688 [0;39m <==    Updates: 0
2022-08-31 18:12:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259800494706688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:12:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259821491392512 [0;39m 生成今日电子书快照开始
2022-08-31 18:12:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259821491392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:12:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259821491392512 [0;39m ==> Parameters: 
2022-08-31 18:12:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259821491392512 [0;39m <==    Updates: 0
2022-08-31 18:12:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259821491392512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:12:35.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22259821508169728 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:12:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259821508169728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:12:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259821508169728 [0;39m ==> Parameters: 
2022-08-31 18:12:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259821508169728 [0;39m <==    Updates: 8
2022-08-31 18:12:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22259821508169728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:12:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259842454523904 [0;39m 生成今日电子书快照开始
2022-08-31 18:12:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259842454523904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:12:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259842454523904 [0;39m ==> Parameters: 
2022-08-31 18:12:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259842454523904 [0;39m <==    Updates: 0
2022-08-31 18:12:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259842454523904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:12:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259863438626816 [0;39m 生成今日电子书快照开始
2022-08-31 18:12:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259863438626816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:12:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259863438626816 [0;39m ==> Parameters: 
2022-08-31 18:12:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259863438626816 [0;39m <==    Updates: 0
2022-08-31 18:12:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259863438626816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:12:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259884414341120 [0;39m 生成今日电子书快照开始
2022-08-31 18:12:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259884414341120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:12:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259884414341120 [0;39m ==> Parameters: 
2022-08-31 18:12:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259884414341120 [0;39m <==    Updates: 0
2022-08-31 18:12:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259884414341120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:12:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259905339723776 [0;39m 生成今日电子书快照开始
2022-08-31 18:12:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259905339723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:12:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259905339723776 [0;39m ==> Parameters: 
2022-08-31 18:12:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259905339723776 [0;39m <==    Updates: 0
2022-08-31 18:12:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259905339723776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:13:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259926357381120 [0;39m 生成今日电子书快照开始
2022-08-31 18:13:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259926357381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:13:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259926357381120 [0;39m ==> Parameters: 
2022-08-31 18:13:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259926357381120 [0;39m <==    Updates: 0
2022-08-31 18:13:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259926357381120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:13:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259947307929600 [0;39m 生成今日电子书快照开始
2022-08-31 18:13:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259947307929600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:13:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259947307929600 [0;39m ==> Parameters: 
2022-08-31 18:13:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259947307929600 [0;39m <==    Updates: 0
2022-08-31 18:13:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259947307929600 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-31 18:13:05.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22259947349872640 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:13:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259947349872640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:13:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259947349872640 [0;39m ==> Parameters: 
2022-08-31 18:13:05.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22259947349872640 [0;39m <==    Updates: 8
2022-08-31 18:13:05.024 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22259947349872640 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-31 18:13:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259968266866688 [0;39m 生成今日电子书快照开始
2022-08-31 18:13:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259968266866688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:13:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259968266866688 [0;39m ==> Parameters: 
2022-08-31 18:13:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259968266866688 [0;39m <==    Updates: 0
2022-08-31 18:13:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259968266866688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:13:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22259989221609472 [0;39m 生成今日电子书快照开始
2022-08-31 18:13:15.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259989221609472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:13:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259989221609472 [0;39m ==> Parameters: 
2022-08-31 18:13:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22259989221609472 [0;39m <==    Updates: 0
2022-08-31 18:13:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22259989221609472 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-31 18:13:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260010230878208 [0;39m 生成今日电子书快照开始
2022-08-31 18:13:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260010230878208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:13:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260010230878208 [0;39m ==> Parameters: 
2022-08-31 18:13:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260010230878208 [0;39m <==    Updates: 0
2022-08-31 18:13:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260010230878208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:13:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260031185620992 [0;39m 生成今日电子书快照开始
2022-08-31 18:13:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260031185620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:13:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260031185620992 [0;39m ==> Parameters: 
2022-08-31 18:13:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260031185620992 [0;39m <==    Updates: 0
2022-08-31 18:13:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260031185620992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:13:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260052148752384 [0;39m 生成今日电子书快照开始
2022-08-31 18:13:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260052148752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:13:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260052148752384 [0;39m ==> Parameters: 
2022-08-31 18:13:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260052148752384 [0;39m <==    Updates: 0
2022-08-31 18:13:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260052148752384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:13:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260073153826816 [0;39m 生成今日电子书快照开始
2022-08-31 18:13:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260073153826816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:13:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260073153826816 [0;39m ==> Parameters: 
2022-08-31 18:13:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260073153826816 [0;39m <==    Updates: 0
2022-08-31 18:13:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260073153826816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:13:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22260073162215424 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:13:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260073162215424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:13:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260073162215424 [0;39m ==> Parameters: 
2022-08-31 18:13:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260073162215424 [0;39m <==    Updates: 8
2022-08-31 18:13:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22260073162215424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:13:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260094100180992 [0;39m 生成今日电子书快照开始
2022-08-31 18:13:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260094100180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:13:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260094100180992 [0;39m ==> Parameters: 
2022-08-31 18:13:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260094100180992 [0;39m <==    Updates: 0
2022-08-31 18:13:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260094100180992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:13:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260115088478208 [0;39m 生成今日电子书快照开始
2022-08-31 18:13:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260115088478208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:13:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260115088478208 [0;39m ==> Parameters: 
2022-08-31 18:13:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260115088478208 [0;39m <==    Updates: 0
2022-08-31 18:13:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260115088478208 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 18:13:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260136059998208 [0;39m 生成今日电子书快照开始
2022-08-31 18:13:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260136059998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:13:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260136059998208 [0;39m ==> Parameters: 
2022-08-31 18:13:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260136059998208 [0;39m <==    Updates: 0
2022-08-31 18:13:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260136059998208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:13:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260157018935296 [0;39m 生成今日电子书快照开始
2022-08-31 18:13:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260157018935296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:13:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260157018935296 [0;39m ==> Parameters: 
2022-08-31 18:13:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260157018935296 [0;39m <==    Updates: 0
2022-08-31 18:13:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260157018935296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:14:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260177977872384 [0;39m 生成今日电子书快照开始
2022-08-31 18:14:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260177977872384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:14:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260177977872384 [0;39m ==> Parameters: 
2022-08-31 18:14:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260177977872384 [0;39m <==    Updates: 0
2022-08-31 18:14:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260177977872384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:14:05.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260198941003776 [0;39m 生成今日电子书快照开始
2022-08-31 18:14:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260198941003776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:14:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260198941003776 [0;39m ==> Parameters: 
2022-08-31 18:14:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260198941003776 [0;39m <==    Updates: 0
2022-08-31 18:14:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260198941003776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:14:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22260198957780992 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:14:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260198957780992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:14:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260198957780992 [0;39m ==> Parameters: 
2022-08-31 18:14:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260198957780992 [0;39m <==    Updates: 8
2022-08-31 18:14:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22260198957780992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 18:14:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260219929300992 [0;39m 生成今日电子书快照开始
2022-08-31 18:14:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260219929300992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:14:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260219929300992 [0;39m ==> Parameters: 
2022-08-31 18:14:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260219929300992 [0;39m <==    Updates: 0
2022-08-31 18:14:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260219929300992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:14:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260240888238080 [0;39m 生成今日电子书快照开始
2022-08-31 18:14:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260240888238080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:14:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260240888238080 [0;39m ==> Parameters: 
2022-08-31 18:14:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260240888238080 [0;39m <==    Updates: 0
2022-08-31 18:14:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260240888238080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:14:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260261910089728 [0;39m 生成今日电子书快照开始
2022-08-31 18:14:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260261910089728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:14:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260261910089728 [0;39m ==> Parameters: 
2022-08-31 18:14:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260261910089728 [0;39m <==    Updates: 0
2022-08-31 18:14:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260261910089728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:14:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260282856443904 [0;39m 生成今日电子书快照开始
2022-08-31 18:14:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260282856443904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:14:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260282856443904 [0;39m ==> Parameters: 
2022-08-31 18:14:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260282856443904 [0;39m <==    Updates: 0
2022-08-31 18:14:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260282856443904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:14:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260303806992384 [0;39m 生成今日电子书快照开始
2022-08-31 18:14:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260303806992384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:14:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260303806992384 [0;39m ==> Parameters: 
2022-08-31 18:14:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260303806992384 [0;39m <==    Updates: 0
2022-08-31 18:14:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260303806992384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:14:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22260324791095296 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:14:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260324791095296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:14:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260324791095296 [0;39m ==> Parameters: 
2022-08-31 18:14:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260324791095296 [0;39m <==    Updates: 8
2022-08-31 18:14:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22260324791095296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 18:14:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260324799483904 [0;39m 生成今日电子书快照开始
2022-08-31 18:14:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260324799483904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:14:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260324799483904 [0;39m ==> Parameters: 
2022-08-31 18:14:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260324799483904 [0;39m <==    Updates: 0
2022-08-31 18:14:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260324799483904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:14:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260345787781120 [0;39m 生成今日电子书快照开始
2022-08-31 18:14:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260345787781120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:14:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260345787781120 [0;39m ==> Parameters: 
2022-08-31 18:14:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260345787781120 [0;39m <==    Updates: 0
2022-08-31 18:14:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260345787781120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:14:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260366767689728 [0;39m 生成今日电子书快照开始
2022-08-31 18:14:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260366767689728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:14:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260366767689728 [0;39m ==> Parameters: 
2022-08-31 18:14:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260366767689728 [0;39m <==    Updates: 0
2022-08-31 18:14:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260366767689728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:14:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260387693072384 [0;39m 生成今日电子书快照开始
2022-08-31 18:14:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260387693072384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:14:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260387693072384 [0;39m ==> Parameters: 
2022-08-31 18:14:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260387693072384 [0;39m <==    Updates: 0
2022-08-31 18:14:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260387693072384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:14:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260408656203776 [0;39m 生成今日电子书快照开始
2022-08-31 18:14:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260408656203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:14:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260408656203776 [0;39m ==> Parameters: 
2022-08-31 18:14:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260408656203776 [0;39m <==    Updates: 0
2022-08-31 18:14:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260408656203776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:15:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260429686444032 [0;39m 生成今日电子书快照开始
2022-08-31 18:15:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260429686444032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:15:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260429686444032 [0;39m ==> Parameters: 
2022-08-31 18:15:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260429686444032 [0;39m <==    Updates: 0
2022-08-31 18:15:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260429686444032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:15:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260450624409600 [0;39m 生成今日电子书快照开始
2022-08-31 18:15:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260450624409600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:15:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260450624409600 [0;39m ==> Parameters: 
2022-08-31 18:15:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260450624409600 [0;39m <==    Updates: 0
2022-08-31 18:15:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260450624409600 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 18:15:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22260450628603904 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:15:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260450628603904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:15:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260450628603904 [0;39m ==> Parameters: 
2022-08-31 18:15:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260450628603904 [0;39m <==    Updates: 8
2022-08-31 18:15:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22260450628603904 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:15:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260471612706816 [0;39m 生成今日电子书快照开始
2022-08-31 18:15:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260471612706816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:15:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260471612706816 [0;39m ==> Parameters: 
2022-08-31 18:15:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260471612706816 [0;39m <==    Updates: 0
2022-08-31 18:15:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260471612706816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:15:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260492584226816 [0;39m 生成今日电子书快照开始
2022-08-31 18:15:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260492584226816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:15:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260492584226816 [0;39m ==> Parameters: 
2022-08-31 18:15:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260492584226816 [0;39m <==    Updates: 0
2022-08-31 18:15:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260492584226816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:15:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260513526386688 [0;39m 生成今日电子书快照开始
2022-08-31 18:15:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260513526386688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:15:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260513526386688 [0;39m ==> Parameters: 
2022-08-31 18:15:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260513526386688 [0;39m <==    Updates: 0
2022-08-31 18:15:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260513526386688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:15:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260534527266816 [0;39m 生成今日电子书快照开始
2022-08-31 18:15:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260534527266816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:15:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260534527266816 [0;39m ==> Parameters: 
2022-08-31 18:15:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260534527266816 [0;39m <==    Updates: 0
2022-08-31 18:15:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260534527266816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:15:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260555502981120 [0;39m 生成今日电子书快照开始
2022-08-31 18:15:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260555502981120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:15:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260555502981120 [0;39m ==> Parameters: 
2022-08-31 18:15:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260555502981120 [0;39m <==    Updates: 0
2022-08-31 18:15:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260555502981120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:15:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260576466112512 [0;39m 生成今日电子书快照开始
2022-08-31 18:15:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260576466112512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:15:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260576466112512 [0;39m ==> Parameters: 
2022-08-31 18:15:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260576466112512 [0;39m <==    Updates: 0
2022-08-31 18:15:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260576466112512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:15:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22260576474501120 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:15:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260576474501120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:15:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260576474501120 [0;39m ==> Parameters: 
2022-08-31 18:15:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260576474501120 [0;39m <==    Updates: 8
2022-08-31 18:15:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22260576474501120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:15:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260597412466688 [0;39m 生成今日电子书快照开始
2022-08-31 18:15:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260597412466688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:15:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260597412466688 [0;39m ==> Parameters: 
2022-08-31 18:15:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260597412466688 [0;39m <==    Updates: 0
2022-08-31 18:15:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260597412466688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:15:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260618383986688 [0;39m 生成今日电子书快照开始
2022-08-31 18:15:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260618383986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:15:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260618383986688 [0;39m ==> Parameters: 
2022-08-31 18:15:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260618383986688 [0;39m <==    Updates: 0
2022-08-31 18:15:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260618383986688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:15:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260639368089600 [0;39m 生成今日电子书快照开始
2022-08-31 18:15:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260639368089600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:15:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260639368089600 [0;39m ==> Parameters: 
2022-08-31 18:15:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260639368089600 [0;39m <==    Updates: 0
2022-08-31 18:15:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260639368089600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:15:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260660339609600 [0;39m 生成今日电子书快照开始
2022-08-31 18:15:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260660339609600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:15:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260660339609600 [0;39m ==> Parameters: 
2022-08-31 18:15:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260660339609600 [0;39m <==    Updates: 0
2022-08-31 18:15:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260660339609600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:16:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260681294352384 [0;39m 生成今日电子书快照开始
2022-08-31 18:16:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260681294352384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:16:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260681294352384 [0;39m ==> Parameters: 
2022-08-31 18:16:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260681294352384 [0;39m <==    Updates: 0
2022-08-31 18:16:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260681294352384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:16:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22260702291038208 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:16:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260702291038208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:16:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260702291038208 [0;39m ==> Parameters: 
2022-08-31 18:16:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260702291038208 [0;39m <==    Updates: 8
2022-08-31 18:16:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22260702291038208 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-31 18:16:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260702307815424 [0;39m 生成今日电子书快照开始
2022-08-31 18:16:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260702307815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:16:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260702307815424 [0;39m ==> Parameters: 
2022-08-31 18:16:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260702307815424 [0;39m <==    Updates: 0
2022-08-31 18:16:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260702307815424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:16:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260723262558208 [0;39m 生成今日电子书快照开始
2022-08-31 18:16:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260723262558208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:16:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260723262558208 [0;39m ==> Parameters: 
2022-08-31 18:16:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260723262558208 [0;39m <==    Updates: 0
2022-08-31 18:16:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260723262558208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:16:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260744221495296 [0;39m 生成今日电子书快照开始
2022-08-31 18:16:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260744221495296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:16:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260744221495296 [0;39m ==> Parameters: 
2022-08-31 18:16:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260744221495296 [0;39m <==    Updates: 0
2022-08-31 18:16:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260744221495296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:16:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260765230764032 [0;39m 生成今日电子书快照开始
2022-08-31 18:16:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260765230764032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:16:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260765230764032 [0;39m ==> Parameters: 
2022-08-31 18:16:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260765230764032 [0;39m <==    Updates: 0
2022-08-31 18:16:20.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260765230764032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:16:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260786168729600 [0;39m 生成今日电子书快照开始
2022-08-31 18:16:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260786168729600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:16:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260786168729600 [0;39m ==> Parameters: 
2022-08-31 18:16:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260786168729600 [0;39m <==    Updates: 0
2022-08-31 18:16:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260786168729600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:16:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260807119278080 [0;39m 生成今日电子书快照开始
2022-08-31 18:16:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260807119278080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:16:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260807119278080 [0;39m ==> Parameters: 
2022-08-31 18:16:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260807119278080 [0;39m <==    Updates: 0
2022-08-31 18:16:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260807119278080 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-31 18:16:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260828128546816 [0;39m 生成今日电子书快照开始
2022-08-31 18:16:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260828128546816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:16:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260828128546816 [0;39m ==> Parameters: 
2022-08-31 18:16:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260828128546816 [0;39m <==    Updates: 0
2022-08-31 18:16:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260828128546816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-31 18:16:35.020 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22260828162101248 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:16:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260828162101248 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:16:35.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260828162101248 [0;39m ==> Parameters: 
2022-08-31 18:16:35.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260828162101248 [0;39m <==    Updates: 8
2022-08-31 18:16:35.024 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22260828162101248 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-31 18:16:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260849079095296 [0;39m 生成今日电子书快照开始
2022-08-31 18:16:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260849079095296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:16:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260849079095296 [0;39m ==> Parameters: 
2022-08-31 18:16:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260849079095296 [0;39m <==    Updates: 0
2022-08-31 18:16:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260849079095296 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-31 18:16:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260870054809600 [0;39m 生成今日电子书快照开始
2022-08-31 18:16:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260870054809600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:16:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260870054809600 [0;39m ==> Parameters: 
2022-08-31 18:16:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260870054809600 [0;39m <==    Updates: 0
2022-08-31 18:16:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260870054809600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:16:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260891013746688 [0;39m 生成今日电子书快照开始
2022-08-31 18:16:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260891013746688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:16:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260891013746688 [0;39m ==> Parameters: 
2022-08-31 18:16:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260891013746688 [0;39m <==    Updates: 0
2022-08-31 18:16:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260891013746688 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-31 18:16:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260912031404032 [0;39m 生成今日电子书快照开始
2022-08-31 18:16:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260912031404032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:16:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260912031404032 [0;39m ==> Parameters: 
2022-08-31 18:16:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260912031404032 [0;39m <==    Updates: 0
2022-08-31 18:16:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260912031404032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:17:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260932952592384 [0;39m 生成今日电子书快照开始
2022-08-31 18:17:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260932952592384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:17:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260932952592384 [0;39m ==> Parameters: 
2022-08-31 18:17:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260932952592384 [0;39m <==    Updates: 0
2022-08-31 18:17:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260932952592384 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 18:17:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22260953949278208 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:17:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260953949278208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:17:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260953949278208 [0;39m ==> Parameters: 
2022-08-31 18:17:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22260953949278208 [0;39m <==    Updates: 8
2022-08-31 18:17:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22260953949278208 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-31 18:17:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260953957666816 [0;39m 生成今日电子书快照开始
2022-08-31 18:17:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260953957666816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:17:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260953957666816 [0;39m ==> Parameters: 
2022-08-31 18:17:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260953957666816 [0;39m <==    Updates: 0
2022-08-31 18:17:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260953957666816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 18:17:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260974895632384 [0;39m 生成今日电子书快照开始
2022-08-31 18:17:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260974895632384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:17:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260974895632384 [0;39m ==> Parameters: 
2022-08-31 18:17:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260974895632384 [0;39m <==    Updates: 0
2022-08-31 18:17:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260974895632384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:17:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22260995896512512 [0;39m 生成今日电子书快照开始
2022-08-31 18:17:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260995896512512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:17:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260995896512512 [0;39m ==> Parameters: 
2022-08-31 18:17:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22260995896512512 [0;39m <==    Updates: 0
2022-08-31 18:17:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22260995896512512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:17:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261016859643904 [0;39m 生成今日电子书快照开始
2022-08-31 18:17:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261016859643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:17:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261016859643904 [0;39m ==> Parameters: 
2022-08-31 18:17:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261016859643904 [0;39m <==    Updates: 0
2022-08-31 18:17:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261016859643904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:17:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261037856329728 [0;39m 生成今日电子书快照开始
2022-08-31 18:17:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261037856329728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:17:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261037856329728 [0;39m ==> Parameters: 
2022-08-31 18:17:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261037856329728 [0;39m <==    Updates: 0
2022-08-31 18:17:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261037856329728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:17:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261058806878208 [0;39m 生成今日电子书快照开始
2022-08-31 18:17:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261058806878208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:17:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261058806878208 [0;39m ==> Parameters: 
2022-08-31 18:17:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261058806878208 [0;39m <==    Updates: 0
2022-08-31 18:17:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261058806878208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:17:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22261079757426688 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:17:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22261079757426688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:17:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22261079757426688 [0;39m ==> Parameters: 
2022-08-31 18:17:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22261079757426688 [0;39m <==    Updates: 8
2022-08-31 18:17:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22261079757426688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:17:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261079761620992 [0;39m 生成今日电子书快照开始
2022-08-31 18:17:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261079761620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:17:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261079761620992 [0;39m ==> Parameters: 
2022-08-31 18:17:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261079761620992 [0;39m <==    Updates: 0
2022-08-31 18:17:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261079761620992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-31 18:17:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261100733140992 [0;39m 生成今日电子书快照开始
2022-08-31 18:17:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261100733140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:17:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261100733140992 [0;39m ==> Parameters: 
2022-08-31 18:17:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261100733140992 [0;39m <==    Updates: 0
2022-08-31 18:17:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261100733140992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:17:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261121700466688 [0;39m 生成今日电子书快照开始
2022-08-31 18:17:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261121700466688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:17:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261121700466688 [0;39m ==> Parameters: 
2022-08-31 18:17:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261121700466688 [0;39m <==    Updates: 0
2022-08-31 18:17:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261121700466688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:17:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261142709735424 [0;39m 生成今日电子书快照开始
2022-08-31 18:17:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261142709735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:17:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261142709735424 [0;39m ==> Parameters: 
2022-08-31 18:17:50.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261142709735424 [0;39m <==    Updates: 0
2022-08-31 18:17:50.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261142709735424 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-31 18:17:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261163656089600 [0;39m 生成今日电子书快照开始
2022-08-31 18:17:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261163656089600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:17:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261163656089600 [0;39m ==> Parameters: 
2022-08-31 18:17:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261163656089600 [0;39m <==    Updates: 0
2022-08-31 18:17:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261163656089600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:18:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261184640192512 [0;39m 生成今日电子书快照开始
2022-08-31 18:18:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261184640192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:18:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261184640192512 [0;39m ==> Parameters: 
2022-08-31 18:18:00.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261184640192512 [0;39m <==    Updates: 0
2022-08-31 18:18:00.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261184640192512 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-31 18:18:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261205607518208 [0;39m 生成今日电子书快照开始
2022-08-31 18:18:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261205607518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:18:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261205607518208 [0;39m ==> Parameters: 
2022-08-31 18:18:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261205607518208 [0;39m <==    Updates: 0
2022-08-31 18:18:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261205607518208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:18:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22261205615906816 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:18:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22261205615906816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:18:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22261205615906816 [0;39m ==> Parameters: 
2022-08-31 18:18:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22261205615906816 [0;39m <==    Updates: 8
2022-08-31 18:18:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22261205615906816 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:18:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261226553872384 [0;39m 生成今日电子书快照开始
2022-08-31 18:18:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261226553872384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:18:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261226553872384 [0;39m ==> Parameters: 
2022-08-31 18:18:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261226553872384 [0;39m <==    Updates: 0
2022-08-31 18:18:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261226553872384 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-31 18:18:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261247525392384 [0;39m 生成今日电子书快照开始
2022-08-31 18:18:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261247525392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:18:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261247525392384 [0;39m ==> Parameters: 
2022-08-31 18:18:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261247525392384 [0;39m <==    Updates: 0
2022-08-31 18:18:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261247525392384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:18:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261268513689600 [0;39m 生成今日电子书快照开始
2022-08-31 18:18:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261268513689600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:18:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261268513689600 [0;39m ==> Parameters: 
2022-08-31 18:18:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261268513689600 [0;39m <==    Updates: 0
2022-08-31 18:18:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261268513689600 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-31 18:18:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261289455849472 [0;39m 生成今日电子书快照开始
2022-08-31 18:18:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261289455849472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:18:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261289455849472 [0;39m ==> Parameters: 
2022-08-31 18:18:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261289455849472 [0;39m <==    Updates: 0
2022-08-31 18:18:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261289455849472 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-31 18:18:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261310486089728 [0;39m 生成今日电子书快照开始
2022-08-31 18:18:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261310486089728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:18:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261310486089728 [0;39m ==> Parameters: 
2022-08-31 18:18:30.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261310486089728 [0;39m <==    Updates: 0
2022-08-31 18:18:30.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261310486089728 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-31 18:18:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261331445026816 [0;39m 生成今日电子书快照开始
2022-08-31 18:18:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261331445026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:18:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261331445026816 [0;39m ==> Parameters: 
2022-08-31 18:18:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261331445026816 [0;39m <==    Updates: 0
2022-08-31 18:18:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261331445026816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:18:35.019 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22261331474386944 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:18:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22261331474386944 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:18:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22261331474386944 [0;39m ==> Parameters: 
2022-08-31 18:18:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22261331474386944 [0;39m <==    Updates: 8
2022-08-31 18:18:35.020 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22261331474386944 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:18:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261352382992384 [0;39m 生成今日电子书快照开始
2022-08-31 18:18:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261352382992384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:18:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261352382992384 [0;39m ==> Parameters: 
2022-08-31 18:18:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261352382992384 [0;39m <==    Updates: 0
2022-08-31 18:18:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261352382992384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:18:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261373383872512 [0;39m 生成今日电子书快照开始
2022-08-31 18:18:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261373383872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:18:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261373383872512 [0;39m ==> Parameters: 
2022-08-31 18:18:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261373383872512 [0;39m <==    Updates: 0
2022-08-31 18:18:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261373383872512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:18:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261394351198208 [0;39m 生成今日电子书快照开始
2022-08-31 18:18:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261394351198208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:18:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261394351198208 [0;39m ==> Parameters: 
2022-08-31 18:18:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261394351198208 [0;39m <==    Updates: 0
2022-08-31 18:18:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261394351198208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:18:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261415297552384 [0;39m 生成今日电子书快照开始
2022-08-31 18:18:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261415297552384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:18:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261415297552384 [0;39m ==> Parameters: 
2022-08-31 18:18:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261415297552384 [0;39m <==    Updates: 0
2022-08-31 18:18:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261415297552384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:19:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261436285849600 [0;39m 生成今日电子书快照开始
2022-08-31 18:19:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261436285849600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:19:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261436285849600 [0;39m ==> Parameters: 
2022-08-31 18:19:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261436285849600 [0;39m <==    Updates: 0
2022-08-31 18:19:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261436285849600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:19:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261457261563904 [0;39m 生成今日电子书快照开始
2022-08-31 18:19:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261457261563904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:19:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261457261563904 [0;39m ==> Parameters: 
2022-08-31 18:19:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261457261563904 [0;39m <==    Updates: 0
2022-08-31 18:19:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261457261563904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-31 18:19:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22261457274146816 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:19:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22261457274146816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:19:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22261457274146816 [0;39m ==> Parameters: 
2022-08-31 18:19:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22261457274146816 [0;39m <==    Updates: 8
2022-08-31 18:19:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22261457274146816 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-31 18:19:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261478224695296 [0;39m 生成今日电子书快照开始
2022-08-31 18:19:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261478224695296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:19:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261478224695296 [0;39m ==> Parameters: 
2022-08-31 18:19:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261478224695296 [0;39m <==    Updates: 0
2022-08-31 18:19:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261478224695296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:19:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261499175243776 [0;39m 生成今日电子书快照开始
2022-08-31 18:19:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261499175243776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:19:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261499175243776 [0;39m ==> Parameters: 
2022-08-31 18:19:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261499175243776 [0;39m <==    Updates: 0
2022-08-31 18:19:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261499175243776 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-31 18:19:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261520184512512 [0;39m 生成今日电子书快照开始
2022-08-31 18:19:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261520184512512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:19:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261520184512512 [0;39m ==> Parameters: 
2022-08-31 18:19:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261520184512512 [0;39m <==    Updates: 0
2022-08-31 18:19:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261520184512512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:19:21.418 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m22251778296909824 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-31 18:19:21.419 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m22251778296909824 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-31 18:19:21.419 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m22251778296909824 [0;39m 登录校验开始，token：22249199726891008
2022-08-31 18:19:21.485 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m22251778296909824 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"22249199726891008"}
2022-08-31 18:19:21.486 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261526371110912 [0;39m ------------- 开始 -------------
2022-08-31 18:19:21.486 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261526371110912 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-31 18:19:21.487 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261526371110912 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-31 18:19:21.487 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261526371110912 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:21.487 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261526371110912 [0;39m 请求参数: [{"content":"<blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id=\"ys69d\"><br></h2><h2 id=\"ys69d\">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技\n</font></p><p><font size=\"3\">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函\n</font></p><p><font size=\"3\">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">2.&nbsp; RPC特点？</font><br></p><p><font size=\"3\">1. 简单：使用简单，建立分布式应用更容易。\n</font></p><p><font size=\"3\">2. 高效：调用过程看起来十分清晰，效率高。\n</font></p><p><font size=\"3\">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><hr><p><font size=\"5\">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size=\"3\">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp;<font color=\"#c24f4a\"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color=\"#000000\" size=\"5\">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp;<font size=\"4\"> <i style=\"background-color: rgb(139, 170, 74);\">&nbsp; Spring Cloud 是一个很好的生态来解决上面的问题！！</i></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; </font><b style=\"\"><font size=\"3\">&nbsp;</font><font size=\"4\"> 1. spring Cloud NetFlix&nbsp; </font></b><font size=\"4\">&nbsp;一站式解决方案！</font></p><p><font size=\"4\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font face=\"黑体\">&nbsp; &nbsp;</font></font><font face=\"黑体\" size=\"3\">api网关，zuul组件<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Feign通信 ---HttpClinet ---Http通信方式，同步，阻塞<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Eureka<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;熔断机制：Hystrix</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 。。。。<br></p><p><font size=\"4\"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;<font face=\"黑体\">&nbsp;API:没有，找第三方组件，或者自己实现</font></font><font face=\"黑体\" size=\"3\"><br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;通信：Duboo RPC通信<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Zookeeper</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\" face=\"黑体\">没有：借助 Hystrix</font><font face=\"黑体\" size=\"3\"><br></font></p><p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=\"3\" face=\"黑体\"><br></font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font size=\"4\"><i style=\"background-color: rgb(139, 170, 74);\">Dubbo 这个方案并不完善~~</i></font><br></p><p><font size=\"4\"><b style=\"\">&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b style=\"\">Spring Cloud Alibaba&nbsp;&nbsp;</b><b style=\"color: rgb(194, 79, 74);\">new&nbsp; &nbsp;</b><font color=\"#000000\" style=\"\">一站式解决方案!更简单</font></font><font size=\"5\"></font></p>","ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}]
2022-08-31 18:19:21.488 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22261526371110912 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-31 18:19:21.489 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22261526371110912 [0;39m ==> Parameters: 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 1(Integer), 0(Integer), 20420961950109696(Long)
2022-08-31 18:19:21.490 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m22261526371110912 [0;39m <==    Updates: 1
2022-08-31 18:19:21.490 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22261526371110912 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-31 18:19:21.491 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22261526371110912 [0;39m ==> Parameters: <blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id="ys69d"><br></h2><h2 id="ys69d">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size="4" style="background-color: rgb(139, 170, 74);">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技
</font></p><p><font size="3">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函
</font></p><p><font size="3">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size="4" style="background-color: rgb(139, 170, 74);">2.&nbsp; RPC特点？</font><br></p><p><font size="3">1. 简单：使用简单，建立分布式应用更容易。
</font></p><p><font size="3">2. 高效：调用过程看起来十分清晰，效率高。
</font></p><p><font size="3">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p><hr><p><font size="5">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size="3">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size="3">&nbsp; &nbsp; &nbsp;<font color="#c24f4a"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color="#000000" size="5">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp;<font size="4"> <i style="background-color: rgb(139, 170, 74);">&nbsp; Spring Cloud 是一个很好的生态来解决上面的问题！！</i></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; </font><b style=""><font size="3">&nbsp;</font><font size="4"> 1. spring Cloud NetFlix&nbsp; </font></b><font size="4">&nbsp;一站式解决方案！</font></p><p><font size="4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font face="黑体">&nbsp; &nbsp;</font></font><font face="黑体" size="3">api网关，zuul组件<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Feign通信 ---HttpClinet ---Http通信方式，同步，阻塞<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Eureka<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;熔断机制：Hystrix</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 。。。。<br></p><p><font size="4"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;<font face="黑体">&nbsp;API:没有，找第三方组件，或者自己实现</font></font><font face="黑体" size="3"><br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;通信：Duboo RPC通信<br></font></p><p><font face="黑体" size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Zookeeper</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3" face="黑体">没有：借助 Hystrix</font><font face="黑体" size="3"><br></font></p><p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="3" face="黑体"><br></font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font size="4"><i style="background-color: rgb(139, 170, 74);">Dubbo 这个方案并不完善~~</i></font><br></p><p><font size="4"><b style="">&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b style="">Spring Cloud Alibaba&nbsp;&nbsp;</b><b style="color: rgb(194, 79, 74);">new&nbsp; &nbsp;</b><font color="#000000" style="">一站式解决方案!更简单</font></font><font size="5"></font></p>(String), 20420961950109696(Long)
2022-08-31 18:19:21.493 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m22261526371110912 [0;39m <==    Updates: 1
2022-08-31 18:19:21.558 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261526371110912 [0;39m 返回结果: {"success":true}
2022-08-31 18:19:21.558 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261526371110912 [0;39m ------------- 结束 耗时：72 ms -------------
2022-08-31 18:19:21.559 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m22261526371110912 [0;39m ------------- LoginInterceptor 结束 耗时：140 ms -------------
2022-08-31 18:19:21.569 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261526719238144 [0;39m ------------- 开始 -------------
2022-08-31 18:19:21.569 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261526719238144 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 18:19:21.569 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261526719238144 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 18:19:21.570 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261526719238144 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:21.570 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261526719238144 [0;39m 请求参数: [20420687550353408]
2022-08-31 18:19:21.570 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22261526719238144 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 18:19:21.571 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22261526719238144 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 18:19:21.572 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261526719238144 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 18:19:21.572 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261526719238144 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 18:19:21.573 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22261526719238144 [0;39m <==      Total: 1
2022-08-31 18:19:21.574 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261526719238144 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 18:19:21.574 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261526719238144 [0;39m ------------- 结束 耗时：5 ms -------------
2022-08-31 18:19:21.983 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261528455680000 [0;39m ------------- 开始 -------------
2022-08-31 18:19:21.983 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261528455680001 [0;39m ------------- 开始 -------------
2022-08-31 18:19:21.984 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261528455680000 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2022-08-31 18:19:21.984 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261528455680001 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2022-08-31 18:19:21.983 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261528455680002 [0;39m ------------- 开始 -------------
2022-08-31 18:19:21.984 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261528455680000 [0;39m 类名方法: com.zs.wikibb.controller.EbookSnapshotController.get30Statistic
2022-08-31 18:19:21.984 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261528455680001 [0;39m 类名方法: com.zs.wikibb.controller.CategoryController.all
2022-08-31 18:19:21.984 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261528455680002 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2022-08-31 18:19:21.984 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261528455680000 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:21.984 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261528455680002 [0;39m 类名方法: com.zs.wikibb.controller.EbookSnapshotController.getStatistic
2022-08-31 18:19:21.984 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261528455680001 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:21.984 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261528455680000 [0;39m 请求参数: []
2022-08-31 18:19:21.984 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261528455680002 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:21.984 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261528455680001 [0;39m 请求参数: []
2022-08-31 18:19:21.984 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261528455680002 [0;39m 请求参数: []
2022-08-31 18:19:21.985 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m22261528455680000 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-08-31 18:19:21.988 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m22261528455680000 [0;39m ==> Parameters: 
2022-08-31 18:19:21.990 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261528455680000 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-08-31 18:19:21.993 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22261528455680001 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-08-31 18:19:21.994 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22261528455680001 [0;39m ==> Parameters: 
2022-08-31 18:19:21.994 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261528455680000 [0;39m <==        Row: 2022-08-01, 13, 0
2022-08-31 18:19:21.995 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261528455680000 [0;39m <==        Row: 2022-08-17, 342, 54
2022-08-31 18:19:21.995 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==    Columns: id, parent, name, sort
2022-08-31 18:19:21.995 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 100, 0, 前端开发, 100
2022-08-31 18:19:21.996 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261528455680000 [0;39m <==        Row: 2022-08-18, 11, 0
2022-08-31 18:19:21.996 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 101, 100, Vue, 101
2022-08-31 18:19:21.996 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261528455680000 [0;39m <==        Row: 2022-08-19, 19, 6
2022-08-31 18:19:21.996 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-08-31 18:19:21.997 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261528455680000 [0;39m <==        Row: 2022-08-26, 372, 60
2022-08-31 18:19:21.997 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 200, 0, Java, 200
2022-08-31 18:19:21.997 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261528455680000 [0;39m <==        Row: 2022-08-29, 372, 60
2022-08-31 18:19:21.993 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m22261528455680002 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-08-31 18:19:21.997 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 201, 200, 基础应用, 201
2022-08-31 18:19:21.998 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m22261528455680000 [0;39m <==      Total: 6
2022-08-31 18:19:21.998 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 202, 200, 框架应用, 202
2022-08-31 18:19:21.998 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m22261528455680002 [0;39m ==> Parameters: 
2022-08-31 18:19:21.998 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 181311914796781568, 200, SpringBoot+Vue3 前后端分离知识库系统, 231
2022-08-31 18:19:21.998 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261528455680000 [0;39m 返回结果: {"content":[{"date":1659283200000,"viewCount":0,"viewIncrease":13,"voteCount":0,"voteIncrease":0},{"date":1660665600000,"viewCount":0,"viewIncrease":342,"voteCount":0,"voteIncrease":54},{"date":1660752000000,"viewCount":0,"viewIncrease":11,"voteCount":0,"voteIncrease":0},{"date":1660838400000,"viewCount":0,"viewIncrease":19,"voteCount":0,"voteIncrease":6},{"date":1661443200000,"viewCount":0,"viewIncrease":372,"voteCount":0,"voteIncrease":60},{"date":1661702400000,"viewCount":0,"viewIncrease":372,"voteCount":0,"voteIncrease":60}],"success":true}
2022-08-31 18:19:21.998 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 300, 0, Python, 300
2022-08-31 18:19:21.999 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261528455680000 [0;39m ------------- 结束 耗时：16 ms -------------
2022-08-31 18:19:21.999 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 301, 300, 基础应用, 301
2022-08-31 18:19:21.999 TRACE c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :143 
                [32m22261528455680002 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-08-31 18:19:21.999 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2022-08-31 18:19:21.999 TRACE c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :143 
                [32m22261528455680002 [0;39m <==        Row: 2022-08-31, 373, 60, 373, 60
2022-08-31 18:19:22.000 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 400, 0, 数据库, 400
2022-08-31 18:19:22.000 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 401, 400, MySQL, 401
2022-08-31 18:19:22.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m22261528455680002 [0;39m <==      Total: 1
2022-08-31 18:19:22.000 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 500, 0, 其它, 500
2022-08-31 18:19:22.000 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261528455680002 [0;39m 返回结果: {"content":[{"date":1661875200000,"viewCount":373,"viewIncrease":373,"voteCount":60,"voteIncrease":60}],"success":true}
2022-08-31 18:19:22.001 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261528455680002 [0;39m ------------- 结束 耗时：18 ms -------------
2022-08-31 18:19:22.001 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 501, 500, 服务器, 501
2022-08-31 18:19:22.001 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 502, 500, 开发工具, 502
2022-08-31 18:19:22.001 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261528455680001 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2022-08-31 18:19:22.004 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22261528455680001 [0;39m <==      Total: 16
2022-08-31 18:19:22.009 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261528455680001 [0;39m 返回结果: {"content":[{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":181311914796781568,"name":"SpringBoot+Vue3 前后端分离知识库系统","parent":200,"sort":231},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2022-08-31 18:19:22.010 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261528455680001 [0;39m ------------- 结束 耗时：27 ms -------------
2022-08-31 18:19:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261541122478080 [0;39m 生成今日电子书快照开始
2022-08-31 18:19:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261541122478080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:19:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261541122478080 [0;39m ==> Parameters: 
2022-08-31 18:19:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261541122478080 [0;39m <==    Updates: 0
2022-08-31 18:19:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261541122478080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:19:28.579 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261556121309184 [0;39m ------------- 开始 -------------
2022-08-31 18:19:28.580 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261556121309184 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-31 18:19:28.580 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261556121309184 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-31 18:19:28.580 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261556121309184 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:28.580 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261556121309184 [0;39m 请求参数: [{"categoryId2":201,"page":1,"size":1000}]
2022-08-31 18:19:28.585 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22261556121309184 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-08-31 18:19:28.585 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22261556121309184 [0;39m ==> Parameters: 201(Long)
2022-08-31 18:19:28.586 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22261556121309184 [0;39m <==    Columns: count(0)
2022-08-31 18:19:28.586 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22261556121309184 [0;39m <==        Row: 1
2022-08-31 18:19:28.587 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22261556121309184 [0;39m <==      Total: 1
2022-08-31 18:19:28.588 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22261556121309184 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2022-08-31 18:19:28.588 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22261556121309184 [0;39m ==> Parameters: 201(Long), 1000(Integer)
2022-08-31 18:19:28.588 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22261556121309184 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-31 18:19:28.589 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22261556121309184 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover1.png, 4, 62, 10
2022-08-31 18:19:28.589 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22261556121309184 [0;39m <==      Total: 1
2022-08-31 18:19:28.589 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m22261556121309184 [0;39m 总行数：1
2022-08-31 18:19:28.590 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m22261556121309184 [0;39m 总页数：1
2022-08-31 18:19:28.590 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261556121309184 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover1.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":4,"id":1,"name":"Spring Boot 入门教程","viewCount":62,"voteCount":10}],"total":1},"success":true}
2022-08-31 18:19:28.590 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261556121309184 [0;39m ------------- 结束 耗时：11 ms -------------
2022-08-31 18:19:29.555 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261560214949888 [0;39m ------------- 开始 -------------
2022-08-31 18:19:29.555 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261560214949888 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/1 GET
2022-08-31 18:19:29.555 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261560214949888 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 18:19:29.556 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261560214949888 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:29.556 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261560214949888 [0;39m 请求参数: [1]
2022-08-31 18:19:29.557 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22261560214949888 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 18:19:29.557 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22261560214949888 [0;39m ==> Parameters: 1(Long)
2022-08-31 18:19:29.558 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261560214949888 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 18:19:29.558 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261560214949888 [0;39m <==        Row: 1, 1, 0, Ant Design Of Vue, 1, 37, 4
2022-08-31 18:19:29.558 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261560214949888 [0;39m <==        Row: 2, 1, 1, 文档1.1, 1, 12, 3
2022-08-31 18:19:29.559 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261560214949888 [0;39m <==        Row: 4, 1, 3, 文档2.1, 1, 8, 2
2022-08-31 18:19:29.559 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261560214949888 [0;39m <==        Row: 3, 1, 0, 文档2, 2, 5, 1
2022-08-31 18:19:29.559 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22261560214949888 [0;39m <==      Total: 4
2022-08-31 18:19:29.560 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261560214949888 [0;39m 返回结果: {"content":[{"ebookId":1,"id":1,"name":"Ant Design Of Vue","parent":0,"sort":1,"viewCount":37,"voteCount":4},{"ebookId":1,"id":2,"name":"文档1.1","parent":1,"sort":1,"viewCount":12,"voteCount":3},{"ebookId":1,"id":4,"name":"文档2.1","parent":3,"sort":1,"viewCount":8,"voteCount":2},{"ebookId":1,"id":3,"name":"文档2","parent":0,"sort":2,"viewCount":5,"voteCount":1}],"success":true}
2022-08-31 18:19:29.560 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261560214949888 [0;39m ------------- 结束 耗时：5 ms -------------
2022-08-31 18:19:29.575 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261560298835968 [0;39m ------------- 开始 -------------
2022-08-31 18:19:29.576 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261560298835968 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/1 GET
2022-08-31 18:19:29.576 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261560298835968 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-31 18:19:29.576 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261560298835968 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:29.576 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261560298835968 [0;39m 请求参数: [1]
2022-08-31 18:19:29.577 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261560298835968 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-31 18:19:29.577 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261560298835968 [0;39m ==> Parameters: 1(Long)
2022-08-31 18:19:29.578 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m22261560298835968 [0;39m <==    Columns: id, content
2022-08-31 18:19:29.578 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m22261560298835968 [0;39m <==        Row: 1, <<BLOB>>
2022-08-31 18:19:29.579 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261560298835968 [0;39m <==      Total: 1
2022-08-31 18:19:29.579 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261560298835968 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-31 18:19:29.580 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261560298835968 [0;39m ==> Parameters: 1(Long)
2022-08-31 18:19:29.626 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261560298835968 [0;39m <==    Updates: 1
2022-08-31 18:19:29.626 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261560298835968 [0;39m 返回结果: {"content":"<blockquote><h1 id=\"japt6\"><font face=\"仿宋\" color=\"#7b5ba1\"><b><u>33332222</u></b></font></h1><p><font face=\"仿宋\" color=\"#c24f4a\"><b style=\"background-color: rgb(139, 170, 74);\">2022.7.4</b></font></p><img class=\"eleImg\" src=\"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/pcmoren_tian_org.png\" alt=\"[[舔屏]]\"><div><font face=\"仿宋\" color=\"#7b5ba1\"><b></b></font></div></blockquote>","success":true}
2022-08-31 18:19:29.626 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261560298835968 [0;39m ------------- 结束 耗时：51 ms -------------
2022-08-31 18:19:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261562123358208 [0;39m 生成今日电子书快照开始
2022-08-31 18:19:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261562123358208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:19:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261562123358208 [0;39m ==> Parameters: 
2022-08-31 18:19:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261562123358208 [0;39m <==    Updates: 0
2022-08-31 18:19:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261562123358208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:19:30.763 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261565277474816 [0;39m ------------- 开始 -------------
2022-08-31 18:19:30.763 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261565277474816 [0;39m 请求地址: http://127.0.0.1:8880/doc/vote/1 GET
2022-08-31 18:19:30.763 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261565277474816 [0;39m 类名方法: com.zs.wikibb.controller.DocController.vote
2022-08-31 18:19:30.763 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261565277474816 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:30.763 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261565277474816 [0;39m 请求参数: [1]
2022-08-31 18:19:30.844 INFO  com.zs.wikibb.utils.RedisUtil                     :31  
                [32m22261565277474816 [0;39m key不存在，放入：DOC_VOTE_1_127.0.0.1，过期 86400 秒
2022-08-31 18:19:30.939 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseVoteCount:137 
                [32m22261565277474816 [0;39m ==>  Preparing: update doc set vote_count=vote_count+1 where id=?
2022-08-31 18:19:30.940 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseVoteCount:137 
                [32m22261565277474816 [0;39m ==> Parameters: 1(Long)
2022-08-31 18:19:30.959 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseVoteCount:137 
                [32m22261565277474816 [0;39m <==    Updates: 1
2022-08-31 18:19:30.960 DEBUG com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :137 
                [32m22261565277474816 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2022-08-31 18:19:30.960 DEBUG com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :137 
                [32m22261565277474816 [0;39m ==> Parameters: 1(Long)
2022-08-31 18:19:30.961 TRACE com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :143 
                [32m22261565277474816 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 18:19:30.961 TRACE com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :143 
                [32m22261565277474816 [0;39m <==        Row: 1, 1, 0, Ant Design Of Vue, 1, 38, 5
2022-08-31 18:19:30.962 DEBUG com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :137 
                [32m22261565277474816 [0;39m <==      Total: 1
2022-08-31 18:19:30.977 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261565277474816 [0;39m 返回结果: {"success":true}
2022-08-31 18:19:30.977 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261565277474816 [0;39m ------------- 结束 耗时：215 ms -------------
2022-08-31 18:19:31.041 INFO  com.zs.wikibb.websocket.WebSocketServer           :72  
                [32m22261565277474816 [0;39m 推送消息：jDz2dFKboN，内容：【Ant Design Of Vue】被点赞
2022-08-31 18:19:31.744 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261569396281344 [0;39m ------------- 开始 -------------
2022-08-31 18:19:31.744 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261569396281344 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/2 GET
2022-08-31 18:19:31.744 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261569396281344 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-31 18:19:31.744 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261569396281344 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:31.744 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261569396281344 [0;39m 请求参数: [2]
2022-08-31 18:19:31.745 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261569396281344 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-31 18:19:31.745 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261569396281344 [0;39m ==> Parameters: 2(Long)
2022-08-31 18:19:31.746 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261569396281344 [0;39m <==      Total: 0
2022-08-31 18:19:31.747 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261569396281344 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-31 18:19:31.747 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261569396281344 [0;39m ==> Parameters: 2(Long)
2022-08-31 18:19:31.757 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261569396281344 [0;39m <==    Updates: 1
2022-08-31 18:19:31.757 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261569396281344 [0;39m 返回结果: {"content":"","success":true}
2022-08-31 18:19:31.757 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261569396281344 [0;39m ------------- 结束 耗时：13 ms -------------
2022-08-31 18:19:32.485 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261572504260608 [0;39m ------------- 开始 -------------
2022-08-31 18:19:32.485 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261572504260608 [0;39m 请求地址: http://127.0.0.1:8880/doc/vote/2 GET
2022-08-31 18:19:32.485 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261572504260608 [0;39m 类名方法: com.zs.wikibb.controller.DocController.vote
2022-08-31 18:19:32.486 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261572504260608 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:32.486 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261572504260608 [0;39m 请求参数: [2]
2022-08-31 18:19:32.570 INFO  com.zs.wikibb.utils.RedisUtil                     :31  
                [32m22261572504260608 [0;39m key不存在，放入：DOC_VOTE_2_127.0.0.1，过期 86400 秒
2022-08-31 18:19:32.659 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseVoteCount:137 
                [32m22261572504260608 [0;39m ==>  Preparing: update doc set vote_count=vote_count+1 where id=?
2022-08-31 18:19:32.660 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseVoteCount:137 
                [32m22261572504260608 [0;39m ==> Parameters: 2(Long)
2022-08-31 18:19:32.740 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseVoteCount:137 
                [32m22261572504260608 [0;39m <==    Updates: 1
2022-08-31 18:19:32.741 DEBUG com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :137 
                [32m22261572504260608 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2022-08-31 18:19:32.741 DEBUG com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :137 
                [32m22261572504260608 [0;39m ==> Parameters: 2(Long)
2022-08-31 18:19:32.741 TRACE com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :143 
                [32m22261572504260608 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 18:19:32.742 TRACE com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :143 
                [32m22261572504260608 [0;39m <==        Row: 2, 1, 1, 文档1.1, 1, 13, 4
2022-08-31 18:19:32.742 DEBUG com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :137 
                [32m22261572504260608 [0;39m <==      Total: 1
2022-08-31 18:19:32.742 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261572504260608 [0;39m 返回结果: {"success":true}
2022-08-31 18:19:32.743 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261572504260608 [0;39m ------------- 结束 耗时：258 ms -------------
2022-08-31 18:19:32.743 INFO  com.zs.wikibb.websocket.WebSocketServer           :72  
                [32m22261572504260608 [0;39m 推送消息：jDz2dFKboN，内容：【文档1.1】被点赞
2022-08-31 18:19:33.319 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261576002310144 [0;39m ------------- 开始 -------------
2022-08-31 18:19:33.319 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261576002310144 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/3 GET
2022-08-31 18:19:33.319 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261576002310144 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-31 18:19:33.319 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261576002310144 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:33.320 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261576002310144 [0;39m 请求参数: [3]
2022-08-31 18:19:33.320 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261576002310144 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-31 18:19:33.320 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261576002310144 [0;39m ==> Parameters: 3(Long)
2022-08-31 18:19:33.321 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261576002310144 [0;39m <==      Total: 0
2022-08-31 18:19:33.321 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261576002310144 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-31 18:19:33.322 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261576002310144 [0;39m ==> Parameters: 3(Long)
2022-08-31 18:19:33.337 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261576002310144 [0;39m <==    Updates: 1
2022-08-31 18:19:33.338 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261576002310144 [0;39m 返回结果: {"content":"","success":true}
2022-08-31 18:19:33.338 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261576002310144 [0;39m ------------- 结束 耗时：19 ms -------------
2022-08-31 18:19:33.926 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261578548252672 [0;39m ------------- 开始 -------------
2022-08-31 18:19:33.926 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261578548252672 [0;39m 请求地址: http://127.0.0.1:8880/doc/vote/3 GET
2022-08-31 18:19:33.926 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261578548252672 [0;39m 类名方法: com.zs.wikibb.controller.DocController.vote
2022-08-31 18:19:33.927 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261578548252672 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:33.927 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261578548252672 [0;39m 请求参数: [3]
2022-08-31 18:19:34.009 INFO  com.zs.wikibb.utils.RedisUtil                     :31  
                [32m22261578548252672 [0;39m key不存在，放入：DOC_VOTE_3_127.0.0.1，过期 86400 秒
2022-08-31 18:19:34.093 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseVoteCount:137 
                [32m22261578548252672 [0;39m ==>  Preparing: update doc set vote_count=vote_count+1 where id=?
2022-08-31 18:19:34.093 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseVoteCount:137 
                [32m22261578548252672 [0;39m ==> Parameters: 3(Long)
2022-08-31 18:19:34.226 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseVoteCount:137 
                [32m22261578548252672 [0;39m <==    Updates: 1
2022-08-31 18:19:34.227 DEBUG com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :137 
                [32m22261578548252672 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2022-08-31 18:19:34.227 DEBUG com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :137 
                [32m22261578548252672 [0;39m ==> Parameters: 3(Long)
2022-08-31 18:19:34.228 TRACE com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :143 
                [32m22261578548252672 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 18:19:34.228 TRACE com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :143 
                [32m22261578548252672 [0;39m <==        Row: 3, 1, 0, 文档2, 2, 6, 2
2022-08-31 18:19:34.229 DEBUG com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :137 
                [32m22261578548252672 [0;39m <==      Total: 1
2022-08-31 18:19:34.229 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261578548252672 [0;39m 返回结果: {"success":true}
2022-08-31 18:19:34.230 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261578548252672 [0;39m ------------- 结束 耗时：304 ms -------------
2022-08-31 18:19:34.230 INFO  com.zs.wikibb.websocket.WebSocketServer           :72  
                [32m22261578548252672 [0;39m 推送消息：jDz2dFKboN，内容：【文档2】被点赞
2022-08-31 18:19:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261583073906688 [0;39m 生成今日电子书快照开始
2022-08-31 18:19:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261583073906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:19:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261583073906688 [0;39m ==> Parameters: 
2022-08-31 18:19:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261583073906688 [0;39m <==    Updates: 0
2022-08-31 18:19:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261583073906688 [0;39m 生成今日电子书快照结束，耗时：12 毫秒
2022-08-31 18:19:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m22261583124238336 [0;39m 更新电子书下的文档数据开始
2022-08-31 18:19:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22261583124238336 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-31 18:19:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22261583124238336 [0;39m ==> Parameters: 
2022-08-31 18:19:35.026 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m22261583124238336 [0;39m <==    Updates: 8
2022-08-31 18:19:35.027 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m22261583124238336 [0;39m 更新电子书下的文档数据结束，耗时：9 毫秒
2022-08-31 18:19:35.849 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261586613899265 [0;39m ------------- 开始 -------------
2022-08-31 18:19:35.849 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261586613899264 [0;39m ------------- 开始 -------------
2022-08-31 18:19:35.849 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261586613899266 [0;39m ------------- 开始 -------------
2022-08-31 18:19:35.850 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261586613899265 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2022-08-31 18:19:35.850 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261586613899266 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2022-08-31 18:19:35.850 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261586613899264 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2022-08-31 18:19:35.850 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261586613899265 [0;39m 类名方法: com.zs.wikibb.controller.CategoryController.all
2022-08-31 18:19:35.850 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261586613899266 [0;39m 类名方法: com.zs.wikibb.controller.EbookSnapshotController.get30Statistic
2022-08-31 18:19:35.850 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261586613899264 [0;39m 类名方法: com.zs.wikibb.controller.EbookSnapshotController.getStatistic
2022-08-31 18:19:35.850 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261586613899265 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:35.850 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261586613899264 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:35.850 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261586613899266 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:35.850 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261586613899265 [0;39m 请求参数: []
2022-08-31 18:19:35.850 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261586613899264 [0;39m 请求参数: []
2022-08-31 18:19:35.850 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261586613899266 [0;39m 请求参数: []
2022-08-31 18:19:35.851 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m22261586613899266 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-08-31 18:19:35.851 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22261586613899265 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-08-31 18:19:35.851 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m22261586613899264 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-08-31 18:19:35.851 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m22261586613899266 [0;39m ==> Parameters: 
2022-08-31 18:19:35.851 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22261586613899265 [0;39m ==> Parameters: 
2022-08-31 18:19:35.851 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m22261586613899264 [0;39m ==> Parameters: 
2022-08-31 18:19:35.852 TRACE c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :143 
                [32m22261586613899264 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-08-31 18:19:35.853 TRACE c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :143 
                [32m22261586613899264 [0;39m <==        Row: 2022-08-31, 373, 60, 373, 60
2022-08-31 18:19:35.853 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m22261586613899264 [0;39m <==      Total: 1
2022-08-31 18:19:35.854 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261586613899264 [0;39m 返回结果: {"content":[{"date":1661875200000,"viewCount":373,"viewIncrease":373,"voteCount":60,"voteIncrease":60}],"success":true}
2022-08-31 18:19:35.854 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261586613899264 [0;39m ------------- 结束 耗时：5 ms -------------
2022-08-31 18:19:35.855 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==    Columns: id, parent, name, sort
2022-08-31 18:19:35.855 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261586613899266 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-08-31 18:19:35.855 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 100, 0, 前端开发, 100
2022-08-31 18:19:35.855 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261586613899266 [0;39m <==        Row: 2022-08-01, 13, 0
2022-08-31 18:19:35.855 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 101, 100, Vue, 101
2022-08-31 18:19:35.856 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-08-31 18:19:35.856 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 200, 0, Java, 200
2022-08-31 18:19:35.857 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 201, 200, 基础应用, 201
2022-08-31 18:19:35.857 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 202, 200, 框架应用, 202
2022-08-31 18:19:35.857 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261586613899266 [0;39m <==        Row: 2022-08-17, 342, 54
2022-08-31 18:19:35.857 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 181311914796781568, 200, SpringBoot+Vue3 前后端分离知识库系统, 231
2022-08-31 18:19:35.858 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 300, 0, Python, 300
2022-08-31 18:19:35.858 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 301, 300, 基础应用, 301
2022-08-31 18:19:35.859 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261586613899266 [0;39m <==        Row: 2022-08-18, 11, 0
2022-08-31 18:19:35.859 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2022-08-31 18:19:35.859 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261586613899266 [0;39m <==        Row: 2022-08-19, 19, 6
2022-08-31 18:19:35.859 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 400, 0, 数据库, 400
2022-08-31 18:19:35.860 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 401, 400, MySQL, 401
2022-08-31 18:19:35.860 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261586613899266 [0;39m <==        Row: 2022-08-26, 372, 60
2022-08-31 18:19:35.860 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 500, 0, 其它, 500
2022-08-31 18:19:35.860 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261586613899266 [0;39m <==        Row: 2022-08-29, 372, 60
2022-08-31 18:19:35.860 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 501, 500, 服务器, 501
2022-08-31 18:19:35.860 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 502, 500, 开发工具, 502
2022-08-31 18:19:35.860 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m22261586613899266 [0;39m <==      Total: 6
2022-08-31 18:19:35.861 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261586613899265 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2022-08-31 18:19:35.861 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22261586613899265 [0;39m <==      Total: 16
2022-08-31 18:19:35.861 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261586613899266 [0;39m 返回结果: {"content":[{"date":1659283200000,"viewCount":0,"viewIncrease":13,"voteCount":0,"voteIncrease":0},{"date":1660665600000,"viewCount":0,"viewIncrease":342,"voteCount":0,"voteIncrease":54},{"date":1660752000000,"viewCount":0,"viewIncrease":11,"voteCount":0,"voteIncrease":0},{"date":1660838400000,"viewCount":0,"viewIncrease":19,"voteCount":0,"voteIncrease":6},{"date":1661443200000,"viewCount":0,"viewIncrease":372,"voteCount":0,"voteIncrease":60},{"date":1661702400000,"viewCount":0,"viewIncrease":372,"voteCount":0,"voteIncrease":60}],"success":true}
2022-08-31 18:19:35.861 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261586613899266 [0;39m ------------- 结束 耗时：12 ms -------------
2022-08-31 18:19:35.866 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261586613899265 [0;39m 返回结果: {"content":[{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":181311914796781568,"name":"SpringBoot+Vue3 前后端分离知识库系统","parent":200,"sort":231},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2022-08-31 18:19:35.866 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261586613899265 [0;39m ------------- 结束 耗时：17 ms -------------
2022-08-31 18:19:37.884 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261595149307904 [0;39m ------------- 开始 -------------
2022-08-31 18:19:37.885 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261595149307904 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-31 18:19:37.885 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261595149307904 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-31 18:19:37.885 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261595149307904 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:37.885 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261595149307904 [0;39m 请求参数: [{"categoryId2":181311914796781568,"page":1,"size":1000}]
2022-08-31 18:19:37.896 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22261595149307904 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-08-31 18:19:37.897 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22261595149307904 [0;39m ==> Parameters: 181311914796781568(Long)
2022-08-31 18:19:37.898 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22261595149307904 [0;39m <==    Columns: count(0)
2022-08-31 18:19:37.898 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22261595149307904 [0;39m <==        Row: 1
2022-08-31 18:19:37.899 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22261595149307904 [0;39m <==      Total: 1
2022-08-31 18:19:37.899 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22261595149307904 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2022-08-31 18:19:37.900 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22261595149307904 [0;39m ==> Parameters: 181311914796781568(Long), 1000(Integer)
2022-08-31 18:19:37.900 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22261595149307904 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-31 18:19:37.901 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22261595149307904 [0;39m <==        Row: 202714600712572928, Wiki个人知识库, 200, 181311914796781568, 本文档讲述了知识库的开发过程以及遇到的问题！, /image/cover2.png, 12, 259, 38
2022-08-31 18:19:37.901 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22261595149307904 [0;39m <==      Total: 1
2022-08-31 18:19:37.902 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m22261595149307904 [0;39m 总行数：1
2022-08-31 18:19:37.902 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m22261595149307904 [0;39m 总页数：1
2022-08-31 18:19:37.902 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261595149307904 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":181311914796781568,"cover":"/image/cover2.png","description":"本文档讲述了知识库的开发过程以及遇到的问题！","docCount":12,"id":202714600712572928,"name":"Wiki个人知识库","viewCount":259,"voteCount":38}],"total":1},"success":true}
2022-08-31 18:19:37.902 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261595149307904 [0;39m ------------- 结束 耗时：18 ms -------------
2022-08-31 18:19:38.504 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261597749776384 [0;39m ------------- 开始 -------------
2022-08-31 18:19:38.505 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261597749776384 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-31 18:19:38.505 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261597749776384 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 18:19:38.505 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261597749776384 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:38.505 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261597749776384 [0;39m 请求参数: [202714600712572928]
2022-08-31 18:19:38.506 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22261597749776384 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 18:19:38.507 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22261597749776384 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-31 18:19:38.508 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261597749776384 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 18:19:38.508 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261597749776384 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 52, 6
2022-08-31 18:19:38.509 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261597749776384 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 44, 5
2022-08-31 18:19:38.510 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261597749776384 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-31 18:19:38.510 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261597749776384 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 22, 3
2022-08-31 18:19:38.511 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261597749776384 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 27, 5
2022-08-31 18:19:38.511 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261597749776384 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 27, 2
2022-08-31 18:19:38.511 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261597749776384 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 10, 2
2022-08-31 18:19:38.511 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261597749776384 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 13, 4
2022-08-31 18:19:38.511 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261597749776384 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 11, 2
2022-08-31 18:19:38.512 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261597749776384 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 10, 1
2022-08-31 18:19:38.512 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261597749776384 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 5, 2
2022-08-31 18:19:38.512 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261597749776384 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 5, 3
2022-08-31 18:19:38.513 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22261597749776384 [0;39m <==      Total: 12
2022-08-31 18:19:38.513 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261597749776384 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":52,"voteCount":6},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":44,"voteCount":5},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":22,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":27,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":27,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":10,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":13,"voteCount":4},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":11,"voteCount":2},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":10,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":5,"voteCount":2},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":5,"voteCount":3}],"success":true}
2022-08-31 18:19:38.514 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261597749776384 [0;39m ------------- 结束 耗时：10 ms -------------
2022-08-31 18:19:38.529 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261597854633984 [0;39m ------------- 开始 -------------
2022-08-31 18:19:38.529 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261597854633984 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202714909656616960 GET
2022-08-31 18:19:38.530 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261597854633984 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-31 18:19:38.530 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261597854633984 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:38.530 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261597854633984 [0;39m 请求参数: [202714909656616960]
2022-08-31 18:19:38.530 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261597854633984 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-31 18:19:38.530 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261597854633984 [0;39m ==> Parameters: 202714909656616960(Long)
2022-08-31 18:19:38.534 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m22261597854633984 [0;39m <==    Columns: id, content
2022-08-31 18:19:38.534 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m22261597854633984 [0;39m <==        Row: 202714909656616960, <<BLOB>>
2022-08-31 18:19:38.535 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261597854633984 [0;39m <==      Total: 1
2022-08-31 18:19:38.535 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261597854633984 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-31 18:19:38.535 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261597854633984 [0;39m ==> Parameters: 202714909656616960(Long)
2022-08-31 18:19:38.551 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261597854633984 [0;39m <==    Updates: 1
2022-08-31 18:19:38.551 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261597854633984 [0;39m 返回结果: {"content":"<blockquote><h2><b>前端：</b>Vue CLI(生成一个前端框架)、Vue3、Ant Design Vue(UI组件)、router、vuex、axios</h2><p><br></p><h2><b>后端：</b>SpringBoot核心知识体系AOP、拦截器、过滤器、异步化、定时任务、websocket、多环境、缓存、消息队列...</h2></blockquote><p><img src=\"https://obohe.com/i/2022/07/29/m04bxh.png\" style=\"max-width:100%;\"><br></p>","success":true}
2022-08-31 18:19:38.552 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261597854633984 [0;39m ------------- 结束 耗时：23 ms -------------
2022-08-31 18:19:39.072 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261600132141056 [0;39m ------------- 开始 -------------
2022-08-31 18:19:39.072 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261600132141056 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202715172312322048 GET
2022-08-31 18:19:39.073 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261600132141056 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-31 18:19:39.073 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261600132141056 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:39.073 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261600132141056 [0;39m 请求参数: [202715172312322048]
2022-08-31 18:19:39.073 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261600132141056 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-31 18:19:39.074 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261600132141056 [0;39m ==> Parameters: 202715172312322048(Long)
2022-08-31 18:19:39.074 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m22261600132141056 [0;39m <==    Columns: id, content
2022-08-31 18:19:39.075 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m22261600132141056 [0;39m <==        Row: 202715172312322048, <<BLOB>>
2022-08-31 18:19:39.075 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261600132141056 [0;39m <==      Total: 1
2022-08-31 18:19:39.075 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261600132141056 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-31 18:19:39.076 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261600132141056 [0;39m ==> Parameters: 202715172312322048(Long)
2022-08-31 18:19:39.092 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261600132141056 [0;39m <==    Updates: 1
2022-08-31 18:19:39.093 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261600132141056 [0;39m 返回结果: {"content":"<blockquote><ul><li><font size=\"4\" face=\"楷体\">数据库准备</font></li><li><font size=\"4\" face=\"楷体\">IDEA关联数据库</font></li><li><font size=\"4\" face=\"楷体\">集成Mybatis（持久层（Mapper/Dao）框架，访问数据库）</font></li><li><font size=\"4\" face=\"楷体\">Mybatis Generator的使用</font></li></ul></blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size=\"4\" face=\"楷体\" style=\"background-color: rgb(249, 150, 59);\">1.&nbsp;</font><font size=\"3\"><b style=\"background-color: rgb(249, 150, 59);\">持久层框架：Mybatis，Hiberate有什么区别？</b></font></p><p>&nbsp; &nbsp;&nbsp;&nbsp;<span style=\"background-color: rgb(238, 236, 224);\">&nbsp;&nbsp;&nbsp;<font size=\"3\" style=\"\">前者是半自动（需自己写sql）的，后者是全自动的</font></span></p><p>&nbsp; &nbsp; &nbsp;&nbsp;<font face=\"宋体\">&nbsp;<b style=\"\"><font size=\"3\" style=\"background-color: rgb(249, 150, 59);\">&nbsp;2. 如何集成Mybatis？</font></b></font></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=\"3\" style=\"background-color: rgb(238, 236, 224);\">先在pom文件集成Mybatis和Mysql——&gt;配置数据源（applicaiton.yml）&nbsp;</font><span style=\"background-color: rgb(238, 236, 224);\"><font size=\"3\" style=\"\"><br></font></span></p><hr><p style=\"line-height:1.6;\">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color=\"#c24f4a\">&nbsp;&nbsp;&nbsp;<u style=\"background-color: rgb(238, 236, 224);\"><font size=\"4\">记得在application.java 加入mapperScan扫描注解</font></u></font></i></p><pre type=\"Java\"><code><xmp>　　　　# 配置mybatis所有Mapper.xml所在的路径，使其被识别</xmp><xmp><br></xmp><xmp>　　　　mybatis.mapper-locations=classpath:/mapper/**/*.xml</xmp></code></pre><p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></p><hr><p>&nbsp; &nbsp; &nbsp; &nbsp; <b><font size=\"3\" face=\"宋体\" style=\"background-color: rgb(249, 150, 59);\">3. 集成Mybatis官方代码生成器？</font></b><br></p><p style=\"text-align:center;\">&nbsp;<span style=\"background-color: rgb(238, 236, 224);\"><b> &nbsp;先在pom文件集成插件，然后在相对路径下新建：</b></span><b style=\"background-color: rgb(238, 236, 224);\">generator-config.xml</b><br></p><pre type=\"Java\"><code><xmp>  <!-- mybatis generator 自动生成代码插件 -->\n            <plugin>\n                <groupId>org.mybatis.generator</groupId>\n                <artifactId>mybatis-generator-maven-plugin</artifactId>\n                <version>1.4.0</version>\n                <configuration>\n                    <configurationFile>src/main/resources/generator/generator-config.xml</configurationFile>\n                    <overwrite>true</overwrite>\n                    <verbose>true</verbose>\n                </configuration>\n                <dependencies>\n                    <dependency>\n                        <groupId>mysql</groupId>\n                        <artifactId>mysql-connector-java</artifactId>\n                        <version>8.0.22</version>\n                    </dependency>\n                </dependencies>\n            </plugin></xmp></code></pre><p style=\"text-align:center;\"><b style=\"background-color: rgb(238, 236, 224);\">增加启动命令，点击Edit Configuration——add maven——Command line：mybatis-generator:generate -e</b></p><p style=\"text-align:center;\"><img src=\"https://i.postimg.cc/Y08Kc8Tz/1658809334271.png\" style=\"max-width:100%;\" width=\"30%\"></p><hr><p style=\"text-align:left;\"><b><font size=\"3\" style=\"background-color: rgb(249, 150, 59);\">4. 项目的后端会有很多的接口，为了让前端能够统一处理逻辑（登录校验、权限校验），需要统一后端的返回值。（CommonResp：通用的返回类）</font></b></p><p style=\"text-align:left;\">&nbsp; &nbsp; &nbsp; &nbsp;<span style=\"background-color: rgb(238, 236, 224);\"><font size=\"3\"> req类：因为当获取前端的值较多或者是多个值时，req中的所有值中会自动映射看前端需要那个值。</font><b><font size=\"3\" style=\"\"><br></font></b></span></p><p style=\"text-align:left;\"><span style=\"background-color: rgb(238, 236, 224);\">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><font size=\"3\"><span style=\"background-color: rgb(238, 236, 224);\">resp类：返回值，作用和req一样。</span><br></font></p><p style=\"text-align:left;\">&nbsp; &nbsp;<span style=\"background-color: rgb(194, 79, 74);\"> &nbsp;</span><font size=\"3\"><strike style=\"background-color: rgb(194, 79, 74);\"> &nbsp; 注：controller不要出现实体类</strike><span style=\"background-color: rgb(238, 236, 224);\"><br></span></font></p><p style=\"text-align:left;\"><font size=\"3\"><strike style=\"background-color: rgb(194, 79, 74);\"><br></strike></font></p><p style=\"text-align:left;\"><b style=\"background-color: rgb(249, 150, 59);\">4. 制作CopyUtil封装BeanUtils</b><br></p><p style=\"text-align:left;\">&nbsp; &nbsp; <font size=\"3\" style=\"background-color: rgb(238, 236, 224);\">里面包含单体复制和实体复制，因为controller不能出现实体类的值，避免外界人士看到，所以把实体类的值赋值到resp中，就用到了BeanUtil实现赋值。本次编写了一个CopyUtils里面封装了单体复制和列表复制，可以使用更少的代码实现一样的功能</font><b><br></b></p><p style=\"text-align:left;\"><font size=\"3\" style=\"background-color: rgb(238, 236, 224);\"><br></font></p><p style=\"text-align:left;\"><b style=\"background-color: rgb(249, 150, 59);\">5. 泛型和object的区别？</b><font size=\"3\" style=\"background-color: rgb(238, 236, 224);\"><br></font></p><p style=\"text-align:left;\">&nbsp; &nbsp; &nbsp;<span style=\"background-color: rgb(238, 236, 224);\">1. 使用泛型不需要做强制类型转换<b style=\"\"><br></b></span></p><p style=\"text-align:left;\"><span style=\"background-color: rgb(238, 236, 224);\">&nbsp; &nbsp; 2. 编译时更安全。<strong>如果使用Object类的话，你没法保证返回的类型一定是Foo，也许是其它类型。这时你就会在运行时得到一个类型转换异常（ClassCastException）</strong></span><br></p><p style=\"text-align:left;\"><span style=\"background-color: rgb(238, 236, 224);\"><strong><br></strong></span></p><p>&nbsp; &nbsp;&nbsp;<strong>泛型引用</strong></p><pre><code>　　　　String result = doSomeThing(\"参数是String\");</code></pre><p>&nbsp; &nbsp;&nbsp;<strong>Object引用</strong></p><pre><code>　　　　String result = (String)doSomeThing(\"参数是String\");</code></pre>","success":true}
2022-08-31 18:19:39.093 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261600132141056 [0;39m ------------- 结束 耗时：21 ms -------------
2022-08-31 18:19:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261604028649472 [0;39m 生成今日电子书快照开始
2022-08-31 18:19:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261604028649472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:19:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261604028649472 [0;39m ==> Parameters: 
2022-08-31 18:19:40.038 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261604028649472 [0;39m <==    Updates: 0
2022-08-31 18:19:40.038 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261604028649472 [0;39m 生成今日电子书快照结束，耗时：37 毫秒
2022-08-31 18:19:41.206 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261609082785792 [0;39m ------------- 开始 -------------
2022-08-31 18:19:41.206 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261609082785792 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202714909656616960 GET
2022-08-31 18:19:41.206 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261609082785792 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-31 18:19:41.206 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261609082785792 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:41.206 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261609082785792 [0;39m 请求参数: [202714909656616960]
2022-08-31 18:19:41.207 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261609082785792 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-31 18:19:41.207 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261609082785792 [0;39m ==> Parameters: 202714909656616960(Long)
2022-08-31 18:19:41.208 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m22261609082785792 [0;39m <==    Columns: id, content
2022-08-31 18:19:41.208 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m22261609082785792 [0;39m <==        Row: 202714909656616960, <<BLOB>>
2022-08-31 18:19:41.208 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261609082785792 [0;39m <==      Total: 1
2022-08-31 18:19:41.209 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261609082785792 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-31 18:19:41.209 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261609082785792 [0;39m ==> Parameters: 202714909656616960(Long)
2022-08-31 18:19:41.246 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261609082785792 [0;39m <==    Updates: 1
2022-08-31 18:19:41.246 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261609082785792 [0;39m 返回结果: {"content":"<blockquote><h2><b>前端：</b>Vue CLI(生成一个前端框架)、Vue3、Ant Design Vue(UI组件)、router、vuex、axios</h2><p><br></p><h2><b>后端：</b>SpringBoot核心知识体系AOP、拦截器、过滤器、异步化、定时任务、websocket、多环境、缓存、消息队列...</h2></blockquote><p><img src=\"https://obohe.com/i/2022/07/29/m04bxh.png\" style=\"max-width:100%;\"><br></p>","success":true}
2022-08-31 18:19:41.246 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261609082785792 [0;39m ------------- 结束 耗时：40 ms -------------
2022-08-31 18:19:41.952 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261612211736576 [0;39m ------------- 开始 -------------
2022-08-31 18:19:41.952 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261612211736576 [0;39m 请求地址: http://127.0.0.1:8880/doc/vote/202714909656616960 GET
2022-08-31 18:19:41.952 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261612211736576 [0;39m 类名方法: com.zs.wikibb.controller.DocController.vote
2022-08-31 18:19:41.952 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261612211736576 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:41.952 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261612211736576 [0;39m 请求参数: [202714909656616960]
2022-08-31 18:19:42.160 INFO  com.zs.wikibb.utils.RedisUtil                     :31  
                [32m22261612211736576 [0;39m key不存在，放入：DOC_VOTE_202714909656616960_127.0.0.1，过期 86400 秒
2022-08-31 18:19:42.276 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseVoteCount:137 
                [32m22261612211736576 [0;39m ==>  Preparing: update doc set vote_count=vote_count+1 where id=?
2022-08-31 18:19:42.277 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseVoteCount:137 
                [32m22261612211736576 [0;39m ==> Parameters: 202714909656616960(Long)
2022-08-31 18:19:42.302 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseVoteCount:137 
                [32m22261612211736576 [0;39m <==    Updates: 1
2022-08-31 18:19:42.302 DEBUG com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :137 
                [32m22261612211736576 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2022-08-31 18:19:42.302 DEBUG com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :137 
                [32m22261612211736576 [0;39m ==> Parameters: 202714909656616960(Long)
2022-08-31 18:19:42.303 TRACE com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :143 
                [32m22261612211736576 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 18:19:42.303 TRACE com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :143 
                [32m22261612211736576 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 54, 7
2022-08-31 18:19:42.304 DEBUG com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :137 
                [32m22261612211736576 [0;39m <==      Total: 1
2022-08-31 18:19:42.304 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261612211736576 [0;39m 返回结果: {"success":true}
2022-08-31 18:19:42.304 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261612211736576 [0;39m ------------- 结束 耗时：352 ms -------------
2022-08-31 18:19:42.305 INFO  com.zs.wikibb.websocket.WebSocketServer           :72  
                [32m22261612211736576 [0;39m 推送消息：jDz2dFKboN，内容：【课程导学】被点赞
2022-08-31 18:19:43.297 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261617853075456 [0;39m ------------- 开始 -------------
2022-08-31 18:19:43.298 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261617857269760 [0;39m ------------- 开始 -------------
2022-08-31 18:19:43.298 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261617853075456 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2022-08-31 18:19:43.298 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261617857269760 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2022-08-31 18:19:43.298 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261617857269761 [0;39m ------------- 开始 -------------
2022-08-31 18:19:43.298 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261617853075456 [0;39m 类名方法: com.zs.wikibb.controller.EbookSnapshotController.getStatistic
2022-08-31 18:19:43.298 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261617857269760 [0;39m 类名方法: com.zs.wikibb.controller.EbookSnapshotController.get30Statistic
2022-08-31 18:19:43.298 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261617857269761 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2022-08-31 18:19:43.298 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261617853075456 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:43.298 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261617857269760 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:43.299 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261617857269761 [0;39m 类名方法: com.zs.wikibb.controller.CategoryController.all
2022-08-31 18:19:43.299 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261617853075456 [0;39m 请求参数: []
2022-08-31 18:19:43.299 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261617857269760 [0;39m 请求参数: []
2022-08-31 18:19:43.299 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261617857269761 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:43.299 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261617857269761 [0;39m 请求参数: []
2022-08-31 18:19:43.299 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m22261617857269760 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-08-31 18:19:43.299 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m22261617853075456 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-08-31 18:19:43.300 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22261617857269761 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-08-31 18:19:43.300 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m22261617857269760 [0;39m ==> Parameters: 
2022-08-31 18:19:43.300 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22261617857269761 [0;39m ==> Parameters: 
2022-08-31 18:19:43.301 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261617857269760 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-08-31 18:19:43.301 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==    Columns: id, parent, name, sort
2022-08-31 18:19:43.301 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m22261617853075456 [0;39m ==> Parameters: 
2022-08-31 18:19:43.301 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261617857269760 [0;39m <==        Row: 2022-08-01, 13, 0
2022-08-31 18:19:43.301 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 100, 0, 前端开发, 100
2022-08-31 18:19:43.302 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 101, 100, Vue, 101
2022-08-31 18:19:43.302 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261617857269760 [0;39m <==        Row: 2022-08-17, 342, 54
2022-08-31 18:19:43.302 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261617857269760 [0;39m <==        Row: 2022-08-18, 11, 0
2022-08-31 18:19:43.302 TRACE c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :143 
                [32m22261617853075456 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-08-31 18:19:43.303 TRACE c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :143 
                [32m22261617853075456 [0;39m <==        Row: 2022-08-31, 376, 63, 376, 63
2022-08-31 18:19:43.303 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261617857269760 [0;39m <==        Row: 2022-08-19, 19, 6
2022-08-31 18:19:43.302 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-08-31 18:19:43.303 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m22261617853075456 [0;39m <==      Total: 1
2022-08-31 18:19:43.303 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261617857269760 [0;39m <==        Row: 2022-08-26, 372, 60
2022-08-31 18:19:43.304 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 200, 0, Java, 200
2022-08-31 18:19:43.304 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261617853075456 [0;39m 返回结果: {"content":[{"date":1661875200000,"viewCount":376,"viewIncrease":376,"voteCount":63,"voteIncrease":63}],"success":true}
2022-08-31 18:19:43.304 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261617853075456 [0;39m ------------- 结束 耗时：7 ms -------------
2022-08-31 18:19:43.304 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261617857269760 [0;39m <==        Row: 2022-08-29, 372, 60
2022-08-31 18:19:43.304 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 201, 200, 基础应用, 201
2022-08-31 18:19:43.304 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m22261617857269760 [0;39m <==      Total: 6
2022-08-31 18:19:43.304 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 202, 200, 框架应用, 202
2022-08-31 18:19:43.305 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 181311914796781568, 200, SpringBoot+Vue3 前后端分离知识库系统, 231
2022-08-31 18:19:43.305 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261617857269760 [0;39m 返回结果: {"content":[{"date":1659283200000,"viewCount":0,"viewIncrease":13,"voteCount":0,"voteIncrease":0},{"date":1660665600000,"viewCount":0,"viewIncrease":342,"voteCount":0,"voteIncrease":54},{"date":1660752000000,"viewCount":0,"viewIncrease":11,"voteCount":0,"voteIncrease":0},{"date":1660838400000,"viewCount":0,"viewIncrease":19,"voteCount":0,"voteIncrease":6},{"date":1661443200000,"viewCount":0,"viewIncrease":372,"voteCount":0,"voteIncrease":60},{"date":1661702400000,"viewCount":0,"viewIncrease":372,"voteCount":0,"voteIncrease":60}],"success":true}
2022-08-31 18:19:43.305 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261617857269760 [0;39m ------------- 结束 耗时：7 ms -------------
2022-08-31 18:19:43.305 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 300, 0, Python, 300
2022-08-31 18:19:43.306 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 301, 300, 基础应用, 301
2022-08-31 18:19:43.306 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2022-08-31 18:19:43.307 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 400, 0, 数据库, 400
2022-08-31 18:19:43.307 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 401, 400, MySQL, 401
2022-08-31 18:19:43.308 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 500, 0, 其它, 500
2022-08-31 18:19:43.309 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 501, 500, 服务器, 501
2022-08-31 18:19:43.310 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 502, 500, 开发工具, 502
2022-08-31 18:19:43.310 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261617857269761 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2022-08-31 18:19:43.311 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22261617857269761 [0;39m <==      Total: 16
2022-08-31 18:19:43.313 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261617857269761 [0;39m 返回结果: {"content":[{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":181311914796781568,"name":"SpringBoot+Vue3 前后端分离知识库系统","parent":200,"sort":231},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2022-08-31 18:19:43.313 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261617857269761 [0;39m ------------- 结束 耗时：15 ms -------------
2022-08-31 18:19:45.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261625071472640 [0;39m 生成今日电子书快照开始
2022-08-31 18:19:45.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261625071472640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:19:45.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261625071472640 [0;39m ==> Parameters: 
2022-08-31 18:19:45.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261625071472640 [0;39m <==    Updates: 0
2022-08-31 18:19:45.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261625071472640 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:19:46.366 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261630725394432 [0;39m ------------- 开始 -------------
2022-08-31 18:19:46.367 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261630725394432 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-31 18:19:46.367 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261630725394432 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-31 18:19:46.367 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261630725394432 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:46.367 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261630725394432 [0;39m 请求参数: [{"categoryId2":202,"page":1,"size":1000}]
2022-08-31 18:19:46.369 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22261630725394432 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-08-31 18:19:46.370 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22261630725394432 [0;39m ==> Parameters: 202(Long)
2022-08-31 18:19:46.371 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22261630725394432 [0;39m <==    Columns: count(0)
2022-08-31 18:19:46.371 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m22261630725394432 [0;39m <==        Row: 1
2022-08-31 18:19:46.371 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m22261630725394432 [0;39m <==      Total: 1
2022-08-31 18:19:46.371 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22261630725394432 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2022-08-31 18:19:46.372 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22261630725394432 [0;39m ==> Parameters: 202(Long), 1000(Integer)
2022-08-31 18:19:46.373 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22261630725394432 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-31 18:19:46.374 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m22261630725394432 [0;39m <==        Row: 20420687550353408, Srping Cloud微服务架构, 200, 202, 一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现, null, 1, 1, 0
2022-08-31 18:19:46.374 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m22261630725394432 [0;39m <==      Total: 1
2022-08-31 18:19:46.375 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m22261630725394432 [0;39m 总行数：1
2022-08-31 18:19:46.375 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m22261630725394432 [0;39m 总页数：1
2022-08-31 18:19:46.375 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261630725394432 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现","docCount":1,"id":20420687550353408,"name":"Srping Cloud微服务架构","viewCount":1,"voteCount":0}],"total":1},"success":true}
2022-08-31 18:19:46.375 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261630725394432 [0;39m ------------- 结束 耗时：9 ms -------------
2022-08-31 18:19:47.388 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261635011973120 [0;39m ------------- 开始 -------------
2022-08-31 18:19:47.389 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261635011973120 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-31 18:19:47.389 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261635011973120 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-31 18:19:47.389 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261635011973120 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:47.389 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261635011973120 [0;39m 请求参数: [20420687550353408]
2022-08-31 18:19:47.390 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22261635011973120 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-31 18:19:47.391 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22261635011973120 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-31 18:19:47.392 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261635011973120 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 18:19:47.392 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m22261635011973120 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 1, 0
2022-08-31 18:19:47.392 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m22261635011973120 [0;39m <==      Total: 1
2022-08-31 18:19:47.393 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261635011973120 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":1,"voteCount":0}],"success":true}
2022-08-31 18:19:47.393 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261635011973120 [0;39m ------------- 结束 耗时：5 ms -------------
2022-08-31 18:19:47.400 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261635062304768 [0;39m ------------- 开始 -------------
2022-08-31 18:19:47.401 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261635062304768 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/20420961950109696 GET
2022-08-31 18:19:47.401 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261635062304768 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-31 18:19:47.401 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261635062304768 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:47.401 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261635062304768 [0;39m 请求参数: [20420961950109696]
2022-08-31 18:19:47.401 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261635062304768 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-31 18:19:47.401 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261635062304768 [0;39m ==> Parameters: 20420961950109696(Long)
2022-08-31 18:19:47.402 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m22261635062304768 [0;39m <==    Columns: id, content
2022-08-31 18:19:47.403 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m22261635062304768 [0;39m <==        Row: 20420961950109696, <<BLOB>>
2022-08-31 18:19:47.403 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m22261635062304768 [0;39m <==      Total: 1
2022-08-31 18:19:47.403 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261635062304768 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-31 18:19:47.404 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261635062304768 [0;39m ==> Parameters: 20420961950109696(Long)
2022-08-31 18:19:47.429 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m22261635062304768 [0;39m <==    Updates: 1
2022-08-31 18:19:47.430 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261635062304768 [0;39m 返回结果: {"content":"<blockquote><h2>一、在学习Dubbo分布式框架之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2><h2 id=\"ys69d\"><br></h2><h2 id=\"ys69d\">二、在学习SpringCloud微服务架构之前，先掌握Duboo Zookeeper分布式架构（消费者、提供者、注册中心（在Windows以及linux的安装及运行）、监控中心）</h2></blockquote><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">1.&nbsp; RPC？</font></p><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;RPC 【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技\n</font></p><p><font size=\"3\">术思想，而不是规范。它允许程序调用另一个地址空间（网络的另一台机器上）的过程或函\n</font></p><p><font size=\"3\">数，而不用开发人员显式编码这个调用的细节。调用本地方法和调用远程方法一样。</font>&nbsp;</p><p><font size=\"4\" style=\"background-color: rgb(139, 170, 74);\">2.&nbsp; RPC特点？</font><br></p><p><font size=\"3\">1. 简单：使用简单，建立分布式应用更容易。\n</font></p><p><font size=\"3\">2. 高效：调用过程看起来十分清晰，效率高。\n</font></p><p><font size=\"3\">3. 通用：进程间通讯的方式，有通用的规则。</font></p><p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><hr><p><font size=\"5\">微服务架构4个核心问题？</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; <font size=\"3\">1. 服务很多，客户端该怎么访问？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;2. 这么多服务？ 服务之间如何通信？<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp;3. 这么多服务？如何治理？</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp;<font color=\"#c24f4a\"> &nbsp;4. 服务挂了怎么办 ※？</font></font></p><p><font color=\"#000000\" size=\"5\">解决方案？</font></p><p>&nbsp; &nbsp; &nbsp;<font size=\"4\"> <i style=\"background-color: rgb(139, 170, 74);\">&nbsp; Spring Cloud 是一个很好的生态来解决上面的问题！！</i></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; </font><b style=\"\"><font size=\"3\">&nbsp;</font><font size=\"4\"> 1. spring Cloud NetFlix&nbsp; </font></b><font size=\"4\">&nbsp;一站式解决方案！</font></p><p><font size=\"4\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font face=\"黑体\">&nbsp; &nbsp;</font></font><font face=\"黑体\" size=\"3\">api网关，zuul组件<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Feign通信 ---HttpClinet ---Http通信方式，同步，阻塞<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Eureka<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;熔断机制：Hystrix</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 。。。。<br></p><p><font size=\"4\"><b>&nbsp; &nbsp; &nbsp; &nbsp; 2. Apache Dubbo Zookeeper&nbsp; </b>半自动，需要整合别人的！</font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;<font face=\"黑体\">&nbsp;API:没有，找第三方组件，或者自己实现</font></font><font face=\"黑体\" size=\"3\"><br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;通信：Duboo RPC通信<br></font></p><p><font face=\"黑体\" size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;服务注册发现：Zookeeper</font><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\" face=\"黑体\">没有：借助 Hystrix</font><font face=\"黑体\" size=\"3\"><br></font></p><p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=\"3\" face=\"黑体\"><br></font></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font size=\"4\"><i style=\"background-color: rgb(139, 170, 74);\">Dubbo 这个方案并不完善~~</i></font><br></p><p><font size=\"4\"><b style=\"\">&nbsp; &nbsp; &nbsp; &nbsp; 3</b>. <b style=\"\">Spring Cloud Alibaba&nbsp;&nbsp;</b><b style=\"color: rgb(194, 79, 74);\">new&nbsp; &nbsp;</b><font color=\"#000000\" style=\"\">一站式解决方案!更简单</font></font><font size=\"5\"></font></p>","success":true}
2022-08-31 18:19:47.430 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261635062304768 [0;39m ------------- 结束 耗时：30 ms -------------
2022-08-31 18:19:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261645992660992 [0;39m 生成今日电子书快照开始
2022-08-31 18:19:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261645992660992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:19:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261645992660992 [0;39m ==> Parameters: 
2022-08-31 18:19:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261645992660992 [0;39m <==    Updates: 0
2022-08-31 18:19:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261645992660992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:19:50.980 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261650077913088 [0;39m ------------- 开始 -------------
2022-08-31 18:19:50.980 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261650077913088 [0;39m 请求地址: http://127.0.0.1:8880/doc/vote/20420961950109696 GET
2022-08-31 18:19:50.980 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261650077913088 [0;39m 类名方法: com.zs.wikibb.controller.DocController.vote
2022-08-31 18:19:50.980 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261650077913088 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:50.981 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261650077913088 [0;39m 请求参数: [20420961950109696]
2022-08-31 18:19:51.086 INFO  com.zs.wikibb.utils.RedisUtil                     :31  
                [32m22261650077913088 [0;39m key不存在，放入：DOC_VOTE_20420961950109696_127.0.0.1，过期 86400 秒
2022-08-31 18:19:51.582 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseVoteCount:137 
                [32m22261650077913088 [0;39m ==>  Preparing: update doc set vote_count=vote_count+1 where id=?
2022-08-31 18:19:51.583 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseVoteCount:137 
                [32m22261650077913088 [0;39m ==> Parameters: 20420961950109696(Long)
2022-08-31 18:19:51.613 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseVoteCount:137 
                [32m22261650077913088 [0;39m <==    Updates: 1
2022-08-31 18:19:51.613 DEBUG com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :137 
                [32m22261650077913088 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2022-08-31 18:19:51.614 DEBUG com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :137 
                [32m22261650077913088 [0;39m ==> Parameters: 20420961950109696(Long)
2022-08-31 18:19:51.614 TRACE com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :143 
                [32m22261650077913088 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-31 18:19:51.615 TRACE com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :143 
                [32m22261650077913088 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 2, 1
2022-08-31 18:19:51.615 DEBUG com.zs.wikibb.mapper.DocMapper.selectByPrimaryKey :137 
                [32m22261650077913088 [0;39m <==      Total: 1
2022-08-31 18:19:51.615 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261650077913088 [0;39m 返回结果: {"success":true}
2022-08-31 18:19:51.615 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261650077913088 [0;39m ------------- 结束 耗时：635 ms -------------
2022-08-31 18:19:51.616 INFO  com.zs.wikibb.websocket.WebSocketServer           :72  
                [32m22261650077913088 [0;39m 推送消息：jDz2dFKboN，内容：【导读】被点赞
2022-08-31 18:19:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261666972569600 [0;39m 生成今日电子书快照开始
2022-08-31 18:19:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261666972569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:19:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261666972569600 [0;39m ==> Parameters: 
2022-08-31 18:19:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261666972569600 [0;39m <==    Updates: 0
2022-08-31 18:19:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261666972569600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-31 18:19:55.128 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261667475886081 [0;39m ------------- 开始 -------------
2022-08-31 18:19:55.128 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261667475886080 [0;39m ------------- 开始 -------------
2022-08-31 18:19:55.128 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m22261667475886082 [0;39m ------------- 开始 -------------
2022-08-31 18:19:55.128 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261667475886081 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2022-08-31 18:19:55.128 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261667475886080 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2022-08-31 18:19:55.128 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m22261667475886082 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2022-08-31 18:19:55.128 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261667475886081 [0;39m 类名方法: com.zs.wikibb.controller.CategoryController.all
2022-08-31 18:19:55.128 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261667475886082 [0;39m 类名方法: com.zs.wikibb.controller.EbookSnapshotController.get30Statistic
2022-08-31 18:19:55.128 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m22261667475886080 [0;39m 类名方法: com.zs.wikibb.controller.EbookSnapshotController.getStatistic
2022-08-31 18:19:55.129 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261667475886081 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:55.129 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261667475886082 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:55.129 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m22261667475886080 [0;39m 远程地址: 127.0.0.1
2022-08-31 18:19:55.129 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261667475886081 [0;39m 请求参数: []
2022-08-31 18:19:55.129 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261667475886082 [0;39m 请求参数: []
2022-08-31 18:19:55.129 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m22261667475886080 [0;39m 请求参数: []
2022-08-31 18:19:55.129 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m22261667475886082 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-08-31 18:19:55.129 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22261667475886081 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-08-31 18:19:55.129 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m22261667475886080 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-08-31 18:19:55.130 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22261667475886081 [0;39m ==> Parameters: 
2022-08-31 18:19:55.130 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m22261667475886082 [0;39m ==> Parameters: 
2022-08-31 18:19:55.130 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m22261667475886080 [0;39m ==> Parameters: 
2022-08-31 18:19:55.131 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==    Columns: id, parent, name, sort
2022-08-31 18:19:55.131 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261667475886082 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-08-31 18:19:55.131 TRACE c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :143 
                [32m22261667475886080 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-08-31 18:19:55.132 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261667475886082 [0;39m <==        Row: 2022-08-01, 13, 0
2022-08-31 18:19:55.132 TRACE c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :143 
                [32m22261667475886080 [0;39m <==        Row: 2022-08-31, 376, 63, 376, 63
2022-08-31 18:19:55.131 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 100, 0, 前端开发, 100
2022-08-31 18:19:55.132 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 101, 100, Vue, 101
2022-08-31 18:19:55.132 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261667475886082 [0;39m <==        Row: 2022-08-17, 342, 54
2022-08-31 18:19:55.132 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m22261667475886080 [0;39m <==      Total: 1
2022-08-31 18:19:55.132 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261667475886082 [0;39m <==        Row: 2022-08-18, 11, 0
2022-08-31 18:19:55.133 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261667475886080 [0;39m 返回结果: {"content":[{"date":1661875200000,"viewCount":376,"viewIncrease":376,"voteCount":63,"voteIncrease":63}],"success":true}
2022-08-31 18:19:55.133 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261667475886080 [0;39m ------------- 结束 耗时：5 ms -------------
2022-08-31 18:19:55.133 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261667475886082 [0;39m <==        Row: 2022-08-19, 19, 6
2022-08-31 18:19:55.132 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-08-31 18:19:55.133 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261667475886082 [0;39m <==        Row: 2022-08-26, 372, 60
2022-08-31 18:19:55.133 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 200, 0, Java, 200
2022-08-31 18:19:55.134 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m22261667475886082 [0;39m <==        Row: 2022-08-29, 372, 60
2022-08-31 18:19:55.134 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m22261667475886082 [0;39m <==      Total: 6
2022-08-31 18:19:55.135 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261667475886082 [0;39m 返回结果: {"content":[{"date":1659283200000,"viewCount":0,"viewIncrease":13,"voteCount":0,"voteIncrease":0},{"date":1660665600000,"viewCount":0,"viewIncrease":342,"voteCount":0,"voteIncrease":54},{"date":1660752000000,"viewCount":0,"viewIncrease":11,"voteCount":0,"voteIncrease":0},{"date":1660838400000,"viewCount":0,"viewIncrease":19,"voteCount":0,"voteIncrease":6},{"date":1661443200000,"viewCount":0,"viewIncrease":372,"voteCount":0,"voteIncrease":60},{"date":1661702400000,"viewCount":0,"viewIncrease":372,"voteCount":0,"voteIncrease":60}],"success":true}
2022-08-31 18:19:55.135 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261667475886082 [0;39m ------------- 结束 耗时：7 ms -------------
2022-08-31 18:19:55.134 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 201, 200, 基础应用, 201
2022-08-31 18:19:55.136 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 202, 200, 框架应用, 202
2022-08-31 18:19:55.137 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 181311914796781568, 200, SpringBoot+Vue3 前后端分离知识库系统, 231
2022-08-31 18:19:55.137 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 300, 0, Python, 300
2022-08-31 18:19:55.138 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 301, 300, 基础应用, 301
2022-08-31 18:19:55.138 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2022-08-31 18:19:55.138 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 400, 0, 数据库, 400
2022-08-31 18:19:55.139 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 401, 400, MySQL, 401
2022-08-31 18:19:55.139 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 500, 0, 其它, 500
2022-08-31 18:19:55.139 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 501, 500, 服务器, 501
2022-08-31 18:19:55.140 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 502, 500, 开发工具, 502
2022-08-31 18:19:55.140 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m22261667475886081 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2022-08-31 18:19:55.140 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m22261667475886081 [0;39m <==      Total: 16
2022-08-31 18:19:55.141 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m22261667475886081 [0;39m 返回结果: {"content":[{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":181311914796781568,"name":"SpringBoot+Vue3 前后端分离知识库系统","parent":200,"sort":231},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2022-08-31 18:19:55.141 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m22261667475886081 [0;39m ------------- 结束 耗时：13 ms -------------
2022-08-31 18:19:59.218 INFO  com.zs.wikibb.websocket.WebSocketServer           :41  
                [32m22261617857269761 [0;39m 连接关闭，token：jDz2dFKboN，session id：0！当前连接数：0
2022-08-31 18:20:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m22261687931506688 [0;39m 生成今日电子书快照开始
2022-08-31 18:20:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261687931506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-31 18:20:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261687931506688 [0;39m ==> Parameters: 
2022-08-31 18:20:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m22261687931506688 [0;39m <==    Updates: 0
2022-08-31 18:20:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m22261687931506688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-31 18:20:03.831 INFO  com.zaxxer.hikari.HikariDataSource                :350 
                [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-08-31 18:20:03.836 INFO  com.zaxxer.hikari.HikariDataSource                :352 
                [32m                  [0;39m HikariPool-1 - Shutdown completed.
