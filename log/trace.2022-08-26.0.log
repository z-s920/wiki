2022-08-26 16:20:49.486 INFO  org.hibernate.validator.internal.util.Version     :21  
                [32m                  [0;39m HV000001: Hibernate Validator 6.2.3.Final
2022-08-26 16:20:49.538 INFO  com.zs.wikibb.WikibbApplication                   :55  
                [32m                  [0;39m Starting WikibbApplication using Java 1.8.0_221 on LAPTOP-OO2VPQLS with PID 15380 (D:\wikibb\target\classes started by 张硕 in D:\wikibb)
2022-08-26 16:20:49.539 INFO  com.zs.wikibb.WikibbApplication                   :640 
                [32m                  [0;39m No active profile set, falling back to 1 default profile: "default"
2022-08-26 16:20:49.652 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255 
                [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-08-26 16:20:49.653 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255 
                [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-08-26 16:20:53.198 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262 
                [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-08-26 16:20:53.201 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132 
                [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-08-26 16:20:53.238 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201 
                [32m                  [0;39m Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
2022-08-26 16:20:56.099 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108 
                [32m                  [0;39m Tomcat initialized with port(s): 8880 (http)
2022-08-26 16:20:56.112 INFO  org.apache.coyote.http11.Http11NioProtocol        :173 
                [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8880"]
2022-08-26 16:20:56.113 INFO  org.apache.catalina.core.StandardService          :173 
                [32m                  [0;39m Starting service [Tomcat]
2022-08-26 16:20:56.113 INFO  org.apache.catalina.core.StandardEngine           :173 
                [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.60]
2022-08-26 16:20:56.252 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173 
                [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-08-26 16:20:56.252 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290 
                [32m                  [0;39m Root WebApplicationContext: initialization completed in 6598 ms
2022-08-26 16:20:59.503 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58  
                [32m                  [0;39m LiveReload server is running on port 35729
2022-08-26 16:20:59.537 INFO  org.apache.coyote.http11.Http11NioProtocol        :173 
                [32m                  [0;39m Starting ProtocolHandler ["http-nio-8880"]
2022-08-26 16:20:59.560 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220 
                [32m                  [0;39m Tomcat started on port(s): 8880 (http) with context path ''
2022-08-26 16:20:59.656 INFO  com.zs.wikibb.WikibbApplication                   :61  
                [32m                  [0;39m Started WikibbApplication in 12.086 seconds (JVM running for 18.594)
2022-08-26 16:20:59.659 INFO  com.zs.wikibb.WikibbApplication                   :26  
                [32m                  [0;39m 启动成功！！
2022-08-26 16:20:59.659 INFO  com.zs.wikibb.WikibbApplication                   :27  
                [32m                  [0;39m 地址: 	http://127.0.0.1:8880
2022-08-26 16:21:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20419801310695424 [0;39m 生成今日电子书快照开始
2022-08-26 16:21:00.044 INFO  com.zaxxer.hikari.HikariDataSource                :110 
                [32m20419801310695424 [0;39m HikariPool-1 - Starting...
2022-08-26 16:21:00.810 INFO  com.zaxxer.hikari.HikariDataSource                :123 
                [32m20419801310695424 [0;39m HikariPool-1 - Start completed.
2022-08-26 16:21:00.821 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419801310695424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:21:00.851 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419801310695424 [0;39m ==> Parameters: 
2022-08-26 16:21:01.031 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419801310695424 [0;39m <==    Updates: 7
2022-08-26 16:21:01.035 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20419801310695424 [0;39m 生成今日电子书快照结束，耗时：1020 毫秒
2022-08-26 16:21:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20419822244466688 [0;39m 生成今日电子书快照开始
2022-08-26 16:21:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419822244466688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:21:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419822244466688 [0;39m ==> Parameters: 
2022-08-26 16:21:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419822244466688 [0;39m <==    Updates: 0
2022-08-26 16:21:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20419822244466688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:21:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20419822261243904 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:21:05.029 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20419822261243904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:21:05.030 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20419822261243904 [0;39m ==> Parameters: 
2022-08-26 16:21:05.050 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20419822261243904 [0;39m <==    Updates: 7
2022-08-26 16:21:05.050 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20419822261243904 [0;39m 更新电子书下的文档数据结束，耗时：41 毫秒
2022-08-26 16:21:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20419843266318336 [0;39m 生成今日电子书快照开始
2022-08-26 16:21:10.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419843266318336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:21:10.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419843266318336 [0;39m ==> Parameters: 
2022-08-26 16:21:10.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419843266318336 [0;39m <==    Updates: 0
2022-08-26 16:21:10.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20419843266318336 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 16:21:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20419864191700992 [0;39m 生成今日电子书快照开始
2022-08-26 16:21:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419864191700992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:21:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419864191700992 [0;39m ==> Parameters: 
2022-08-26 16:21:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419864191700992 [0;39m <==    Updates: 0
2022-08-26 16:21:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20419864191700992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:21:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20419885175803904 [0;39m 生成今日电子书快照开始
2022-08-26 16:21:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419885175803904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:21:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419885175803904 [0;39m ==> Parameters: 
2022-08-26 16:21:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419885175803904 [0;39m <==    Updates: 0
2022-08-26 16:21:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20419885175803904 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:21:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20419906168295424 [0;39m 生成今日电子书快照开始
2022-08-26 16:21:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419906168295424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:21:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419906168295424 [0;39m ==> Parameters: 
2022-08-26 16:21:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419906168295424 [0;39m <==    Updates: 0
2022-08-26 16:21:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20419906168295424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:21:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20419927085289472 [0;39m 生成今日电子书快照开始
2022-08-26 16:21:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419927085289472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:21:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419927085289472 [0;39m ==> Parameters: 
2022-08-26 16:21:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419927085289472 [0;39m <==    Updates: 0
2022-08-26 16:21:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20419927085289472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:21:35.000 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20419948052615168 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:21:35.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20419948052615168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:21:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20419948052615168 [0;39m ==> Parameters: 
2022-08-26 16:21:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20419948052615168 [0;39m <==    Updates: 7
2022-08-26 16:21:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20419948052615168 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 16:21:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20419948073586688 [0;39m 生成今日电子书快照开始
2022-08-26 16:21:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419948073586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:21:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419948073586688 [0;39m ==> Parameters: 
2022-08-26 16:21:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419948073586688 [0;39m <==    Updates: 0
2022-08-26 16:21:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20419948073586688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:21:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20419969036718080 [0;39m 生成今日电子书快照开始
2022-08-26 16:21:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419969036718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:21:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419969036718080 [0;39m ==> Parameters: 
2022-08-26 16:21:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419969036718080 [0;39m <==    Updates: 0
2022-08-26 16:21:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20419969036718080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:21:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20419990041792512 [0;39m 生成今日电子书快照开始
2022-08-26 16:21:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419990041792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:21:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419990041792512 [0;39m ==> Parameters: 
2022-08-26 16:21:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20419990041792512 [0;39m <==    Updates: 0
2022-08-26 16:21:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20419990041792512 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 16:21:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420010988146688 [0;39m 生成今日电子书快照开始
2022-08-26 16:21:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420010988146688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:21:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420010988146688 [0;39m ==> Parameters: 
2022-08-26 16:21:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420010988146688 [0;39m <==    Updates: 0
2022-08-26 16:21:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420010988146688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:21:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420031955472384 [0;39m 生成今日电子书快照开始
2022-08-26 16:21:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420031955472384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:21:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420031955472384 [0;39m ==> Parameters: 
2022-08-26 16:21:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420031955472384 [0;39m <==    Updates: 0
2022-08-26 16:21:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420031955472384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:22:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420052977324032 [0;39m 生成今日电子书快照开始
2022-08-26 16:22:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420052977324032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:22:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420052977324032 [0;39m ==> Parameters: 
2022-08-26 16:22:00.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420052977324032 [0;39m <==    Updates: 0
2022-08-26 16:22:00.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420052977324032 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 16:22:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420073898512384 [0;39m 生成今日电子书快照开始
2022-08-26 16:22:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420073898512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:22:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420073898512384 [0;39m ==> Parameters: 
2022-08-26 16:22:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420073898512384 [0;39m <==    Updates: 0
2022-08-26 16:22:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420073898512384 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:22:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20420073940455424 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:22:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420073940455424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:22:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420073940455424 [0;39m ==> Parameters: 
2022-08-26 16:22:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420073940455424 [0;39m <==    Updates: 7
2022-08-26 16:22:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20420073940455424 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:22:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420094865838080 [0;39m 生成今日电子书快照开始
2022-08-26 16:22:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420094865838080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:22:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420094865838080 [0;39m ==> Parameters: 
2022-08-26 16:22:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420094865838080 [0;39m <==    Updates: 0
2022-08-26 16:22:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420094865838080 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:22:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420115837358080 [0;39m 生成今日电子书快照开始
2022-08-26 16:22:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420115837358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:22:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420115837358080 [0;39m ==> Parameters: 
2022-08-26 16:22:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420115837358080 [0;39m <==    Updates: 0
2022-08-26 16:22:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420115837358080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:22:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420136800489472 [0;39m 生成今日电子书快照开始
2022-08-26 16:22:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420136800489472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:22:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420136800489472 [0;39m ==> Parameters: 
2022-08-26 16:22:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420136800489472 [0;39m <==    Updates: 0
2022-08-26 16:22:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420136800489472 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 16:22:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420157772009472 [0;39m 生成今日电子书快照开始
2022-08-26 16:22:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420157772009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:22:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420157772009472 [0;39m ==> Parameters: 
2022-08-26 16:22:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420157772009472 [0;39m <==    Updates: 0
2022-08-26 16:22:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420157772009472 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 16:22:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420178764500992 [0;39m 生成今日电子书快照开始
2022-08-26 16:22:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420178764500992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:22:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420178764500992 [0;39m ==> Parameters: 
2022-08-26 16:22:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420178764500992 [0;39m <==    Updates: 0
2022-08-26 16:22:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420178764500992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:22:30.430 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173 
                [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-08-26 16:22:30.431 INFO  org.springframework.web.servlet.DispatcherServlet :525 
                [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-08-26 16:22:30.433 INFO  org.springframework.web.servlet.DispatcherServlet :547 
                [32m                  [0;39m Completed initialization in 2 ms
2022-08-26 16:22:30.564 INFO  com.zs.wikibb.websocket.WebSocketServer           :32  
                [32m                  [0;39m 有新连接：token：t1b0lbY4uB，session id：0，当前连接数：1
2022-08-26 16:22:30.631 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420181377552386 [0;39m ------------- 开始 -------------
2022-08-26 16:22:30.631 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420181377552384 [0;39m ------------- 开始 -------------
2022-08-26 16:22:30.631 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420181377552385 [0;39m ------------- 开始 -------------
2022-08-26 16:22:30.632 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420181377552386 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2022-08-26 16:22:30.632 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420181377552385 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2022-08-26 16:22:30.632 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420181377552384 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2022-08-26 16:22:30.632 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420181377552386 [0;39m 类名方法: com.zs.wikibb.controller.CategoryController.all
2022-08-26 16:22:30.632 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420181377552385 [0;39m 类名方法: com.zs.wikibb.controller.EbookSnapshotController.get30Statistic
2022-08-26 16:22:30.632 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420181377552384 [0;39m 类名方法: com.zs.wikibb.controller.EbookSnapshotController.getStatistic
2022-08-26 16:22:30.633 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420181377552384 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:30.633 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420181377552385 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:30.633 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420181377552386 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:30.682 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420181377552384 [0;39m 请求参数: []
2022-08-26 16:22:30.682 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420181377552385 [0;39m 请求参数: []
2022-08-26 16:22:30.682 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420181377552386 [0;39m 请求参数: []
2022-08-26 16:22:30.688 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m20420181377552384 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-08-26 16:22:30.688 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m20420181377552385 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-08-26 16:22:30.689 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m20420181377552385 [0;39m ==> Parameters: 
2022-08-26 16:22:30.689 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m20420181377552384 [0;39m ==> Parameters: 
2022-08-26 16:22:30.706 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m20420181377552386 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-08-26 16:22:30.707 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m20420181377552386 [0;39m ==> Parameters: 
2022-08-26 16:22:30.713 TRACE c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :143 
                [32m20420181377552384 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-08-26 16:22:30.713 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m20420181377552385 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-08-26 16:22:30.714 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m20420181377552385 [0;39m <==        Row: 2022-07-27, 7, 0
2022-08-26 16:22:30.714 TRACE c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :143 
                [32m20420181377552384 [0;39m <==        Row: 2022-08-26, 372, 60, 372, 60
2022-08-26 16:22:30.717 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.getStatistic :137 
                [32m20420181377552384 [0;39m <==      Total: 1
2022-08-26 16:22:30.717 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m20420181377552385 [0;39m <==        Row: 2022-07-28, 26, 3
2022-08-26 16:22:30.718 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m20420181377552385 [0;39m <==        Row: 2022-07-29, 25, 4
2022-08-26 16:22:30.719 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m20420181377552385 [0;39m <==        Row: 2022-07-30, 24, 0
2022-08-26 16:22:30.720 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==    Columns: id, parent, name, sort
2022-08-26 16:22:30.720 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m20420181377552385 [0;39m <==        Row: 2022-07-31, 5, -1
2022-08-26 16:22:30.720 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 100, 0, 前端开发, 100
2022-08-26 16:22:30.721 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m20420181377552385 [0;39m <==        Row: 2022-08-01, 13, 0
2022-08-26 16:22:30.721 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 101, 100, Vue, 101
2022-08-26 16:22:30.722 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-08-26 16:22:30.722 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m20420181377552385 [0;39m <==        Row: 2022-08-17, 342, 54
2022-08-26 16:22:30.722 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 200, 0, Java, 200
2022-08-26 16:22:30.722 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m20420181377552385 [0;39m <==        Row: 2022-08-18, 11, 0
2022-08-26 16:22:30.723 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 201, 200, 基础应用, 201
2022-08-26 16:22:30.723 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 202, 200, 框架应用, 202
2022-08-26 16:22:30.724 TRACE c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :143 
                [32m20420181377552385 [0;39m <==        Row: 2022-08-19, 19, 6
2022-08-26 16:22:30.724 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 181311914796781568, 200, SpringBoot+Vue3 前后端分离知识库系统, 231
2022-08-26 16:22:30.724 DEBUG c.z.w.m.EbookSnapshotMapperCust.get30Statistic    :137 
                [32m20420181377552385 [0;39m <==      Total: 9
2022-08-26 16:22:30.725 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 300, 0, Python, 300
2022-08-26 16:22:30.725 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 301, 300, 基础应用, 301
2022-08-26 16:22:30.726 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2022-08-26 16:22:30.727 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 400, 0, 数据库, 400
2022-08-26 16:22:30.728 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 401, 400, MySQL, 401
2022-08-26 16:22:30.728 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 500, 0, 其它, 500
2022-08-26 16:22:30.729 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 501, 500, 服务器, 501
2022-08-26 16:22:30.729 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 502, 500, 开发工具, 502
2022-08-26 16:22:30.730 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420181377552386 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2022-08-26 16:22:30.732 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m20420181377552386 [0;39m <==      Total: 16
2022-08-26 16:22:30.754 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420181377552386 [0;39m 返回结果: {"content":[{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":181311914796781568,"name":"SpringBoot+Vue3 前后端分离知识库系统","parent":200,"sort":231},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2022-08-26 16:22:30.755 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420181377552386 [0;39m ------------- 结束 耗时：126 ms -------------
2022-08-26 16:22:30.755 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420181377552385 [0;39m 返回结果: {"content":[{"date":1658851200000,"viewCount":0,"viewIncrease":7,"voteCount":0,"voteIncrease":0},{"date":1658937600000,"viewCount":0,"viewIncrease":26,"voteCount":0,"voteIncrease":3},{"date":1659024000000,"viewCount":0,"viewIncrease":25,"voteCount":0,"voteIncrease":4},{"date":1659110400000,"viewCount":0,"viewIncrease":24,"voteCount":0,"voteIncrease":0},{"date":1659196800000,"viewCount":0,"viewIncrease":5,"voteCount":0,"voteIncrease":-1},{"date":1659283200000,"viewCount":0,"viewIncrease":13,"voteCount":0,"voteIncrease":0},{"date":1660665600000,"viewCount":0,"viewIncrease":342,"voteCount":0,"voteIncrease":54},{"date":1660752000000,"viewCount":0,"viewIncrease":11,"voteCount":0,"voteIncrease":0},{"date":1660838400000,"viewCount":0,"viewIncrease":19,"voteCount":0,"voteIncrease":6}],"success":true}
2022-08-26 16:22:30.755 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420181377552384 [0;39m 返回结果: {"content":[{"date":1661443200000,"viewCount":372,"viewIncrease":372,"voteCount":60,"voteIncrease":60}],"success":true}
2022-08-26 16:22:30.756 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420181377552385 [0;39m ------------- 结束 耗时：127 ms -------------
2022-08-26 16:22:30.756 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420181377552384 [0;39m ------------- 结束 耗时：127 ms -------------
2022-08-26 16:22:35.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20420199719243776 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:22:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420199719243776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:22:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420199719243776 [0;39m ==> Parameters: 
2022-08-26 16:22:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420199719243776 [0;39m <==    Updates: 7
2022-08-26 16:22:35.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20420199719243776 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:22:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420199727632384 [0;39m 生成今日电子书快照开始
2022-08-26 16:22:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420199727632384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:22:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420199727632384 [0;39m ==> Parameters: 
2022-08-26 16:22:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420199727632384 [0;39m <==    Updates: 0
2022-08-26 16:22:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420199727632384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:22:39.071 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420216785866752 [0;39m ------------- 开始 -------------
2022-08-26 16:22:39.071 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420216785866752 [0;39m 请求地址: http://127.0.0.1:8880/user_wiki/login POST
2022-08-26 16:22:39.071 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420216785866752 [0;39m 类名方法: com.zs.wikibb.controller.UserwikiController.login
2022-08-26 16:22:39.071 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420216785866752 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:39.073 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420216785866752 [0;39m 请求参数: [{"loginName":"test"}]
2022-08-26 16:22:39.086 DEBUG c.zs.wikibb.mapper.UserwikiMapper.selectByExample :137 
                [32m20420216785866752 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from userwiki WHERE ( login_name = ? )
2022-08-26 16:22:39.086 DEBUG c.zs.wikibb.mapper.UserwikiMapper.selectByExample :137 
                [32m20420216785866752 [0;39m ==> Parameters: test(String)
2022-08-26 16:22:39.094 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m20420216785866752 [0;39m <==    Columns: id, login_name, name, password
2022-08-26 16:22:39.095 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m20420216785866752 [0;39m <==        Row: 1, test, 测试, e70e2222a9d67c4f2eae107533359aa4
2022-08-26 16:22:39.095 DEBUG c.zs.wikibb.mapper.UserwikiMapper.selectByExample :137 
                [32m20420216785866752 [0;39m <==      Total: 1
2022-08-26 16:22:39.099 INFO  com.zs.wikibb.controller.UserwikiController       :86  
                [32m20420216785866752 [0;39m 生成单点登录token，并放入redis中
2022-08-26 16:22:40.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420220682375168 [0;39m 生成今日电子书快照开始
2022-08-26 16:22:40.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420220682375168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:22:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420220682375168 [0;39m ==> Parameters: 
2022-08-26 16:22:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420220682375168 [0;39m <==    Updates: 0
2022-08-26 16:22:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420220682375168 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:22:40.777 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420216785866752 [0;39m 返回结果: {"content":{"id":1,"loginName":"test","name":"测试","token":"20420216903307264"},"success":true}
2022-08-26 16:22:40.777 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420216785866752 [0;39m ------------- 结束 耗时：1706 ms -------------
2022-08-26 16:22:42.161 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420229746266112 [0;39m ------------- 开始 -------------
2022-08-26 16:22:42.161 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420229746266112 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2022-08-26 16:22:42.161 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420229746266112 [0;39m 类名方法: com.zs.wikibb.controller.CategoryController.all
2022-08-26 16:22:42.162 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420229746266112 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:42.162 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420229746266112 [0;39m 请求参数: []
2022-08-26 16:22:42.163 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m20420229746266112 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-08-26 16:22:42.163 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m20420229746266112 [0;39m ==> Parameters: 
2022-08-26 16:22:42.165 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==    Columns: id, parent, name, sort
2022-08-26 16:22:42.165 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 100, 0, 前端开发, 100
2022-08-26 16:22:42.166 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 101, 100, Vue, 101
2022-08-26 16:22:42.166 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-08-26 16:22:42.166 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 200, 0, Java, 200
2022-08-26 16:22:42.167 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 201, 200, 基础应用, 201
2022-08-26 16:22:42.168 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 202, 200, 框架应用, 202
2022-08-26 16:22:42.169 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 181311914796781568, 200, SpringBoot+Vue3 前后端分离知识库系统, 231
2022-08-26 16:22:42.169 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 300, 0, Python, 300
2022-08-26 16:22:42.170 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 301, 300, 基础应用, 301
2022-08-26 16:22:42.170 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2022-08-26 16:22:42.170 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 400, 0, 数据库, 400
2022-08-26 16:22:42.171 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 401, 400, MySQL, 401
2022-08-26 16:22:42.171 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 500, 0, 其它, 500
2022-08-26 16:22:42.172 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 501, 500, 服务器, 501
2022-08-26 16:22:42.173 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 502, 500, 开发工具, 502
2022-08-26 16:22:42.173 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420229746266112 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2022-08-26 16:22:42.173 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m20420229746266112 [0;39m <==      Total: 16
2022-08-26 16:22:42.175 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420229746266112 [0;39m 返回结果: {"content":[{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":181311914796781568,"name":"SpringBoot+Vue3 前后端分离知识库系统","parent":200,"sort":231},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2022-08-26 16:22:42.175 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420229746266112 [0;39m ------------- 结束 耗时：14 ms -------------
2022-08-26 16:22:42.303 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420230341857280 [0;39m ------------- 开始 -------------
2022-08-26 16:22:42.303 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420230341857280 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-26 16:22:42.303 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420230341857280 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-26 16:22:42.304 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420230341857280 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:42.307 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420230341857280 [0;39m 请求参数: [{"page":1,"size":4}]
2022-08-26 16:22:42.351 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420230341857280 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-08-26 16:22:42.351 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420230341857280 [0;39m ==> Parameters: 
2022-08-26 16:22:42.353 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420230341857280 [0;39m <==    Columns: count(0)
2022-08-26 16:22:42.354 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420230341857280 [0;39m <==        Row: 7
2022-08-26 16:22:42.355 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420230341857280 [0;39m <==      Total: 1
2022-08-26 16:22:42.358 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420230341857280 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-08-26 16:22:42.358 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420230341857280 [0;39m ==> Parameters: 4(Integer)
2022-08-26 16:22:42.359 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420230341857280 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-26 16:22:42.360 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420230341857280 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover1.png, 4, 62, 10
2022-08-26 16:22:42.360 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420230341857280 [0;39m <==        Row: 2, Vue 入门教程, 100, 503, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover2.png, 7, 39, 10
2022-08-26 16:22:42.360 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420230341857280 [0;39m <==        Row: 3, Python 入门教程, 200, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 2, 1
2022-08-26 16:22:42.361 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420230341857280 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, /image/cover2.png, 1, 1, 0
2022-08-26 16:22:42.361 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420230341857280 [0;39m <==      Total: 4
2022-08-26 16:22:42.362 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m20420230341857280 [0;39m 总行数：7
2022-08-26 16:22:42.363 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m20420230341857280 [0;39m 总页数：2
2022-08-26 16:22:42.370 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420230341857280 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover1.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":4,"id":1,"name":"Spring Boot 入门教程","viewCount":62,"voteCount":10},{"category1Id":100,"category2Id":503,"cover":"/image/cover2.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":7,"id":2,"name":"Vue 入门教程","viewCount":39,"voteCount":10},{"category1Id":200,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python 入门教程","viewCount":2,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":1,"voteCount":0}],"total":7},"success":true}
2022-08-26 16:22:42.371 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420230341857280 [0;39m ------------- 结束 耗时：68 ms -------------
2022-08-26 16:22:43.777 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420236524261376 [0;39m ------------- 开始 -------------
2022-08-26 16:22:43.777 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420236524261376 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-26 16:22:43.777 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420236524261376 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-26 16:22:43.777 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420236524261376 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:43.778 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420236524261376 [0;39m 请求参数: [{"page":2,"size":4}]
2022-08-26 16:22:43.779 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420236524261376 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-08-26 16:22:43.780 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420236524261376 [0;39m ==> Parameters: 
2022-08-26 16:22:43.780 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420236524261376 [0;39m <==    Columns: count(0)
2022-08-26 16:22:43.781 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420236524261376 [0;39m <==        Row: 7
2022-08-26 16:22:43.781 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420236524261376 [0;39m <==      Total: 1
2022-08-26 16:22:43.781 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420236524261376 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?, ?
2022-08-26 16:22:43.782 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420236524261376 [0;39m ==> Parameters: 4(Long), 4(Integer)
2022-08-26 16:22:43.783 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420236524261376 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-26 16:22:43.783 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420236524261376 [0;39m <==        Row: 5, Oracle入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 0, 0
2022-08-26 16:22:43.784 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420236524261376 [0;39m <==        Row: 6, Vue CLI 入门教程, 100, 101, Vue CLI 用于快速搭建基于VUE的前端, /image/cover1.png, 1, 9, 1
2022-08-26 16:22:43.784 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420236524261376 [0;39m <==        Row: 202714600712572928, Wiki个人知识库, 200, 181311914796781568, 本文档讲述了知识库的开发过程以及遇到的问题！, /image/cover2.png, 12, 259, 38
2022-08-26 16:22:43.784 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420236524261376 [0;39m <==      Total: 3
2022-08-26 16:22:43.784 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m20420236524261376 [0;39m 总行数：7
2022-08-26 16:22:43.785 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m20420236524261376 [0;39m 总页数：2
2022-08-26 16:22:43.785 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420236524261376 [0;39m 返回结果: {"content":{"list":[{"category1Id":400,"category2Id":401,"cover":"/image/cover1.png","description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle入门教程","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"Vue CLI 用于快速搭建基于VUE的前端","docCount":1,"id":6,"name":"Vue CLI 入门教程","viewCount":9,"voteCount":1},{"category1Id":200,"category2Id":181311914796781568,"cover":"/image/cover2.png","description":"本文档讲述了知识库的开发过程以及遇到的问题！","docCount":12,"id":202714600712572928,"name":"Wiki个人知识库","viewCount":259,"voteCount":38}],"total":7},"success":true}
2022-08-26 16:22:43.785 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420236524261376 [0;39m ------------- 结束 耗时：8 ms -------------
2022-08-26 16:22:44.792 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420240781479936 [0;39m ------------- 开始 -------------
2022-08-26 16:22:44.793 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420240781479936 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-26 16:22:44.793 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420240781479936 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-26 16:22:44.793 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420240781479936 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:44.793 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420240781479936 [0;39m 请求参数: [202714600712572928]
2022-08-26 16:22:44.801 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m20420240781479936 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-26 16:22:44.802 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m20420240781479936 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-26 16:22:44.803 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420240781479936 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-26 16:22:44.804 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420240781479936 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 52, 6
2022-08-26 16:22:44.804 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420240781479936 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 44, 5
2022-08-26 16:22:44.805 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420240781479936 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-26 16:22:44.805 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420240781479936 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 22, 3
2022-08-26 16:22:44.806 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420240781479936 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 27, 5
2022-08-26 16:22:44.807 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420240781479936 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 27, 2
2022-08-26 16:22:44.807 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420240781479936 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 10, 2
2022-08-26 16:22:44.808 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420240781479936 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 13, 4
2022-08-26 16:22:44.809 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420240781479936 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 11, 2
2022-08-26 16:22:44.809 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420240781479936 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 10, 1
2022-08-26 16:22:44.810 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420240781479936 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 5, 2
2022-08-26 16:22:44.811 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420240781479936 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 5, 3
2022-08-26 16:22:44.812 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m20420240781479936 [0;39m <==      Total: 12
2022-08-26 16:22:44.825 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420240781479936 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":52,"voteCount":6},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":44,"voteCount":5},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":22,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":27,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":27,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":10,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":13,"voteCount":4},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":11,"voteCount":2},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":10,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":5,"voteCount":2},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":5,"voteCount":3}],"success":true}
2022-08-26 16:22:44.826 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420240781479936 [0;39m ------------- 结束 耗时：34 ms -------------
2022-08-26 16:22:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420241704226816 [0;39m 生成今日电子书快照开始
2022-08-26 16:22:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420241704226816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:22:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420241704226816 [0;39m ==> Parameters: 
2022-08-26 16:22:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420241704226816 [0;39m <==    Updates: 0
2022-08-26 16:22:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420241704226816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:22:45.882 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-26 16:22:45.883 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：0 ms -------------
2022-08-26 16:22:45.886 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m20420216785866752 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-26 16:22:45.886 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m20420216785866752 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/user_wiki/list
2022-08-26 16:22:45.886 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m20420216785866752 [0;39m 登录校验开始，token：20420216903307264
2022-08-26 16:22:45.925 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m20420216785866752 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"20420216903307264"}
2022-08-26 16:22:45.958 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420245672038400 [0;39m ------------- 开始 -------------
2022-08-26 16:22:45.959 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420245672038400 [0;39m 请求地址: http://127.0.0.1:8880/user_wiki/list GET
2022-08-26 16:22:45.959 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420245672038400 [0;39m 类名方法: com.zs.wikibb.controller.UserwikiController.list
2022-08-26 16:22:45.959 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420245672038400 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:45.960 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420245672038400 [0;39m 请求参数: [{"page":1,"size":10}]
2022-08-26 16:22:45.961 DEBUG c.z.w.mapper.UserwikiMapper.selectByExample_COUNT :137 
                [32m20420245672038400 [0;39m ==>  Preparing: SELECT count(0) FROM userwiki
2022-08-26 16:22:45.962 DEBUG c.z.w.mapper.UserwikiMapper.selectByExample_COUNT :137 
                [32m20420245672038400 [0;39m ==> Parameters: 
2022-08-26 16:22:45.963 TRACE c.z.w.mapper.UserwikiMapper.selectByExample_COUNT :143 
                [32m20420245672038400 [0;39m <==    Columns: count(0)
2022-08-26 16:22:45.963 TRACE c.z.w.mapper.UserwikiMapper.selectByExample_COUNT :143 
                [32m20420245672038400 [0;39m <==        Row: 3
2022-08-26 16:22:45.963 DEBUG c.z.w.mapper.UserwikiMapper.selectByExample_COUNT :137 
                [32m20420245672038400 [0;39m <==      Total: 1
2022-08-26 16:22:45.964 DEBUG c.zs.wikibb.mapper.UserwikiMapper.selectByExample :137 
                [32m20420245672038400 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from userwiki LIMIT ?
2022-08-26 16:22:45.964 DEBUG c.zs.wikibb.mapper.UserwikiMapper.selectByExample :137 
                [32m20420245672038400 [0;39m ==> Parameters: 10(Integer)
2022-08-26 16:22:45.965 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m20420245672038400 [0;39m <==    Columns: id, login_name, name, password
2022-08-26 16:22:45.965 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m20420245672038400 [0;39m <==        Row: 1, test, 测试, e70e2222a9d67c4f2eae107533359aa4
2022-08-26 16:22:45.965 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m20420245672038400 [0;39m <==        Row: 2, zhangshuo, 张硕, 0099120649bc7c7807f8188f97a66c59
2022-08-26 16:22:45.966 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m20420245672038400 [0;39m <==        Row: 3, zhangyishan, 张一山, e70e2222a9d67c4f2eae107533359aa4
2022-08-26 16:22:45.966 DEBUG c.zs.wikibb.mapper.UserwikiMapper.selectByExample :137 
                [32m20420245672038400 [0;39m <==      Total: 3
2022-08-26 16:22:45.966 INFO  com.zs.wikibb.service.UserwikiService             :49  
                [32m20420245672038400 [0;39m 总行数：3
2022-08-26 16:22:45.966 INFO  com.zs.wikibb.service.UserwikiService             :50  
                [32m20420245672038400 [0;39m 总页数：1
2022-08-26 16:22:45.972 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420245672038400 [0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":2,"loginName":"zhangshuo","name":"张硕"},{"id":3,"loginName":"zhangyishan","name":"张一山"}],"total":3},"success":true}
2022-08-26 16:22:45.972 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420245672038400 [0;39m ------------- 结束 耗时：14 ms -------------
2022-08-26 16:22:45.974 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m20420245672038400 [0;39m ------------- LoginInterceptor 结束 耗时：88 ms -------------
2022-08-26 16:22:46.934 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-26 16:22:46.934 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/user_wiki/list
2022-08-26 16:22:46.934 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m                  [0;39m 登录校验开始，token：20420216903307264
2022-08-26 16:22:46.969 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m                  [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"20420216903307264"}
2022-08-26 16:22:46.970 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420249916674048 [0;39m ------------- 开始 -------------
2022-08-26 16:22:46.971 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420249916674048 [0;39m 请求地址: http://127.0.0.1:8880/user_wiki/list GET
2022-08-26 16:22:46.971 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420249916674048 [0;39m 类名方法: com.zs.wikibb.controller.UserwikiController.list
2022-08-26 16:22:46.971 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420249916674048 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:46.971 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420249916674048 [0;39m 请求参数: [{"page":1,"size":10}]
2022-08-26 16:22:46.973 DEBUG c.z.w.mapper.UserwikiMapper.selectByExample_COUNT :137 
                [32m20420249916674048 [0;39m ==>  Preparing: SELECT count(0) FROM userwiki
2022-08-26 16:22:46.973 DEBUG c.z.w.mapper.UserwikiMapper.selectByExample_COUNT :137 
                [32m20420249916674048 [0;39m ==> Parameters: 
2022-08-26 16:22:46.974 TRACE c.z.w.mapper.UserwikiMapper.selectByExample_COUNT :143 
                [32m20420249916674048 [0;39m <==    Columns: count(0)
2022-08-26 16:22:46.974 TRACE c.z.w.mapper.UserwikiMapper.selectByExample_COUNT :143 
                [32m20420249916674048 [0;39m <==        Row: 3
2022-08-26 16:22:46.974 DEBUG c.z.w.mapper.UserwikiMapper.selectByExample_COUNT :137 
                [32m20420249916674048 [0;39m <==      Total: 1
2022-08-26 16:22:46.974 DEBUG c.zs.wikibb.mapper.UserwikiMapper.selectByExample :137 
                [32m20420249916674048 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from userwiki LIMIT ?
2022-08-26 16:22:46.975 DEBUG c.zs.wikibb.mapper.UserwikiMapper.selectByExample :137 
                [32m20420249916674048 [0;39m ==> Parameters: 10(Integer)
2022-08-26 16:22:46.975 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m20420249916674048 [0;39m <==    Columns: id, login_name, name, password
2022-08-26 16:22:46.975 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m20420249916674048 [0;39m <==        Row: 1, test, 测试, e70e2222a9d67c4f2eae107533359aa4
2022-08-26 16:22:46.976 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m20420249916674048 [0;39m <==        Row: 2, zhangshuo, 张硕, 0099120649bc7c7807f8188f97a66c59
2022-08-26 16:22:46.976 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m20420249916674048 [0;39m <==        Row: 3, zhangyishan, 张一山, e70e2222a9d67c4f2eae107533359aa4
2022-08-26 16:22:46.976 DEBUG c.zs.wikibb.mapper.UserwikiMapper.selectByExample :137 
                [32m20420249916674048 [0;39m <==      Total: 3
2022-08-26 16:22:46.976 INFO  com.zs.wikibb.service.UserwikiService             :49  
                [32m20420249916674048 [0;39m 总行数：3
2022-08-26 16:22:46.977 INFO  com.zs.wikibb.service.UserwikiService             :50  
                [32m20420249916674048 [0;39m 总页数：1
2022-08-26 16:22:46.977 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420249916674048 [0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":2,"loginName":"zhangshuo","name":"张硕"},{"id":3,"loginName":"zhangyishan","name":"张一山"}],"total":3},"success":true}
2022-08-26 16:22:46.977 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420249916674048 [0;39m ------------- 结束 耗时：7 ms -------------
2022-08-26 16:22:46.978 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m20420249916674048 [0;39m ------------- LoginInterceptor 结束 耗时：44 ms -------------
2022-08-26 16:22:47.814 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420253456666624 [0;39m ------------- 开始 -------------
2022-08-26 16:22:47.815 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420253456666624 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2022-08-26 16:22:47.815 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420253456666624 [0;39m 类名方法: com.zs.wikibb.controller.CategoryController.all
2022-08-26 16:22:47.815 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420253456666624 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:47.815 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420253456666624 [0;39m 请求参数: []
2022-08-26 16:22:47.816 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m20420253456666624 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-08-26 16:22:47.817 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m20420253456666624 [0;39m ==> Parameters: 
2022-08-26 16:22:47.818 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==    Columns: id, parent, name, sort
2022-08-26 16:22:47.818 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 100, 0, 前端开发, 100
2022-08-26 16:22:47.819 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 101, 100, Vue, 101
2022-08-26 16:22:47.819 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-08-26 16:22:47.819 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 200, 0, Java, 200
2022-08-26 16:22:47.820 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 201, 200, 基础应用, 201
2022-08-26 16:22:47.820 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 202, 200, 框架应用, 202
2022-08-26 16:22:47.820 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 181311914796781568, 200, SpringBoot+Vue3 前后端分离知识库系统, 231
2022-08-26 16:22:47.820 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 300, 0, Python, 300
2022-08-26 16:22:47.821 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 301, 300, 基础应用, 301
2022-08-26 16:22:47.821 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2022-08-26 16:22:47.821 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 400, 0, 数据库, 400
2022-08-26 16:22:47.822 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 401, 400, MySQL, 401
2022-08-26 16:22:47.822 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 500, 0, 其它, 500
2022-08-26 16:22:47.823 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 501, 500, 服务器, 501
2022-08-26 16:22:47.823 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 502, 500, 开发工具, 502
2022-08-26 16:22:47.823 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420253456666624 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2022-08-26 16:22:47.824 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m20420253456666624 [0;39m <==      Total: 16
2022-08-26 16:22:47.826 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420253456666624 [0;39m 返回结果: {"content":[{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":181311914796781568,"name":"SpringBoot+Vue3 前后端分离知识库系统","parent":200,"sort":231},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2022-08-26 16:22:47.826 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420253456666624 [0;39m ------------- 结束 耗时：12 ms -------------
2022-08-26 16:22:47.838 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420253557329920 [0;39m ------------- 开始 -------------
2022-08-26 16:22:47.838 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420253557329920 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-26 16:22:47.839 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420253557329920 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-26 16:22:47.839 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420253557329920 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:47.839 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420253557329920 [0;39m 请求参数: [{"page":1,"size":4}]
2022-08-26 16:22:47.841 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420253557329920 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-08-26 16:22:47.842 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420253557329920 [0;39m ==> Parameters: 
2022-08-26 16:22:47.843 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420253557329920 [0;39m <==    Columns: count(0)
2022-08-26 16:22:47.843 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420253557329920 [0;39m <==        Row: 7
2022-08-26 16:22:47.844 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420253557329920 [0;39m <==      Total: 1
2022-08-26 16:22:47.845 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420253557329920 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-08-26 16:22:47.845 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420253557329920 [0;39m ==> Parameters: 4(Integer)
2022-08-26 16:22:47.846 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420253557329920 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-26 16:22:47.846 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420253557329920 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover1.png, 4, 62, 10
2022-08-26 16:22:47.847 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420253557329920 [0;39m <==        Row: 2, Vue 入门教程, 100, 503, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover2.png, 7, 39, 10
2022-08-26 16:22:47.847 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420253557329920 [0;39m <==        Row: 3, Python 入门教程, 200, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 2, 1
2022-08-26 16:22:47.847 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420253557329920 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, /image/cover2.png, 1, 1, 0
2022-08-26 16:22:47.847 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420253557329920 [0;39m <==      Total: 4
2022-08-26 16:22:47.848 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m20420253557329920 [0;39m 总行数：7
2022-08-26 16:22:47.848 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m20420253557329920 [0;39m 总页数：2
2022-08-26 16:22:47.848 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420253557329920 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover1.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":4,"id":1,"name":"Spring Boot 入门教程","viewCount":62,"voteCount":10},{"category1Id":100,"category2Id":503,"cover":"/image/cover2.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":7,"id":2,"name":"Vue 入门教程","viewCount":39,"voteCount":10},{"category1Id":200,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python 入门教程","viewCount":2,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":1,"voteCount":0}],"total":7},"success":true}
2022-08-26 16:22:47.848 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420253557329920 [0;39m ------------- 结束 耗时：10 ms -------------
2022-08-26 16:22:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420262663163904 [0;39m 生成今日电子书快照开始
2022-08-26 16:22:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420262663163904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:22:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420262663163904 [0;39m ==> Parameters: 
2022-08-26 16:22:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420262663163904 [0;39m <==    Updates: 0
2022-08-26 16:22:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420262663163904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:22:52.126 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420271542505472 [0;39m ------------- 开始 -------------
2022-08-26 16:22:52.126 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420271542505472 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-26 16:22:52.126 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420271542505472 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-26 16:22:52.127 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420271542505472 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:52.127 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420271542505472 [0;39m 请求参数: [{"page":2,"size":4}]
2022-08-26 16:22:52.130 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420271542505472 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-08-26 16:22:52.131 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420271542505472 [0;39m ==> Parameters: 
2022-08-26 16:22:52.132 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420271542505472 [0;39m <==    Columns: count(0)
2022-08-26 16:22:52.133 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420271542505472 [0;39m <==        Row: 7
2022-08-26 16:22:52.134 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420271542505472 [0;39m <==      Total: 1
2022-08-26 16:22:52.135 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420271542505472 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?, ?
2022-08-26 16:22:52.136 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420271542505472 [0;39m ==> Parameters: 4(Long), 4(Integer)
2022-08-26 16:22:52.137 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420271542505472 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-26 16:22:52.137 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420271542505472 [0;39m <==        Row: 5, Oracle入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 0, 0
2022-08-26 16:22:52.137 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420271542505472 [0;39m <==        Row: 6, Vue CLI 入门教程, 100, 101, Vue CLI 用于快速搭建基于VUE的前端, /image/cover1.png, 1, 9, 1
2022-08-26 16:22:52.138 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420271542505472 [0;39m <==        Row: 202714600712572928, Wiki个人知识库, 200, 181311914796781568, 本文档讲述了知识库的开发过程以及遇到的问题！, /image/cover2.png, 12, 259, 38
2022-08-26 16:22:52.138 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420271542505472 [0;39m <==      Total: 3
2022-08-26 16:22:52.139 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m20420271542505472 [0;39m 总行数：7
2022-08-26 16:22:52.139 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m20420271542505472 [0;39m 总页数：2
2022-08-26 16:22:52.139 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420271542505472 [0;39m 返回结果: {"content":{"list":[{"category1Id":400,"category2Id":401,"cover":"/image/cover1.png","description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle入门教程","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"Vue CLI 用于快速搭建基于VUE的前端","docCount":1,"id":6,"name":"Vue CLI 入门教程","viewCount":9,"voteCount":1},{"category1Id":200,"category2Id":181311914796781568,"cover":"/image/cover2.png","description":"本文档讲述了知识库的开发过程以及遇到的问题！","docCount":12,"id":202714600712572928,"name":"Wiki个人知识库","viewCount":259,"voteCount":38}],"total":7},"success":true}
2022-08-26 16:22:52.139 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420271542505472 [0;39m ------------- 结束 耗时：13 ms -------------
2022-08-26 16:22:53.923 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420279079669760 [0;39m ------------- 开始 -------------
2022-08-26 16:22:53.923 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420279079669760 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-26 16:22:53.923 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420279079669760 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-26 16:22:53.924 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420279079669760 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:53.924 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420279079669760 [0;39m 请求参数: [{"page":1,"size":4}]
2022-08-26 16:22:53.925 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420279079669760 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-08-26 16:22:53.926 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420279079669760 [0;39m ==> Parameters: 
2022-08-26 16:22:53.927 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420279079669760 [0;39m <==    Columns: count(0)
2022-08-26 16:22:53.927 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420279079669760 [0;39m <==        Row: 7
2022-08-26 16:22:53.927 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420279079669760 [0;39m <==      Total: 1
2022-08-26 16:22:53.928 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420279079669760 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-08-26 16:22:53.929 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420279079669760 [0;39m ==> Parameters: 4(Integer)
2022-08-26 16:22:53.930 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420279079669760 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-26 16:22:53.930 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420279079669760 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover1.png, 4, 62, 10
2022-08-26 16:22:53.931 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420279079669760 [0;39m <==        Row: 2, Vue 入门教程, 100, 503, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover2.png, 7, 39, 10
2022-08-26 16:22:53.933 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420279079669760 [0;39m <==        Row: 3, Python 入门教程, 200, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 2, 1
2022-08-26 16:22:53.934 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420279079669760 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, /image/cover2.png, 1, 1, 0
2022-08-26 16:22:53.934 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420279079669760 [0;39m <==      Total: 4
2022-08-26 16:22:53.935 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m20420279079669760 [0;39m 总行数：7
2022-08-26 16:22:53.935 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m20420279079669760 [0;39m 总页数：2
2022-08-26 16:22:53.937 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420279079669760 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover1.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":4,"id":1,"name":"Spring Boot 入门教程","viewCount":62,"voteCount":10},{"category1Id":100,"category2Id":503,"cover":"/image/cover2.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":7,"id":2,"name":"Vue 入门教程","viewCount":39,"voteCount":10},{"category1Id":200,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python 入门教程","viewCount":2,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":1,"voteCount":0}],"total":7},"success":true}
2022-08-26 16:22:53.937 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420279079669760 [0;39m ------------- 结束 耗时：14 ms -------------
2022-08-26 16:22:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420283651461120 [0;39m 生成今日电子书快照开始
2022-08-26 16:22:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420283651461120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:22:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420283651461120 [0;39m ==> Parameters: 
2022-08-26 16:22:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420283651461120 [0;39m <==    Updates: 0
2022-08-26 16:22:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420283651461120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:22:55.295 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420284834254848 [0;39m ------------- 开始 -------------
2022-08-26 16:22:55.295 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420284834254848 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/1 GET
2022-08-26 16:22:55.295 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420284834254848 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-26 16:22:55.296 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420284834254848 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:55.296 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420284834254848 [0;39m 请求参数: [1]
2022-08-26 16:22:55.297 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m20420284834254848 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-26 16:22:55.298 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m20420284834254848 [0;39m ==> Parameters: 1(Long)
2022-08-26 16:22:55.299 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420284834254848 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-26 16:22:55.299 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420284834254848 [0;39m <==        Row: 1, 1, 0, Ant Design Of Vue, 1, 37, 4
2022-08-26 16:22:55.299 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420284834254848 [0;39m <==        Row: 2, 1, 1, 文档1.1, 1, 12, 3
2022-08-26 16:22:55.300 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420284834254848 [0;39m <==        Row: 4, 1, 3, 文档2.1, 1, 8, 2
2022-08-26 16:22:55.300 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420284834254848 [0;39m <==        Row: 3, 1, 0, 文档2, 2, 5, 1
2022-08-26 16:22:55.302 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m20420284834254848 [0;39m <==      Total: 4
2022-08-26 16:22:55.305 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420284834254848 [0;39m 返回结果: {"content":[{"ebookId":1,"id":1,"name":"Ant Design Of Vue","parent":0,"sort":1,"viewCount":37,"voteCount":4},{"ebookId":1,"id":2,"name":"文档1.1","parent":1,"sort":1,"viewCount":12,"voteCount":3},{"ebookId":1,"id":4,"name":"文档2.1","parent":3,"sort":1,"viewCount":8,"voteCount":2},{"ebookId":1,"id":3,"name":"文档2","parent":0,"sort":2,"viewCount":5,"voteCount":1}],"success":true}
2022-08-26 16:22:55.305 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420284834254848 [0;39m ------------- 结束 耗时：10 ms -------------
2022-08-26 16:22:57.266 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m20420240781479936 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-26 16:22:57.266 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m20420240781479936 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/user_wiki/list
2022-08-26 16:22:57.267 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m20420240781479936 [0;39m 登录校验开始，token：20420216903307264
2022-08-26 16:22:57.302 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m20420240781479936 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"20420216903307264"}
2022-08-26 16:22:57.304 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420293260611584 [0;39m ------------- 开始 -------------
2022-08-26 16:22:57.304 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420293260611584 [0;39m 请求地址: http://127.0.0.1:8880/user_wiki/list GET
2022-08-26 16:22:57.304 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420293260611584 [0;39m 类名方法: com.zs.wikibb.controller.UserwikiController.list
2022-08-26 16:22:57.304 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420293260611584 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:57.305 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420293260611584 [0;39m 请求参数: [{"page":1,"size":10}]
2022-08-26 16:22:57.306 DEBUG c.z.w.mapper.UserwikiMapper.selectByExample_COUNT :137 
                [32m20420293260611584 [0;39m ==>  Preparing: SELECT count(0) FROM userwiki
2022-08-26 16:22:57.307 DEBUG c.z.w.mapper.UserwikiMapper.selectByExample_COUNT :137 
                [32m20420293260611584 [0;39m ==> Parameters: 
2022-08-26 16:22:57.307 TRACE c.z.w.mapper.UserwikiMapper.selectByExample_COUNT :143 
                [32m20420293260611584 [0;39m <==    Columns: count(0)
2022-08-26 16:22:57.308 TRACE c.z.w.mapper.UserwikiMapper.selectByExample_COUNT :143 
                [32m20420293260611584 [0;39m <==        Row: 3
2022-08-26 16:22:57.308 DEBUG c.z.w.mapper.UserwikiMapper.selectByExample_COUNT :137 
                [32m20420293260611584 [0;39m <==      Total: 1
2022-08-26 16:22:57.308 DEBUG c.zs.wikibb.mapper.UserwikiMapper.selectByExample :137 
                [32m20420293260611584 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from userwiki LIMIT ?
2022-08-26 16:22:57.309 DEBUG c.zs.wikibb.mapper.UserwikiMapper.selectByExample :137 
                [32m20420293260611584 [0;39m ==> Parameters: 10(Integer)
2022-08-26 16:22:57.309 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m20420293260611584 [0;39m <==    Columns: id, login_name, name, password
2022-08-26 16:22:57.310 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m20420293260611584 [0;39m <==        Row: 1, test, 测试, e70e2222a9d67c4f2eae107533359aa4
2022-08-26 16:22:57.310 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m20420293260611584 [0;39m <==        Row: 2, zhangshuo, 张硕, 0099120649bc7c7807f8188f97a66c59
2022-08-26 16:22:57.310 TRACE c.zs.wikibb.mapper.UserwikiMapper.selectByExample :143 
                [32m20420293260611584 [0;39m <==        Row: 3, zhangyishan, 张一山, e70e2222a9d67c4f2eae107533359aa4
2022-08-26 16:22:57.310 DEBUG c.zs.wikibb.mapper.UserwikiMapper.selectByExample :137 
                [32m20420293260611584 [0;39m <==      Total: 3
2022-08-26 16:22:57.310 INFO  com.zs.wikibb.service.UserwikiService             :49  
                [32m20420293260611584 [0;39m 总行数：3
2022-08-26 16:22:57.311 INFO  com.zs.wikibb.service.UserwikiService             :50  
                [32m20420293260611584 [0;39m 总页数：1
2022-08-26 16:22:57.311 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420293260611584 [0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":2,"loginName":"zhangshuo","name":"张硕"},{"id":3,"loginName":"zhangyishan","name":"张一山"}],"total":3},"success":true}
2022-08-26 16:22:57.311 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420293260611584 [0;39m ------------- 结束 耗时：8 ms -------------
2022-08-26 16:22:57.312 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m20420293260611584 [0;39m ------------- LoginInterceptor 结束 耗时：46 ms -------------
2022-08-26 16:22:58.241 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420297186480128 [0;39m ------------- 开始 -------------
2022-08-26 16:22:58.241 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420297186480128 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2022-08-26 16:22:58.241 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420297186480128 [0;39m 类名方法: com.zs.wikibb.controller.CategoryController.all
2022-08-26 16:22:58.241 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420297186480128 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:58.241 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420297186480128 [0;39m 请求参数: []
2022-08-26 16:22:58.242 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m20420297186480128 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-08-26 16:22:58.243 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m20420297186480128 [0;39m ==> Parameters: 
2022-08-26 16:22:58.243 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==    Columns: id, parent, name, sort
2022-08-26 16:22:58.244 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 100, 0, 前端开发, 100
2022-08-26 16:22:58.244 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 101, 100, Vue, 101
2022-08-26 16:22:58.244 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-08-26 16:22:58.244 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 200, 0, Java, 200
2022-08-26 16:22:58.244 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 201, 200, 基础应用, 201
2022-08-26 16:22:58.245 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 202, 200, 框架应用, 202
2022-08-26 16:22:58.245 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 181311914796781568, 200, SpringBoot+Vue3 前后端分离知识库系统, 231
2022-08-26 16:22:58.245 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 300, 0, Python, 300
2022-08-26 16:22:58.246 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 301, 300, 基础应用, 301
2022-08-26 16:22:58.246 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2022-08-26 16:22:58.246 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 400, 0, 数据库, 400
2022-08-26 16:22:58.246 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 401, 400, MySQL, 401
2022-08-26 16:22:58.246 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 500, 0, 其它, 500
2022-08-26 16:22:58.247 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 501, 500, 服务器, 501
2022-08-26 16:22:58.247 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 502, 500, 开发工具, 502
2022-08-26 16:22:58.247 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m20420297186480128 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2022-08-26 16:22:58.248 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m20420297186480128 [0;39m <==      Total: 16
2022-08-26 16:22:58.248 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420297186480128 [0;39m 返回结果: {"content":[{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":181311914796781568,"name":"SpringBoot+Vue3 前后端分离知识库系统","parent":200,"sort":231},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2022-08-26 16:22:58.249 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420297186480128 [0;39m ------------- 结束 耗时：9 ms -------------
2022-08-26 16:22:58.258 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420297261977600 [0;39m ------------- 开始 -------------
2022-08-26 16:22:58.258 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420297261977600 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-26 16:22:58.258 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420297261977600 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-26 16:22:58.258 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420297261977600 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:22:58.258 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420297261977600 [0;39m 请求参数: [{"page":1,"size":4}]
2022-08-26 16:22:58.259 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420297261977600 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-08-26 16:22:58.260 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420297261977600 [0;39m ==> Parameters: 
2022-08-26 16:22:58.260 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420297261977600 [0;39m <==    Columns: count(0)
2022-08-26 16:22:58.260 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420297261977600 [0;39m <==        Row: 7
2022-08-26 16:22:58.261 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420297261977600 [0;39m <==      Total: 1
2022-08-26 16:22:58.261 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420297261977600 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-08-26 16:22:58.261 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420297261977600 [0;39m ==> Parameters: 4(Integer)
2022-08-26 16:22:58.261 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420297261977600 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-26 16:22:58.261 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420297261977600 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover1.png, 4, 62, 10
2022-08-26 16:22:58.261 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420297261977600 [0;39m <==        Row: 2, Vue 入门教程, 100, 503, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover2.png, 7, 39, 10
2022-08-26 16:22:58.262 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420297261977600 [0;39m <==        Row: 3, Python 入门教程, 200, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 2, 1
2022-08-26 16:22:58.262 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420297261977600 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, /image/cover2.png, 1, 1, 0
2022-08-26 16:22:58.262 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420297261977600 [0;39m <==      Total: 4
2022-08-26 16:22:58.262 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m20420297261977600 [0;39m 总行数：7
2022-08-26 16:22:58.263 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m20420297261977600 [0;39m 总页数：2
2022-08-26 16:22:58.264 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420297261977600 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover1.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":4,"id":1,"name":"Spring Boot 入门教程","viewCount":62,"voteCount":10},{"category1Id":100,"category2Id":503,"cover":"/image/cover2.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":7,"id":2,"name":"Vue 入门教程","viewCount":39,"voteCount":10},{"category1Id":200,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python 入门教程","viewCount":2,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":1,"voteCount":0}],"total":7},"success":true}
2022-08-26 16:22:58.264 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420297261977600 [0;39m ------------- 结束 耗时：6 ms -------------
2022-08-26 16:23:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420304593620992 [0;39m 生成今日电子书快照开始
2022-08-26 16:23:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420304593620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:23:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420304593620992 [0;39m ==> Parameters: 
2022-08-26 16:23:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420304593620992 [0;39m <==    Updates: 0
2022-08-26 16:23:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420304593620992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:23:05.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20420325544169472 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:23:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420325544169472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:23:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420325544169472 [0;39m ==> Parameters: 
2022-08-26 16:23:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420325544169472 [0;39m <==    Updates: 7
2022-08-26 16:23:05.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20420325544169472 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:23:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420325552558080 [0;39m 生成今日电子书快照开始
2022-08-26 16:23:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420325552558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:23:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420325552558080 [0;39m ==> Parameters: 
2022-08-26 16:23:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420325552558080 [0;39m <==    Updates: 0
2022-08-26 16:23:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420325552558080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:23:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420346532466688 [0;39m 生成今日电子书快照开始
2022-08-26 16:23:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420346532466688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:23:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420346532466688 [0;39m ==> Parameters: 
2022-08-26 16:23:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420346532466688 [0;39m <==    Updates: 0
2022-08-26 16:23:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420346532466688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:23:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420367499792384 [0;39m 生成今日电子书快照开始
2022-08-26 16:23:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420367499792384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:23:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420367499792384 [0;39m ==> Parameters: 
2022-08-26 16:23:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420367499792384 [0;39m <==    Updates: 0
2022-08-26 16:23:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420367499792384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:23:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420388492283904 [0;39m 生成今日电子书快照开始
2022-08-26 16:23:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420388492283904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:23:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420388492283904 [0;39m ==> Parameters: 
2022-08-26 16:23:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420388492283904 [0;39m <==    Updates: 0
2022-08-26 16:23:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420388492283904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:23:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420409451220992 [0;39m 生成今日电子书快照开始
2022-08-26 16:23:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420409451220992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:23:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420409451220992 [0;39m ==> Parameters: 
2022-08-26 16:23:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420409451220992 [0;39m <==    Updates: 0
2022-08-26 16:23:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420409451220992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:23:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420430426935296 [0;39m 生成今日电子书快照开始
2022-08-26 16:23:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420430426935296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:23:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420430426935296 [0;39m ==> Parameters: 
2022-08-26 16:23:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420430426935296 [0;39m <==    Updates: 0
2022-08-26 16:23:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420430426935296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:23:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20420451381678080 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:23:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420451381678080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:23:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420451381678080 [0;39m ==> Parameters: 
2022-08-26 16:23:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420451381678080 [0;39m <==    Updates: 7
2022-08-26 16:23:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20420451381678080 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:23:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420451390066688 [0;39m 生成今日电子书快照开始
2022-08-26 16:23:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420451390066688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:23:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420451390066688 [0;39m ==> Parameters: 
2022-08-26 16:23:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420451390066688 [0;39m <==    Updates: 0
2022-08-26 16:23:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420451390066688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:23:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420472395141120 [0;39m 生成今日电子书快照开始
2022-08-26 16:23:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420472395141120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:23:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420472395141120 [0;39m ==> Parameters: 
2022-08-26 16:23:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420472395141120 [0;39m <==    Updates: 0
2022-08-26 16:23:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420472395141120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:23:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420493362466816 [0;39m 生成今日电子书快照开始
2022-08-26 16:23:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420493362466816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:23:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420493362466816 [0;39m ==> Parameters: 
2022-08-26 16:23:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420493362466816 [0;39m <==    Updates: 0
2022-08-26 16:23:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420493362466816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:23:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420514308820992 [0;39m 生成今日电子书快照开始
2022-08-26 16:23:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420514308820992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:23:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420514308820992 [0;39m ==> Parameters: 
2022-08-26 16:23:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420514308820992 [0;39m <==    Updates: 0
2022-08-26 16:23:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420514308820992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:23:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420535313895424 [0;39m 生成今日电子书快照开始
2022-08-26 16:23:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420535313895424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:23:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420535313895424 [0;39m ==> Parameters: 
2022-08-26 16:23:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420535313895424 [0;39m <==    Updates: 0
2022-08-26 16:23:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420535313895424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:24:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420556264443904 [0;39m 生成今日电子书快照开始
2022-08-26 16:24:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420556264443904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:24:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420556264443904 [0;39m ==> Parameters: 
2022-08-26 16:24:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420556264443904 [0;39m <==    Updates: 0
2022-08-26 16:24:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420556264443904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:24:05.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20420577206603776 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:24:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420577206603776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:24:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420577206603776 [0;39m ==> Parameters: 
2022-08-26 16:24:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420577206603776 [0;39m <==    Updates: 7
2022-08-26 16:24:05.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20420577206603776 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:24:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420577214992384 [0;39m 生成今日电子书快照开始
2022-08-26 16:24:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420577214992384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:24:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420577214992384 [0;39m ==> Parameters: 
2022-08-26 16:24:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420577214992384 [0;39m <==    Updates: 0
2022-08-26 16:24:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420577214992384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:24:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420598224261120 [0;39m 生成今日电子书快照开始
2022-08-26 16:24:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420598224261120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:24:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420598224261120 [0;39m ==> Parameters: 
2022-08-26 16:24:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420598224261120 [0;39m <==    Updates: 0
2022-08-26 16:24:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420598224261120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:24:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420619162226688 [0;39m 生成今日电子书快照开始
2022-08-26 16:24:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420619162226688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:24:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420619162226688 [0;39m ==> Parameters: 
2022-08-26 16:24:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420619162226688 [0;39m <==    Updates: 0
2022-08-26 16:24:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420619162226688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:24:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420640154718208 [0;39m 生成今日电子书快照开始
2022-08-26 16:24:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420640154718208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:24:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420640154718208 [0;39m ==> Parameters: 
2022-08-26 16:24:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420640154718208 [0;39m <==    Updates: 0
2022-08-26 16:24:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420640154718208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:24:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420661101072384 [0;39m 生成今日电子书快照开始
2022-08-26 16:24:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420661101072384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:24:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420661101072384 [0;39m ==> Parameters: 
2022-08-26 16:24:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420661101072384 [0;39m <==    Updates: 0
2022-08-26 16:24:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420661101072384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:24:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420682064203776 [0;39m 生成今日电子书快照开始
2022-08-26 16:24:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420682064203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:24:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420682064203776 [0;39m ==> Parameters: 
2022-08-26 16:24:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420682064203776 [0;39m <==    Updates: 0
2022-08-26 16:24:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20420682064203776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:24:31.254 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m20420271542505472 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-26 16:24:31.255 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m20420271542505472 [0;39m ------------- LoginInterceptor 结束 耗时：0 ms -------------
2022-08-26 16:24:31.258 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m20420279079669760 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-26 16:24:31.258 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m20420279079669760 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/ebook/save
2022-08-26 16:24:31.258 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m20420279079669760 [0;39m 登录校验开始，token：20420216903307264
2022-08-26 16:24:31.296 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m20420279079669760 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"20420216903307264"}
2022-08-26 16:24:31.304 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420687525187584 [0;39m ------------- 开始 -------------
2022-08-26 16:24:31.304 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420687525187584 [0;39m 请求地址: http://127.0.0.1:8880/ebook/save POST
2022-08-26 16:24:31.304 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420687525187584 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.save
2022-08-26 16:24:31.304 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420687525187584 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:24:31.307 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420687525187584 [0;39m 请求参数: [{"category1Id":200,"category2Id":202,"description":"一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现","name":"Dubbo分布式框架"}]
2022-08-26 16:24:31.310 DEBUG com.zs.wikibb.mapper.EbookMapper.insert           :137 
                [32m20420687525187584 [0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-08-26 16:24:31.311 DEBUG com.zs.wikibb.mapper.EbookMapper.insert           :137 
                [32m20420687525187584 [0;39m ==> Parameters: 20420687550353408(Long), Dubbo分布式框架(String), 200(Long), 202(Long), 一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现(String), null, null, null, null
2022-08-26 16:24:31.366 DEBUG com.zs.wikibb.mapper.EbookMapper.insert           :137 
                [32m20420687525187584 [0;39m <==    Updates: 1
2022-08-26 16:24:31.366 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420687525187584 [0;39m 返回结果: {"success":true}
2022-08-26 16:24:31.366 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420687525187584 [0;39m ------------- 结束 耗时：62 ms -------------
2022-08-26 16:24:31.367 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m20420687525187584 [0;39m ------------- LoginInterceptor 结束 耗时：109 ms -------------
2022-08-26 16:24:31.395 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420687906869248 [0;39m ------------- 开始 -------------
2022-08-26 16:24:31.395 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420687906869248 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-26 16:24:31.396 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420687906869248 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-26 16:24:31.396 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420687906869248 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:24:31.396 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420687906869248 [0;39m 请求参数: [{"page":1,"size":4}]
2022-08-26 16:24:31.397 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420687906869248 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-08-26 16:24:31.398 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420687906869248 [0;39m ==> Parameters: 
2022-08-26 16:24:31.399 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420687906869248 [0;39m <==    Columns: count(0)
2022-08-26 16:24:31.399 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420687906869248 [0;39m <==        Row: 8
2022-08-26 16:24:31.400 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420687906869248 [0;39m <==      Total: 1
2022-08-26 16:24:31.400 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420687906869248 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-08-26 16:24:31.400 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420687906869248 [0;39m ==> Parameters: 4(Integer)
2022-08-26 16:24:31.401 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420687906869248 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-26 16:24:31.402 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420687906869248 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover1.png, 4, 62, 10
2022-08-26 16:24:31.402 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420687906869248 [0;39m <==        Row: 2, Vue 入门教程, 100, 503, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover2.png, 7, 39, 10
2022-08-26 16:24:31.403 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420687906869248 [0;39m <==        Row: 3, Python 入门教程, 200, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 2, 1
2022-08-26 16:24:31.403 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420687906869248 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, /image/cover2.png, 1, 1, 0
2022-08-26 16:24:31.403 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420687906869248 [0;39m <==      Total: 4
2022-08-26 16:24:31.404 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m20420687906869248 [0;39m 总行数：8
2022-08-26 16:24:31.404 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m20420687906869248 [0;39m 总页数：2
2022-08-26 16:24:31.404 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420687906869248 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover1.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":4,"id":1,"name":"Spring Boot 入门教程","viewCount":62,"voteCount":10},{"category1Id":100,"category2Id":503,"cover":"/image/cover2.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":7,"id":2,"name":"Vue 入门教程","viewCount":39,"voteCount":10},{"category1Id":200,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python 入门教程","viewCount":2,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":1,"voteCount":0}],"total":8},"success":true}
2022-08-26 16:24:31.405 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420687906869248 [0;39m ------------- 结束 耗时：10 ms -------------
2022-08-26 16:24:32.830 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420693925695488 [0;39m ------------- 开始 -------------
2022-08-26 16:24:32.830 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420693925695488 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-26 16:24:32.830 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420693925695488 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-26 16:24:32.831 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420693925695488 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:24:32.831 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420693925695488 [0;39m 请求参数: [{"page":2,"size":4}]
2022-08-26 16:24:32.840 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420693925695488 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-08-26 16:24:32.841 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420693925695488 [0;39m ==> Parameters: 
2022-08-26 16:24:32.842 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420693925695488 [0;39m <==    Columns: count(0)
2022-08-26 16:24:32.842 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m20420693925695488 [0;39m <==        Row: 8
2022-08-26 16:24:32.843 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m20420693925695488 [0;39m <==      Total: 1
2022-08-26 16:24:32.843 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420693925695488 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?, ?
2022-08-26 16:24:32.844 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420693925695488 [0;39m ==> Parameters: 4(Long), 4(Integer)
2022-08-26 16:24:32.844 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420693925695488 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-26 16:24:32.845 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420693925695488 [0;39m <==        Row: 5, Oracle入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 0, 0
2022-08-26 16:24:32.845 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420693925695488 [0;39m <==        Row: 6, Vue CLI 入门教程, 100, 101, Vue CLI 用于快速搭建基于VUE的前端, /image/cover1.png, 1, 9, 1
2022-08-26 16:24:32.845 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420693925695488 [0;39m <==        Row: 20420687550353408, Dubbo分布式框架, 200, 202, 一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现, null, null, null, null
2022-08-26 16:24:32.845 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m20420693925695488 [0;39m <==        Row: 202714600712572928, Wiki个人知识库, 200, 181311914796781568, 本文档讲述了知识库的开发过程以及遇到的问题！, /image/cover2.png, 12, 259, 38
2022-08-26 16:24:32.846 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m20420693925695488 [0;39m <==      Total: 4
2022-08-26 16:24:32.846 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m20420693925695488 [0;39m 总行数：8
2022-08-26 16:24:32.846 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m20420693925695488 [0;39m 总页数：2
2022-08-26 16:24:32.846 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420693925695488 [0;39m 返回结果: {"content":{"list":[{"category1Id":400,"category2Id":401,"cover":"/image/cover1.png","description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle入门教程","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"Vue CLI 用于快速搭建基于VUE的前端","docCount":1,"id":6,"name":"Vue CLI 入门教程","viewCount":9,"voteCount":1},{"category1Id":200,"category2Id":202,"description":"一款高性能的Java RPC框架，提供三个核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现","id":20420687550353408,"name":"Dubbo分布式框架"},{"category1Id":200,"category2Id":181311914796781568,"cover":"/image/cover2.png","description":"本文档讲述了知识库的开发过程以及遇到的问题！","docCount":12,"id":202714600712572928,"name":"Wiki个人知识库","viewCount":259,"voteCount":38}],"total":8},"success":true}
2022-08-26 16:24:32.847 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420693925695488 [0;39m ------------- 结束 耗时：17 ms -------------
2022-08-26 16:24:34.997 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420703010557952 [0;39m ------------- 开始 -------------
2022-08-26 16:24:34.997 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420703010557952 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-26 16:24:34.997 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420703010557952 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-26 16:24:34.997 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420703010557952 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:24:34.998 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420703010557952 [0;39m 请求参数: [20420687550353408]
2022-08-26 16:24:34.999 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m20420703010557952 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-26 16:24:34.999 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m20420703010557952 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-26 16:24:35.000 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m20420703010557952 [0;39m <==      Total: 0
2022-08-26 16:24:35.001 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420703010557952 [0;39m 返回结果: {"content":[],"success":true}
2022-08-26 16:24:35.001 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420703010557952 [0;39m ------------- 结束 耗时：5 ms -------------
2022-08-26 16:24:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420703044112384 [0;39m 生成今日电子书快照开始
2022-08-26 16:24:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420703044112384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:24:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420703044112384 [0;39m ==> Parameters: 
2022-08-26 16:24:35.199 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20420703044112384 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:24:35.201 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20420703870390272 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:24:35.201 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420703870390272 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:24:35.201 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420703870390272 [0;39m ==> Parameters: 
2022-08-26 16:24:35.202 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420703870390272 [0;39m <==    Updates: 7
2022-08-26 16:24:35.203 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20420703870390272 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:24:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420724049186816 [0;39m 生成今日电子书快照开始
2022-08-26 16:24:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420724049186816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:24:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420724049186816 [0;39m ==> Parameters: 
2022-08-26 16:24:40.016 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20420724049186816 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:24:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420744974569472 [0;39m 生成今日电子书快照开始
2022-08-26 16:24:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420744974569472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:24:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420744974569472 [0;39m ==> Parameters: 
2022-08-26 16:24:45.003 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20420744974569472 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:24:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420766004809728 [0;39m 生成今日电子书快照开始
2022-08-26 16:24:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420766004809728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:24:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420766004809728 [0;39m ==> Parameters: 
2022-08-26 16:24:50.017 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20420766004809728 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:24:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420786984718336 [0;39m 生成今日电子书快照开始
2022-08-26 16:24:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420786984718336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:24:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420786984718336 [0;39m ==> Parameters: 
2022-08-26 16:24:55.019 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20420786984718336 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:25:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420807952044032 [0;39m 生成今日电子书快照开始
2022-08-26 16:25:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420807952044032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:25:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420807952044032 [0;39m ==> Parameters: 
2022-08-26 16:25:00.019 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20420807952044032 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:25:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20420828877426688 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:25:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420828877426688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:25:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420828877426688 [0;39m ==> Parameters: 
2022-08-26 16:25:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420828877426688 [0;39m <==    Updates: 7
2022-08-26 16:25:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20420828877426688 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:25:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420828885815296 [0;39m 生成今日电子书快照开始
2022-08-26 16:25:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420828885815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:25:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420828885815296 [0;39m ==> Parameters: 
2022-08-26 16:25:05.009 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20420828885815296 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:25:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420849836363776 [0;39m 生成今日电子书快照开始
2022-08-26 16:25:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420849836363776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:25:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420849836363776 [0;39m ==> Parameters: 
2022-08-26 16:25:10.005 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20420849836363776 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:25:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420870824660992 [0;39m 生成今日电子书快照开始
2022-08-26 16:25:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420870824660992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:25:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420870824660992 [0;39m ==> Parameters: 
2022-08-26 16:25:15.008 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20420870824660992 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:25:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420891829735424 [0;39m 生成今日电子书快照开始
2022-08-26 16:25:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420891829735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:25:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420891829735424 [0;39m ==> Parameters: 
2022-08-26 16:25:20.016 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20420891829735424 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:25:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420912792866816 [0;39m 生成今日电子书快照开始
2022-08-26 16:25:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420912792866816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:25:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420912792866816 [0;39m ==> Parameters: 
2022-08-26 16:25:25.016 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20420912792866816 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:25:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420933772775424 [0;39m 生成今日电子书快照开始
2022-08-26 16:25:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420933772775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:25:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420933772775424 [0;39m ==> Parameters: 
2022-08-26 16:25:30.016 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20420933772775424 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:25:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420954710740992 [0;39m 生成今日电子书快照开始
2022-08-26 16:25:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420954710740992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:25:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420954710740992 [0;39m ==> Parameters: 
2022-08-26 16:25:35.008 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20420954710740992 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:25:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20420954719129600 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:25:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420954719129600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:25:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420954719129600 [0;39m ==> Parameters: 
2022-08-26 16:25:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20420954719129600 [0;39m <==    Updates: 7
2022-08-26 16:25:35.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20420954719129600 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:25:36.655 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m20420253456666624 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-26 16:25:36.656 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m20420253456666624 [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-08-26 16:25:36.658 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m20420249916674048 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-26 16:25:36.658 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m20420249916674048 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-26 16:25:36.659 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m20420249916674048 [0;39m 登录校验开始，token：20420216903307264
2022-08-26 16:25:36.700 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m20420249916674048 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"20420216903307264"}
2022-08-26 16:25:36.706 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420961841057792 [0;39m ------------- 开始 -------------
2022-08-26 16:25:36.706 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420961841057792 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-26 16:25:36.707 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420961841057792 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-26 16:25:36.707 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420961841057792 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:25:36.709 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420961841057792 [0;39m 请求参数: [{"content":"<p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p>","ebookId":20420687550353408,"name":"导读","parent":0,"sort":1}]
2022-08-26 16:25:36.734 DEBUG com.zs.wikibb.mapper.DocMapper.insert             :137 
                [32m20420961841057792 [0;39m ==>  Preparing: insert into doc (id, ebook_id, parent, `name`, sort, view_count, vote_count) values (?, ?, ?, ?, ?, ?, ?)
2022-08-26 16:25:36.734 DEBUG com.zs.wikibb.mapper.DocMapper.insert             :137 
                [32m20420961841057792 [0;39m ==> Parameters: 20420961950109696(Long), 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 0(Integer), 0(Integer)
2022-08-26 16:25:36.736 DEBUG com.zs.wikibb.mapper.DocMapper.insert             :137 
                [32m20420961841057792 [0;39m <==    Updates: 1
2022-08-26 16:25:36.737 DEBUG com.zs.wikibb.mapper.ContentMapper.insert         :137 
                [32m20420961841057792 [0;39m ==>  Preparing: insert into content (id, content) values (?, ?)
2022-08-26 16:25:36.737 DEBUG com.zs.wikibb.mapper.ContentMapper.insert         :137 
                [32m20420961841057792 [0;39m ==> Parameters: 20420961950109696(Long), <p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p>(String)
2022-08-26 16:25:36.746 DEBUG com.zs.wikibb.mapper.ContentMapper.insert         :137 
                [32m20420961841057792 [0;39m <==    Updates: 1
2022-08-26 16:25:36.809 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420961841057792 [0;39m 返回结果: {"success":true}
2022-08-26 16:25:36.811 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420961841057792 [0;39m ------------- 结束 耗时：105 ms -------------
2022-08-26 16:25:36.812 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m20420961841057792 [0;39m ------------- LoginInterceptor 结束 耗时：154 ms -------------
2022-08-26 16:25:36.819 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20420962315014144 [0;39m ------------- 开始 -------------
2022-08-26 16:25:36.820 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20420962315014144 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-26 16:25:36.820 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20420962315014144 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-26 16:25:36.820 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20420962315014144 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:25:36.820 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20420962315014144 [0;39m 请求参数: [20420687550353408]
2022-08-26 16:25:36.821 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m20420962315014144 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-26 16:25:36.822 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m20420962315014144 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-26 16:25:36.823 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420962315014144 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-26 16:25:36.823 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20420962315014144 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 0, 0
2022-08-26 16:25:36.824 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m20420962315014144 [0;39m <==      Total: 1
2022-08-26 16:25:36.824 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20420962315014144 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":0,"voteCount":0}],"success":true}
2022-08-26 16:25:36.824 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20420962315014144 [0;39m ------------- 结束 耗时：5 ms -------------
2022-08-26 16:25:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420975669678080 [0;39m 生成今日电子书快照开始
2022-08-26 16:25:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420975669678080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:25:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420975669678080 [0;39m ==> Parameters: 
2022-08-26 16:25:40.005 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20420975669678080 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:25:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20420996662169600 [0;39m 生成今日电子书快照开始
2022-08-26 16:25:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420996662169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:25:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20420996662169600 [0;39m ==> Parameters: 
2022-08-26 16:25:45.010 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20420996662169600 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:25:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421017625300992 [0;39m 生成今日电子书快照开始
2022-08-26 16:25:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421017625300992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:25:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421017625300992 [0;39m ==> Parameters: 
2022-08-26 16:25:50.011 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20421017625300992 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:25:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421038601015296 [0;39m 生成今日电子书快照开始
2022-08-26 16:25:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421038601015296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:25:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421038601015296 [0;39m ==> Parameters: 
2022-08-26 16:25:55.009 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20421038601015296 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:25:56.598 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20421045274152960 [0;39m ------------- 开始 -------------
2022-08-26 16:25:56.598 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20421045274152960 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/20420961950109696 GET
2022-08-26 16:25:56.599 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20421045274152960 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-26 16:25:56.599 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20421045274152960 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:25:56.599 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20421045274152960 [0;39m 请求参数: [20420961950109696]
2022-08-26 16:25:56.600 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m20421045274152960 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-26 16:25:56.601 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m20421045274152960 [0;39m ==> Parameters: 20420961950109696(Long)
2022-08-26 16:25:56.604 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m20421045274152960 [0;39m <==    Columns: id, content
2022-08-26 16:25:56.604 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m20421045274152960 [0;39m <==        Row: 20420961950109696, <<BLOB>>
2022-08-26 16:25:56.605 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m20421045274152960 [0;39m <==      Total: 1
2022-08-26 16:25:56.607 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m20421045274152960 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-26 16:25:56.608 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m20421045274152960 [0;39m ==> Parameters: 20420961950109696(Long)
2022-08-26 16:25:56.681 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m20421045274152960 [0;39m <==    Updates: 1
2022-08-26 16:25:56.682 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20421045274152960 [0;39m 返回结果: {"content":"<p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p>","success":true}
2022-08-26 16:25:56.682 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20421045274152960 [0;39m ------------- 结束 耗时：84 ms -------------
2022-08-26 16:26:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421059580923904 [0;39m 生成今日电子书快照开始
2022-08-26 16:26:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421059580923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:26:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421059580923904 [0;39m ==> Parameters: 
2022-08-26 16:26:00.012 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95  
                [32m20421059580923904 [0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [D:\wikibb\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate());          update ebook_snapshot t1,ebook t2         set t1.view_count=t2.view_count,             t1.vote_count=t2.vote_count         where t1.`date`=curdate()           and t1.ebook_id=t2.id;          update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot             where `date`=date_sub(curdate(), interval 1 day )) t2         on t1.ebook_id=t2.ebook_id             set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)),                 t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0)         where t1.`date`=curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.zs.wikibb.service.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:15)
	at com.zs.wikibb.job.EbookSnapshotJob.cron(EbookSnapshotJob.java:34)
	at sun.reflect.GeneratedMethodAccessor72.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:371)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy128.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy126.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor64.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 21 common frames omitted
2022-08-26 16:26:05.000 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20421080514695168 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:26:05.000 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421080514695168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:26:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421080514695168 [0;39m ==> Parameters: 
2022-08-26 16:26:05.027 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421080514695168 [0;39m <==    Updates: 8
2022-08-26 16:26:05.027 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20421080514695168 [0;39m 更新电子书下的文档数据结束，耗时：27 毫秒
2022-08-26 16:26:05.027 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421080627941376 [0;39m 生成今日电子书快照开始
2022-08-26 16:26:05.027 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421080627941376 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:26:05.028 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421080627941376 [0;39m ==> Parameters: 
2022-08-26 16:26:05.054 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421080627941376 [0;39m <==    Updates: 0
2022-08-26 16:26:05.054 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421080627941376 [0;39m 生成今日电子书快照结束，耗时：27 毫秒
2022-08-26 16:26:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421101498798080 [0;39m 生成今日电子书快照开始
2022-08-26 16:26:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421101498798080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:26:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421101498798080 [0;39m ==> Parameters: 
2022-08-26 16:26:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421101498798080 [0;39m <==    Updates: 0
2022-08-26 16:26:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421101498798080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:26:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421122520649728 [0;39m 生成今日电子书快照开始
2022-08-26 16:26:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421122520649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:26:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421122520649728 [0;39m ==> Parameters: 
2022-08-26 16:26:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421122520649728 [0;39m <==    Updates: 0
2022-08-26 16:26:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421122520649728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:26:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421143479586816 [0;39m 生成今日电子书快照开始
2022-08-26 16:26:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421143479586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:26:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421143479586816 [0;39m ==> Parameters: 
2022-08-26 16:26:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421143479586816 [0;39m <==    Updates: 0
2022-08-26 16:26:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421143479586816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:26:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421164425940992 [0;39m 生成今日电子书快照开始
2022-08-26 16:26:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421164425940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:26:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421164425940992 [0;39m ==> Parameters: 
2022-08-26 16:26:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421164425940992 [0;39m <==    Updates: 0
2022-08-26 16:26:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421164425940992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:26:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421185384878080 [0;39m 生成今日电子书快照开始
2022-08-26 16:26:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421185384878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:26:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421185384878080 [0;39m ==> Parameters: 
2022-08-26 16:26:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421185384878080 [0;39m <==    Updates: 0
2022-08-26 16:26:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421185384878080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:26:35.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20421206348009472 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:26:35.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421206348009472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:26:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421206348009472 [0;39m ==> Parameters: 
2022-08-26 16:26:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421206348009472 [0;39m <==    Updates: 8
2022-08-26 16:26:35.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20421206348009472 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:26:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421206356398080 [0;39m 生成今日电子书快照开始
2022-08-26 16:26:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421206356398080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:26:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421206356398080 [0;39m ==> Parameters: 
2022-08-26 16:26:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421206356398080 [0;39m <==    Updates: 0
2022-08-26 16:26:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421206356398080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:26:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421227319529472 [0;39m 生成今日电子书快照开始
2022-08-26 16:26:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421227319529472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:26:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421227319529472 [0;39m ==> Parameters: 
2022-08-26 16:26:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421227319529472 [0;39m <==    Updates: 0
2022-08-26 16:26:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421227319529472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:26:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421248332992512 [0;39m 生成今日电子书快照开始
2022-08-26 16:26:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421248332992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:26:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421248332992512 [0;39m ==> Parameters: 
2022-08-26 16:26:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421248332992512 [0;39m <==    Updates: 0
2022-08-26 16:26:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421248332992512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:26:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421269304512512 [0;39m 生成今日电子书快照开始
2022-08-26 16:26:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421269304512512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:26:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421269304512512 [0;39m ==> Parameters: 
2022-08-26 16:26:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421269304512512 [0;39m <==    Updates: 0
2022-08-26 16:26:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421269304512512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:26:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421290255060992 [0;39m 生成今日电子书快照开始
2022-08-26 16:26:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421290255060992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:26:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421290255060992 [0;39m ==> Parameters: 
2022-08-26 16:26:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421290255060992 [0;39m <==    Updates: 0
2022-08-26 16:26:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421290255060992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:27:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421311218192384 [0;39m 生成今日电子书快照开始
2022-08-26 16:27:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421311218192384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:27:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421311218192384 [0;39m ==> Parameters: 
2022-08-26 16:27:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421311218192384 [0;39m <==    Updates: 0
2022-08-26 16:27:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421311218192384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:27:00.334 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m20420693925695488 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-26 16:27:00.334 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m20420693925695488 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-26 16:27:00.334 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m20420693925695488 [0;39m 登录校验开始，token：20420216903307264
2022-08-26 16:27:00.377 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m20420693925695488 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"20420216903307264"}
2022-08-26 16:27:00.378 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20421312786862080 [0;39m ------------- 开始 -------------
2022-08-26 16:27:00.378 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20421312786862080 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-26 16:27:00.378 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20421312786862080 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-26 16:27:00.378 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20421312786862080 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:27:00.378 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20421312786862080 [0;39m 请求参数: [{"content":"<p><img src=\"https://sukiui.com/i/2022/08/26/qvn3ky.jpg\" style=\"max-width:100%;\"><br></p><p><br></p><blockquote><h2 style=\"text-align:center;\" id=\"clhau\">在学习Dubbo分布式框架爱之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2></blockquote>","ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":0,"voteCount":0}]
2022-08-26 16:27:00.379 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m20421312786862080 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-26 16:27:00.380 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m20421312786862080 [0;39m ==> Parameters: 20420687550353408(Long), 0(Long), 导读(String), 1(Integer), 0(Integer), 0(Integer), 20420961950109696(Long)
2022-08-26 16:27:00.381 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m20421312786862080 [0;39m <==    Updates: 1
2022-08-26 16:27:00.382 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m20421312786862080 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-26 16:27:00.382 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m20421312786862080 [0;39m ==> Parameters: <p><img src="https://sukiui.com/i/2022/08/26/qvn3ky.jpg" style="max-width:100%;"><br></p><p><br></p><blockquote><h2 style="text-align:center;" id="clhau">在学习Dubbo分布式框架爱之前，学习了如何安装虚拟机VMware以及安装linux系统并且掌握了一些常用的命令</h2></blockquote>(String), 20420961950109696(Long)
2022-08-26 16:27:00.385 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m20421312786862080 [0;39m <==    Updates: 1
2022-08-26 16:27:00.392 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20421312786862080 [0;39m 返回结果: {"success":true}
2022-08-26 16:27:00.392 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20421312786862080 [0;39m ------------- 结束 耗时：14 ms -------------
2022-08-26 16:27:00.393 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m20421312786862080 [0;39m ------------- LoginInterceptor 结束 耗时：59 ms -------------
2022-08-26 16:27:00.399 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m20421312874942464 [0;39m ------------- 开始 -------------
2022-08-26 16:27:00.400 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m20421312874942464 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/20420687550353408 GET
2022-08-26 16:27:00.400 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m20421312874942464 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-26 16:27:00.400 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m20421312874942464 [0;39m 远程地址: 127.0.0.1
2022-08-26 16:27:00.401 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m20421312874942464 [0;39m 请求参数: [20420687550353408]
2022-08-26 16:27:00.402 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m20421312874942464 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-26 16:27:00.402 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m20421312874942464 [0;39m ==> Parameters: 20420687550353408(Long)
2022-08-26 16:27:00.403 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20421312874942464 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-26 16:27:00.404 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m20421312874942464 [0;39m <==        Row: 20420961950109696, 20420687550353408, 0, 导读, 1, 0, 0
2022-08-26 16:27:00.404 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m20421312874942464 [0;39m <==      Total: 1
2022-08-26 16:27:00.404 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m20421312874942464 [0;39m 返回结果: {"content":[{"ebookId":20420687550353408,"id":20420961950109696,"name":"导读","parent":0,"sort":1,"viewCount":0,"voteCount":0}],"success":true}
2022-08-26 16:27:00.405 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m20421312874942464 [0;39m ------------- 结束 耗时：6 ms -------------
2022-08-26 16:27:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20421332227461120 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:27:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421332227461120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:27:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421332227461120 [0;39m ==> Parameters: 
2022-08-26 16:27:05.049 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421332227461120 [0;39m <==    Updates: 8
2022-08-26 16:27:05.050 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20421332227461120 [0;39m 更新电子书下的文档数据结束，耗时：37 毫秒
2022-08-26 16:27:05.050 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421332382650368 [0;39m 生成今日电子书快照开始
2022-08-26 16:27:05.050 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421332382650368 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:27:05.051 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421332382650368 [0;39m ==> Parameters: 
2022-08-26 16:27:05.078 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421332382650368 [0;39m <==    Updates: 0
2022-08-26 16:27:05.079 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421332382650368 [0;39m 生成今日电子书快照结束，耗时：29 毫秒
2022-08-26 16:27:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421353207369728 [0;39m 生成今日电子书快照开始
2022-08-26 16:27:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421353207369728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:27:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421353207369728 [0;39m ==> Parameters: 
2022-08-26 16:27:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421353207369728 [0;39m <==    Updates: 0
2022-08-26 16:27:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421353207369728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:27:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421374157918208 [0;39m 生成今日电子书快照开始
2022-08-26 16:27:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421374157918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:27:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421374157918208 [0;39m ==> Parameters: 
2022-08-26 16:27:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421374157918208 [0;39m <==    Updates: 0
2022-08-26 16:27:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421374157918208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:27:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421395112660992 [0;39m 生成今日电子书快照开始
2022-08-26 16:27:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421395112660992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:27:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421395112660992 [0;39m ==> Parameters: 
2022-08-26 16:27:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421395112660992 [0;39m <==    Updates: 0
2022-08-26 16:27:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421395112660992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:27:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421416117735424 [0;39m 生成今日电子书快照开始
2022-08-26 16:27:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421416117735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:27:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421416117735424 [0;39m ==> Parameters: 
2022-08-26 16:27:25.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421416117735424 [0;39m <==    Updates: 0
2022-08-26 16:27:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421416117735424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:27:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421437064089600 [0;39m 生成今日电子书快照开始
2022-08-26 16:27:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421437064089600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:27:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421437064089600 [0;39m ==> Parameters: 
2022-08-26 16:27:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421437064089600 [0;39m <==    Updates: 0
2022-08-26 16:27:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421437064089600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:27:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20421458027220992 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:27:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421458027220992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:27:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421458027220992 [0;39m ==> Parameters: 
2022-08-26 16:27:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421458027220992 [0;39m <==    Updates: 8
2022-08-26 16:27:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20421458027220992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:27:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421458035609600 [0;39m 生成今日电子书快照开始
2022-08-26 16:27:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421458035609600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:27:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421458035609600 [0;39m ==> Parameters: 
2022-08-26 16:27:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421458035609600 [0;39m <==    Updates: 0
2022-08-26 16:27:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421458035609600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:27:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421479036489728 [0;39m 生成今日电子书快照开始
2022-08-26 16:27:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421479036489728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:27:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421479036489728 [0;39m ==> Parameters: 
2022-08-26 16:27:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421479036489728 [0;39m <==    Updates: 0
2022-08-26 16:27:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421479036489728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:27:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421499995426816 [0;39m 生成今日电子书快照开始
2022-08-26 16:27:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421499995426816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:27:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421499995426816 [0;39m ==> Parameters: 
2022-08-26 16:27:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421499995426816 [0;39m <==    Updates: 0
2022-08-26 16:27:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421499995426816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:27:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421520937586688 [0;39m 生成今日电子书快照开始
2022-08-26 16:27:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421520937586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:27:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421520937586688 [0;39m ==> Parameters: 
2022-08-26 16:27:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421520937586688 [0;39m <==    Updates: 0
2022-08-26 16:27:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421520937586688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:27:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421541913300992 [0;39m 生成今日电子书快照开始
2022-08-26 16:27:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421541913300992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:27:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421541913300992 [0;39m ==> Parameters: 
2022-08-26 16:27:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421541913300992 [0;39m <==    Updates: 0
2022-08-26 16:27:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421541913300992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:28:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421562876432384 [0;39m 生成今日电子书快照开始
2022-08-26 16:28:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421562876432384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:28:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421562876432384 [0;39m ==> Parameters: 
2022-08-26 16:28:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421562876432384 [0;39m <==    Updates: 0
2022-08-26 16:28:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421562876432384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:28:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20421583898284032 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:28:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421583898284032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:28:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421583898284032 [0;39m ==> Parameters: 
2022-08-26 16:28:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421583898284032 [0;39m <==    Updates: 8
2022-08-26 16:28:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20421583898284032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:28:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421583906672640 [0;39m 生成今日电子书快照开始
2022-08-26 16:28:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421583906672640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:28:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421583906672640 [0;39m ==> Parameters: 
2022-08-26 16:28:05.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421583906672640 [0;39m <==    Updates: 0
2022-08-26 16:28:05.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421583906672640 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:28:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421604844638208 [0;39m 生成今日电子书快照开始
2022-08-26 16:28:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421604844638208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:28:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421604844638208 [0;39m ==> Parameters: 
2022-08-26 16:28:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421604844638208 [0;39m <==    Updates: 0
2022-08-26 16:28:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421604844638208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:28:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421625799380992 [0;39m 生成今日电子书快照开始
2022-08-26 16:28:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421625799380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:28:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421625799380992 [0;39m ==> Parameters: 
2022-08-26 16:28:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421625799380992 [0;39m <==    Updates: 0
2022-08-26 16:28:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421625799380992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:28:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421646766706688 [0;39m 生成今日电子书快照开始
2022-08-26 16:28:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421646766706688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:28:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421646766706688 [0;39m ==> Parameters: 
2022-08-26 16:28:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421646766706688 [0;39m <==    Updates: 0
2022-08-26 16:28:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421646766706688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:28:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421667734032384 [0;39m 生成今日电子书快照开始
2022-08-26 16:28:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421667734032384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:28:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421667734032384 [0;39m ==> Parameters: 
2022-08-26 16:28:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421667734032384 [0;39m <==    Updates: 0
2022-08-26 16:28:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421667734032384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:28:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421688705552384 [0;39m 生成今日电子书快照开始
2022-08-26 16:28:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421688705552384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:28:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421688705552384 [0;39m ==> Parameters: 
2022-08-26 16:28:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421688705552384 [0;39m <==    Updates: 0
2022-08-26 16:28:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421688705552384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:28:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20421709689655296 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:28:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421709689655296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:28:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421709689655296 [0;39m ==> Parameters: 
2022-08-26 16:28:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421709689655296 [0;39m <==    Updates: 8
2022-08-26 16:28:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20421709689655296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:28:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421709698043904 [0;39m 生成今日电子书快照开始
2022-08-26 16:28:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421709698043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:28:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421709698043904 [0;39m ==> Parameters: 
2022-08-26 16:28:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421709698043904 [0;39m <==    Updates: 0
2022-08-26 16:28:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421709698043904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:28:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421730640203776 [0;39m 生成今日电子书快照开始
2022-08-26 16:28:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421730640203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:28:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421730640203776 [0;39m ==> Parameters: 
2022-08-26 16:28:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421730640203776 [0;39m <==    Updates: 0
2022-08-26 16:28:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421730640203776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:28:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421751611723776 [0;39m 生成今日电子书快照开始
2022-08-26 16:28:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421751611723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:28:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421751611723776 [0;39m ==> Parameters: 
2022-08-26 16:28:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421751611723776 [0;39m <==    Updates: 0
2022-08-26 16:28:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421751611723776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:28:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421772620992512 [0;39m 生成今日电子书快照开始
2022-08-26 16:28:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421772620992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:28:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421772620992512 [0;39m ==> Parameters: 
2022-08-26 16:28:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421772620992512 [0;39m <==    Updates: 0
2022-08-26 16:28:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421772620992512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:28:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421793609289728 [0;39m 生成今日电子书快照开始
2022-08-26 16:28:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421793609289728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:28:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421793609289728 [0;39m ==> Parameters: 
2022-08-26 16:28:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421793609289728 [0;39m <==    Updates: 0
2022-08-26 16:28:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421793609289728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:29:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421814555643904 [0;39m 生成今日电子书快照开始
2022-08-26 16:29:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421814555643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:29:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421814555643904 [0;39m ==> Parameters: 
2022-08-26 16:29:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421814555643904 [0;39m <==    Updates: 0
2022-08-26 16:29:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421814555643904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:29:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421835514580992 [0;39m 生成今日电子书快照开始
2022-08-26 16:29:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421835514580992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:29:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421835514580992 [0;39m ==> Parameters: 
2022-08-26 16:29:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421835514580992 [0;39m <==    Updates: 0
2022-08-26 16:29:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421835514580992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:29:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20421835527163904 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:29:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421835527163904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:29:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421835527163904 [0;39m ==> Parameters: 
2022-08-26 16:29:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421835527163904 [0;39m <==    Updates: 8
2022-08-26 16:29:05.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20421835527163904 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:29:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421856477712384 [0;39m 生成今日电子书快照开始
2022-08-26 16:29:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421856477712384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:29:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421856477712384 [0;39m ==> Parameters: 
2022-08-26 16:29:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421856477712384 [0;39m <==    Updates: 0
2022-08-26 16:29:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421856477712384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:29:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421877440843776 [0;39m 生成今日电子书快照开始
2022-08-26 16:29:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421877440843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:29:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421877440843776 [0;39m ==> Parameters: 
2022-08-26 16:29:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421877440843776 [0;39m <==    Updates: 0
2022-08-26 16:29:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421877440843776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:29:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421898416558080 [0;39m 生成今日电子书快照开始
2022-08-26 16:29:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421898416558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:29:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421898416558080 [0;39m ==> Parameters: 
2022-08-26 16:29:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421898416558080 [0;39m <==    Updates: 0
2022-08-26 16:29:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421898416558080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:29:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421919434215424 [0;39m 生成今日电子书快照开始
2022-08-26 16:29:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421919434215424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:29:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421919434215424 [0;39m ==> Parameters: 
2022-08-26 16:29:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421919434215424 [0;39m <==    Updates: 0
2022-08-26 16:29:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421919434215424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:29:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421940351209472 [0;39m 生成今日电子书快照开始
2022-08-26 16:29:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421940351209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:29:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421940351209472 [0;39m ==> Parameters: 
2022-08-26 16:29:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421940351209472 [0;39m <==    Updates: 0
2022-08-26 16:29:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421940351209472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:29:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20421961352089600 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:29:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421961352089600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:29:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421961352089600 [0;39m ==> Parameters: 
2022-08-26 16:29:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20421961352089600 [0;39m <==    Updates: 8
2022-08-26 16:29:35.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20421961352089600 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:29:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421961364672512 [0;39m 生成今日电子书快照开始
2022-08-26 16:29:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421961364672512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:29:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421961364672512 [0;39m ==> Parameters: 
2022-08-26 16:29:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421961364672512 [0;39m <==    Updates: 0
2022-08-26 16:29:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421961364672512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:29:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20421982340386816 [0;39m 生成今日电子书快照开始
2022-08-26 16:29:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421982340386816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:29:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421982340386816 [0;39m ==> Parameters: 
2022-08-26 16:29:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20421982340386816 [0;39m <==    Updates: 0
2022-08-26 16:29:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20421982340386816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:29:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422003265769472 [0;39m 生成今日电子书快照开始
2022-08-26 16:29:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422003265769472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:29:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422003265769472 [0;39m ==> Parameters: 
2022-08-26 16:29:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422003265769472 [0;39m <==    Updates: 0
2022-08-26 16:29:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422003265769472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:29:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422024254066688 [0;39m 生成今日电子书快照开始
2022-08-26 16:29:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422024254066688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:29:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422024254066688 [0;39m ==> Parameters: 
2022-08-26 16:29:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422024254066688 [0;39m <==    Updates: 0
2022-08-26 16:29:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422024254066688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:29:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422045213003776 [0;39m 生成今日电子书快照开始
2022-08-26 16:29:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422045213003776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:29:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422045213003776 [0;39m ==> Parameters: 
2022-08-26 16:29:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422045213003776 [0;39m <==    Updates: 0
2022-08-26 16:29:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422045213003776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:30:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422066188718080 [0;39m 生成今日电子书快照开始
2022-08-26 16:30:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422066188718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:30:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422066188718080 [0;39m ==> Parameters: 
2022-08-26 16:30:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422066188718080 [0;39m <==    Updates: 0
2022-08-26 16:30:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422066188718080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:30:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422087189598208 [0;39m 生成今日电子书快照开始
2022-08-26 16:30:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422087189598208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:30:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422087189598208 [0;39m ==> Parameters: 
2022-08-26 16:30:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422087189598208 [0;39m <==    Updates: 0
2022-08-26 16:30:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422087189598208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:30:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20422087197986816 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:30:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422087197986816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:30:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422087197986816 [0;39m ==> Parameters: 
2022-08-26 16:30:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422087197986816 [0;39m <==    Updates: 8
2022-08-26 16:30:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20422087197986816 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:30:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422108182089728 [0;39m 生成今日电子书快照开始
2022-08-26 16:30:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422108182089728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:30:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422108182089728 [0;39m ==> Parameters: 
2022-08-26 16:30:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422108182089728 [0;39m <==    Updates: 0
2022-08-26 16:30:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422108182089728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:30:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422129124249600 [0;39m 生成今日电子书快照开始
2022-08-26 16:30:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422129124249600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:30:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422129124249600 [0;39m ==> Parameters: 
2022-08-26 16:30:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422129124249600 [0;39m <==    Updates: 0
2022-08-26 16:30:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422129124249600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:30:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422150108352512 [0;39m 生成今日电子书快照开始
2022-08-26 16:30:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422150108352512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:30:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422150108352512 [0;39m ==> Parameters: 
2022-08-26 16:30:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422150108352512 [0;39m <==    Updates: 0
2022-08-26 16:30:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422150108352512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:30:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422171050512384 [0;39m 生成今日电子书快照开始
2022-08-26 16:30:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422171050512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:30:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422171050512384 [0;39m ==> Parameters: 
2022-08-26 16:30:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422171050512384 [0;39m <==    Updates: 0
2022-08-26 16:30:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422171050512384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:30:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422192009449472 [0;39m 生成今日电子书快照开始
2022-08-26 16:30:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422192009449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:30:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422192009449472 [0;39m ==> Parameters: 
2022-08-26 16:30:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422192009449472 [0;39m <==    Updates: 0
2022-08-26 16:30:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422192009449472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:30:35.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422212980969472 [0;39m 生成今日电子书快照开始
2022-08-26 16:30:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422212980969472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:30:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422212980969472 [0;39m ==> Parameters: 
2022-08-26 16:30:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422212980969472 [0;39m <==    Updates: 0
2022-08-26 16:30:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422212980969472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:30:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20422212989358080 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:30:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422212989358080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:30:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422212989358080 [0;39m ==> Parameters: 
2022-08-26 16:30:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422212989358080 [0;39m <==    Updates: 8
2022-08-26 16:30:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20422212989358080 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:30:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422234011209728 [0;39m 生成今日电子书快照开始
2022-08-26 16:30:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422234011209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:30:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422234011209728 [0;39m ==> Parameters: 
2022-08-26 16:30:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422234011209728 [0;39m <==    Updates: 0
2022-08-26 16:30:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422234011209728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:30:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422254970146816 [0;39m 生成今日电子书快照开始
2022-08-26 16:30:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422254970146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:30:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422254970146816 [0;39m ==> Parameters: 
2022-08-26 16:30:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422254970146816 [0;39m <==    Updates: 0
2022-08-26 16:30:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422254970146816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:30:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422275920695296 [0;39m 生成今日电子书快照开始
2022-08-26 16:30:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422275920695296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:30:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422275920695296 [0;39m ==> Parameters: 
2022-08-26 16:30:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422275920695296 [0;39m <==    Updates: 0
2022-08-26 16:30:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422275920695296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:30:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422296892215296 [0;39m 生成今日电子书快照开始
2022-08-26 16:30:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422296892215296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:30:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422296892215296 [0;39m ==> Parameters: 
2022-08-26 16:30:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422296892215296 [0;39m <==    Updates: 0
2022-08-26 16:30:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422296892215296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:31:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422317846958080 [0;39m 生成今日电子书快照开始
2022-08-26 16:31:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422317846958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:31:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422317846958080 [0;39m ==> Parameters: 
2022-08-26 16:31:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422317846958080 [0;39m <==    Updates: 0
2022-08-26 16:31:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422317846958080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:31:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20422338843643904 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:31:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422338843643904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:31:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422338843643904 [0;39m ==> Parameters: 
2022-08-26 16:31:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422338843643904 [0;39m <==    Updates: 8
2022-08-26 16:31:05.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20422338843643904 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:31:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422338852032512 [0;39m 生成今日电子书快照开始
2022-08-26 16:31:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422338852032512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:31:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422338852032512 [0;39m ==> Parameters: 
2022-08-26 16:31:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422338852032512 [0;39m <==    Updates: 0
2022-08-26 16:31:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422338852032512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:31:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422359823552512 [0;39m 生成今日电子书快照开始
2022-08-26 16:31:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422359823552512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:31:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422359823552512 [0;39m ==> Parameters: 
2022-08-26 16:31:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422359823552512 [0;39m <==    Updates: 0
2022-08-26 16:31:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422359823552512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:31:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422380782489600 [0;39m 生成今日电子书快照开始
2022-08-26 16:31:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422380782489600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:31:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422380782489600 [0;39m ==> Parameters: 
2022-08-26 16:31:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422380782489600 [0;39m <==    Updates: 0
2022-08-26 16:31:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422380782489600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:31:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422401766592512 [0;39m 生成今日电子书快照开始
2022-08-26 16:31:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422401766592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:31:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422401766592512 [0;39m ==> Parameters: 
2022-08-26 16:31:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422401766592512 [0;39m <==    Updates: 0
2022-08-26 16:31:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422401766592512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:31:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422422708752384 [0;39m 生成今日电子书快照开始
2022-08-26 16:31:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422422708752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:31:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422422708752384 [0;39m ==> Parameters: 
2022-08-26 16:31:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422422708752384 [0;39m <==    Updates: 0
2022-08-26 16:31:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422422708752384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:31:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422443718021120 [0;39m 生成今日电子书快照开始
2022-08-26 16:31:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422443718021120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:31:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422443718021120 [0;39m ==> Parameters: 
2022-08-26 16:31:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422443718021120 [0;39m <==    Updates: 0
2022-08-26 16:31:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422443718021120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:31:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20422464693735424 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:31:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422464693735424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:31:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422464693735424 [0;39m ==> Parameters: 
2022-08-26 16:31:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422464693735424 [0;39m <==    Updates: 8
2022-08-26 16:31:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20422464693735424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:31:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422464702124032 [0;39m 生成今日电子书快照开始
2022-08-26 16:31:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422464702124032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:31:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422464702124032 [0;39m ==> Parameters: 
2022-08-26 16:31:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422464702124032 [0;39m <==    Updates: 0
2022-08-26 16:31:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422464702124032 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:31:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422485648478208 [0;39m 生成今日电子书快照开始
2022-08-26 16:31:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422485648478208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:31:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422485648478208 [0;39m ==> Parameters: 
2022-08-26 16:31:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422485648478208 [0;39m <==    Updates: 0
2022-08-26 16:31:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422485648478208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:31:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422506603220992 [0;39m 生成今日电子书快照开始
2022-08-26 16:31:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422506603220992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:31:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422506603220992 [0;39m ==> Parameters: 
2022-08-26 16:31:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422506603220992 [0;39m <==    Updates: 0
2022-08-26 16:31:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422506603220992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:31:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422527587323904 [0;39m 生成今日电子书快照开始
2022-08-26 16:31:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422527587323904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:31:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422527587323904 [0;39m ==> Parameters: 
2022-08-26 16:31:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422527587323904 [0;39m <==    Updates: 0
2022-08-26 16:31:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422527587323904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:31:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422548558843904 [0;39m 生成今日电子书快照开始
2022-08-26 16:31:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422548558843904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:31:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422548558843904 [0;39m ==> Parameters: 
2022-08-26 16:31:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422548558843904 [0;39m <==    Updates: 0
2022-08-26 16:31:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422548558843904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:32:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422569559724032 [0;39m 生成今日电子书快照开始
2022-08-26 16:32:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422569559724032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:32:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422569559724032 [0;39m ==> Parameters: 
2022-08-26 16:32:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422569559724032 [0;39m <==    Updates: 0
2022-08-26 16:32:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422569559724032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:32:05.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20422590476718080 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:32:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422590476718080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:32:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422590476718080 [0;39m ==> Parameters: 
2022-08-26 16:32:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422590476718080 [0;39m <==    Updates: 8
2022-08-26 16:32:05.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20422590476718080 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:32:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422590485106688 [0;39m 生成今日电子书快照开始
2022-08-26 16:32:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422590485106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:32:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422590485106688 [0;39m ==> Parameters: 
2022-08-26 16:32:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422590485106688 [0;39m <==    Updates: 0
2022-08-26 16:32:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422590485106688 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 16:32:06.008 INFO  io.lettuce.core.protocol.CommandHandler           :217 
                [32m                  [0;39m null Unexpected exception during request: java.io.IOException: 远程主机强迫关闭了一个现有的连接。
java.io.IOException: 远程主机强迫关闭了一个现有的连接。
	at sun.nio.ch.SocketDispatcher.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:43)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:258)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-08-26 16:32:06.242 INFO  io.lettuce.core.protocol.ConnectionWatchdog       :171 
                [32m                  [0;39m Reconnecting, last destination was r-uf6ljbcdaxobsifyctpd.redis.rds.aliyuncs.com/47.103.172.100:6379
2022-08-26 16:32:06.511 INFO  io.lettuce.core.protocol.ReconnectionHandler      :174 
                [32m                  [0;39m Reconnected to r-uf6ljbcdaxobsifyctpd.redis.rds.aliyuncs.com:6379
2022-08-26 16:32:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422611448238080 [0;39m 生成今日电子书快照开始
2022-08-26 16:32:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422611448238080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:32:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422611448238080 [0;39m ==> Parameters: 
2022-08-26 16:32:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422611448238080 [0;39m <==    Updates: 0
2022-08-26 16:32:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422611448238080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:32:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422632432340992 [0;39m 生成今日电子书快照开始
2022-08-26 16:32:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422632432340992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:32:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422632432340992 [0;39m ==> Parameters: 
2022-08-26 16:32:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422632432340992 [0;39m <==    Updates: 0
2022-08-26 16:32:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422632432340992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:32:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422653416443904 [0;39m 生成今日电子书快照开始
2022-08-26 16:32:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422653416443904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:32:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422653416443904 [0;39m ==> Parameters: 
2022-08-26 16:32:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422653416443904 [0;39m <==    Updates: 0
2022-08-26 16:32:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422653416443904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:32:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422674354409472 [0;39m 生成今日电子书快照开始
2022-08-26 16:32:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422674354409472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:32:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422674354409472 [0;39m ==> Parameters: 
2022-08-26 16:32:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422674354409472 [0;39m <==    Updates: 0
2022-08-26 16:32:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422674354409472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:32:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422695380455424 [0;39m 生成今日电子书快照开始
2022-08-26 16:32:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422695380455424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:32:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422695380455424 [0;39m ==> Parameters: 
2022-08-26 16:32:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422695380455424 [0;39m <==    Updates: 0
2022-08-26 16:32:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422695380455424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:32:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20422716360364032 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:32:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422716360364032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:32:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422716360364032 [0;39m ==> Parameters: 
2022-08-26 16:32:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422716360364032 [0;39m <==    Updates: 8
2022-08-26 16:32:35.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20422716360364032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:32:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422716368752640 [0;39m 生成今日电子书快照开始
2022-08-26 16:32:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422716368752640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:32:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422716368752640 [0;39m ==> Parameters: 
2022-08-26 16:32:35.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422716368752640 [0;39m <==    Updates: 0
2022-08-26 16:32:35.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422716368752640 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:32:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422737277358080 [0;39m 生成今日电子书快照开始
2022-08-26 16:32:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422737277358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:32:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422737277358080 [0;39m ==> Parameters: 
2022-08-26 16:32:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422737277358080 [0;39m <==    Updates: 0
2022-08-26 16:32:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422737277358080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:32:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422758290821120 [0;39m 生成今日电子书快照开始
2022-08-26 16:32:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422758290821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:32:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422758290821120 [0;39m ==> Parameters: 
2022-08-26 16:32:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422758290821120 [0;39m <==    Updates: 0
2022-08-26 16:32:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422758290821120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:32:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422779253952512 [0;39m 生成今日电子书快照开始
2022-08-26 16:32:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422779253952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:32:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422779253952512 [0;39m ==> Parameters: 
2022-08-26 16:32:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422779253952512 [0;39m <==    Updates: 0
2022-08-26 16:32:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422779253952512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:32:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422800233861120 [0;39m 生成今日电子书快照开始
2022-08-26 16:32:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422800233861120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:32:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422800233861120 [0;39m ==> Parameters: 
2022-08-26 16:32:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422800233861120 [0;39m <==    Updates: 0
2022-08-26 16:32:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422800233861120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:33:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422821180215296 [0;39m 生成今日电子书快照开始
2022-08-26 16:33:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422821180215296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:33:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422821180215296 [0;39m ==> Parameters: 
2022-08-26 16:33:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422821180215296 [0;39m <==    Updates: 0
2022-08-26 16:33:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422821180215296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:33:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422842143346688 [0;39m 生成今日电子书快照开始
2022-08-26 16:33:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422842143346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:33:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422842143346688 [0;39m ==> Parameters: 
2022-08-26 16:33:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422842143346688 [0;39m <==    Updates: 0
2022-08-26 16:33:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422842143346688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:33:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20422842155929600 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:33:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422842155929600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:33:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422842155929600 [0;39m ==> Parameters: 
2022-08-26 16:33:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422842155929600 [0;39m <==    Updates: 8
2022-08-26 16:33:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20422842155929600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:33:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422863152615424 [0;39m 生成今日电子书快照开始
2022-08-26 16:33:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422863152615424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:33:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422863152615424 [0;39m ==> Parameters: 
2022-08-26 16:33:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422863152615424 [0;39m <==    Updates: 0
2022-08-26 16:33:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422863152615424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:33:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422884128329728 [0;39m 生成今日电子书快照开始
2022-08-26 16:33:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422884128329728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:33:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422884128329728 [0;39m ==> Parameters: 
2022-08-26 16:33:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422884128329728 [0;39m <==    Updates: 0
2022-08-26 16:33:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422884128329728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:33:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422905066295296 [0;39m 生成今日电子书快照开始
2022-08-26 16:33:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422905066295296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:33:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422905066295296 [0;39m ==> Parameters: 
2022-08-26 16:33:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422905066295296 [0;39m <==    Updates: 0
2022-08-26 16:33:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422905066295296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:33:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422926025232384 [0;39m 生成今日电子书快照开始
2022-08-26 16:33:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422926025232384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:33:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422926025232384 [0;39m ==> Parameters: 
2022-08-26 16:33:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422926025232384 [0;39m <==    Updates: 0
2022-08-26 16:33:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422926025232384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:33:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422947047084032 [0;39m 生成今日电子书快照开始
2022-08-26 16:33:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422947047084032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:33:30.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422947047084032 [0;39m ==> Parameters: 
2022-08-26 16:33:30.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422947047084032 [0;39m <==    Updates: 0
2022-08-26 16:33:30.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422947047084032 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 16:33:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20422968006021120 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:33:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422968006021120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:33:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422968006021120 [0;39m ==> Parameters: 
2022-08-26 16:33:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20422968006021120 [0;39m <==    Updates: 8
2022-08-26 16:33:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20422968006021120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:33:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422968014409728 [0;39m 生成今日电子书快照开始
2022-08-26 16:33:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422968014409728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:33:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422968014409728 [0;39m ==> Parameters: 
2022-08-26 16:33:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422968014409728 [0;39m <==    Updates: 0
2022-08-26 16:33:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422968014409728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:33:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20422988935598080 [0;39m 生成今日电子书快照开始
2022-08-26 16:33:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422988935598080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:33:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422988935598080 [0;39m ==> Parameters: 
2022-08-26 16:33:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20422988935598080 [0;39m <==    Updates: 0
2022-08-26 16:33:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20422988935598080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:33:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423009949061120 [0;39m 生成今日电子书快照开始
2022-08-26 16:33:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423009949061120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:33:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423009949061120 [0;39m ==> Parameters: 
2022-08-26 16:33:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423009949061120 [0;39m <==    Updates: 0
2022-08-26 16:33:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423009949061120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:33:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423030912192512 [0;39m 生成今日电子书快照开始
2022-08-26 16:33:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423030912192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:33:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423030912192512 [0;39m ==> Parameters: 
2022-08-26 16:33:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423030912192512 [0;39m <==    Updates: 0
2022-08-26 16:33:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423030912192512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:33:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423051854352384 [0;39m 生成今日电子书快照开始
2022-08-26 16:33:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423051854352384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:33:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423051854352384 [0;39m ==> Parameters: 
2022-08-26 16:33:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423051854352384 [0;39m <==    Updates: 0
2022-08-26 16:33:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423051854352384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:34:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423072872009728 [0;39m 生成今日电子书快照开始
2022-08-26 16:34:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423072872009728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:34:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423072872009728 [0;39m ==> Parameters: 
2022-08-26 16:34:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423072872009728 [0;39m <==    Updates: 0
2022-08-26 16:34:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423072872009728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:34:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20423093839335424 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:34:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423093839335424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:34:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423093839335424 [0;39m ==> Parameters: 
2022-08-26 16:34:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423093839335424 [0;39m <==    Updates: 8
2022-08-26 16:34:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20423093839335424 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:34:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423093847724032 [0;39m 生成今日电子书快照开始
2022-08-26 16:34:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423093847724032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:34:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423093847724032 [0;39m ==> Parameters: 
2022-08-26 16:34:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423093847724032 [0;39m <==    Updates: 0
2022-08-26 16:34:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423093847724032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:34:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423114789883904 [0;39m 生成今日电子书快照开始
2022-08-26 16:34:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423114789883904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:34:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423114789883904 [0;39m ==> Parameters: 
2022-08-26 16:34:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423114789883904 [0;39m <==    Updates: 0
2022-08-26 16:34:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423114789883904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:34:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423135753015296 [0;39m 生成今日电子书快照开始
2022-08-26 16:34:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423135753015296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:34:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423135753015296 [0;39m ==> Parameters: 
2022-08-26 16:34:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423135753015296 [0;39m <==    Updates: 0
2022-08-26 16:34:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423135753015296 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:34:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423156737118208 [0;39m 生成今日电子书快照开始
2022-08-26 16:34:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423156737118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:34:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423156737118208 [0;39m ==> Parameters: 
2022-08-26 16:34:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423156737118208 [0;39m <==    Updates: 0
2022-08-26 16:34:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423156737118208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:34:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423177717026816 [0;39m 生成今日电子书快照开始
2022-08-26 16:34:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423177717026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:34:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423177717026816 [0;39m ==> Parameters: 
2022-08-26 16:34:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423177717026816 [0;39m <==    Updates: 0
2022-08-26 16:34:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423177717026816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:34:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423198684352512 [0;39m 生成今日电子书快照开始
2022-08-26 16:34:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423198684352512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:34:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423198684352512 [0;39m ==> Parameters: 
2022-08-26 16:34:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423198684352512 [0;39m <==    Updates: 0
2022-08-26 16:34:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423198684352512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:34:35.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20423219647483904 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:34:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423219647483904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:34:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423219647483904 [0;39m ==> Parameters: 
2022-08-26 16:34:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423219647483904 [0;39m <==    Updates: 8
2022-08-26 16:34:35.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20423219647483904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:34:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423219655872512 [0;39m 生成今日电子书快照开始
2022-08-26 16:34:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423219655872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:34:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423219655872512 [0;39m ==> Parameters: 
2022-08-26 16:34:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423219655872512 [0;39m <==    Updates: 0
2022-08-26 16:34:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423219655872512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:34:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423240631586816 [0;39m 生成今日电子书快照开始
2022-08-26 16:34:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423240631586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:34:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423240631586816 [0;39m ==> Parameters: 
2022-08-26 16:34:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423240631586816 [0;39m <==    Updates: 0
2022-08-26 16:34:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423240631586816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:34:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423261582135296 [0;39m 生成今日电子书快照开始
2022-08-26 16:34:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423261582135296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:34:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423261582135296 [0;39m ==> Parameters: 
2022-08-26 16:34:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423261582135296 [0;39m <==    Updates: 0
2022-08-26 16:34:45.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423261582135296 [0;39m 生成今日电子书快照结束，耗时：11 毫秒
2022-08-26 16:34:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423282557849600 [0;39m 生成今日电子书快照开始
2022-08-26 16:34:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423282557849600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:34:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423282557849600 [0;39m ==> Parameters: 
2022-08-26 16:34:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423282557849600 [0;39m <==    Updates: 0
2022-08-26 16:34:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423282557849600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:34:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423303537758208 [0;39m 生成今日电子书快照开始
2022-08-26 16:34:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423303537758208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:34:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423303537758208 [0;39m ==> Parameters: 
2022-08-26 16:34:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423303537758208 [0;39m <==    Updates: 0
2022-08-26 16:34:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423303537758208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:35:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423324484112384 [0;39m 生成今日电子书快照开始
2022-08-26 16:35:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423324484112384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:35:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423324484112384 [0;39m ==> Parameters: 
2022-08-26 16:35:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423324484112384 [0;39m <==    Updates: 0
2022-08-26 16:35:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423324484112384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:35:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20423345489186816 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:35:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423345489186816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:35:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423345489186816 [0;39m ==> Parameters: 
2022-08-26 16:35:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423345489186816 [0;39m <==    Updates: 8
2022-08-26 16:35:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20423345489186816 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:35:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423345497575424 [0;39m 生成今日电子书快照开始
2022-08-26 16:35:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423345497575424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:35:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423345497575424 [0;39m ==> Parameters: 
2022-08-26 16:35:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423345497575424 [0;39m <==    Updates: 0
2022-08-26 16:35:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423345497575424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:35:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423366422958080 [0;39m 生成今日电子书快照开始
2022-08-26 16:35:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423366422958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:35:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423366422958080 [0;39m ==> Parameters: 
2022-08-26 16:35:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423366422958080 [0;39m <==    Updates: 0
2022-08-26 16:35:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423366422958080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:35:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423387394478080 [0;39m 生成今日电子书快照开始
2022-08-26 16:35:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423387394478080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:35:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423387394478080 [0;39m ==> Parameters: 
2022-08-26 16:35:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423387394478080 [0;39m <==    Updates: 0
2022-08-26 16:35:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423387394478080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:35:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423408391163904 [0;39m 生成今日电子书快照开始
2022-08-26 16:35:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423408391163904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:35:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423408391163904 [0;39m ==> Parameters: 
2022-08-26 16:35:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423408391163904 [0;39m <==    Updates: 0
2022-08-26 16:35:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423408391163904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:35:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423429350100992 [0;39m 生成今日电子书快照开始
2022-08-26 16:35:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423429350100992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:35:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423429350100992 [0;39m ==> Parameters: 
2022-08-26 16:35:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423429350100992 [0;39m <==    Updates: 0
2022-08-26 16:35:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423429350100992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:35:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423450355175424 [0;39m 生成今日电子书快照开始
2022-08-26 16:35:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423450355175424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:35:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423450355175424 [0;39m ==> Parameters: 
2022-08-26 16:35:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423450355175424 [0;39m <==    Updates: 0
2022-08-26 16:35:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423450355175424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:35:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20423471297335296 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:35:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423471297335296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:35:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423471297335296 [0;39m ==> Parameters: 
2022-08-26 16:35:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423471297335296 [0;39m <==    Updates: 8
2022-08-26 16:35:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20423471297335296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:35:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423471305723904 [0;39m 生成今日电子书快照开始
2022-08-26 16:35:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423471305723904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:35:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423471305723904 [0;39m ==> Parameters: 
2022-08-26 16:35:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423471305723904 [0;39m <==    Updates: 0
2022-08-26 16:35:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423471305723904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:35:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423492247883776 [0;39m 生成今日电子书快照开始
2022-08-26 16:35:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423492247883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:35:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423492247883776 [0;39m ==> Parameters: 
2022-08-26 16:35:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423492247883776 [0;39m <==    Updates: 0
2022-08-26 16:35:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423492247883776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:35:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423513261346816 [0;39m 生成今日电子书快照开始
2022-08-26 16:35:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423513261346816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:35:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423513261346816 [0;39m ==> Parameters: 
2022-08-26 16:35:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423513261346816 [0;39m <==    Updates: 0
2022-08-26 16:35:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423513261346816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:35:50.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423534186729472 [0;39m 生成今日电子书快照开始
2022-08-26 16:35:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423534186729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:35:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423534186729472 [0;39m ==> Parameters: 
2022-08-26 16:35:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423534186729472 [0;39m <==    Updates: 0
2022-08-26 16:35:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423534186729472 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 16:35:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423555212775424 [0;39m 生成今日电子书快照开始
2022-08-26 16:35:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423555212775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:35:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423555212775424 [0;39m ==> Parameters: 
2022-08-26 16:35:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423555212775424 [0;39m <==    Updates: 0
2022-08-26 16:35:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423555212775424 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:36:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423576142352384 [0;39m 生成今日电子书快照开始
2022-08-26 16:36:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423576142352384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:36:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423576142352384 [0;39m ==> Parameters: 
2022-08-26 16:36:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423576142352384 [0;39m <==    Updates: 0
2022-08-26 16:36:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423576142352384 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 16:36:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20423597134843904 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:36:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423597134843904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:36:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423597134843904 [0;39m ==> Parameters: 
2022-08-26 16:36:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423597134843904 [0;39m <==    Updates: 8
2022-08-26 16:36:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20423597134843904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:36:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423597143232512 [0;39m 生成今日电子书快照开始
2022-08-26 16:36:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423597143232512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:36:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423597143232512 [0;39m ==> Parameters: 
2022-08-26 16:36:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423597143232512 [0;39m <==    Updates: 0
2022-08-26 16:36:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423597143232512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:36:10.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423618156695552 [0;39m 生成今日电子书快照开始
2022-08-26 16:36:10.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423618156695552 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:36:10.026 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423618156695552 [0;39m ==> Parameters: 
2022-08-26 16:36:10.032 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423618156695552 [0;39m <==    Updates: 0
2022-08-26 16:36:10.032 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423618156695552 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 16:36:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423639061106688 [0;39m 生成今日电子书快照开始
2022-08-26 16:36:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423639061106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:36:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423639061106688 [0;39m ==> Parameters: 
2022-08-26 16:36:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423639061106688 [0;39m <==    Updates: 0
2022-08-26 16:36:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423639061106688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:36:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423660015849472 [0;39m 生成今日电子书快照开始
2022-08-26 16:36:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423660015849472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:36:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423660015849472 [0;39m ==> Parameters: 
2022-08-26 16:36:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423660015849472 [0;39m <==    Updates: 0
2022-08-26 16:36:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423660015849472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:36:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423681020923904 [0;39m 生成今日电子书快照开始
2022-08-26 16:36:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423681020923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:36:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423681020923904 [0;39m ==> Parameters: 
2022-08-26 16:36:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423681020923904 [0;39m <==    Updates: 0
2022-08-26 16:36:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423681020923904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:36:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423701958889472 [0;39m 生成今日电子书快照开始
2022-08-26 16:36:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423701958889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:36:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423701958889472 [0;39m ==> Parameters: 
2022-08-26 16:36:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423701958889472 [0;39m <==    Updates: 0
2022-08-26 16:36:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423701958889472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:36:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423722993324032 [0;39m 生成今日电子书快照开始
2022-08-26 16:36:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423722993324032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:36:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423722993324032 [0;39m ==> Parameters: 
2022-08-26 16:36:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423722993324032 [0;39m <==    Updates: 0
2022-08-26 16:36:35.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423722993324032 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:36:35.020 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20423723010101248 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:36:35.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423723010101248 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:36:35.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423723010101248 [0;39m ==> Parameters: 
2022-08-26 16:36:35.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423723010101248 [0;39m <==    Updates: 8
2022-08-26 16:36:35.024 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20423723010101248 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 16:36:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423743952261120 [0;39m 生成今日电子书快照开始
2022-08-26 16:36:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423743952261120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:36:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423743952261120 [0;39m ==> Parameters: 
2022-08-26 16:36:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423743952261120 [0;39m <==    Updates: 0
2022-08-26 16:36:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423743952261120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:36:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423764894420992 [0;39m 生成今日电子书快照开始
2022-08-26 16:36:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423764894420992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:36:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423764894420992 [0;39m ==> Parameters: 
2022-08-26 16:36:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423764894420992 [0;39m <==    Updates: 0
2022-08-26 16:36:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423764894420992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:36:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423785874329600 [0;39m 生成今日电子书快照开始
2022-08-26 16:36:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423785874329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:36:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423785874329600 [0;39m ==> Parameters: 
2022-08-26 16:36:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423785874329600 [0;39m <==    Updates: 0
2022-08-26 16:36:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423785874329600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:36:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423806833266688 [0;39m 生成今日电子书快照开始
2022-08-26 16:36:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423806833266688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:36:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423806833266688 [0;39m ==> Parameters: 
2022-08-26 16:36:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423806833266688 [0;39m <==    Updates: 0
2022-08-26 16:36:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423806833266688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:37:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423827829952512 [0;39m 生成今日电子书快照开始
2022-08-26 16:37:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423827829952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:37:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423827829952512 [0;39m ==> Parameters: 
2022-08-26 16:37:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423827829952512 [0;39m <==    Updates: 0
2022-08-26 16:37:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423827829952512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:37:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423848801472512 [0;39m 生成今日电子书快照开始
2022-08-26 16:37:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423848801472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:37:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423848801472512 [0;39m ==> Parameters: 
2022-08-26 16:37:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423848801472512 [0;39m <==    Updates: 0
2022-08-26 16:37:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423848801472512 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 16:37:05.017 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20423848826638336 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:37:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423848826638336 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:37:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423848826638336 [0;39m ==> Parameters: 
2022-08-26 16:37:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423848826638336 [0;39m <==    Updates: 8
2022-08-26 16:37:05.020 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20423848826638336 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 16:37:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423869764603904 [0;39m 生成今日电子书快照开始
2022-08-26 16:37:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423869764603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:37:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423869764603904 [0;39m ==> Parameters: 
2022-08-26 16:37:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423869764603904 [0;39m <==    Updates: 0
2022-08-26 16:37:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423869764603904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:37:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423890706763776 [0;39m 生成今日电子书快照开始
2022-08-26 16:37:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423890706763776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:37:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423890706763776 [0;39m ==> Parameters: 
2022-08-26 16:37:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423890706763776 [0;39m <==    Updates: 0
2022-08-26 16:37:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423890706763776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:37:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423911720226816 [0;39m 生成今日电子书快照开始
2022-08-26 16:37:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423911720226816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:37:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423911720226816 [0;39m ==> Parameters: 
2022-08-26 16:37:20.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423911720226816 [0;39m <==    Updates: 0
2022-08-26 16:37:20.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423911720226816 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 16:37:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423932695941120 [0;39m 生成今日电子书快照开始
2022-08-26 16:37:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423932695941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:37:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423932695941120 [0;39m ==> Parameters: 
2022-08-26 16:37:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423932695941120 [0;39m <==    Updates: 0
2022-08-26 16:37:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423932695941120 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 16:37:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423953680044032 [0;39m 生成今日电子书快照开始
2022-08-26 16:37:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423953680044032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:37:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423953680044032 [0;39m ==> Parameters: 
2022-08-26 16:37:30.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423953680044032 [0;39m <==    Updates: 0
2022-08-26 16:37:30.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423953680044032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:37:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20423974605426688 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:37:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423974605426688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:37:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423974605426688 [0;39m ==> Parameters: 
2022-08-26 16:37:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20423974605426688 [0;39m <==    Updates: 8
2022-08-26 16:37:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20423974605426688 [0;39m 更新电子书下的文档数据结束，耗时：7 毫秒
2022-08-26 16:37:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423974634786816 [0;39m 生成今日电子书快照开始
2022-08-26 16:37:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423974634786816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:37:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423974634786816 [0;39m ==> Parameters: 
2022-08-26 16:37:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423974634786816 [0;39m <==    Updates: 0
2022-08-26 16:37:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423974634786816 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 16:37:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20423995560169472 [0;39m 生成今日电子书快照开始
2022-08-26 16:37:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423995560169472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:37:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423995560169472 [0;39m ==> Parameters: 
2022-08-26 16:37:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20423995560169472 [0;39m <==    Updates: 0
2022-08-26 16:37:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20423995560169472 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 16:37:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424016565243904 [0;39m 生成今日电子书快照开始
2022-08-26 16:37:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424016565243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:37:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424016565243904 [0;39m ==> Parameters: 
2022-08-26 16:37:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424016565243904 [0;39m <==    Updates: 0
2022-08-26 16:37:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424016565243904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:37:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424037553541120 [0;39m 生成今日电子书快照开始
2022-08-26 16:37:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424037553541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:37:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424037553541120 [0;39m ==> Parameters: 
2022-08-26 16:37:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424037553541120 [0;39m <==    Updates: 0
2022-08-26 16:37:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424037553541120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:37:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424058533449728 [0;39m 生成今日电子书快照开始
2022-08-26 16:37:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424058533449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:37:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424058533449728 [0;39m ==> Parameters: 
2022-08-26 16:37:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424058533449728 [0;39m <==    Updates: 0
2022-08-26 16:37:55.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424058533449728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:38:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424079471415296 [0;39m 生成今日电子书快照开始
2022-08-26 16:38:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424079471415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:38:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424079471415296 [0;39m ==> Parameters: 
2022-08-26 16:38:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424079471415296 [0;39m <==    Updates: 0
2022-08-26 16:38:00.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424079471415296 [0;39m 生成今日电子书快照结束，耗时：11 毫秒
2022-08-26 16:38:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424100426158080 [0;39m 生成今日电子书快照开始
2022-08-26 16:38:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424100426158080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:38:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424100426158080 [0;39m ==> Parameters: 
2022-08-26 16:38:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424100426158080 [0;39m <==    Updates: 0
2022-08-26 16:38:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424100426158080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:38:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20424100438740992 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:38:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424100438740992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:38:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424100438740992 [0;39m ==> Parameters: 
2022-08-26 16:38:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424100438740992 [0;39m <==    Updates: 8
2022-08-26 16:38:05.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20424100438740992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:38:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424121410260992 [0;39m 生成今日电子书快照开始
2022-08-26 16:38:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424121410260992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:38:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424121410260992 [0;39m ==> Parameters: 
2022-08-26 16:38:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424121410260992 [0;39m <==    Updates: 0
2022-08-26 16:38:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424121410260992 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 16:38:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424142411141120 [0;39m 生成今日电子书快照开始
2022-08-26 16:38:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424142411141120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:38:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424142411141120 [0;39m ==> Parameters: 
2022-08-26 16:38:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424142411141120 [0;39m <==    Updates: 0
2022-08-26 16:38:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424142411141120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:38:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424163386855424 [0;39m 生成今日电子书快照开始
2022-08-26 16:38:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424163386855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:38:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424163386855424 [0;39m ==> Parameters: 
2022-08-26 16:38:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424163386855424 [0;39m <==    Updates: 0
2022-08-26 16:38:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424163386855424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:38:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424184303849472 [0;39m 生成今日电子书快照开始
2022-08-26 16:38:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424184303849472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:38:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424184303849472 [0;39m ==> Parameters: 
2022-08-26 16:38:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424184303849472 [0;39m <==    Updates: 0
2022-08-26 16:38:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424184303849472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:38:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424205279563776 [0;39m 生成今日电子书快照开始
2022-08-26 16:38:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424205279563776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:38:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424205279563776 [0;39m ==> Parameters: 
2022-08-26 16:38:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424205279563776 [0;39m <==    Updates: 0
2022-08-26 16:38:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424205279563776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:38:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20424226267860992 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:38:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424226267860992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:38:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424226267860992 [0;39m ==> Parameters: 
2022-08-26 16:38:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424226267860992 [0;39m <==    Updates: 8
2022-08-26 16:38:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20424226267860992 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-26 16:38:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424226297221120 [0;39m 生成今日电子书快照开始
2022-08-26 16:38:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424226297221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:38:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424226297221120 [0;39m ==> Parameters: 
2022-08-26 16:38:35.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424226297221120 [0;39m <==    Updates: 0
2022-08-26 16:38:35.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424226297221120 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:38:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424247272935424 [0;39m 生成今日电子书快照开始
2022-08-26 16:38:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424247272935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:38:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424247272935424 [0;39m ==> Parameters: 
2022-08-26 16:38:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424247272935424 [0;39m <==    Updates: 0
2022-08-26 16:38:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424247272935424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:38:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424268194123776 [0;39m 生成今日电子书快照开始
2022-08-26 16:38:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424268194123776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:38:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424268194123776 [0;39m ==> Parameters: 
2022-08-26 16:38:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424268194123776 [0;39m <==    Updates: 0
2022-08-26 16:38:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424268194123776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:38:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424289178226688 [0;39m 生成今日电子书快照开始
2022-08-26 16:38:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424289178226688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:38:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424289178226688 [0;39m ==> Parameters: 
2022-08-26 16:38:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424289178226688 [0;39m <==    Updates: 0
2022-08-26 16:38:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424289178226688 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:38:55.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424310128775168 [0;39m 生成今日电子书快照开始
2022-08-26 16:38:55.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424310128775168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:38:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424310128775168 [0;39m ==> Parameters: 
2022-08-26 16:38:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424310128775168 [0;39m <==    Updates: 0
2022-08-26 16:38:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424310128775168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:39:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424331163209728 [0;39m 生成今日电子书快照开始
2022-08-26 16:39:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424331163209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:39:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424331163209728 [0;39m ==> Parameters: 
2022-08-26 16:39:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424331163209728 [0;39m <==    Updates: 0
2022-08-26 16:39:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424331163209728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:39:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20424352122146816 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:39:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424352122146816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:39:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424352122146816 [0;39m ==> Parameters: 
2022-08-26 16:39:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424352122146816 [0;39m <==    Updates: 8
2022-08-26 16:39:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20424352122146816 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:39:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424352130535424 [0;39m 生成今日电子书快照开始
2022-08-26 16:39:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424352130535424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:39:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424352130535424 [0;39m ==> Parameters: 
2022-08-26 16:39:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424352130535424 [0;39m <==    Updates: 0
2022-08-26 16:39:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424352130535424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:39:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424373076889600 [0;39m 生成今日电子书快照开始
2022-08-26 16:39:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424373076889600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:39:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424373076889600 [0;39m ==> Parameters: 
2022-08-26 16:39:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424373076889600 [0;39m <==    Updates: 0
2022-08-26 16:39:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424373076889600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:39:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424394052603904 [0;39m 生成今日电子书快照开始
2022-08-26 16:39:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424394052603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:39:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424394052603904 [0;39m ==> Parameters: 
2022-08-26 16:39:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424394052603904 [0;39m <==    Updates: 0
2022-08-26 16:39:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424394052603904 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:39:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424415011540992 [0;39m 生成今日电子书快照开始
2022-08-26 16:39:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424415011540992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:39:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424415011540992 [0;39m ==> Parameters: 
2022-08-26 16:39:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424415011540992 [0;39m <==    Updates: 0
2022-08-26 16:39:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424415011540992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:39:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424436004032512 [0;39m 生成今日电子书快照开始
2022-08-26 16:39:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424436004032512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:39:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424436004032512 [0;39m ==> Parameters: 
2022-08-26 16:39:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424436004032512 [0;39m <==    Updates: 0
2022-08-26 16:39:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424436004032512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:39:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424456950386688 [0;39m 生成今日电子书快照开始
2022-08-26 16:39:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424456950386688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:39:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424456950386688 [0;39m ==> Parameters: 
2022-08-26 16:39:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424456950386688 [0;39m <==    Updates: 0
2022-08-26 16:39:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424456950386688 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:39:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20424477934489600 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:39:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424477934489600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:39:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424477934489600 [0;39m ==> Parameters: 
2022-08-26 16:39:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424477934489600 [0;39m <==    Updates: 8
2022-08-26 16:39:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20424477934489600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:39:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424477938683904 [0;39m 生成今日电子书快照开始
2022-08-26 16:39:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424477938683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:39:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424477938683904 [0;39m ==> Parameters: 
2022-08-26 16:39:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424477938683904 [0;39m <==    Updates: 0
2022-08-26 16:39:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424477938683904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:39:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424498889232384 [0;39m 生成今日电子书快照开始
2022-08-26 16:39:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424498889232384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:39:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424498889232384 [0;39m ==> Parameters: 
2022-08-26 16:39:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424498889232384 [0;39m <==    Updates: 0
2022-08-26 16:39:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424498889232384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:39:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424519873335296 [0;39m 生成今日电子书快照开始
2022-08-26 16:39:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424519873335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:39:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424519873335296 [0;39m ==> Parameters: 
2022-08-26 16:39:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424519873335296 [0;39m <==    Updates: 0
2022-08-26 16:39:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424519873335296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:39:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424540836466688 [0;39m 生成今日电子书快照开始
2022-08-26 16:39:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424540836466688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:39:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424540836466688 [0;39m ==> Parameters: 
2022-08-26 16:39:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424540836466688 [0;39m <==    Updates: 0
2022-08-26 16:39:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424540836466688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:39:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424561854124032 [0;39m 生成今日电子书快照开始
2022-08-26 16:39:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424561854124032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:39:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424561854124032 [0;39m ==> Parameters: 
2022-08-26 16:39:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424561854124032 [0;39m <==    Updates: 0
2022-08-26 16:39:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424561854124032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:40:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424582775312384 [0;39m 生成今日电子书快照开始
2022-08-26 16:40:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424582775312384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:40:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424582775312384 [0;39m ==> Parameters: 
2022-08-26 16:40:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424582775312384 [0;39m <==    Updates: 0
2022-08-26 16:40:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424582775312384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:40:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424603742638080 [0;39m 生成今日电子书快照开始
2022-08-26 16:40:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424603742638080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:40:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424603742638080 [0;39m ==> Parameters: 
2022-08-26 16:40:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424603742638080 [0;39m <==    Updates: 0
2022-08-26 16:40:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424603742638080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:40:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20424603755220992 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:40:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424603755220992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:40:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424603755220992 [0;39m ==> Parameters: 
2022-08-26 16:40:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424603755220992 [0;39m <==    Updates: 8
2022-08-26 16:40:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20424603755220992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:40:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424624718352384 [0;39m 生成今日电子书快照开始
2022-08-26 16:40:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424624718352384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:40:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424624718352384 [0;39m ==> Parameters: 
2022-08-26 16:40:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424624718352384 [0;39m <==    Updates: 0
2022-08-26 16:40:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424624718352384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:40:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424645727621120 [0;39m 生成今日电子书快照开始
2022-08-26 16:40:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424645727621120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:40:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424645727621120 [0;39m ==> Parameters: 
2022-08-26 16:40:15.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424645727621120 [0;39m <==    Updates: 0
2022-08-26 16:40:15.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424645727621120 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 16:40:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424666673975296 [0;39m 生成今日电子书快照开始
2022-08-26 16:40:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424666673975296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:40:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424666673975296 [0;39m ==> Parameters: 
2022-08-26 16:40:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424666673975296 [0;39m <==    Updates: 0
2022-08-26 16:40:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424666673975296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:40:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424687641300992 [0;39m 生成今日电子书快照开始
2022-08-26 16:40:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424687641300992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:40:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424687641300992 [0;39m ==> Parameters: 
2022-08-26 16:40:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424687641300992 [0;39m <==    Updates: 0
2022-08-26 16:40:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424687641300992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:40:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424708625403904 [0;39m 生成今日电子书快照开始
2022-08-26 16:40:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424708625403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:40:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424708625403904 [0;39m ==> Parameters: 
2022-08-26 16:40:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424708625403904 [0;39m <==    Updates: 0
2022-08-26 16:40:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424708625403904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:40:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424729571758080 [0;39m 生成今日电子书快照开始
2022-08-26 16:40:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424729571758080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:40:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424729571758080 [0;39m ==> Parameters: 
2022-08-26 16:40:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424729571758080 [0;39m <==    Updates: 0
2022-08-26 16:40:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424729571758080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:40:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20424729580146688 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:40:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424729580146688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:40:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424729580146688 [0;39m ==> Parameters: 
2022-08-26 16:40:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424729580146688 [0;39m <==    Updates: 8
2022-08-26 16:40:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20424729580146688 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:40:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424750589415424 [0;39m 生成今日电子书快照开始
2022-08-26 16:40:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424750589415424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:40:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424750589415424 [0;39m ==> Parameters: 
2022-08-26 16:40:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424750589415424 [0;39m <==    Updates: 0
2022-08-26 16:40:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424750589415424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:40:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424771556741120 [0;39m 生成今日电子书快照开始
2022-08-26 16:40:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424771556741120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:40:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424771556741120 [0;39m ==> Parameters: 
2022-08-26 16:40:45.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424771556741120 [0;39m <==    Updates: 0
2022-08-26 16:40:45.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424771556741120 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:40:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424792482123776 [0;39m 生成今日电子书快照开始
2022-08-26 16:40:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424792482123776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:40:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424792482123776 [0;39m ==> Parameters: 
2022-08-26 16:40:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424792482123776 [0;39m <==    Updates: 0
2022-08-26 16:40:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424792482123776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:40:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424813491392512 [0;39m 生成今日电子书快照开始
2022-08-26 16:40:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424813491392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:40:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424813491392512 [0;39m ==> Parameters: 
2022-08-26 16:40:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424813491392512 [0;39m <==    Updates: 0
2022-08-26 16:40:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424813491392512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:41:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424834467106816 [0;39m 生成今日电子书快照开始
2022-08-26 16:41:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424834467106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:41:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424834467106816 [0;39m ==> Parameters: 
2022-08-26 16:41:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424834467106816 [0;39m <==    Updates: 0
2022-08-26 16:41:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424834467106816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:41:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20424855417655296 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:41:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424855417655296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:41:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424855417655296 [0;39m ==> Parameters: 
2022-08-26 16:41:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424855417655296 [0;39m <==    Updates: 8
2022-08-26 16:41:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20424855417655296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:41:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424855426043904 [0;39m 生成今日电子书快照开始
2022-08-26 16:41:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424855426043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:41:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424855426043904 [0;39m ==> Parameters: 
2022-08-26 16:41:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424855426043904 [0;39m <==    Updates: 0
2022-08-26 16:41:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424855426043904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:41:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424876368203776 [0;39m 生成今日电子书快照开始
2022-08-26 16:41:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424876368203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:41:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424876368203776 [0;39m ==> Parameters: 
2022-08-26 16:41:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424876368203776 [0;39m <==    Updates: 0
2022-08-26 16:41:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424876368203776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:41:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424897339723776 [0;39m 生成今日电子书快照开始
2022-08-26 16:41:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424897339723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:41:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424897339723776 [0;39m ==> Parameters: 
2022-08-26 16:41:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424897339723776 [0;39m <==    Updates: 0
2022-08-26 16:41:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424897339723776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:41:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424918315438080 [0;39m 生成今日电子书快照开始
2022-08-26 16:41:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424918315438080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:41:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424918315438080 [0;39m ==> Parameters: 
2022-08-26 16:41:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424918315438080 [0;39m <==    Updates: 0
2022-08-26 16:41:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424918315438080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:41:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424939328901120 [0;39m 生成今日电子书快照开始
2022-08-26 16:41:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424939328901120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:41:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424939328901120 [0;39m ==> Parameters: 
2022-08-26 16:41:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424939328901120 [0;39m <==    Updates: 0
2022-08-26 16:41:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424939328901120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:41:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424960287838208 [0;39m 生成今日电子书快照开始
2022-08-26 16:41:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424960287838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:41:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424960287838208 [0;39m ==> Parameters: 
2022-08-26 16:41:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424960287838208 [0;39m <==    Updates: 0
2022-08-26 16:41:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424960287838208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:41:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20424981280329728 [0;39m 生成今日电子书快照开始
2022-08-26 16:41:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424981280329728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:41:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424981280329728 [0;39m ==> Parameters: 
2022-08-26 16:41:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20424981280329728 [0;39m <==    Updates: 0
2022-08-26 16:41:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20424981280329728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:41:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20424981292912640 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:41:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424981292912640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:41:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424981292912640 [0;39m ==> Parameters: 
2022-08-26 16:41:35.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20424981292912640 [0;39m <==    Updates: 8
2022-08-26 16:41:35.021 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20424981292912640 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 16:41:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425002251849728 [0;39m 生成今日电子书快照开始
2022-08-26 16:41:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425002251849728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:41:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425002251849728 [0;39m ==> Parameters: 
2022-08-26 16:41:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425002251849728 [0;39m <==    Updates: 0
2022-08-26 16:41:40.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425002251849728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:41:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425023206592512 [0;39m 生成今日电子书快照开始
2022-08-26 16:41:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425023206592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:41:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425023206592512 [0;39m ==> Parameters: 
2022-08-26 16:41:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425023206592512 [0;39m <==    Updates: 0
2022-08-26 16:41:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425023206592512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:41:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425044140363776 [0;39m 生成今日电子书快照开始
2022-08-26 16:41:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425044140363776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:41:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425044140363776 [0;39m ==> Parameters: 
2022-08-26 16:41:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425044140363776 [0;39m <==    Updates: 0
2022-08-26 16:41:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425044140363776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:41:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425065141243904 [0;39m 生成今日电子书快照开始
2022-08-26 16:41:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425065141243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:41:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425065141243904 [0;39m ==> Parameters: 
2022-08-26 16:41:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425065141243904 [0;39m <==    Updates: 0
2022-08-26 16:41:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425065141243904 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 16:42:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425086116958208 [0;39m 生成今日电子书快照开始
2022-08-26 16:42:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425086116958208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:42:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425086116958208 [0;39m ==> Parameters: 
2022-08-26 16:42:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425086116958208 [0;39m <==    Updates: 0
2022-08-26 16:42:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425086116958208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:42:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425107109449728 [0;39m 生成今日电子书快照开始
2022-08-26 16:42:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425107109449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:42:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425107109449728 [0;39m ==> Parameters: 
2022-08-26 16:42:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425107109449728 [0;39m <==    Updates: 0
2022-08-26 16:42:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425107109449728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:42:05.017 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20425107117838336 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:42:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425107117838336 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:42:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425107117838336 [0;39m ==> Parameters: 
2022-08-26 16:42:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425107117838336 [0;39m <==    Updates: 8
2022-08-26 16:42:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20425107117838336 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:42:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425128022249472 [0;39m 生成今日电子书快照开始
2022-08-26 16:42:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425128022249472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:42:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425128022249472 [0;39m ==> Parameters: 
2022-08-26 16:42:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425128022249472 [0;39m <==    Updates: 0
2022-08-26 16:42:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425128022249472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:42:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425149023129600 [0;39m 生成今日电子书快照开始
2022-08-26 16:42:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425149023129600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:42:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425149023129600 [0;39m ==> Parameters: 
2022-08-26 16:42:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425149023129600 [0;39m <==    Updates: 0
2022-08-26 16:42:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425149023129600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:42:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425170032398336 [0;39m 生成今日电子书快照开始
2022-08-26 16:42:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425170032398336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:42:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425170032398336 [0;39m ==> Parameters: 
2022-08-26 16:42:20.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425170032398336 [0;39m <==    Updates: 0
2022-08-26 16:42:20.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425170032398336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:42:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425190936809472 [0;39m 生成今日电子书快照开始
2022-08-26 16:42:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425190936809472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:42:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425190936809472 [0;39m ==> Parameters: 
2022-08-26 16:42:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425190936809472 [0;39m <==    Updates: 0
2022-08-26 16:42:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425190936809472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:42:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425211908329472 [0;39m 生成今日电子书快照开始
2022-08-26 16:42:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425211908329472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:42:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425211908329472 [0;39m ==> Parameters: 
2022-08-26 16:42:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425211908329472 [0;39m <==    Updates: 0
2022-08-26 16:42:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425211908329472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:42:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20425232909209600 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:42:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425232909209600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:42:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425232909209600 [0;39m ==> Parameters: 
2022-08-26 16:42:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425232909209600 [0;39m <==    Updates: 8
2022-08-26 16:42:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20425232909209600 [0;39m 更新电子书下的文档数据结束，耗时：9 毫秒
2022-08-26 16:42:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425232946958336 [0;39m 生成今日电子书快照开始
2022-08-26 16:42:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425232946958336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:42:35.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425232946958336 [0;39m ==> Parameters: 
2022-08-26 16:42:35.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425232946958336 [0;39m <==    Updates: 0
2022-08-26 16:42:35.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425232946958336 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 16:42:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425253889118208 [0;39m 生成今日电子书快照开始
2022-08-26 16:42:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425253889118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:42:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425253889118208 [0;39m ==> Parameters: 
2022-08-26 16:42:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425253889118208 [0;39m <==    Updates: 0
2022-08-26 16:42:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425253889118208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:42:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425274822889472 [0;39m 生成今日电子书快照开始
2022-08-26 16:42:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425274822889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:42:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425274822889472 [0;39m ==> Parameters: 
2022-08-26 16:42:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425274822889472 [0;39m <==    Updates: 0
2022-08-26 16:42:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425274822889472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:42:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425295848935424 [0;39m 生成今日电子书快照开始
2022-08-26 16:42:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425295848935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:42:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425295848935424 [0;39m ==> Parameters: 
2022-08-26 16:42:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425295848935424 [0;39m <==    Updates: 0
2022-08-26 16:42:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425295848935424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:42:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425316812066816 [0;39m 生成今日电子书快照开始
2022-08-26 16:42:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425316812066816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:42:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425316812066816 [0;39m ==> Parameters: 
2022-08-26 16:42:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425316812066816 [0;39m <==    Updates: 0
2022-08-26 16:42:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425316812066816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:43:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425337775198208 [0;39m 生成今日电子书快照开始
2022-08-26 16:43:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425337775198208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:43:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425337775198208 [0;39m ==> Parameters: 
2022-08-26 16:43:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425337775198208 [0;39m <==    Updates: 0
2022-08-26 16:43:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425337775198208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:43:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425358717358080 [0;39m 生成今日电子书快照开始
2022-08-26 16:43:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425358717358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:43:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425358717358080 [0;39m ==> Parameters: 
2022-08-26 16:43:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425358717358080 [0;39m <==    Updates: 0
2022-08-26 16:43:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425358717358080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:43:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20425358725746688 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:43:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425358725746688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:43:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425358725746688 [0;39m ==> Parameters: 
2022-08-26 16:43:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425358725746688 [0;39m <==    Updates: 8
2022-08-26 16:43:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20425358725746688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:43:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425379739209728 [0;39m 生成今日电子书快照开始
2022-08-26 16:43:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425379739209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:43:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425379739209728 [0;39m ==> Parameters: 
2022-08-26 16:43:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425379739209728 [0;39m <==    Updates: 0
2022-08-26 16:43:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425379739209728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:43:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425400689758208 [0;39m 生成今日电子书快照开始
2022-08-26 16:43:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425400689758208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:43:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425400689758208 [0;39m ==> Parameters: 
2022-08-26 16:43:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425400689758208 [0;39m <==    Updates: 0
2022-08-26 16:43:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425400689758208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:43:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425421665472512 [0;39m 生成今日电子书快照开始
2022-08-26 16:43:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425421665472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:43:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425421665472512 [0;39m ==> Parameters: 
2022-08-26 16:43:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425421665472512 [0;39m <==    Updates: 0
2022-08-26 16:43:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425421665472512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:43:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425442611826688 [0;39m 生成今日电子书快照开始
2022-08-26 16:43:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425442611826688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:43:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425442611826688 [0;39m ==> Parameters: 
2022-08-26 16:43:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425442611826688 [0;39m <==    Updates: 0
2022-08-26 16:43:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425442611826688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:43:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425463583346688 [0;39m 生成今日电子书快照开始
2022-08-26 16:43:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425463583346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:43:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425463583346688 [0;39m ==> Parameters: 
2022-08-26 16:43:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425463583346688 [0;39m <==    Updates: 0
2022-08-26 16:43:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425463583346688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:43:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425484584226816 [0;39m 生成今日电子书快照开始
2022-08-26 16:43:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425484584226816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:43:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425484584226816 [0;39m ==> Parameters: 
2022-08-26 16:43:35.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425484584226816 [0;39m <==    Updates: 0
2022-08-26 16:43:35.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425484584226816 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:43:35.021 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20425484621975552 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:43:35.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425484621975552 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:43:35.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425484621975552 [0;39m ==> Parameters: 
2022-08-26 16:43:35.024 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425484621975552 [0;39m <==    Updates: 8
2022-08-26 16:43:35.024 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20425484621975552 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 16:43:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425505517998080 [0;39m 生成今日电子书快照开始
2022-08-26 16:43:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425505517998080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:43:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425505517998080 [0;39m ==> Parameters: 
2022-08-26 16:43:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425505517998080 [0;39m <==    Updates: 0
2022-08-26 16:43:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425505517998080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:43:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425526485323776 [0;39m 生成今日电子书快照开始
2022-08-26 16:43:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425526485323776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:43:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425526485323776 [0;39m ==> Parameters: 
2022-08-26 16:43:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425526485323776 [0;39m <==    Updates: 0
2022-08-26 16:43:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425526485323776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 16:43:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425547456843776 [0;39m 生成今日电子书快照开始
2022-08-26 16:43:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425547456843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:43:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425547456843776 [0;39m ==> Parameters: 
2022-08-26 16:43:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425547456843776 [0;39m <==    Updates: 0
2022-08-26 16:43:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425547456843776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:43:55.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425568516444160 [0;39m 生成今日电子书快照开始
2022-08-26 16:43:55.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425568516444160 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:43:55.045 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425568516444160 [0;39m ==> Parameters: 
2022-08-26 16:43:55.047 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425568516444160 [0;39m <==    Updates: 0
2022-08-26 16:43:55.047 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425568516444160 [0;39m 生成今日电子书快照结束，耗时：24 毫秒
2022-08-26 16:44:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425589408272384 [0;39m 生成今日电子书快照开始
2022-08-26 16:44:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425589408272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:44:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425589408272384 [0;39m ==> Parameters: 
2022-08-26 16:44:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425589408272384 [0;39m <==    Updates: 0
2022-08-26 16:44:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425589408272384 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 16:44:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20425610404958208 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:44:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425610404958208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:44:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425610404958208 [0;39m ==> Parameters: 
2022-08-26 16:44:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425610404958208 [0;39m <==    Updates: 8
2022-08-26 16:44:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20425610404958208 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:44:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425610413346816 [0;39m 生成今日电子书快照开始
2022-08-26 16:44:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425610413346816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:44:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425610413346816 [0;39m ==> Parameters: 
2022-08-26 16:44:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425610413346816 [0;39m <==    Updates: 0
2022-08-26 16:44:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425610413346816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:44:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425631384866816 [0;39m 生成今日电子书快照开始
2022-08-26 16:44:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425631384866816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:44:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425631384866816 [0;39m ==> Parameters: 
2022-08-26 16:44:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425631384866816 [0;39m <==    Updates: 0
2022-08-26 16:44:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425631384866816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:44:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425652335415296 [0;39m 生成今日电子书快照开始
2022-08-26 16:44:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425652335415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:44:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425652335415296 [0;39m ==> Parameters: 
2022-08-26 16:44:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425652335415296 [0;39m <==    Updates: 0
2022-08-26 16:44:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425652335415296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:44:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425673294352384 [0;39m 生成今日电子书快照开始
2022-08-26 16:44:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425673294352384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:44:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425673294352384 [0;39m ==> Parameters: 
2022-08-26 16:44:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425673294352384 [0;39m <==    Updates: 0
2022-08-26 16:44:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425673294352384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:44:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425694307815424 [0;39m 生成今日电子书快照开始
2022-08-26 16:44:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425694307815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:44:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425694307815424 [0;39m ==> Parameters: 
2022-08-26 16:44:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425694307815424 [0;39m <==    Updates: 0
2022-08-26 16:44:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425694307815424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:44:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425715266752512 [0;39m 生成今日电子书快照开始
2022-08-26 16:44:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425715266752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:44:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425715266752512 [0;39m ==> Parameters: 
2022-08-26 16:44:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425715266752512 [0;39m <==    Updates: 0
2022-08-26 16:44:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425715266752512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:44:35.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20425736229883904 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:44:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425736229883904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:44:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425736229883904 [0;39m ==> Parameters: 
2022-08-26 16:44:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425736229883904 [0;39m <==    Updates: 8
2022-08-26 16:44:35.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20425736229883904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:44:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425736238272512 [0;39m 生成今日电子书快照开始
2022-08-26 16:44:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425736238272512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:44:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425736238272512 [0;39m ==> Parameters: 
2022-08-26 16:44:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425736238272512 [0;39m <==    Updates: 0
2022-08-26 16:44:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425736238272512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:44:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425757209792512 [0;39m 生成今日电子书快照开始
2022-08-26 16:44:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425757209792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:44:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425757209792512 [0;39m ==> Parameters: 
2022-08-26 16:44:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425757209792512 [0;39m <==    Updates: 0
2022-08-26 16:44:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425757209792512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:44:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425778202284032 [0;39m 生成今日电子书快照开始
2022-08-26 16:44:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425778202284032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:44:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425778202284032 [0;39m ==> Parameters: 
2022-08-26 16:44:45.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425778202284032 [0;39m <==    Updates: 0
2022-08-26 16:44:45.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425778202284032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:44:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425799131860992 [0;39m 生成今日电子书快照开始
2022-08-26 16:44:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425799131860992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:44:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425799131860992 [0;39m ==> Parameters: 
2022-08-26 16:44:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425799131860992 [0;39m <==    Updates: 0
2022-08-26 16:44:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425799131860992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:44:55.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425820078215168 [0;39m 生成今日电子书快照开始
2022-08-26 16:44:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425820078215168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:44:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425820078215168 [0;39m ==> Parameters: 
2022-08-26 16:44:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425820078215168 [0;39m <==    Updates: 0
2022-08-26 16:44:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425820078215168 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 16:45:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425841100066816 [0;39m 生成今日电子书快照开始
2022-08-26 16:45:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425841100066816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:45:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425841100066816 [0;39m ==> Parameters: 
2022-08-26 16:45:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425841100066816 [0;39m <==    Updates: 0
2022-08-26 16:45:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425841100066816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:45:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20425862075781120 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:45:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425862075781120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:45:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425862075781120 [0;39m ==> Parameters: 
2022-08-26 16:45:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425862075781120 [0;39m <==    Updates: 8
2022-08-26 16:45:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20425862075781120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:45:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425862084169728 [0;39m 生成今日电子书快照开始
2022-08-26 16:45:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425862084169728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:45:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425862084169728 [0;39m ==> Parameters: 
2022-08-26 16:45:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425862084169728 [0;39m <==    Updates: 0
2022-08-26 16:45:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425862084169728 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:45:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425883059884032 [0;39m 生成今日电子书快照开始
2022-08-26 16:45:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425883059884032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:45:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425883059884032 [0;39m ==> Parameters: 
2022-08-26 16:45:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425883059884032 [0;39m <==    Updates: 0
2022-08-26 16:45:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425883059884032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:45:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425903993655296 [0;39m 生成今日电子书快照开始
2022-08-26 16:45:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425903993655296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:45:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425903993655296 [0;39m ==> Parameters: 
2022-08-26 16:45:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425903993655296 [0;39m <==    Updates: 0
2022-08-26 16:45:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425903993655296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:45:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425924948398080 [0;39m 生成今日电子书快照开始
2022-08-26 16:45:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425924948398080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:45:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425924948398080 [0;39m ==> Parameters: 
2022-08-26 16:45:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425924948398080 [0;39m <==    Updates: 0
2022-08-26 16:45:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425924948398080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:45:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425945932500992 [0;39m 生成今日电子书快照开始
2022-08-26 16:45:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425945932500992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:45:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425945932500992 [0;39m ==> Parameters: 
2022-08-26 16:45:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425945932500992 [0;39m <==    Updates: 0
2022-08-26 16:45:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425945932500992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:45:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425966887243776 [0;39m 生成今日电子书快照开始
2022-08-26 16:45:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425966887243776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:45:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425966887243776 [0;39m ==> Parameters: 
2022-08-26 16:45:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425966887243776 [0;39m <==    Updates: 0
2022-08-26 16:45:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425966887243776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:45:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20425987871346688 [0;39m 生成今日电子书快照开始
2022-08-26 16:45:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425987871346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:45:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425987871346688 [0;39m ==> Parameters: 
2022-08-26 16:45:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20425987871346688 [0;39m <==    Updates: 0
2022-08-26 16:45:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20425987871346688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:45:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20425987875540992 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:45:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425987875540992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:45:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425987875540992 [0;39m ==> Parameters: 
2022-08-26 16:45:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20425987875540992 [0;39m <==    Updates: 8
2022-08-26 16:45:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20425987875540992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:45:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426008830283776 [0;39m 生成今日电子书快照开始
2022-08-26 16:45:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426008830283776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:45:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426008830283776 [0;39m ==> Parameters: 
2022-08-26 16:45:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426008830283776 [0;39m <==    Updates: 0
2022-08-26 16:45:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426008830283776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:45:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426029826969600 [0;39m 生成今日电子书快照开始
2022-08-26 16:45:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426029826969600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:45:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426029826969600 [0;39m ==> Parameters: 
2022-08-26 16:45:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426029826969600 [0;39m <==    Updates: 0
2022-08-26 16:45:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426029826969600 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 16:45:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426050790100992 [0;39m 生成今日电子书快照开始
2022-08-26 16:45:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426050790100992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:45:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426050790100992 [0;39m ==> Parameters: 
2022-08-26 16:45:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426050790100992 [0;39m <==    Updates: 0
2022-08-26 16:45:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426050790100992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:45:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426071782592512 [0;39m 生成今日电子书快照开始
2022-08-26 16:45:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426071782592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:45:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426071782592512 [0;39m ==> Parameters: 
2022-08-26 16:45:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426071782592512 [0;39m <==    Updates: 0
2022-08-26 16:45:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426071782592512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:46:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426092749918208 [0;39m 生成今日电子书快照开始
2022-08-26 16:46:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426092749918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:46:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426092749918208 [0;39m ==> Parameters: 
2022-08-26 16:46:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426092749918208 [0;39m <==    Updates: 0
2022-08-26 16:46:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426092749918208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:46:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426113692078080 [0;39m 生成今日电子书快照开始
2022-08-26 16:46:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426113692078080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:46:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426113692078080 [0;39m ==> Parameters: 
2022-08-26 16:46:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426113692078080 [0;39m <==    Updates: 0
2022-08-26 16:46:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426113692078080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:46:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20426113700466688 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:46:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426113700466688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:46:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426113700466688 [0;39m ==> Parameters: 
2022-08-26 16:46:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426113700466688 [0;39m <==    Updates: 8
2022-08-26 16:46:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20426113700466688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:46:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426134684569600 [0;39m 生成今日电子书快照开始
2022-08-26 16:46:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426134684569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:46:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426134684569600 [0;39m ==> Parameters: 
2022-08-26 16:46:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426134684569600 [0;39m <==    Updates: 0
2022-08-26 16:46:10.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426134684569600 [0;39m 生成今日电子书快照结束，耗时：11 毫秒
2022-08-26 16:46:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426155677061120 [0;39m 生成今日电子书快照开始
2022-08-26 16:46:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426155677061120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:46:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426155677061120 [0;39m ==> Parameters: 
2022-08-26 16:46:15.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426155677061120 [0;39m <==    Updates: 0
2022-08-26 16:46:15.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426155677061120 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 16:46:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426176652775424 [0;39m 生成今日电子书快照开始
2022-08-26 16:46:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426176652775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:46:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426176652775424 [0;39m ==> Parameters: 
2022-08-26 16:46:20.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426176652775424 [0;39m <==    Updates: 0
2022-08-26 16:46:20.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426176652775424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 16:46:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426197632684032 [0;39m 生成今日电子书快照开始
2022-08-26 16:46:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426197632684032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:46:25.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426197632684032 [0;39m ==> Parameters: 
2022-08-26 16:46:25.025 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426197632684032 [0;39m <==    Updates: 0
2022-08-26 16:46:25.026 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426197632684032 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 16:46:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426218587426816 [0;39m 生成今日电子书快照开始
2022-08-26 16:46:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426218587426816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:46:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426218587426816 [0;39m ==> Parameters: 
2022-08-26 16:46:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426218587426816 [0;39m <==    Updates: 0
2022-08-26 16:46:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426218587426816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:46:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20426239575724032 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:46:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426239575724032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:46:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426239575724032 [0;39m ==> Parameters: 
2022-08-26 16:46:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426239575724032 [0;39m <==    Updates: 8
2022-08-26 16:46:35.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20426239575724032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:46:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426239584112640 [0;39m 生成今日电子书快照开始
2022-08-26 16:46:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426239584112640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:46:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426239584112640 [0;39m ==> Parameters: 
2022-08-26 16:46:35.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426239584112640 [0;39m <==    Updates: 0
2022-08-26 16:46:35.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426239584112640 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:46:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426260501106688 [0;39m 生成今日电子书快照开始
2022-08-26 16:46:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426260501106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:46:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426260501106688 [0;39m ==> Parameters: 
2022-08-26 16:46:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426260501106688 [0;39m <==    Updates: 0
2022-08-26 16:46:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426260501106688 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 16:46:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426281514569728 [0;39m 生成今日电子书快照开始
2022-08-26 16:46:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426281514569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:46:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426281514569728 [0;39m ==> Parameters: 
2022-08-26 16:46:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426281514569728 [0;39m <==    Updates: 0
2022-08-26 16:46:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426281514569728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:46:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426302452535296 [0;39m 生成今日电子书快照开始
2022-08-26 16:46:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426302452535296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:46:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426302452535296 [0;39m ==> Parameters: 
2022-08-26 16:46:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426302452535296 [0;39m <==    Updates: 0
2022-08-26 16:46:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426302452535296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:46:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426323461804032 [0;39m 生成今日电子书快照开始
2022-08-26 16:46:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426323461804032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:46:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426323461804032 [0;39m ==> Parameters: 
2022-08-26 16:46:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426323461804032 [0;39m <==    Updates: 0
2022-08-26 16:46:55.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426323461804032 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:47:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426344378798080 [0;39m 生成今日电子书快照开始
2022-08-26 16:47:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426344378798080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:47:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426344378798080 [0;39m ==> Parameters: 
2022-08-26 16:47:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426344378798080 [0;39m <==    Updates: 0
2022-08-26 16:47:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426344378798080 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:47:05.000 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20426365337735168 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:47:05.000 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426365337735168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:47:05.000 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426365337735168 [0;39m ==> Parameters: 
2022-08-26 16:47:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426365337735168 [0;39m <==    Updates: 8
2022-08-26 16:47:05.001 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20426365337735168 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:47:05.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426365346123776 [0;39m 生成今日电子书快照开始
2022-08-26 16:47:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426365346123776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:47:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426365346123776 [0;39m ==> Parameters: 
2022-08-26 16:47:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426365346123776 [0;39m <==    Updates: 0
2022-08-26 16:47:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426365346123776 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:47:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426386376364032 [0;39m 生成今日电子书快照开始
2022-08-26 16:47:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426386376364032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:47:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426386376364032 [0;39m ==> Parameters: 
2022-08-26 16:47:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426386376364032 [0;39m <==    Updates: 0
2022-08-26 16:47:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426386376364032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:47:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426407284969472 [0;39m 生成今日电子书快照开始
2022-08-26 16:47:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426407284969472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:47:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426407284969472 [0;39m ==> Parameters: 
2022-08-26 16:47:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426407284969472 [0;39m <==    Updates: 0
2022-08-26 16:47:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426407284969472 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 16:47:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426428294238208 [0;39m 生成今日电子书快照开始
2022-08-26 16:47:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426428294238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:47:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426428294238208 [0;39m ==> Parameters: 
2022-08-26 16:47:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426428294238208 [0;39m <==    Updates: 0
2022-08-26 16:47:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426428294238208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:47:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426449290924032 [0;39m 生成今日电子书快照开始
2022-08-26 16:47:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426449290924032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:47:25.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426449290924032 [0;39m ==> Parameters: 
2022-08-26 16:47:25.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426449290924032 [0;39m <==    Updates: 0
2022-08-26 16:47:25.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426449290924032 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:47:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426470199529472 [0;39m 生成今日电子书快照开始
2022-08-26 16:47:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426470199529472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:47:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426470199529472 [0;39m ==> Parameters: 
2022-08-26 16:47:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426470199529472 [0;39m <==    Updates: 0
2022-08-26 16:47:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426470199529472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:47:35.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20426491175243776 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:47:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426491175243776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:47:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426491175243776 [0;39m ==> Parameters: 
2022-08-26 16:47:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426491175243776 [0;39m <==    Updates: 8
2022-08-26 16:47:35.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20426491175243776 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:47:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426491183632384 [0;39m 生成今日电子书快照开始
2022-08-26 16:47:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426491183632384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:47:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426491183632384 [0;39m ==> Parameters: 
2022-08-26 16:47:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426491183632384 [0;39m <==    Updates: 0
2022-08-26 16:47:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426491183632384 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:47:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426512176123904 [0;39m 生成今日电子书快照开始
2022-08-26 16:47:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426512176123904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:47:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426512176123904 [0;39m ==> Parameters: 
2022-08-26 16:47:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426512176123904 [0;39m <==    Updates: 0
2022-08-26 16:47:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426512176123904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:47:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426533143449600 [0;39m 生成今日电子书快照开始
2022-08-26 16:47:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426533143449600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:47:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426533143449600 [0;39m ==> Parameters: 
2022-08-26 16:47:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426533143449600 [0;39m <==    Updates: 0
2022-08-26 16:47:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426533143449600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:47:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426554098192384 [0;39m 生成今日电子书快照开始
2022-08-26 16:47:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426554098192384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:47:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426554098192384 [0;39m ==> Parameters: 
2022-08-26 16:47:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426554098192384 [0;39m <==    Updates: 0
2022-08-26 16:47:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426554098192384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:47:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426575111655424 [0;39m 生成今日电子书快照开始
2022-08-26 16:47:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426575111655424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:47:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426575111655424 [0;39m ==> Parameters: 
2022-08-26 16:47:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426575111655424 [0;39m <==    Updates: 0
2022-08-26 16:47:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426575111655424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:48:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426596049620992 [0;39m 生成今日电子书快照开始
2022-08-26 16:48:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426596049620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:48:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426596049620992 [0;39m ==> Parameters: 
2022-08-26 16:48:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426596049620992 [0;39m <==    Updates: 0
2022-08-26 16:48:00.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426596049620992 [0;39m 生成今日电子书快照结束，耗时：12 毫秒
2022-08-26 16:48:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20426617025335296 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:48:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426617025335296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:48:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426617025335296 [0;39m ==> Parameters: 
2022-08-26 16:48:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426617025335296 [0;39m <==    Updates: 8
2022-08-26 16:48:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20426617025335296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:48:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426617033723904 [0;39m 生成今日电子书快照开始
2022-08-26 16:48:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426617033723904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:48:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426617033723904 [0;39m ==> Parameters: 
2022-08-26 16:48:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426617033723904 [0;39m <==    Updates: 0
2022-08-26 16:48:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426617033723904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:48:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426637971689472 [0;39m 生成今日电子书快照开始
2022-08-26 16:48:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426637971689472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:48:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426637971689472 [0;39m ==> Parameters: 
2022-08-26 16:48:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426637971689472 [0;39m <==    Updates: 0
2022-08-26 16:48:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426637971689472 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 16:48:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426658955792384 [0;39m 生成今日电子书快照开始
2022-08-26 16:48:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426658955792384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:48:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426658955792384 [0;39m ==> Parameters: 
2022-08-26 16:48:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426658955792384 [0;39m <==    Updates: 0
2022-08-26 16:48:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426658955792384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:48:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426679939895296 [0;39m 生成今日电子书快照开始
2022-08-26 16:48:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426679939895296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:48:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426679939895296 [0;39m ==> Parameters: 
2022-08-26 16:48:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426679939895296 [0;39m <==    Updates: 0
2022-08-26 16:48:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426679939895296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:48:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426700936581120 [0;39m 生成今日电子书快照开始
2022-08-26 16:48:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426700936581120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:48:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426700936581120 [0;39m ==> Parameters: 
2022-08-26 16:48:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426700936581120 [0;39m <==    Updates: 0
2022-08-26 16:48:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426700936581120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:48:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426721920684032 [0;39m 生成今日电子书快照开始
2022-08-26 16:48:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426721920684032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:48:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426721920684032 [0;39m ==> Parameters: 
2022-08-26 16:48:30.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426721920684032 [0;39m <==    Updates: 0
2022-08-26 16:48:30.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426721920684032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:48:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20426742841872384 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:48:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426742841872384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:48:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426742841872384 [0;39m ==> Parameters: 
2022-08-26 16:48:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426742841872384 [0;39m <==    Updates: 8
2022-08-26 16:48:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20426742841872384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:48:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426742850260992 [0;39m 生成今日电子书快照开始
2022-08-26 16:48:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426742850260992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:48:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426742850260992 [0;39m ==> Parameters: 
2022-08-26 16:48:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426742850260992 [0;39m <==    Updates: 0
2022-08-26 16:48:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426742850260992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:48:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426763855335424 [0;39m 生成今日电子书快照开始
2022-08-26 16:48:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426763855335424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:48:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426763855335424 [0;39m ==> Parameters: 
2022-08-26 16:48:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426763855335424 [0;39m <==    Updates: 0
2022-08-26 16:48:40.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426763855335424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:48:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426784814272512 [0;39m 生成今日电子书快照开始
2022-08-26 16:48:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426784814272512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:48:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426784814272512 [0;39m ==> Parameters: 
2022-08-26 16:48:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426784814272512 [0;39m <==    Updates: 0
2022-08-26 16:48:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426784814272512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:48:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426805781598208 [0;39m 生成今日电子书快照开始
2022-08-26 16:48:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426805781598208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:48:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426805781598208 [0;39m ==> Parameters: 
2022-08-26 16:48:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426805781598208 [0;39m <==    Updates: 0
2022-08-26 16:48:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426805781598208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:48:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426826753118208 [0;39m 生成今日电子书快照开始
2022-08-26 16:48:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426826753118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:48:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426826753118208 [0;39m ==> Parameters: 
2022-08-26 16:48:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426826753118208 [0;39m <==    Updates: 0
2022-08-26 16:48:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426826753118208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:49:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426847691083776 [0;39m 生成今日电子书快照开始
2022-08-26 16:49:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426847691083776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:49:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426847691083776 [0;39m ==> Parameters: 
2022-08-26 16:49:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426847691083776 [0;39m <==    Updates: 0
2022-08-26 16:49:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426847691083776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:49:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426868687769600 [0;39m 生成今日电子书快照开始
2022-08-26 16:49:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426868687769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:49:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426868687769600 [0;39m ==> Parameters: 
2022-08-26 16:49:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426868687769600 [0;39m <==    Updates: 0
2022-08-26 16:49:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426868687769600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:49:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20426868696158208 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:49:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426868696158208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:49:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426868696158208 [0;39m ==> Parameters: 
2022-08-26 16:49:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426868696158208 [0;39m <==    Updates: 8
2022-08-26 16:49:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20426868696158208 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:49:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426889634123776 [0;39m 生成今日电子书快照开始
2022-08-26 16:49:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426889634123776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:49:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426889634123776 [0;39m ==> Parameters: 
2022-08-26 16:49:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426889634123776 [0;39m <==    Updates: 0
2022-08-26 16:49:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426889634123776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:49:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426910614032384 [0;39m 生成今日电子书快照开始
2022-08-26 16:49:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426910614032384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:49:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426910614032384 [0;39m ==> Parameters: 
2022-08-26 16:49:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426910614032384 [0;39m <==    Updates: 0
2022-08-26 16:49:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426910614032384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:49:20.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426931568775168 [0;39m 生成今日电子书快照开始
2022-08-26 16:49:20.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426931568775168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:49:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426931568775168 [0;39m ==> Parameters: 
2022-08-26 16:49:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426931568775168 [0;39m <==    Updates: 0
2022-08-26 16:49:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426931568775168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:49:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426952586432512 [0;39m 生成今日电子书快照开始
2022-08-26 16:49:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426952586432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:49:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426952586432512 [0;39m ==> Parameters: 
2022-08-26 16:49:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426952586432512 [0;39m <==    Updates: 0
2022-08-26 16:49:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426952586432512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:49:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426973536980992 [0;39m 生成今日电子书快照开始
2022-08-26 16:49:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426973536980992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:49:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426973536980992 [0;39m ==> Parameters: 
2022-08-26 16:49:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426973536980992 [0;39m <==    Updates: 0
2022-08-26 16:49:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426973536980992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:49:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20426994491723776 [0;39m 生成今日电子书快照开始
2022-08-26 16:49:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426994491723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:49:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426994491723776 [0;39m ==> Parameters: 
2022-08-26 16:49:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20426994491723776 [0;39m <==    Updates: 0
2022-08-26 16:49:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20426994491723776 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:49:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20426994495918080 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:49:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426994495918080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:49:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426994495918080 [0;39m ==> Parameters: 
2022-08-26 16:49:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20426994495918080 [0;39m <==    Updates: 8
2022-08-26 16:49:35.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20426994495918080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:49:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427015492603904 [0;39m 生成今日电子书快照开始
2022-08-26 16:49:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427015492603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:49:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427015492603904 [0;39m ==> Parameters: 
2022-08-26 16:49:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427015492603904 [0;39m <==    Updates: 0
2022-08-26 16:49:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427015492603904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:49:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427036438958080 [0;39m 生成今日电子书快照开始
2022-08-26 16:49:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427036438958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:49:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427036438958080 [0;39m ==> Parameters: 
2022-08-26 16:49:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427036438958080 [0;39m <==    Updates: 0
2022-08-26 16:49:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427036438958080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:49:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427057431449600 [0;39m 生成今日电子书快照开始
2022-08-26 16:49:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427057431449600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:49:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427057431449600 [0;39m ==> Parameters: 
2022-08-26 16:49:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427057431449600 [0;39m <==    Updates: 0
2022-08-26 16:49:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427057431449600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:49:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427078411358208 [0;39m 生成今日电子书快照开始
2022-08-26 16:49:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427078411358208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:49:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427078411358208 [0;39m ==> Parameters: 
2022-08-26 16:49:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427078411358208 [0;39m <==    Updates: 0
2022-08-26 16:49:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427078411358208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:50:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427099370295296 [0;39m 生成今日电子书快照开始
2022-08-26 16:50:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427099370295296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:50:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427099370295296 [0;39m ==> Parameters: 
2022-08-26 16:50:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427099370295296 [0;39m <==    Updates: 0
2022-08-26 16:50:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427099370295296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:50:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427120325038080 [0;39m 生成今日电子书快照开始
2022-08-26 16:50:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427120325038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:50:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427120325038080 [0;39m ==> Parameters: 
2022-08-26 16:50:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427120325038080 [0;39m <==    Updates: 0
2022-08-26 16:50:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427120325038080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:50:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20427120337620992 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:50:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427120337620992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:50:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427120337620992 [0;39m ==> Parameters: 
2022-08-26 16:50:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427120337620992 [0;39m <==    Updates: 8
2022-08-26 16:50:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20427120337620992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:50:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427141304946688 [0;39m 生成今日电子书快照开始
2022-08-26 16:50:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427141304946688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:50:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427141304946688 [0;39m ==> Parameters: 
2022-08-26 16:50:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427141304946688 [0;39m <==    Updates: 0
2022-08-26 16:50:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427141304946688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:50:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427162272272384 [0;39m 生成今日电子书快照开始
2022-08-26 16:50:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427162272272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:50:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427162272272384 [0;39m ==> Parameters: 
2022-08-26 16:50:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427162272272384 [0;39m <==    Updates: 0
2022-08-26 16:50:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427162272272384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:50:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427183231209472 [0;39m 生成今日电子书快照开始
2022-08-26 16:50:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427183231209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:50:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427183231209472 [0;39m ==> Parameters: 
2022-08-26 16:50:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427183231209472 [0;39m <==    Updates: 0
2022-08-26 16:50:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427183231209472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:50:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427204236283904 [0;39m 生成今日电子书快照开始
2022-08-26 16:50:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427204236283904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:50:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427204236283904 [0;39m ==> Parameters: 
2022-08-26 16:50:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427204236283904 [0;39m <==    Updates: 0
2022-08-26 16:50:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427204236283904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:50:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427225220386816 [0;39m 生成今日电子书快照开始
2022-08-26 16:50:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427225220386816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:50:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427225220386816 [0;39m ==> Parameters: 
2022-08-26 16:50:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427225220386816 [0;39m <==    Updates: 0
2022-08-26 16:50:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427225220386816 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 16:50:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20427246183518208 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:50:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427246183518208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:50:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427246183518208 [0;39m ==> Parameters: 
2022-08-26 16:50:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427246183518208 [0;39m <==    Updates: 8
2022-08-26 16:50:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20427246183518208 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:50:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427246191906816 [0;39m 生成今日电子书快照开始
2022-08-26 16:50:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427246191906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:50:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427246191906816 [0;39m ==> Parameters: 
2022-08-26 16:50:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427246191906816 [0;39m <==    Updates: 0
2022-08-26 16:50:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427246191906816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:50:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427267150843904 [0;39m 生成今日电子书快照开始
2022-08-26 16:50:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427267150843904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:50:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427267150843904 [0;39m ==> Parameters: 
2022-08-26 16:50:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427267150843904 [0;39m <==    Updates: 0
2022-08-26 16:50:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427267150843904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:50:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427288097198080 [0;39m 生成今日电子书快照开始
2022-08-26 16:50:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427288097198080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:50:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427288097198080 [0;39m ==> Parameters: 
2022-08-26 16:50:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427288097198080 [0;39m <==    Updates: 0
2022-08-26 16:50:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427288097198080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:50:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427309093883904 [0;39m 生成今日电子书快照开始
2022-08-26 16:50:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427309093883904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:50:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427309093883904 [0;39m ==> Parameters: 
2022-08-26 16:50:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427309093883904 [0;39m <==    Updates: 0
2022-08-26 16:50:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427309093883904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:50:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427330090569728 [0;39m 生成今日电子书快照开始
2022-08-26 16:50:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427330090569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:50:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427330090569728 [0;39m ==> Parameters: 
2022-08-26 16:50:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427330090569728 [0;39m <==    Updates: 0
2022-08-26 16:50:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427330090569728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:51:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427351020146688 [0;39m 生成今日电子书快照开始
2022-08-26 16:51:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427351020146688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:51:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427351020146688 [0;39m ==> Parameters: 
2022-08-26 16:51:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427351020146688 [0;39m <==    Updates: 0
2022-08-26 16:51:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427351020146688 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 16:51:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20427372016832512 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:51:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427372016832512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:51:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427372016832512 [0;39m ==> Parameters: 
2022-08-26 16:51:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427372016832512 [0;39m <==    Updates: 8
2022-08-26 16:51:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20427372016832512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:51:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427372025221120 [0;39m 生成今日电子书快照开始
2022-08-26 16:51:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427372025221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:51:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427372025221120 [0;39m ==> Parameters: 
2022-08-26 16:51:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427372025221120 [0;39m <==    Updates: 0
2022-08-26 16:51:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427372025221120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:51:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427393000935424 [0;39m 生成今日电子书快照开始
2022-08-26 16:51:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427393000935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:51:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427393000935424 [0;39m ==> Parameters: 
2022-08-26 16:51:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427393000935424 [0;39m <==    Updates: 0
2022-08-26 16:51:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427393000935424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:51:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427413930512384 [0;39m 生成今日电子书快照开始
2022-08-26 16:51:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427413930512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:51:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427413930512384 [0;39m ==> Parameters: 
2022-08-26 16:51:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427413930512384 [0;39m <==    Updates: 0
2022-08-26 16:51:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427413930512384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:51:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427434906226688 [0;39m 生成今日电子书快照开始
2022-08-26 16:51:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427434906226688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:51:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427434906226688 [0;39m ==> Parameters: 
2022-08-26 16:51:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427434906226688 [0;39m <==    Updates: 0
2022-08-26 16:51:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427434906226688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:51:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427455923884032 [0;39m 生成今日电子书快照开始
2022-08-26 16:51:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427455923884032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:51:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427455923884032 [0;39m ==> Parameters: 
2022-08-26 16:51:25.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427455923884032 [0;39m <==    Updates: 0
2022-08-26 16:51:25.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427455923884032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:51:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427476882821120 [0;39m 生成今日电子书快照开始
2022-08-26 16:51:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427476882821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:51:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427476882821120 [0;39m ==> Parameters: 
2022-08-26 16:51:30.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427476882821120 [0;39m <==    Updates: 0
2022-08-26 16:51:30.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427476882821120 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:51:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20427497858535424 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:51:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427497858535424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:51:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427497858535424 [0;39m ==> Parameters: 
2022-08-26 16:51:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427497858535424 [0;39m <==    Updates: 8
2022-08-26 16:51:35.020 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20427497858535424 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 16:51:35.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427497887895552 [0;39m 生成今日电子书快照开始
2022-08-26 16:51:35.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427497887895552 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:51:35.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427497887895552 [0;39m ==> Parameters: 
2022-08-26 16:51:35.027 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427497887895552 [0;39m <==    Updates: 0
2022-08-26 16:51:35.028 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427497887895552 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 16:51:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427518800695296 [0;39m 生成今日电子书快照开始
2022-08-26 16:51:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427518800695296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:51:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427518800695296 [0;39m ==> Parameters: 
2022-08-26 16:51:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427518800695296 [0;39m <==    Updates: 0
2022-08-26 16:51:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427518800695296 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:51:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427539759632384 [0;39m 生成今日电子书快照开始
2022-08-26 16:51:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427539759632384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:51:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427539759632384 [0;39m ==> Parameters: 
2022-08-26 16:51:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427539759632384 [0;39m <==    Updates: 0
2022-08-26 16:51:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427539759632384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:51:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427560773095424 [0;39m 生成今日电子书快照开始
2022-08-26 16:51:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427560773095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:51:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427560773095424 [0;39m ==> Parameters: 
2022-08-26 16:51:50.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427560773095424 [0;39m <==    Updates: 0
2022-08-26 16:51:50.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427560773095424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 16:51:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427581723643904 [0;39m 生成今日电子书快照开始
2022-08-26 16:51:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427581723643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:51:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427581723643904 [0;39m ==> Parameters: 
2022-08-26 16:51:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427581723643904 [0;39m <==    Updates: 0
2022-08-26 16:51:55.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427581723643904 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 16:52:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427602682580992 [0;39m 生成今日电子书快照开始
2022-08-26 16:52:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427602682580992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:52:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427602682580992 [0;39m ==> Parameters: 
2022-08-26 16:52:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427602682580992 [0;39m <==    Updates: 0
2022-08-26 16:52:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427602682580992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:52:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20427623666683904 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:52:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427623666683904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:52:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427623666683904 [0;39m ==> Parameters: 
2022-08-26 16:52:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427623666683904 [0;39m <==    Updates: 8
2022-08-26 16:52:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20427623666683904 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 16:52:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427623691849728 [0;39m 生成今日电子书快照开始
2022-08-26 16:52:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427623691849728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:52:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427623691849728 [0;39m ==> Parameters: 
2022-08-26 16:52:05.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427623691849728 [0;39m <==    Updates: 0
2022-08-26 16:52:05.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427623691849728 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 16:52:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427644629815296 [0;39m 生成今日电子书快照开始
2022-08-26 16:52:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427644629815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:52:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427644629815296 [0;39m ==> Parameters: 
2022-08-26 16:52:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427644629815296 [0;39m <==    Updates: 0
2022-08-26 16:52:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427644629815296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:52:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427665601335296 [0;39m 生成今日电子书快照开始
2022-08-26 16:52:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427665601335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:52:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427665601335296 [0;39m ==> Parameters: 
2022-08-26 16:52:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427665601335296 [0;39m <==    Updates: 0
2022-08-26 16:52:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427665601335296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:52:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427686598021120 [0;39m 生成今日电子书快照开始
2022-08-26 16:52:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427686598021120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:52:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427686598021120 [0;39m ==> Parameters: 
2022-08-26 16:52:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427686598021120 [0;39m <==    Updates: 0
2022-08-26 16:52:20.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427686598021120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:52:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427707523403776 [0;39m 生成今日电子书快照开始
2022-08-26 16:52:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427707523403776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:52:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427707523403776 [0;39m ==> Parameters: 
2022-08-26 16:52:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427707523403776 [0;39m <==    Updates: 0
2022-08-26 16:52:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427707523403776 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:52:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427728499118080 [0;39m 生成今日电子书快照开始
2022-08-26 16:52:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427728499118080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:52:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427728499118080 [0;39m ==> Parameters: 
2022-08-26 16:52:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427728499118080 [0;39m <==    Updates: 0
2022-08-26 16:52:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427728499118080 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 16:52:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20427749470638080 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:52:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427749470638080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:52:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427749470638080 [0;39m ==> Parameters: 
2022-08-26 16:52:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427749470638080 [0;39m <==    Updates: 8
2022-08-26 16:52:35.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20427749470638080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:52:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427749474832384 [0;39m 生成今日电子书快照开始
2022-08-26 16:52:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427749474832384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:52:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427749474832384 [0;39m ==> Parameters: 
2022-08-26 16:52:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427749474832384 [0;39m <==    Updates: 0
2022-08-26 16:52:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427749474832384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:52:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427770450546688 [0;39m 生成今日电子书快照开始
2022-08-26 16:52:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427770450546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:52:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427770450546688 [0;39m ==> Parameters: 
2022-08-26 16:52:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427770450546688 [0;39m <==    Updates: 0
2022-08-26 16:52:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427770450546688 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:52:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427791443038208 [0;39m 生成今日电子书快照开始
2022-08-26 16:52:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427791443038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:52:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427791443038208 [0;39m ==> Parameters: 
2022-08-26 16:52:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427791443038208 [0;39m <==    Updates: 0
2022-08-26 16:52:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427791443038208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:52:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427812431335424 [0;39m 生成今日电子书快照开始
2022-08-26 16:52:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427812431335424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:52:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427812431335424 [0;39m ==> Parameters: 
2022-08-26 16:52:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427812431335424 [0;39m <==    Updates: 0
2022-08-26 16:52:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427812431335424 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:52:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427833407049728 [0;39m 生成今日电子书快照开始
2022-08-26 16:52:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427833407049728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:52:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427833407049728 [0;39m ==> Parameters: 
2022-08-26 16:52:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427833407049728 [0;39m <==    Updates: 0
2022-08-26 16:52:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427833407049728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:53:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427854353403904 [0;39m 生成今日电子书快照开始
2022-08-26 16:53:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427854353403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:53:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427854353403904 [0;39m ==> Parameters: 
2022-08-26 16:53:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427854353403904 [0;39m <==    Updates: 0
2022-08-26 16:53:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427854353403904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:53:05.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427875295563776 [0;39m 生成今日电子书快照开始
2022-08-26 16:53:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427875295563776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:53:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427875295563776 [0;39m ==> Parameters: 
2022-08-26 16:53:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427875295563776 [0;39m <==    Updates: 0
2022-08-26 16:53:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427875295563776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 16:53:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20427875329118208 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:53:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427875329118208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:53:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427875329118208 [0;39m ==> Parameters: 
2022-08-26 16:53:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20427875329118208 [0;39m <==    Updates: 8
2022-08-26 16:53:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20427875329118208 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 16:53:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427896288055296 [0;39m 生成今日电子书快照开始
2022-08-26 16:53:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427896288055296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:53:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427896288055296 [0;39m ==> Parameters: 
2022-08-26 16:53:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427896288055296 [0;39m <==    Updates: 0
2022-08-26 16:53:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427896288055296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:53:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427917272158208 [0;39m 生成今日电子书快照开始
2022-08-26 16:53:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427917272158208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:53:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427917272158208 [0;39m ==> Parameters: 
2022-08-26 16:53:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427917272158208 [0;39m <==    Updates: 0
2022-08-26 16:53:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427917272158208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:53:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427938235289600 [0;39m 生成今日电子书快照开始
2022-08-26 16:53:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427938235289600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:53:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427938235289600 [0;39m ==> Parameters: 
2022-08-26 16:53:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427938235289600 [0;39m <==    Updates: 0
2022-08-26 16:53:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427938235289600 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:53:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427959177449472 [0;39m 生成今日电子书快照开始
2022-08-26 16:53:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427959177449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:53:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427959177449472 [0;39m ==> Parameters: 
2022-08-26 16:53:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427959177449472 [0;39m <==    Updates: 0
2022-08-26 16:53:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427959177449472 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:53:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20427980186718208 [0;39m 生成今日电子书快照开始
2022-08-26 16:53:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427980186718208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:53:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427980186718208 [0;39m ==> Parameters: 
2022-08-26 16:53:30.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20427980186718208 [0;39m <==    Updates: 0
2022-08-26 16:53:30.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20427980186718208 [0;39m 生成今日电子书快照结束，耗时：12 毫秒
2022-08-26 16:53:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20428001162432512 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:53:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428001162432512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:53:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428001162432512 [0;39m ==> Parameters: 
2022-08-26 16:53:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428001162432512 [0;39m <==    Updates: 8
2022-08-26 16:53:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20428001162432512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:53:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428001170821120 [0;39m 生成今日电子书快照开始
2022-08-26 16:53:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428001170821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:53:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428001170821120 [0;39m ==> Parameters: 
2022-08-26 16:53:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428001170821120 [0;39m <==    Updates: 0
2022-08-26 16:53:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428001170821120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:53:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428022146535424 [0;39m 生成今日电子书快照开始
2022-08-26 16:53:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428022146535424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:53:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428022146535424 [0;39m ==> Parameters: 
2022-08-26 16:53:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428022146535424 [0;39m <==    Updates: 0
2022-08-26 16:53:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428022146535424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:53:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428043084500992 [0;39m 生成今日电子书快照开始
2022-08-26 16:53:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428043084500992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:53:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428043084500992 [0;39m ==> Parameters: 
2022-08-26 16:53:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428043084500992 [0;39m <==    Updates: 0
2022-08-26 16:53:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428043084500992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:53:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428064039243776 [0;39m 生成今日电子书快照开始
2022-08-26 16:53:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428064039243776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:53:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428064039243776 [0;39m ==> Parameters: 
2022-08-26 16:53:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428064039243776 [0;39m <==    Updates: 0
2022-08-26 16:53:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428064039243776 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 16:53:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428085031735296 [0;39m 生成今日电子书快照开始
2022-08-26 16:53:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428085031735296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:53:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428085031735296 [0;39m ==> Parameters: 
2022-08-26 16:53:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428085031735296 [0;39m <==    Updates: 0
2022-08-26 16:53:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428085031735296 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:54:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428106028421120 [0;39m 生成今日电子书快照开始
2022-08-26 16:54:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428106028421120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:54:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428106028421120 [0;39m ==> Parameters: 
2022-08-26 16:54:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428106028421120 [0;39m <==    Updates: 0
2022-08-26 16:54:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428106028421120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:54:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20428126970580992 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:54:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428126970580992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:54:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428126970580992 [0;39m ==> Parameters: 
2022-08-26 16:54:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428126970580992 [0;39m <==    Updates: 8
2022-08-26 16:54:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20428126970580992 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-26 16:54:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428126995746816 [0;39m 生成今日电子书快照开始
2022-08-26 16:54:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428126995746816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:54:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428126995746816 [0;39m ==> Parameters: 
2022-08-26 16:54:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428126995746816 [0;39m <==    Updates: 0
2022-08-26 16:54:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428126995746816 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 16:54:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428147958878208 [0;39m 生成今日电子书快照开始
2022-08-26 16:54:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428147958878208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:54:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428147958878208 [0;39m ==> Parameters: 
2022-08-26 16:54:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428147958878208 [0;39m <==    Updates: 0
2022-08-26 16:54:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428147958878208 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 16:54:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428168917815296 [0;39m 生成今日电子书快照开始
2022-08-26 16:54:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428168917815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:54:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428168917815296 [0;39m ==> Parameters: 
2022-08-26 16:54:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428168917815296 [0;39m <==    Updates: 0
2022-08-26 16:54:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428168917815296 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:54:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428189906112512 [0;39m 生成今日电子书快照开始
2022-08-26 16:54:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428189906112512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:54:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428189906112512 [0;39m ==> Parameters: 
2022-08-26 16:54:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428189906112512 [0;39m <==    Updates: 0
2022-08-26 16:54:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428189906112512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:54:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428210877632512 [0;39m 生成今日电子书快照开始
2022-08-26 16:54:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428210877632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:54:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428210877632512 [0;39m ==> Parameters: 
2022-08-26 16:54:25.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428210877632512 [0;39m <==    Updates: 0
2022-08-26 16:54:25.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428210877632512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 16:54:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428231853346816 [0;39m 生成今日电子书快照开始
2022-08-26 16:54:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428231853346816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:54:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428231853346816 [0;39m ==> Parameters: 
2022-08-26 16:54:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428231853346816 [0;39m <==    Updates: 0
2022-08-26 16:54:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428231853346816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:54:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428252808089600 [0;39m 生成今日电子书快照开始
2022-08-26 16:54:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428252808089600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:54:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428252808089600 [0;39m ==> Parameters: 
2022-08-26 16:54:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428252808089600 [0;39m <==    Updates: 0
2022-08-26 16:54:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428252808089600 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 16:54:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20428252850032640 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:54:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428252850032640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:54:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428252850032640 [0;39m ==> Parameters: 
2022-08-26 16:54:35.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428252850032640 [0;39m <==    Updates: 8
2022-08-26 16:54:35.021 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20428252850032640 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 16:54:40.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428273746055168 [0;39m 生成今日电子书快照开始
2022-08-26 16:54:40.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428273746055168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:54:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428273746055168 [0;39m ==> Parameters: 
2022-08-26 16:54:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428273746055168 [0;39m <==    Updates: 0
2022-08-26 16:54:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428273746055168 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:54:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428294738546688 [0;39m 生成今日电子书快照开始
2022-08-26 16:54:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428294738546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:54:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428294738546688 [0;39m ==> Parameters: 
2022-08-26 16:54:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428294738546688 [0;39m <==    Updates: 0
2022-08-26 16:54:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428294738546688 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 16:54:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428315710066688 [0;39m 生成今日电子书快照开始
2022-08-26 16:54:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428315710066688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:54:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428315710066688 [0;39m ==> Parameters: 
2022-08-26 16:54:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428315710066688 [0;39m <==    Updates: 0
2022-08-26 16:54:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428315710066688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:54:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428336685780992 [0;39m 生成今日电子书快照开始
2022-08-26 16:54:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428336685780992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:54:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428336685780992 [0;39m ==> Parameters: 
2022-08-26 16:54:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428336685780992 [0;39m <==    Updates: 0
2022-08-26 16:54:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428336685780992 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 16:55:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428357648912384 [0;39m 生成今日电子书快照开始
2022-08-26 16:55:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428357648912384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:55:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428357648912384 [0;39m ==> Parameters: 
2022-08-26 16:55:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428357648912384 [0;39m <==    Updates: 0
2022-08-26 16:55:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428357648912384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:55:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20428378645598208 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:55:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428378645598208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:55:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428378645598208 [0;39m ==> Parameters: 
2022-08-26 16:55:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428378645598208 [0;39m <==    Updates: 8
2022-08-26 16:55:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20428378645598208 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:55:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428378653986816 [0;39m 生成今日电子书快照开始
2022-08-26 16:55:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428378653986816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:55:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428378653986816 [0;39m ==> Parameters: 
2022-08-26 16:55:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428378653986816 [0;39m <==    Updates: 0
2022-08-26 16:55:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428378653986816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:55:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428399642284032 [0;39m 生成今日电子书快照开始
2022-08-26 16:55:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428399642284032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:55:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428399642284032 [0;39m ==> Parameters: 
2022-08-26 16:55:10.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428399642284032 [0;39m <==    Updates: 0
2022-08-26 16:55:10.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428399642284032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:55:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428420555083776 [0;39m 生成今日电子书快照开始
2022-08-26 16:55:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428420555083776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:55:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428420555083776 [0;39m ==> Parameters: 
2022-08-26 16:55:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428420555083776 [0;39m <==    Updates: 0
2022-08-26 16:55:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428420555083776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:55:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428441534992384 [0;39m 生成今日电子书快照开始
2022-08-26 16:55:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428441534992384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:55:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428441534992384 [0;39m ==> Parameters: 
2022-08-26 16:55:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428441534992384 [0;39m <==    Updates: 0
2022-08-26 16:55:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428441534992384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:55:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428462519095296 [0;39m 生成今日电子书快照开始
2022-08-26 16:55:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428462519095296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:55:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428462519095296 [0;39m ==> Parameters: 
2022-08-26 16:55:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428462519095296 [0;39m <==    Updates: 0
2022-08-26 16:55:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428462519095296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:55:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428483486420992 [0;39m 生成今日电子书快照开始
2022-08-26 16:55:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428483486420992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:55:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428483486420992 [0;39m ==> Parameters: 
2022-08-26 16:55:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428483486420992 [0;39m <==    Updates: 0
2022-08-26 16:55:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428483486420992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:55:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20428504449552384 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:55:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428504449552384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:55:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428504449552384 [0;39m ==> Parameters: 
2022-08-26 16:55:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428504449552384 [0;39m <==    Updates: 8
2022-08-26 16:55:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20428504449552384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:55:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428504457940992 [0;39m 生成今日电子书快照开始
2022-08-26 16:55:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428504457940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:55:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428504457940992 [0;39m ==> Parameters: 
2022-08-26 16:55:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428504457940992 [0;39m <==    Updates: 0
2022-08-26 16:55:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428504457940992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:55:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428525429460992 [0;39m 生成今日电子书快照开始
2022-08-26 16:55:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428525429460992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:55:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428525429460992 [0;39m ==> Parameters: 
2022-08-26 16:55:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428525429460992 [0;39m <==    Updates: 0
2022-08-26 16:55:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428525429460992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:55:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428546380009472 [0;39m 生成今日电子书快照开始
2022-08-26 16:55:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428546380009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:55:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428546380009472 [0;39m ==> Parameters: 
2022-08-26 16:55:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428546380009472 [0;39m <==    Updates: 0
2022-08-26 16:55:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428546380009472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:55:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428567414444032 [0;39m 生成今日电子书快照开始
2022-08-26 16:55:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428567414444032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:55:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428567414444032 [0;39m ==> Parameters: 
2022-08-26 16:55:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428567414444032 [0;39m <==    Updates: 0
2022-08-26 16:55:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428567414444032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:55:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428588364992512 [0;39m 生成今日电子书快照开始
2022-08-26 16:55:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428588364992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:55:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428588364992512 [0;39m ==> Parameters: 
2022-08-26 16:55:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428588364992512 [0;39m <==    Updates: 0
2022-08-26 16:55:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428588364992512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:56:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428609294569472 [0;39m 生成今日电子书快照开始
2022-08-26 16:56:00.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428609294569472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:56:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428609294569472 [0;39m ==> Parameters: 
2022-08-26 16:56:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428609294569472 [0;39m <==    Updates: 0
2022-08-26 16:56:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428609294569472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:56:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428630303838208 [0;39m 生成今日电子书快照开始
2022-08-26 16:56:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428630303838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:56:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428630303838208 [0;39m ==> Parameters: 
2022-08-26 16:56:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428630303838208 [0;39m <==    Updates: 0
2022-08-26 16:56:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428630303838208 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:56:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20428630308032512 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:56:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428630308032512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:56:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428630308032512 [0;39m ==> Parameters: 
2022-08-26 16:56:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428630308032512 [0;39m <==    Updates: 8
2022-08-26 16:56:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20428630308032512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:56:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428651296329728 [0;39m 生成今日电子书快照开始
2022-08-26 16:56:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428651296329728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:56:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428651296329728 [0;39m ==> Parameters: 
2022-08-26 16:56:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428651296329728 [0;39m <==    Updates: 0
2022-08-26 16:56:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428651296329728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:56:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428672234295296 [0;39m 生成今日电子书快照开始
2022-08-26 16:56:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428672234295296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:56:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428672234295296 [0;39m ==> Parameters: 
2022-08-26 16:56:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428672234295296 [0;39m <==    Updates: 0
2022-08-26 16:56:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428672234295296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:56:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428693214203904 [0;39m 生成今日电子书快照开始
2022-08-26 16:56:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428693214203904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:56:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428693214203904 [0;39m ==> Parameters: 
2022-08-26 16:56:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428693214203904 [0;39m <==    Updates: 0
2022-08-26 16:56:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428693214203904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:56:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428714152169472 [0;39m 生成今日电子书快照开始
2022-08-26 16:56:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428714152169472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:56:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428714152169472 [0;39m ==> Parameters: 
2022-08-26 16:56:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428714152169472 [0;39m <==    Updates: 0
2022-08-26 16:56:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428714152169472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:56:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428735148855296 [0;39m 生成今日电子书快照开始
2022-08-26 16:56:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428735148855296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:56:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428735148855296 [0;39m ==> Parameters: 
2022-08-26 16:56:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428735148855296 [0;39m <==    Updates: 0
2022-08-26 16:56:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428735148855296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:56:35.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428756095209472 [0;39m 生成今日电子书快照开始
2022-08-26 16:56:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428756095209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:56:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428756095209472 [0;39m ==> Parameters: 
2022-08-26 16:56:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428756095209472 [0;39m <==    Updates: 0
2022-08-26 16:56:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428756095209472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:56:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20428756103598080 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:56:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428756103598080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:56:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428756103598080 [0;39m ==> Parameters: 
2022-08-26 16:56:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428756103598080 [0;39m <==    Updates: 8
2022-08-26 16:56:35.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20428756103598080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:56:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428777125449728 [0;39m 生成今日电子书快照开始
2022-08-26 16:56:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428777125449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:56:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428777125449728 [0;39m ==> Parameters: 
2022-08-26 16:56:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428777125449728 [0;39m <==    Updates: 0
2022-08-26 16:56:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428777125449728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:56:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428798101164032 [0;39m 生成今日电子书快照开始
2022-08-26 16:56:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428798101164032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:56:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428798101164032 [0;39m ==> Parameters: 
2022-08-26 16:56:45.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428798101164032 [0;39m <==    Updates: 0
2022-08-26 16:56:45.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428798101164032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:56:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428819026546688 [0;39m 生成今日电子书快照开始
2022-08-26 16:56:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428819026546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:56:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428819026546688 [0;39m ==> Parameters: 
2022-08-26 16:56:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428819026546688 [0;39m <==    Updates: 0
2022-08-26 16:56:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428819026546688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:56:55.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428839981289472 [0;39m 生成今日电子书快照开始
2022-08-26 16:56:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428839981289472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:56:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428839981289472 [0;39m ==> Parameters: 
2022-08-26 16:56:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428839981289472 [0;39m <==    Updates: 0
2022-08-26 16:56:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428839981289472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:57:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428860982169600 [0;39m 生成今日电子书快照开始
2022-08-26 16:57:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428860982169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:57:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428860982169600 [0;39m ==> Parameters: 
2022-08-26 16:57:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428860982169600 [0;39m <==    Updates: 0
2022-08-26 16:57:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428860982169600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:57:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428881978855424 [0;39m 生成今日电子书快照开始
2022-08-26 16:57:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428881978855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:57:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428881978855424 [0;39m ==> Parameters: 
2022-08-26 16:57:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428881978855424 [0;39m <==    Updates: 0
2022-08-26 16:57:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428881978855424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:57:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20428881987244032 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:57:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428881987244032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:57:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428881987244032 [0;39m ==> Parameters: 
2022-08-26 16:57:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20428881987244032 [0;39m <==    Updates: 8
2022-08-26 16:57:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20428881987244032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:57:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428902946181120 [0;39m 生成今日电子书快照开始
2022-08-26 16:57:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428902946181120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:57:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428902946181120 [0;39m ==> Parameters: 
2022-08-26 16:57:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428902946181120 [0;39m <==    Updates: 0
2022-08-26 16:57:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428902946181120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:57:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428923913506816 [0;39m 生成今日电子书快照开始
2022-08-26 16:57:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428923913506816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:57:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428923913506816 [0;39m ==> Parameters: 
2022-08-26 16:57:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428923913506816 [0;39m <==    Updates: 0
2022-08-26 16:57:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428923913506816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:57:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428944855666688 [0;39m 生成今日电子书快照开始
2022-08-26 16:57:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428944855666688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:57:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428944855666688 [0;39m ==> Parameters: 
2022-08-26 16:57:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428944855666688 [0;39m <==    Updates: 0
2022-08-26 16:57:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428944855666688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 16:57:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428965839769600 [0;39m 生成今日电子书快照开始
2022-08-26 16:57:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428965839769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:57:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428965839769600 [0;39m ==> Parameters: 
2022-08-26 16:57:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428965839769600 [0;39m <==    Updates: 0
2022-08-26 16:57:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428965839769600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:57:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20428986844844032 [0;39m 生成今日电子书快照开始
2022-08-26 16:57:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428986844844032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:57:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428986844844032 [0;39m ==> Parameters: 
2022-08-26 16:57:30.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20428986844844032 [0;39m <==    Updates: 0
2022-08-26 16:57:30.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20428986844844032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:57:35.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20429007753449472 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:57:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429007753449472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:57:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429007753449472 [0;39m ==> Parameters: 
2022-08-26 16:57:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429007753449472 [0;39m <==    Updates: 8
2022-08-26 16:57:35.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20429007753449472 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 16:57:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429007761838080 [0;39m 生成今日电子书快照开始
2022-08-26 16:57:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429007761838080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:57:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429007761838080 [0;39m ==> Parameters: 
2022-08-26 16:57:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429007761838080 [0;39m <==    Updates: 0
2022-08-26 16:57:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429007761838080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:57:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429028729163776 [0;39m 生成今日电子书快照开始
2022-08-26 16:57:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429028729163776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:57:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429028729163776 [0;39m ==> Parameters: 
2022-08-26 16:57:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429028729163776 [0;39m <==    Updates: 0
2022-08-26 16:57:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429028729163776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:57:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429049755209728 [0;39m 生成今日电子书快照开始
2022-08-26 16:57:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429049755209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:57:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429049755209728 [0;39m ==> Parameters: 
2022-08-26 16:57:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429049755209728 [0;39m <==    Updates: 0
2022-08-26 16:57:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429049755209728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:57:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429070718341120 [0;39m 生成今日电子书快照开始
2022-08-26 16:57:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429070718341120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:57:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429070718341120 [0;39m ==> Parameters: 
2022-08-26 16:57:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429070718341120 [0;39m <==    Updates: 0
2022-08-26 16:57:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429070718341120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:57:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429091643723776 [0;39m 生成今日电子书快照开始
2022-08-26 16:57:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429091643723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:57:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429091643723776 [0;39m ==> Parameters: 
2022-08-26 16:57:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429091643723776 [0;39m <==    Updates: 0
2022-08-26 16:57:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429091643723776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:58:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429112673964032 [0;39m 生成今日电子书快照开始
2022-08-26 16:58:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429112673964032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:58:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429112673964032 [0;39m ==> Parameters: 
2022-08-26 16:58:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429112673964032 [0;39m <==    Updates: 0
2022-08-26 16:58:00.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429112673964032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:58:05.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429133586763776 [0;39m 生成今日电子书快照开始
2022-08-26 16:58:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429133586763776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:58:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429133586763776 [0;39m ==> Parameters: 
2022-08-26 16:58:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429133586763776 [0;39m <==    Updates: 0
2022-08-26 16:58:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429133586763776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:58:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20429133595152384 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:58:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429133595152384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:58:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429133595152384 [0;39m ==> Parameters: 
2022-08-26 16:58:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429133595152384 [0;39m <==    Updates: 8
2022-08-26 16:58:05.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20429133595152384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:58:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429154596032512 [0;39m 生成今日电子书快照开始
2022-08-26 16:58:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429154596032512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:58:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429154596032512 [0;39m ==> Parameters: 
2022-08-26 16:58:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429154596032512 [0;39m <==    Updates: 0
2022-08-26 16:58:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429154596032512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:58:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429175533998080 [0;39m 生成今日电子书快照开始
2022-08-26 16:58:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429175533998080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:58:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429175533998080 [0;39m ==> Parameters: 
2022-08-26 16:58:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429175533998080 [0;39m <==    Updates: 0
2022-08-26 16:58:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429175533998080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:58:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429196513906688 [0;39m 生成今日电子书快照开始
2022-08-26 16:58:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429196513906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:58:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429196513906688 [0;39m ==> Parameters: 
2022-08-26 16:58:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429196513906688 [0;39m <==    Updates: 0
2022-08-26 16:58:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429196513906688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:58:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429217523175424 [0;39m 生成今日电子书快照开始
2022-08-26 16:58:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429217523175424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:58:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429217523175424 [0;39m ==> Parameters: 
2022-08-26 16:58:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429217523175424 [0;39m <==    Updates: 0
2022-08-26 16:58:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429217523175424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:58:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429238477918208 [0;39m 生成今日电子书快照开始
2022-08-26 16:58:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429238477918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:58:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429238477918208 [0;39m ==> Parameters: 
2022-08-26 16:58:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429238477918208 [0;39m <==    Updates: 0
2022-08-26 16:58:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429238477918208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:58:35.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20429259457826816 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:58:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429259457826816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:58:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429259457826816 [0;39m ==> Parameters: 
2022-08-26 16:58:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429259457826816 [0;39m <==    Updates: 8
2022-08-26 16:58:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20429259457826816 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:58:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429259462021120 [0;39m 生成今日电子书快照开始
2022-08-26 16:58:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429259462021120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:58:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429259462021120 [0;39m ==> Parameters: 
2022-08-26 16:58:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429259462021120 [0;39m <==    Updates: 0
2022-08-26 16:58:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429259462021120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:58:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429280425152512 [0;39m 生成今日电子书快照开始
2022-08-26 16:58:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429280425152512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:58:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429280425152512 [0;39m ==> Parameters: 
2022-08-26 16:58:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429280425152512 [0;39m <==    Updates: 0
2022-08-26 16:58:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429280425152512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:58:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429301371506688 [0;39m 生成今日电子书快照开始
2022-08-26 16:58:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429301371506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:58:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429301371506688 [0;39m ==> Parameters: 
2022-08-26 16:58:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429301371506688 [0;39m <==    Updates: 0
2022-08-26 16:58:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429301371506688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:58:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429322347220992 [0;39m 生成今日电子书快照开始
2022-08-26 16:58:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429322347220992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:58:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429322347220992 [0;39m ==> Parameters: 
2022-08-26 16:58:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429322347220992 [0;39m <==    Updates: 0
2022-08-26 16:58:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429322347220992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:58:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429343339712512 [0;39m 生成今日电子书快照开始
2022-08-26 16:58:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429343339712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:58:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429343339712512 [0;39m ==> Parameters: 
2022-08-26 16:58:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429343339712512 [0;39m <==    Updates: 0
2022-08-26 16:58:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429343339712512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:59:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429364315426816 [0;39m 生成今日电子书快照开始
2022-08-26 16:59:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429364315426816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:59:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429364315426816 [0;39m ==> Parameters: 
2022-08-26 16:59:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429364315426816 [0;39m <==    Updates: 0
2022-08-26 16:59:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429364315426816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:59:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20429385291141120 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:59:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429385291141120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:59:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429385291141120 [0;39m ==> Parameters: 
2022-08-26 16:59:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429385291141120 [0;39m <==    Updates: 8
2022-08-26 16:59:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20429385291141120 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 16:59:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429385303724032 [0;39m 生成今日电子书快照开始
2022-08-26 16:59:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429385303724032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:59:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429385303724032 [0;39m ==> Parameters: 
2022-08-26 16:59:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429385303724032 [0;39m <==    Updates: 0
2022-08-26 16:59:05.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429385303724032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 16:59:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429406233300992 [0;39m 生成今日电子书快照开始
2022-08-26 16:59:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429406233300992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:59:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429406233300992 [0;39m ==> Parameters: 
2022-08-26 16:59:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429406233300992 [0;39m <==    Updates: 0
2022-08-26 16:59:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429406233300992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:59:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429427183849472 [0;39m 生成今日电子书快照开始
2022-08-26 16:59:15.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429427183849472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:59:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429427183849472 [0;39m ==> Parameters: 
2022-08-26 16:59:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429427183849472 [0;39m <==    Updates: 0
2022-08-26 16:59:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429427183849472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:59:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429448163758080 [0;39m 生成今日电子书快照开始
2022-08-26 16:59:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429448163758080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:59:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429448163758080 [0;39m ==> Parameters: 
2022-08-26 16:59:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429448163758080 [0;39m <==    Updates: 0
2022-08-26 16:59:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429448163758080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:59:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429469152055296 [0;39m 生成今日电子书快照开始
2022-08-26 16:59:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429469152055296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:59:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429469152055296 [0;39m ==> Parameters: 
2022-08-26 16:59:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429469152055296 [0;39m <==    Updates: 0
2022-08-26 16:59:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429469152055296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:59:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429490152935424 [0;39m 生成今日电子书快照开始
2022-08-26 16:59:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429490152935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:59:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429490152935424 [0;39m ==> Parameters: 
2022-08-26 16:59:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429490152935424 [0;39m <==    Updates: 0
2022-08-26 16:59:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429490152935424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:59:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20429511107678208 [0;39m 更新电子书下的文档数据开始
2022-08-26 16:59:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429511107678208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 16:59:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429511107678208 [0;39m ==> Parameters: 
2022-08-26 16:59:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429511107678208 [0;39m <==    Updates: 8
2022-08-26 16:59:35.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20429511107678208 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 16:59:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429511111872512 [0;39m 生成今日电子书快照开始
2022-08-26 16:59:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429511111872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:59:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429511111872512 [0;39m ==> Parameters: 
2022-08-26 16:59:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429511111872512 [0;39m <==    Updates: 0
2022-08-26 16:59:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429511111872512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:59:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429532066615296 [0;39m 生成今日电子书快照开始
2022-08-26 16:59:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429532066615296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:59:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429532066615296 [0;39m ==> Parameters: 
2022-08-26 16:59:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429532066615296 [0;39m <==    Updates: 0
2022-08-26 16:59:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429532066615296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:59:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429553021358080 [0;39m 生成今日电子书快照开始
2022-08-26 16:59:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429553021358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:59:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429553021358080 [0;39m ==> Parameters: 
2022-08-26 16:59:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429553021358080 [0;39m <==    Updates: 0
2022-08-26 16:59:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429553021358080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 16:59:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429574030626816 [0;39m 生成今日电子书快照开始
2022-08-26 16:59:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429574030626816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:59:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429574030626816 [0;39m ==> Parameters: 
2022-08-26 16:59:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429574030626816 [0;39m <==    Updates: 0
2022-08-26 16:59:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429574030626816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 16:59:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429595002146816 [0;39m 生成今日电子书快照开始
2022-08-26 16:59:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429595002146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 16:59:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429595002146816 [0;39m ==> Parameters: 
2022-08-26 16:59:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429595002146816 [0;39m <==    Updates: 0
2022-08-26 16:59:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429595002146816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:00:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429615986249728 [0;39m 生成今日电子书快照开始
2022-08-26 17:00:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429615986249728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:00:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429615986249728 [0;39m ==> Parameters: 
2022-08-26 17:00:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429615986249728 [0;39m <==    Updates: 0
2022-08-26 17:00:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429615986249728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:00:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429636924215296 [0;39m 生成今日电子书快照开始
2022-08-26 17:00:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429636924215296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:00:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429636924215296 [0;39m ==> Parameters: 
2022-08-26 17:00:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429636924215296 [0;39m <==    Updates: 0
2022-08-26 17:00:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429636924215296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:00:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20429636932603904 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:00:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429636932603904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:00:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429636932603904 [0;39m ==> Parameters: 
2022-08-26 17:00:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429636932603904 [0;39m <==    Updates: 8
2022-08-26 17:00:05.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20429636932603904 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:00:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429657933484032 [0;39m 生成今日电子书快照开始
2022-08-26 17:00:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429657933484032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:00:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429657933484032 [0;39m ==> Parameters: 
2022-08-26 17:00:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429657933484032 [0;39m <==    Updates: 0
2022-08-26 17:00:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429657933484032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:00:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429678888226816 [0;39m 生成今日电子书快照开始
2022-08-26 17:00:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429678888226816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:00:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429678888226816 [0;39m ==> Parameters: 
2022-08-26 17:00:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429678888226816 [0;39m <==    Updates: 0
2022-08-26 17:00:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429678888226816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:00:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429699876524032 [0;39m 生成今日电子书快照开始
2022-08-26 17:00:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429699876524032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:00:20.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429699876524032 [0;39m ==> Parameters: 
2022-08-26 17:00:20.025 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429699876524032 [0;39m <==    Updates: 0
2022-08-26 17:00:20.026 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429699876524032 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 17:00:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429720810295296 [0;39m 生成今日电子书快照开始
2022-08-26 17:00:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429720810295296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:00:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429720810295296 [0;39m ==> Parameters: 
2022-08-26 17:00:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429720810295296 [0;39m <==    Updates: 0
2022-08-26 17:00:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429720810295296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:00:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429741773426688 [0;39m 生成今日电子书快照开始
2022-08-26 17:00:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429741773426688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:00:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429741773426688 [0;39m ==> Parameters: 
2022-08-26 17:00:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429741773426688 [0;39m <==    Updates: 0
2022-08-26 17:00:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429741773426688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:00:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429762782695424 [0;39m 生成今日电子书快照开始
2022-08-26 17:00:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429762782695424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:00:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429762782695424 [0;39m ==> Parameters: 
2022-08-26 17:00:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429762782695424 [0;39m <==    Updates: 0
2022-08-26 17:00:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429762782695424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:00:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20429762791084032 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:00:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429762791084032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:00:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429762791084032 [0;39m ==> Parameters: 
2022-08-26 17:00:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429762791084032 [0;39m <==    Updates: 8
2022-08-26 17:00:35.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20429762791084032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:00:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429783745826816 [0;39m 生成今日电子书快照开始
2022-08-26 17:00:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429783745826816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:00:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429783745826816 [0;39m ==> Parameters: 
2022-08-26 17:00:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429783745826816 [0;39m <==    Updates: 0
2022-08-26 17:00:40.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429783745826816 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:00:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429804696375296 [0;39m 生成今日电子书快照开始
2022-08-26 17:00:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429804696375296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:00:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429804696375296 [0;39m ==> Parameters: 
2022-08-26 17:00:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429804696375296 [0;39m <==    Updates: 0
2022-08-26 17:00:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429804696375296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:00:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429825663700992 [0;39m 生成今日电子书快照开始
2022-08-26 17:00:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429825663700992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:00:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429825663700992 [0;39m ==> Parameters: 
2022-08-26 17:00:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429825663700992 [0;39m <==    Updates: 0
2022-08-26 17:00:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429825663700992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:00:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429846664581120 [0;39m 生成今日电子书快照开始
2022-08-26 17:00:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429846664581120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:00:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429846664581120 [0;39m ==> Parameters: 
2022-08-26 17:00:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429846664581120 [0;39m <==    Updates: 0
2022-08-26 17:00:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429846664581120 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:01:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429867627712512 [0;39m 生成今日电子书快照开始
2022-08-26 17:01:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429867627712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:01:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429867627712512 [0;39m ==> Parameters: 
2022-08-26 17:01:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429867627712512 [0;39m <==    Updates: 0
2022-08-26 17:01:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429867627712512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:01:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20429888595038208 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:01:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429888595038208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:01:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429888595038208 [0;39m ==> Parameters: 
2022-08-26 17:01:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20429888595038208 [0;39m <==    Updates: 8
2022-08-26 17:01:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20429888595038208 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 17:01:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429888620204032 [0;39m 生成今日电子书快照开始
2022-08-26 17:01:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429888620204032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:01:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429888620204032 [0;39m ==> Parameters: 
2022-08-26 17:01:05.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429888620204032 [0;39m <==    Updates: 0
2022-08-26 17:01:05.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429888620204032 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:01:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429909562363904 [0;39m 生成今日电子书快照开始
2022-08-26 17:01:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429909562363904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:01:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429909562363904 [0;39m ==> Parameters: 
2022-08-26 17:01:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429909562363904 [0;39m <==    Updates: 0
2022-08-26 17:01:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429909562363904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:01:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429930538078208 [0;39m 生成今日电子书快照开始
2022-08-26 17:01:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429930538078208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:01:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429930538078208 [0;39m ==> Parameters: 
2022-08-26 17:01:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429930538078208 [0;39m <==    Updates: 0
2022-08-26 17:01:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429930538078208 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:01:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429951534764032 [0;39m 生成今日电子书快照开始
2022-08-26 17:01:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429951534764032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:01:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429951534764032 [0;39m ==> Parameters: 
2022-08-26 17:01:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429951534764032 [0;39m <==    Updates: 0
2022-08-26 17:01:20.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429951534764032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:01:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429972485312512 [0;39m 生成今日电子书快照开始
2022-08-26 17:01:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429972485312512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:01:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429972485312512 [0;39m ==> Parameters: 
2022-08-26 17:01:25.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429972485312512 [0;39m <==    Updates: 0
2022-08-26 17:01:25.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429972485312512 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:01:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20429993444249600 [0;39m 生成今日电子书快照开始
2022-08-26 17:01:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429993444249600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:01:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429993444249600 [0;39m ==> Parameters: 
2022-08-26 17:01:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20429993444249600 [0;39m <==    Updates: 0
2022-08-26 17:01:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20429993444249600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:01:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20430014403186688 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:01:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430014403186688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:01:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430014403186688 [0;39m ==> Parameters: 
2022-08-26 17:01:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430014403186688 [0;39m <==    Updates: 8
2022-08-26 17:01:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20430014403186688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:01:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430014407380992 [0;39m 生成今日电子书快照开始
2022-08-26 17:01:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430014407380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:01:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430014407380992 [0;39m ==> Parameters: 
2022-08-26 17:01:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430014407380992 [0;39m <==    Updates: 0
2022-08-26 17:01:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430014407380992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:01:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430035383095296 [0;39m 生成今日电子书快照开始
2022-08-26 17:01:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430035383095296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:01:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430035383095296 [0;39m ==> Parameters: 
2022-08-26 17:01:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430035383095296 [0;39m <==    Updates: 0
2022-08-26 17:01:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430035383095296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:01:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430056333643776 [0;39m 生成今日电子书快照开始
2022-08-26 17:01:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430056333643776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:01:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430056333643776 [0;39m ==> Parameters: 
2022-08-26 17:01:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430056333643776 [0;39m <==    Updates: 0
2022-08-26 17:01:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430056333643776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:01:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430077321940992 [0;39m 生成今日电子书快照开始
2022-08-26 17:01:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430077321940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:01:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430077321940992 [0;39m ==> Parameters: 
2022-08-26 17:01:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430077321940992 [0;39m <==    Updates: 0
2022-08-26 17:01:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430077321940992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:01:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430098289266688 [0;39m 生成今日电子书快照开始
2022-08-26 17:01:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430098289266688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:01:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430098289266688 [0;39m ==> Parameters: 
2022-08-26 17:01:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430098289266688 [0;39m <==    Updates: 0
2022-08-26 17:01:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430098289266688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:02:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430119244009472 [0;39m 生成今日电子书快照开始
2022-08-26 17:02:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430119244009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:02:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430119244009472 [0;39m ==> Parameters: 
2022-08-26 17:02:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430119244009472 [0;39m <==    Updates: 0
2022-08-26 17:02:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430119244009472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:02:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20430140261666816 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:02:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430140261666816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:02:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430140261666816 [0;39m ==> Parameters: 
2022-08-26 17:02:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430140261666816 [0;39m <==    Updates: 8
2022-08-26 17:02:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20430140261666816 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:02:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430140265861120 [0;39m 生成今日电子书快照开始
2022-08-26 17:02:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430140265861120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:02:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430140265861120 [0;39m ==> Parameters: 
2022-08-26 17:02:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430140265861120 [0;39m <==    Updates: 0
2022-08-26 17:02:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430140265861120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:02:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430161195438080 [0;39m 生成今日电子书快照开始
2022-08-26 17:02:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430161195438080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:02:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430161195438080 [0;39m ==> Parameters: 
2022-08-26 17:02:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430161195438080 [0;39m <==    Updates: 0
2022-08-26 17:02:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430161195438080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:02:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430182221484032 [0;39m 生成今日电子书快照开始
2022-08-26 17:02:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430182221484032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:02:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430182221484032 [0;39m ==> Parameters: 
2022-08-26 17:02:15.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430182221484032 [0;39m <==    Updates: 0
2022-08-26 17:02:15.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430182221484032 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:02:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430203176226816 [0;39m 生成今日电子书快照开始
2022-08-26 17:02:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430203176226816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:02:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430203176226816 [0;39m ==> Parameters: 
2022-08-26 17:02:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430203176226816 [0;39m <==    Updates: 0
2022-08-26 17:02:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430203176226816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:02:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430224118386688 [0;39m 生成今日电子书快照开始
2022-08-26 17:02:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430224118386688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:02:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430224118386688 [0;39m ==> Parameters: 
2022-08-26 17:02:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430224118386688 [0;39m <==    Updates: 0
2022-08-26 17:02:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430224118386688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:02:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430245131849728 [0;39m 生成今日电子书快照开始
2022-08-26 17:02:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430245131849728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:02:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430245131849728 [0;39m ==> Parameters: 
2022-08-26 17:02:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430245131849728 [0;39m <==    Updates: 0
2022-08-26 17:02:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430245131849728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:02:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430266099175424 [0;39m 生成今日电子书快照开始
2022-08-26 17:02:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430266099175424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:02:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430266099175424 [0;39m ==> Parameters: 
2022-08-26 17:02:35.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430266099175424 [0;39m <==    Updates: 0
2022-08-26 17:02:35.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430266099175424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:02:35.021 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20430266128535552 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:02:35.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430266128535552 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:02:35.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430266128535552 [0;39m ==> Parameters: 
2022-08-26 17:02:35.024 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430266128535552 [0;39m <==    Updates: 8
2022-08-26 17:02:35.024 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20430266128535552 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 17:02:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430287066501120 [0;39m 生成今日电子书快照开始
2022-08-26 17:02:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430287066501120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:02:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430287066501120 [0;39m ==> Parameters: 
2022-08-26 17:02:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430287066501120 [0;39m <==    Updates: 0
2022-08-26 17:02:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430287066501120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:02:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430308042215424 [0;39m 生成今日电子书快照开始
2022-08-26 17:02:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430308042215424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:02:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430308042215424 [0;39m ==> Parameters: 
2022-08-26 17:02:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430308042215424 [0;39m <==    Updates: 0
2022-08-26 17:02:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430308042215424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:02:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430329005346816 [0;39m 生成今日电子书快照开始
2022-08-26 17:02:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430329005346816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:02:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430329005346816 [0;39m ==> Parameters: 
2022-08-26 17:02:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430329005346816 [0;39m <==    Updates: 0
2022-08-26 17:02:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430329005346816 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:02:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430349934923776 [0;39m 生成今日电子书快照开始
2022-08-26 17:02:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430349934923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:02:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430349934923776 [0;39m ==> Parameters: 
2022-08-26 17:02:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430349934923776 [0;39m <==    Updates: 0
2022-08-26 17:02:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430349934923776 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:03:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430370914832384 [0;39m 生成今日电子书快照开始
2022-08-26 17:03:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430370914832384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:03:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430370914832384 [0;39m ==> Parameters: 
2022-08-26 17:03:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430370914832384 [0;39m <==    Updates: 0
2022-08-26 17:03:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430370914832384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:03:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430391919906816 [0;39m 生成今日电子书快照开始
2022-08-26 17:03:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430391919906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:03:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430391919906816 [0;39m ==> Parameters: 
2022-08-26 17:03:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430391919906816 [0;39m <==    Updates: 0
2022-08-26 17:03:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430391919906816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:03:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20430391936684032 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:03:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430391936684032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:03:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430391936684032 [0;39m ==> Parameters: 
2022-08-26 17:03:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430391936684032 [0;39m <==    Updates: 8
2022-08-26 17:03:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20430391936684032 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:03:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430412874649600 [0;39m 生成今日电子书快照开始
2022-08-26 17:03:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430412874649600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:03:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430412874649600 [0;39m ==> Parameters: 
2022-08-26 17:03:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430412874649600 [0;39m <==    Updates: 0
2022-08-26 17:03:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430412874649600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:03:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430433841975296 [0;39m 生成今日电子书快照开始
2022-08-26 17:03:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430433841975296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:03:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430433841975296 [0;39m ==> Parameters: 
2022-08-26 17:03:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430433841975296 [0;39m <==    Updates: 0
2022-08-26 17:03:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430433841975296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:03:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430454792523776 [0;39m 生成今日电子书快照开始
2022-08-26 17:03:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430454792523776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:03:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430454792523776 [0;39m ==> Parameters: 
2022-08-26 17:03:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430454792523776 [0;39m <==    Updates: 0
2022-08-26 17:03:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430454792523776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:03:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430475805986816 [0;39m 生成今日电子书快照开始
2022-08-26 17:03:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430475805986816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:03:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430475805986816 [0;39m ==> Parameters: 
2022-08-26 17:03:25.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430475805986816 [0;39m <==    Updates: 0
2022-08-26 17:03:25.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430475805986816 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:03:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430496760729600 [0;39m 生成今日电子书快照开始
2022-08-26 17:03:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430496760729600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:03:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430496760729600 [0;39m ==> Parameters: 
2022-08-26 17:03:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430496760729600 [0;39m <==    Updates: 0
2022-08-26 17:03:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430496760729600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:03:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430517753221120 [0;39m 生成今日电子书快照开始
2022-08-26 17:03:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430517753221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:03:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430517753221120 [0;39m ==> Parameters: 
2022-08-26 17:03:35.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430517753221120 [0;39m <==    Updates: 0
2022-08-26 17:03:35.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430517753221120 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:03:35.022 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20430517790969856 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:03:35.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430517790969856 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:03:35.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430517790969856 [0;39m ==> Parameters: 
2022-08-26 17:03:35.026 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430517790969856 [0;39m <==    Updates: 8
2022-08-26 17:03:35.026 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20430517790969856 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 17:03:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430538712158208 [0;39m 生成今日电子书快照开始
2022-08-26 17:03:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430538712158208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:03:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430538712158208 [0;39m ==> Parameters: 
2022-08-26 17:03:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430538712158208 [0;39m <==    Updates: 0
2022-08-26 17:03:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430538712158208 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:03:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430559692066816 [0;39m 生成今日电子书快照开始
2022-08-26 17:03:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430559692066816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:03:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430559692066816 [0;39m ==> Parameters: 
2022-08-26 17:03:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430559692066816 [0;39m <==    Updates: 0
2022-08-26 17:03:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430559692066816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:03:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430580651003904 [0;39m 生成今日电子书快照开始
2022-08-26 17:03:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430580651003904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:03:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430580651003904 [0;39m ==> Parameters: 
2022-08-26 17:03:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430580651003904 [0;39m <==    Updates: 0
2022-08-26 17:03:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430580651003904 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:03:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430601609940992 [0;39m 生成今日电子书快照开始
2022-08-26 17:03:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430601609940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:03:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430601609940992 [0;39m ==> Parameters: 
2022-08-26 17:03:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430601609940992 [0;39m <==    Updates: 0
2022-08-26 17:03:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430601609940992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:04:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430622610821120 [0;39m 生成今日电子书快照开始
2022-08-26 17:04:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430622610821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:04:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430622610821120 [0;39m ==> Parameters: 
2022-08-26 17:04:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430622610821120 [0;39m <==    Updates: 0
2022-08-26 17:04:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430622610821120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:04:05.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20430643540398080 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:04:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430643540398080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:04:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430643540398080 [0;39m ==> Parameters: 
2022-08-26 17:04:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430643540398080 [0;39m <==    Updates: 8
2022-08-26 17:04:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20430643540398080 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 17:04:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430643557175296 [0;39m 生成今日电子书快照开始
2022-08-26 17:04:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430643557175296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:04:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430643557175296 [0;39m ==> Parameters: 
2022-08-26 17:04:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430643557175296 [0;39m <==    Updates: 0
2022-08-26 17:04:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430643557175296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:04:10.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430664499335168 [0;39m 生成今日电子书快照开始
2022-08-26 17:04:10.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430664499335168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:04:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430664499335168 [0;39m ==> Parameters: 
2022-08-26 17:04:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430664499335168 [0;39m <==    Updates: 0
2022-08-26 17:04:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430664499335168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:04:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430685508603904 [0;39m 生成今日电子书快照开始
2022-08-26 17:04:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430685508603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:04:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430685508603904 [0;39m ==> Parameters: 
2022-08-26 17:04:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430685508603904 [0;39m <==    Updates: 0
2022-08-26 17:04:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430685508603904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:04:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430706459152384 [0;39m 生成今日电子书快照开始
2022-08-26 17:04:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430706459152384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:04:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430706459152384 [0;39m ==> Parameters: 
2022-08-26 17:04:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430706459152384 [0;39m <==    Updates: 0
2022-08-26 17:04:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430706459152384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:04:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430727426478080 [0;39m 生成今日电子书快照开始
2022-08-26 17:04:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430727426478080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:04:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430727426478080 [0;39m ==> Parameters: 
2022-08-26 17:04:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430727426478080 [0;39m <==    Updates: 0
2022-08-26 17:04:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430727426478080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:04:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430748439941120 [0;39m 生成今日电子书快照开始
2022-08-26 17:04:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430748439941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:04:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430748439941120 [0;39m ==> Parameters: 
2022-08-26 17:04:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430748439941120 [0;39m <==    Updates: 0
2022-08-26 17:04:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430748439941120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:04:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20430769382100992 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:04:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430769382100992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:04:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430769382100992 [0;39m ==> Parameters: 
2022-08-26 17:04:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430769382100992 [0;39m <==    Updates: 8
2022-08-26 17:04:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20430769382100992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:04:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430769386295296 [0;39m 生成今日电子书快照开始
2022-08-26 17:04:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430769386295296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:04:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430769386295296 [0;39m ==> Parameters: 
2022-08-26 17:04:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430769386295296 [0;39m <==    Updates: 0
2022-08-26 17:04:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430769386295296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:04:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430790336843776 [0;39m 生成今日电子书快照开始
2022-08-26 17:04:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430790336843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:04:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430790336843776 [0;39m ==> Parameters: 
2022-08-26 17:04:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430790336843776 [0;39m <==    Updates: 0
2022-08-26 17:04:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430790336843776 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:04:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430811304169472 [0;39m 生成今日电子书快照开始
2022-08-26 17:04:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430811304169472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:04:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430811304169472 [0;39m ==> Parameters: 
2022-08-26 17:04:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430811304169472 [0;39m <==    Updates: 0
2022-08-26 17:04:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430811304169472 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:04:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430832330215424 [0;39m 生成今日电子书快照开始
2022-08-26 17:04:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430832330215424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:04:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430832330215424 [0;39m ==> Parameters: 
2022-08-26 17:04:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430832330215424 [0;39m <==    Updates: 0
2022-08-26 17:04:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430832330215424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:04:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430853310124032 [0;39m 生成今日电子书快照开始
2022-08-26 17:04:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430853310124032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:04:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430853310124032 [0;39m ==> Parameters: 
2022-08-26 17:04:55.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430853310124032 [0;39m <==    Updates: 0
2022-08-26 17:04:55.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430853310124032 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:05:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430874235506688 [0;39m 生成今日电子书快照开始
2022-08-26 17:05:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430874235506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:05:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430874235506688 [0;39m ==> Parameters: 
2022-08-26 17:05:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430874235506688 [0;39m <==    Updates: 0
2022-08-26 17:05:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430874235506688 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:05:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430895227998208 [0;39m 生成今日电子书快照开始
2022-08-26 17:05:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430895227998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:05:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430895227998208 [0;39m ==> Parameters: 
2022-08-26 17:05:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430895227998208 [0;39m <==    Updates: 0
2022-08-26 17:05:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430895227998208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:05:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20430895236386816 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:05:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430895236386816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:05:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430895236386816 [0;39m ==> Parameters: 
2022-08-26 17:05:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20430895236386816 [0;39m <==    Updates: 8
2022-08-26 17:05:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20430895236386816 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:05:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430916195323904 [0;39m 生成今日电子书快照开始
2022-08-26 17:05:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430916195323904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:05:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430916195323904 [0;39m ==> Parameters: 
2022-08-26 17:05:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430916195323904 [0;39m <==    Updates: 0
2022-08-26 17:05:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430916195323904 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:05:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430937158455296 [0;39m 生成今日电子书快照开始
2022-08-26 17:05:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430937158455296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:05:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430937158455296 [0;39m ==> Parameters: 
2022-08-26 17:05:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430937158455296 [0;39m <==    Updates: 0
2022-08-26 17:05:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430937158455296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:05:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430958125780992 [0;39m 生成今日电子书快照开始
2022-08-26 17:05:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430958125780992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:05:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430958125780992 [0;39m ==> Parameters: 
2022-08-26 17:05:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430958125780992 [0;39m <==    Updates: 0
2022-08-26 17:05:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430958125780992 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:05:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20430979105689600 [0;39m 生成今日电子书快照开始
2022-08-26 17:05:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430979105689600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:05:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430979105689600 [0;39m ==> Parameters: 
2022-08-26 17:05:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20430979105689600 [0;39m <==    Updates: 0
2022-08-26 17:05:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20430979105689600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:05:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431000068820992 [0;39m 生成今日电子书快照开始
2022-08-26 17:05:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431000068820992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:05:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431000068820992 [0;39m ==> Parameters: 
2022-08-26 17:05:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431000068820992 [0;39m <==    Updates: 0
2022-08-26 17:05:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431000068820992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:05:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431021036146688 [0;39m 生成今日电子书快照开始
2022-08-26 17:05:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431021036146688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:05:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431021036146688 [0;39m ==> Parameters: 
2022-08-26 17:05:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431021036146688 [0;39m <==    Updates: 0
2022-08-26 17:05:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431021036146688 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 17:05:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20431021082284032 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:05:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431021082284032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:05:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431021082284032 [0;39m ==> Parameters: 
2022-08-26 17:05:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431021082284032 [0;39m <==    Updates: 8
2022-08-26 17:05:35.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20431021082284032 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 17:05:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431042037026816 [0;39m 生成今日电子书快照开始
2022-08-26 17:05:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431042037026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:05:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431042037026816 [0;39m ==> Parameters: 
2022-08-26 17:05:40.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431042037026816 [0;39m <==    Updates: 0
2022-08-26 17:05:40.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431042037026816 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:05:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431062991769600 [0;39m 生成今日电子书快照开始
2022-08-26 17:05:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431062991769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:05:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431062991769600 [0;39m ==> Parameters: 
2022-08-26 17:05:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431062991769600 [0;39m <==    Updates: 0
2022-08-26 17:05:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431062991769600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:05:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431083971678208 [0;39m 生成今日电子书快照开始
2022-08-26 17:05:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431083971678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:05:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431083971678208 [0;39m ==> Parameters: 
2022-08-26 17:05:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431083971678208 [0;39m <==    Updates: 0
2022-08-26 17:05:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431083971678208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:05:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431104959975424 [0;39m 生成今日电子书快照开始
2022-08-26 17:05:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431104959975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:05:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431104959975424 [0;39m ==> Parameters: 
2022-08-26 17:05:55.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431104959975424 [0;39m <==    Updates: 0
2022-08-26 17:05:55.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431104959975424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:06:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431125897940992 [0;39m 生成今日电子书快照开始
2022-08-26 17:06:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431125897940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:06:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431125897940992 [0;39m ==> Parameters: 
2022-08-26 17:06:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431125897940992 [0;39m <==    Updates: 0
2022-08-26 17:06:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431125897940992 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:06:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431146890432512 [0;39m 生成今日电子书快照开始
2022-08-26 17:06:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431146890432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:06:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431146890432512 [0;39m ==> Parameters: 
2022-08-26 17:06:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431146890432512 [0;39m <==    Updates: 0
2022-08-26 17:06:05.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431146890432512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:06:05.020 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20431146928181248 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:06:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431146928181248 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:06:05.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431146928181248 [0;39m ==> Parameters: 
2022-08-26 17:06:05.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431146928181248 [0;39m <==    Updates: 8
2022-08-26 17:06:05.023 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20431146928181248 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 17:06:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431167853563904 [0;39m 生成今日电子书快照开始
2022-08-26 17:06:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431167853563904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:06:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431167853563904 [0;39m ==> Parameters: 
2022-08-26 17:06:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431167853563904 [0;39m <==    Updates: 0
2022-08-26 17:06:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431167853563904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:06:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431188829278208 [0;39m 生成今日电子书快照开始
2022-08-26 17:06:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431188829278208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:06:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431188829278208 [0;39m ==> Parameters: 
2022-08-26 17:06:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431188829278208 [0;39m <==    Updates: 0
2022-08-26 17:06:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431188829278208 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:06:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431209763049472 [0;39m 生成今日电子书快照开始
2022-08-26 17:06:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431209763049472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:06:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431209763049472 [0;39m ==> Parameters: 
2022-08-26 17:06:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431209763049472 [0;39m <==    Updates: 0
2022-08-26 17:06:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431209763049472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:06:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431230755540992 [0;39m 生成今日电子书快照开始
2022-08-26 17:06:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431230755540992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:06:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431230755540992 [0;39m ==> Parameters: 
2022-08-26 17:06:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431230755540992 [0;39m <==    Updates: 0
2022-08-26 17:06:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431230755540992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:06:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431251718672384 [0;39m 生成今日电子书快照开始
2022-08-26 17:06:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431251718672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:06:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431251718672384 [0;39m ==> Parameters: 
2022-08-26 17:06:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431251718672384 [0;39m <==    Updates: 0
2022-08-26 17:06:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431251718672384 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:06:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431272719552512 [0;39m 生成今日电子书快照开始
2022-08-26 17:06:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431272719552512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:06:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431272719552512 [0;39m ==> Parameters: 
2022-08-26 17:06:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431272719552512 [0;39m <==    Updates: 0
2022-08-26 17:06:35.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431272719552512 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:06:35.020 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20431272757301248 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:06:35.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431272757301248 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:06:35.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431272757301248 [0;39m ==> Parameters: 
2022-08-26 17:06:35.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431272757301248 [0;39m <==    Updates: 8
2022-08-26 17:06:35.024 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20431272757301248 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 17:06:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431293653323776 [0;39m 生成今日电子书快照开始
2022-08-26 17:06:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431293653323776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:06:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431293653323776 [0;39m ==> Parameters: 
2022-08-26 17:06:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431293653323776 [0;39m <==    Updates: 0
2022-08-26 17:06:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431293653323776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:06:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431314645815296 [0;39m 生成今日电子书快照开始
2022-08-26 17:06:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431314645815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:06:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431314645815296 [0;39m ==> Parameters: 
2022-08-26 17:06:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431314645815296 [0;39m <==    Updates: 0
2022-08-26 17:06:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431314645815296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:06:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431335617335296 [0;39m 生成今日电子书快照开始
2022-08-26 17:06:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431335617335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:06:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431335617335296 [0;39m ==> Parameters: 
2022-08-26 17:06:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431335617335296 [0;39m <==    Updates: 0
2022-08-26 17:06:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431335617335296 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:06:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431356626604032 [0;39m 生成今日电子书快照开始
2022-08-26 17:06:55.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431356626604032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:06:55.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431356626604032 [0;39m ==> Parameters: 
2022-08-26 17:06:55.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431356626604032 [0;39m <==    Updates: 0
2022-08-26 17:06:55.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431356626604032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:07:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431377598124032 [0;39m 生成今日电子书快照开始
2022-08-26 17:07:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431377598124032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:07:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431377598124032 [0;39m ==> Parameters: 
2022-08-26 17:07:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431377598124032 [0;39m <==    Updates: 0
2022-08-26 17:07:00.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431377598124032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:07:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20431398519312384 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:07:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431398519312384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:07:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431398519312384 [0;39m ==> Parameters: 
2022-08-26 17:07:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431398519312384 [0;39m <==    Updates: 8
2022-08-26 17:07:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20431398519312384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:07:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431398527700992 [0;39m 生成今日电子书快照开始
2022-08-26 17:07:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431398527700992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:07:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431398527700992 [0;39m ==> Parameters: 
2022-08-26 17:07:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431398527700992 [0;39m <==    Updates: 0
2022-08-26 17:07:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431398527700992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:07:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431419507609600 [0;39m 生成今日电子书快照开始
2022-08-26 17:07:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431419507609600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:07:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431419507609600 [0;39m ==> Parameters: 
2022-08-26 17:07:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431419507609600 [0;39m <==    Updates: 0
2022-08-26 17:07:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431419507609600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:07:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431440491712512 [0;39m 生成今日电子书快照开始
2022-08-26 17:07:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431440491712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:07:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431440491712512 [0;39m ==> Parameters: 
2022-08-26 17:07:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431440491712512 [0;39m <==    Updates: 0
2022-08-26 17:07:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431440491712512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:07:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431461480009728 [0;39m 生成今日电子书快照开始
2022-08-26 17:07:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431461480009728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:07:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431461480009728 [0;39m ==> Parameters: 
2022-08-26 17:07:20.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431461480009728 [0;39m <==    Updates: 0
2022-08-26 17:07:20.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431461480009728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:07:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431482405392384 [0;39m 生成今日电子书快照开始
2022-08-26 17:07:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431482405392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:07:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431482405392384 [0;39m ==> Parameters: 
2022-08-26 17:07:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431482405392384 [0;39m <==    Updates: 0
2022-08-26 17:07:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431482405392384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:07:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431503431438336 [0;39m 生成今日电子书快照开始
2022-08-26 17:07:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431503431438336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:07:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431503431438336 [0;39m ==> Parameters: 
2022-08-26 17:07:30.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431503431438336 [0;39m <==    Updates: 0
2022-08-26 17:07:30.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431503431438336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:07:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431524352626688 [0;39m 生成今日电子书快照开始
2022-08-26 17:07:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431524352626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:07:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431524352626688 [0;39m ==> Parameters: 
2022-08-26 17:07:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431524352626688 [0;39m <==    Updates: 0
2022-08-26 17:07:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431524352626688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:07:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20431524361015296 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:07:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431524361015296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:07:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431524361015296 [0;39m ==> Parameters: 
2022-08-26 17:07:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431524361015296 [0;39m <==    Updates: 8
2022-08-26 17:07:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20431524361015296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:07:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431545349312512 [0;39m 生成今日电子书快照开始
2022-08-26 17:07:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431545349312512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:07:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431545349312512 [0;39m ==> Parameters: 
2022-08-26 17:07:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431545349312512 [0;39m <==    Updates: 0
2022-08-26 17:07:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431545349312512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:07:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431566304055296 [0;39m 生成今日电子书快照开始
2022-08-26 17:07:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431566304055296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:07:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431566304055296 [0;39m ==> Parameters: 
2022-08-26 17:07:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431566304055296 [0;39m <==    Updates: 0
2022-08-26 17:07:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431566304055296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:07:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431587288158208 [0;39m 生成今日电子书快照开始
2022-08-26 17:07:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431587288158208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:07:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431587288158208 [0;39m ==> Parameters: 
2022-08-26 17:07:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431587288158208 [0;39m <==    Updates: 0
2022-08-26 17:07:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431587288158208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:07:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431608259678208 [0;39m 生成今日电子书快照开始
2022-08-26 17:07:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431608259678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:07:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431608259678208 [0;39m ==> Parameters: 
2022-08-26 17:07:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431608259678208 [0;39m <==    Updates: 0
2022-08-26 17:07:55.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431608259678208 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:08:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431629243781120 [0;39m 生成今日电子书快照开始
2022-08-26 17:08:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431629243781120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:08:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431629243781120 [0;39m ==> Parameters: 
2022-08-26 17:08:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431629243781120 [0;39m <==    Updates: 0
2022-08-26 17:08:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431629243781120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:08:05.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20431650164969472 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:08:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431650164969472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:08:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431650164969472 [0;39m ==> Parameters: 
2022-08-26 17:08:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431650164969472 [0;39m <==    Updates: 8
2022-08-26 17:08:05.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20431650164969472 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:08:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431650173358080 [0;39m 生成今日电子书快照开始
2022-08-26 17:08:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431650173358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:08:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431650173358080 [0;39m ==> Parameters: 
2022-08-26 17:08:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431650173358080 [0;39m <==    Updates: 0
2022-08-26 17:08:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431650173358080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:08:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431671178432512 [0;39m 生成今日电子书快照开始
2022-08-26 17:08:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431671178432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:08:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431671178432512 [0;39m ==> Parameters: 
2022-08-26 17:08:10.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431671178432512 [0;39m <==    Updates: 0
2022-08-26 17:08:10.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431671178432512 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:08:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431692154146816 [0;39m 生成今日电子书快照开始
2022-08-26 17:08:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431692154146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:08:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431692154146816 [0;39m ==> Parameters: 
2022-08-26 17:08:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431692154146816 [0;39m <==    Updates: 0
2022-08-26 17:08:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431692154146816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:08:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431713096306688 [0;39m 生成今日电子书快照开始
2022-08-26 17:08:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431713096306688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:08:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431713096306688 [0;39m ==> Parameters: 
2022-08-26 17:08:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431713096306688 [0;39m <==    Updates: 0
2022-08-26 17:08:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431713096306688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:08:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431734080409600 [0;39m 生成今日电子书快照开始
2022-08-26 17:08:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431734080409600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:08:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431734080409600 [0;39m ==> Parameters: 
2022-08-26 17:08:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431734080409600 [0;39m <==    Updates: 0
2022-08-26 17:08:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431734080409600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:08:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431755089678336 [0;39m 生成今日电子书快照开始
2022-08-26 17:08:30.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431755089678336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:08:30.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431755089678336 [0;39m ==> Parameters: 
2022-08-26 17:08:30.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431755089678336 [0;39m <==    Updates: 0
2022-08-26 17:08:30.025 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431755089678336 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:08:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20431776002478080 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:08:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431776002478080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:08:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431776002478080 [0;39m ==> Parameters: 
2022-08-26 17:08:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431776002478080 [0;39m <==    Updates: 8
2022-08-26 17:08:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20431776002478080 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 17:08:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431776027643904 [0;39m 生成今日电子书快照开始
2022-08-26 17:08:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431776027643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:08:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431776027643904 [0;39m ==> Parameters: 
2022-08-26 17:08:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431776027643904 [0;39m <==    Updates: 0
2022-08-26 17:08:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431776027643904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:08:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431796965609472 [0;39m 生成今日电子书快照开始
2022-08-26 17:08:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431796965609472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:08:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431796965609472 [0;39m ==> Parameters: 
2022-08-26 17:08:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431796965609472 [0;39m <==    Updates: 0
2022-08-26 17:08:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431796965609472 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:08:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431817937129472 [0;39m 生成今日电子书快照开始
2022-08-26 17:08:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431817937129472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:08:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431817937129472 [0;39m ==> Parameters: 
2022-08-26 17:08:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431817937129472 [0;39m <==    Updates: 0
2022-08-26 17:08:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431817937129472 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:08:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431838958981120 [0;39m 生成今日电子书快照开始
2022-08-26 17:08:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431838958981120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:08:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431838958981120 [0;39m ==> Parameters: 
2022-08-26 17:08:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431838958981120 [0;39m <==    Updates: 0
2022-08-26 17:08:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431838958981120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:08:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431859913723904 [0;39m 生成今日电子书快照开始
2022-08-26 17:08:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431859913723904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:08:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431859913723904 [0;39m ==> Parameters: 
2022-08-26 17:08:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431859913723904 [0;39m <==    Updates: 0
2022-08-26 17:08:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431859913723904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:09:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431880885243904 [0;39m 生成今日电子书快照开始
2022-08-26 17:09:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431880885243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:09:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431880885243904 [0;39m ==> Parameters: 
2022-08-26 17:09:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431880885243904 [0;39m <==    Updates: 0
2022-08-26 17:09:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431880885243904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:09:05.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431901823209472 [0;39m 生成今日电子书快照开始
2022-08-26 17:09:05.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431901823209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:09:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431901823209472 [0;39m ==> Parameters: 
2022-08-26 17:09:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431901823209472 [0;39m <==    Updates: 0
2022-08-26 17:09:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431901823209472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:09:05.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20431901831598080 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:09:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431901831598080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:09:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431901831598080 [0;39m ==> Parameters: 
2022-08-26 17:09:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20431901831598080 [0;39m <==    Updates: 8
2022-08-26 17:09:05.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20431901831598080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:09:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431922815700992 [0;39m 生成今日电子书快照开始
2022-08-26 17:09:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431922815700992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:09:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431922815700992 [0;39m ==> Parameters: 
2022-08-26 17:09:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431922815700992 [0;39m <==    Updates: 0
2022-08-26 17:09:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431922815700992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:09:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431943783026688 [0;39m 生成今日电子书快照开始
2022-08-26 17:09:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431943783026688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:09:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431943783026688 [0;39m ==> Parameters: 
2022-08-26 17:09:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431943783026688 [0;39m <==    Updates: 0
2022-08-26 17:09:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431943783026688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:09:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431964737769472 [0;39m 生成今日电子书快照开始
2022-08-26 17:09:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431964737769472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:09:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431964737769472 [0;39m ==> Parameters: 
2022-08-26 17:09:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431964737769472 [0;39m <==    Updates: 0
2022-08-26 17:09:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431964737769472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:09:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20431985768009728 [0;39m 生成今日电子书快照开始
2022-08-26 17:09:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431985768009728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:09:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431985768009728 [0;39m ==> Parameters: 
2022-08-26 17:09:25.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20431985768009728 [0;39m <==    Updates: 0
2022-08-26 17:09:25.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20431985768009728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:09:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432006743724032 [0;39m 生成今日电子书快照开始
2022-08-26 17:09:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432006743724032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:09:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432006743724032 [0;39m ==> Parameters: 
2022-08-26 17:09:30.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432006743724032 [0;39m <==    Updates: 0
2022-08-26 17:09:30.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432006743724032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:09:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20432027690078208 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:09:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432027690078208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:09:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432027690078208 [0;39m ==> Parameters: 
2022-08-26 17:09:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432027690078208 [0;39m <==    Updates: 8
2022-08-26 17:09:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20432027690078208 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 17:09:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432027715244032 [0;39m 生成今日电子书快照开始
2022-08-26 17:09:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432027715244032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:09:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432027715244032 [0;39m ==> Parameters: 
2022-08-26 17:09:35.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432027715244032 [0;39m <==    Updates: 0
2022-08-26 17:09:35.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432027715244032 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:09:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432048657403904 [0;39m 生成今日电子书快照开始
2022-08-26 17:09:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432048657403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:09:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432048657403904 [0;39m ==> Parameters: 
2022-08-26 17:09:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432048657403904 [0;39m <==    Updates: 0
2022-08-26 17:09:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432048657403904 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:09:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432069607952384 [0;39m 生成今日电子书快照开始
2022-08-26 17:09:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432069607952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:09:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432069607952384 [0;39m ==> Parameters: 
2022-08-26 17:09:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432069607952384 [0;39m <==    Updates: 0
2022-08-26 17:09:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432069607952384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:09:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432090625609728 [0;39m 生成今日电子书快照开始
2022-08-26 17:09:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432090625609728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:09:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432090625609728 [0;39m ==> Parameters: 
2022-08-26 17:09:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432090625609728 [0;39m <==    Updates: 0
2022-08-26 17:09:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432090625609728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:09:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432111584546816 [0;39m 生成今日电子书快照开始
2022-08-26 17:09:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432111584546816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:09:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432111584546816 [0;39m ==> Parameters: 
2022-08-26 17:09:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432111584546816 [0;39m <==    Updates: 0
2022-08-26 17:09:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432111584546816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:10:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432132514123776 [0;39m 生成今日电子书快照开始
2022-08-26 17:10:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432132514123776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:10:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432132514123776 [0;39m ==> Parameters: 
2022-08-26 17:10:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432132514123776 [0;39m <==    Updates: 0
2022-08-26 17:10:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432132514123776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:10:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20432153531781120 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:10:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432153531781120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:10:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432153531781120 [0;39m ==> Parameters: 
2022-08-26 17:10:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432153531781120 [0;39m <==    Updates: 8
2022-08-26 17:10:05.020 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20432153531781120 [0;39m 更新电子书下的文档数据结束，耗时：7 毫秒
2022-08-26 17:10:05.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432153561141248 [0;39m 生成今日电子书快照开始
2022-08-26 17:10:05.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432153561141248 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:10:05.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432153561141248 [0;39m ==> Parameters: 
2022-08-26 17:10:05.026 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432153561141248 [0;39m <==    Updates: 0
2022-08-26 17:10:05.026 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432153561141248 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:10:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432174494912512 [0;39m 生成今日电子书快照开始
2022-08-26 17:10:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432174494912512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:10:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432174494912512 [0;39m ==> Parameters: 
2022-08-26 17:10:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432174494912512 [0;39m <==    Updates: 0
2022-08-26 17:10:10.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432174494912512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:10:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432195483209728 [0;39m 生成今日电子书快照开始
2022-08-26 17:10:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432195483209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:10:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432195483209728 [0;39m ==> Parameters: 
2022-08-26 17:10:15.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432195483209728 [0;39m <==    Updates: 0
2022-08-26 17:10:15.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432195483209728 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:10:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432216421175296 [0;39m 生成今日电子书快照开始
2022-08-26 17:10:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432216421175296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:10:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432216421175296 [0;39m ==> Parameters: 
2022-08-26 17:10:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432216421175296 [0;39m <==    Updates: 0
2022-08-26 17:10:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432216421175296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:10:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432237409472512 [0;39m 生成今日电子书快照开始
2022-08-26 17:10:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432237409472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:10:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432237409472512 [0;39m ==> Parameters: 
2022-08-26 17:10:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432237409472512 [0;39m <==    Updates: 0
2022-08-26 17:10:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432237409472512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:10:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432258389381120 [0;39m 生成今日电子书快照开始
2022-08-26 17:10:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432258389381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:10:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432258389381120 [0;39m ==> Parameters: 
2022-08-26 17:10:30.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432258389381120 [0;39m <==    Updates: 0
2022-08-26 17:10:30.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432258389381120 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:10:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20432279373484032 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:10:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432279373484032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:10:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432279373484032 [0;39m ==> Parameters: 
2022-08-26 17:10:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432279373484032 [0;39m <==    Updates: 8
2022-08-26 17:10:35.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20432279373484032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:10:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432279381872640 [0;39m 生成今日电子书快照开始
2022-08-26 17:10:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432279381872640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:10:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432279381872640 [0;39m ==> Parameters: 
2022-08-26 17:10:35.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432279381872640 [0;39m <==    Updates: 0
2022-08-26 17:10:35.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432279381872640 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:10:40.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432300277895168 [0;39m 生成今日电子书快照开始
2022-08-26 17:10:40.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432300277895168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:10:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432300277895168 [0;39m ==> Parameters: 
2022-08-26 17:10:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432300277895168 [0;39m <==    Updates: 0
2022-08-26 17:10:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432300277895168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:10:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432321274580992 [0;39m 生成今日电子书快照开始
2022-08-26 17:10:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432321274580992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:10:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432321274580992 [0;39m ==> Parameters: 
2022-08-26 17:10:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432321274580992 [0;39m <==    Updates: 0
2022-08-26 17:10:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432321274580992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:10:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432342258683904 [0;39m 生成今日电子书快照开始
2022-08-26 17:10:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432342258683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:10:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432342258683904 [0;39m ==> Parameters: 
2022-08-26 17:10:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432342258683904 [0;39m <==    Updates: 0
2022-08-26 17:10:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432342258683904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:10:55.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432363196649472 [0;39m 生成今日电子书快照开始
2022-08-26 17:10:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432363196649472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:10:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432363196649472 [0;39m ==> Parameters: 
2022-08-26 17:10:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432363196649472 [0;39m <==    Updates: 0
2022-08-26 17:10:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432363196649472 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:11:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432384176558080 [0;39m 生成今日电子书快照开始
2022-08-26 17:11:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432384176558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:11:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432384176558080 [0;39m ==> Parameters: 
2022-08-26 17:11:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432384176558080 [0;39m <==    Updates: 0
2022-08-26 17:11:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432384176558080 [0;39m 生成今日电子书快照结束，耗时：11 毫秒
2022-08-26 17:11:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432405160660992 [0;39m 生成今日电子书快照开始
2022-08-26 17:11:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432405160660992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:11:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432405160660992 [0;39m ==> Parameters: 
2022-08-26 17:11:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432405160660992 [0;39m <==    Updates: 0
2022-08-26 17:11:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432405160660992 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:11:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20432405194215424 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:11:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432405194215424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:11:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432405194215424 [0;39m ==> Parameters: 
2022-08-26 17:11:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432405194215424 [0;39m <==    Updates: 8
2022-08-26 17:11:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20432405194215424 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 17:11:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432426111209472 [0;39m 生成今日电子书快照开始
2022-08-26 17:11:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432426111209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:11:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432426111209472 [0;39m ==> Parameters: 
2022-08-26 17:11:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432426111209472 [0;39m <==    Updates: 0
2022-08-26 17:11:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432426111209472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:11:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432447141449728 [0;39m 生成今日电子书快照开始
2022-08-26 17:11:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432447141449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:11:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432447141449728 [0;39m ==> Parameters: 
2022-08-26 17:11:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432447141449728 [0;39m <==    Updates: 0
2022-08-26 17:11:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432447141449728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:11:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432468079415296 [0;39m 生成今日电子书快照开始
2022-08-26 17:11:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432468079415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:11:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432468079415296 [0;39m ==> Parameters: 
2022-08-26 17:11:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432468079415296 [0;39m <==    Updates: 0
2022-08-26 17:11:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432468079415296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:11:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432489063518208 [0;39m 生成今日电子书快照开始
2022-08-26 17:11:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432489063518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:11:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432489063518208 [0;39m ==> Parameters: 
2022-08-26 17:11:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432489063518208 [0;39m <==    Updates: 0
2022-08-26 17:11:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432489063518208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:11:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432510009872384 [0;39m 生成今日电子书快照开始
2022-08-26 17:11:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432510009872384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:11:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432510009872384 [0;39m ==> Parameters: 
2022-08-26 17:11:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432510009872384 [0;39m <==    Updates: 0
2022-08-26 17:11:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432510009872384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:11:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432530981392384 [0;39m 生成今日电子书快照开始
2022-08-26 17:11:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432530981392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:11:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432530981392384 [0;39m ==> Parameters: 
2022-08-26 17:11:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432530981392384 [0;39m <==    Updates: 0
2022-08-26 17:11:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432530981392384 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:11:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20432531019141120 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:11:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432531019141120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:11:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432531019141120 [0;39m ==> Parameters: 
2022-08-26 17:11:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432531019141120 [0;39m <==    Updates: 8
2022-08-26 17:11:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20432531019141120 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 17:11:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432551965495296 [0;39m 生成今日电子书快照开始
2022-08-26 17:11:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432551965495296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:11:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432551965495296 [0;39m ==> Parameters: 
2022-08-26 17:11:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432551965495296 [0;39m <==    Updates: 0
2022-08-26 17:11:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432551965495296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:11:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432572937015296 [0;39m 生成今日电子书快照开始
2022-08-26 17:11:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432572937015296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:11:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432572937015296 [0;39m ==> Parameters: 
2022-08-26 17:11:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432572937015296 [0;39m <==    Updates: 0
2022-08-26 17:11:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432572937015296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:11:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432593921118208 [0;39m 生成今日电子书快照开始
2022-08-26 17:11:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432593921118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:11:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432593921118208 [0;39m ==> Parameters: 
2022-08-26 17:11:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432593921118208 [0;39m <==    Updates: 0
2022-08-26 17:11:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432593921118208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:11:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432614892638208 [0;39m 生成今日电子书快照开始
2022-08-26 17:11:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432614892638208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:11:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432614892638208 [0;39m ==> Parameters: 
2022-08-26 17:11:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432614892638208 [0;39m <==    Updates: 0
2022-08-26 17:11:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432614892638208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:12:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432635851575296 [0;39m 生成今日电子书快照开始
2022-08-26 17:12:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432635851575296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:12:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432635851575296 [0;39m ==> Parameters: 
2022-08-26 17:12:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432635851575296 [0;39m <==    Updates: 0
2022-08-26 17:12:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432635851575296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:12:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432656839872512 [0;39m 生成今日电子书快照开始
2022-08-26 17:12:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432656839872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:12:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432656839872512 [0;39m ==> Parameters: 
2022-08-26 17:12:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432656839872512 [0;39m <==    Updates: 0
2022-08-26 17:12:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432656839872512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:12:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20432656848261120 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:12:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432656848261120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:12:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432656848261120 [0;39m ==> Parameters: 
2022-08-26 17:12:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432656848261120 [0;39m <==    Updates: 8
2022-08-26 17:12:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20432656848261120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:12:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432677807198208 [0;39m 生成今日电子书快照开始
2022-08-26 17:12:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432677807198208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:12:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432677807198208 [0;39m ==> Parameters: 
2022-08-26 17:12:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432677807198208 [0;39m <==    Updates: 0
2022-08-26 17:12:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432677807198208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:12:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432698782912512 [0;39m 生成今日电子书快照开始
2022-08-26 17:12:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432698782912512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:12:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432698782912512 [0;39m ==> Parameters: 
2022-08-26 17:12:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432698782912512 [0;39m <==    Updates: 0
2022-08-26 17:12:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432698782912512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:12:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432719716683776 [0;39m 生成今日电子书快照开始
2022-08-26 17:12:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432719716683776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:12:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432719716683776 [0;39m ==> Parameters: 
2022-08-26 17:12:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432719716683776 [0;39m <==    Updates: 0
2022-08-26 17:12:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432719716683776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:12:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432740713369600 [0;39m 生成今日电子书快照开始
2022-08-26 17:12:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432740713369600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:12:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432740713369600 [0;39m ==> Parameters: 
2022-08-26 17:12:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432740713369600 [0;39m <==    Updates: 0
2022-08-26 17:12:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432740713369600 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:12:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432761718444032 [0;39m 生成今日电子书快照开始
2022-08-26 17:12:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432761718444032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:12:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432761718444032 [0;39m ==> Parameters: 
2022-08-26 17:12:30.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432761718444032 [0;39m <==    Updates: 0
2022-08-26 17:12:30.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432761718444032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:12:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432782635438080 [0;39m 生成今日电子书快照开始
2022-08-26 17:12:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432782635438080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:12:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432782635438080 [0;39m ==> Parameters: 
2022-08-26 17:12:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432782635438080 [0;39m <==    Updates: 0
2022-08-26 17:12:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432782635438080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:12:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20432782639632384 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:12:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432782639632384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:12:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432782639632384 [0;39m ==> Parameters: 
2022-08-26 17:12:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432782639632384 [0;39m <==    Updates: 8
2022-08-26 17:12:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20432782639632384 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 17:12:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432803623735296 [0;39m 生成今日电子书快照开始
2022-08-26 17:12:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432803623735296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:12:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432803623735296 [0;39m ==> Parameters: 
2022-08-26 17:12:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432803623735296 [0;39m <==    Updates: 0
2022-08-26 17:12:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432803623735296 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:12:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432824603643904 [0;39m 生成今日电子书快照开始
2022-08-26 17:12:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432824603643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:12:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432824603643904 [0;39m ==> Parameters: 
2022-08-26 17:12:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432824603643904 [0;39m <==    Updates: 0
2022-08-26 17:12:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432824603643904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:12:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432845545803776 [0;39m 生成今日电子书快照开始
2022-08-26 17:12:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432845545803776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:12:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432845545803776 [0;39m ==> Parameters: 
2022-08-26 17:12:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432845545803776 [0;39m <==    Updates: 0
2022-08-26 17:12:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432845545803776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:12:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432866517323776 [0;39m 生成今日电子书快照开始
2022-08-26 17:12:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432866517323776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:12:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432866517323776 [0;39m ==> Parameters: 
2022-08-26 17:12:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432866517323776 [0;39m <==    Updates: 0
2022-08-26 17:12:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432866517323776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:13:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432887493038080 [0;39m 生成今日电子书快照开始
2022-08-26 17:13:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432887493038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:13:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432887493038080 [0;39m ==> Parameters: 
2022-08-26 17:13:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432887493038080 [0;39m <==    Updates: 0
2022-08-26 17:13:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432887493038080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:13:05.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20432908460363776 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:13:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432908460363776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:13:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432908460363776 [0;39m ==> Parameters: 
2022-08-26 17:13:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20432908460363776 [0;39m <==    Updates: 8
2022-08-26 17:13:05.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20432908460363776 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:13:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432908468752384 [0;39m 生成今日电子书快照开始
2022-08-26 17:13:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432908468752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:13:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432908468752384 [0;39m ==> Parameters: 
2022-08-26 17:13:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432908468752384 [0;39m <==    Updates: 0
2022-08-26 17:13:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432908468752384 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:13:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432929469632512 [0;39m 生成今日电子书快照开始
2022-08-26 17:13:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432929469632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:13:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432929469632512 [0;39m ==> Parameters: 
2022-08-26 17:13:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432929469632512 [0;39m <==    Updates: 0
2022-08-26 17:13:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432929469632512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:13:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432950457929728 [0;39m 生成今日电子书快照开始
2022-08-26 17:13:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432950457929728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:13:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432950457929728 [0;39m ==> Parameters: 
2022-08-26 17:13:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432950457929728 [0;39m <==    Updates: 0
2022-08-26 17:13:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432950457929728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:13:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432971404283904 [0;39m 生成今日电子书快照开始
2022-08-26 17:13:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432971404283904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:13:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432971404283904 [0;39m ==> Parameters: 
2022-08-26 17:13:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432971404283904 [0;39m <==    Updates: 0
2022-08-26 17:13:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432971404283904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:13:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20432992363220992 [0;39m 生成今日电子书快照开始
2022-08-26 17:13:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432992363220992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:13:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432992363220992 [0;39m ==> Parameters: 
2022-08-26 17:13:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20432992363220992 [0;39m <==    Updates: 0
2022-08-26 17:13:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20432992363220992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:13:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433013355712512 [0;39m 生成今日电子书快照开始
2022-08-26 17:13:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433013355712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:13:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433013355712512 [0;39m ==> Parameters: 
2022-08-26 17:13:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433013355712512 [0;39m <==    Updates: 0
2022-08-26 17:13:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433013355712512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:13:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433034323038208 [0;39m 生成今日电子书快照开始
2022-08-26 17:13:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433034323038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:13:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433034323038208 [0;39m ==> Parameters: 
2022-08-26 17:13:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433034323038208 [0;39m <==    Updates: 0
2022-08-26 17:13:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433034323038208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:13:35.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20433034331426816 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:13:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433034331426816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:13:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433034331426816 [0;39m ==> Parameters: 
2022-08-26 17:13:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433034331426816 [0;39m <==    Updates: 8
2022-08-26 17:13:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20433034331426816 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:13:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433055273586688 [0;39m 生成今日电子书快照开始
2022-08-26 17:13:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433055273586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:13:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433055273586688 [0;39m ==> Parameters: 
2022-08-26 17:13:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433055273586688 [0;39m <==    Updates: 0
2022-08-26 17:13:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433055273586688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:13:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433076291244032 [0;39m 生成今日电子书快照开始
2022-08-26 17:13:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433076291244032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:13:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433076291244032 [0;39m ==> Parameters: 
2022-08-26 17:13:45.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433076291244032 [0;39m <==    Updates: 0
2022-08-26 17:13:45.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433076291244032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:13:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433097208238080 [0;39m 生成今日电子书快照开始
2022-08-26 17:13:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433097208238080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:13:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433097208238080 [0;39m ==> Parameters: 
2022-08-26 17:13:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433097208238080 [0;39m <==    Updates: 0
2022-08-26 17:13:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433097208238080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:13:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433118217506816 [0;39m 生成今日电子书快照开始
2022-08-26 17:13:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433118217506816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:13:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433118217506816 [0;39m ==> Parameters: 
2022-08-26 17:13:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433118217506816 [0;39m <==    Updates: 0
2022-08-26 17:13:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433118217506816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:14:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433139159666688 [0;39m 生成今日电子书快照开始
2022-08-26 17:14:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433139159666688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:14:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433139159666688 [0;39m ==> Parameters: 
2022-08-26 17:14:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433139159666688 [0;39m <==    Updates: 0
2022-08-26 17:14:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433139159666688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:14:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20433160147963904 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:14:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433160147963904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:14:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433160147963904 [0;39m ==> Parameters: 
2022-08-26 17:14:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433160147963904 [0;39m <==    Updates: 8
2022-08-26 17:14:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20433160147963904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:14:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433160156352512 [0;39m 生成今日电子书快照开始
2022-08-26 17:14:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433160156352512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:14:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433160156352512 [0;39m ==> Parameters: 
2022-08-26 17:14:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433160156352512 [0;39m <==    Updates: 0
2022-08-26 17:14:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433160156352512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:14:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433181140455424 [0;39m 生成今日电子书快照开始
2022-08-26 17:14:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433181140455424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:14:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433181140455424 [0;39m ==> Parameters: 
2022-08-26 17:14:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433181140455424 [0;39m <==    Updates: 0
2022-08-26 17:14:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433181140455424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:14:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433202111975424 [0;39m 生成今日电子书快照开始
2022-08-26 17:14:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433202111975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:14:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433202111975424 [0;39m ==> Parameters: 
2022-08-26 17:14:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433202111975424 [0;39m <==    Updates: 0
2022-08-26 17:14:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433202111975424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:14:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433223049940992 [0;39m 生成今日电子书快照开始
2022-08-26 17:14:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433223049940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:14:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433223049940992 [0;39m ==> Parameters: 
2022-08-26 17:14:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433223049940992 [0;39m <==    Updates: 0
2022-08-26 17:14:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433223049940992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:14:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433244025655296 [0;39m 生成今日电子书快照开始
2022-08-26 17:14:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433244025655296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:14:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433244025655296 [0;39m ==> Parameters: 
2022-08-26 17:14:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433244025655296 [0;39m <==    Updates: 0
2022-08-26 17:14:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433244025655296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:14:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433264972009472 [0;39m 生成今日电子书快照开始
2022-08-26 17:14:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433264972009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:14:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433264972009472 [0;39m ==> Parameters: 
2022-08-26 17:14:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433264972009472 [0;39m <==    Updates: 0
2022-08-26 17:14:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433264972009472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:14:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20433285981278208 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:14:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433285981278208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:14:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433285981278208 [0;39m ==> Parameters: 
2022-08-26 17:14:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433285981278208 [0;39m <==    Updates: 8
2022-08-26 17:14:35.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20433285981278208 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:14:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433285985472512 [0;39m 生成今日电子书快照开始
2022-08-26 17:14:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433285985472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:14:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433285985472512 [0;39m ==> Parameters: 
2022-08-26 17:14:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433285985472512 [0;39m <==    Updates: 0
2022-08-26 17:14:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433285985472512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:14:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433306927632384 [0;39m 生成今日电子书快照开始
2022-08-26 17:14:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433306927632384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:14:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433306927632384 [0;39m ==> Parameters: 
2022-08-26 17:14:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433306927632384 [0;39m <==    Updates: 0
2022-08-26 17:14:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433306927632384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:14:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433327915929600 [0;39m 生成今日电子书快照开始
2022-08-26 17:14:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433327915929600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:14:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433327915929600 [0;39m ==> Parameters: 
2022-08-26 17:14:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433327915929600 [0;39m <==    Updates: 0
2022-08-26 17:14:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433327915929600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:14:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433348862283776 [0;39m 生成今日电子书快照开始
2022-08-26 17:14:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433348862283776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:14:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433348862283776 [0;39m ==> Parameters: 
2022-08-26 17:14:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433348862283776 [0;39m <==    Updates: 0
2022-08-26 17:14:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433348862283776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:14:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433369863163904 [0;39m 生成今日电子书快照开始
2022-08-26 17:14:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433369863163904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:14:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433369863163904 [0;39m ==> Parameters: 
2022-08-26 17:14:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433369863163904 [0;39m <==    Updates: 0
2022-08-26 17:14:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433369863163904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:15:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433390834683904 [0;39m 生成今日电子书快照开始
2022-08-26 17:15:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433390834683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:15:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433390834683904 [0;39m ==> Parameters: 
2022-08-26 17:15:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433390834683904 [0;39m <==    Updates: 0
2022-08-26 17:15:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433390834683904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:15:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433411806203904 [0;39m 生成今日电子书快照开始
2022-08-26 17:15:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433411806203904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:15:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433411806203904 [0;39m ==> Parameters: 
2022-08-26 17:15:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433411806203904 [0;39m <==    Updates: 0
2022-08-26 17:15:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433411806203904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:15:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20433411814592512 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:15:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433411814592512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:15:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433411814592512 [0;39m ==> Parameters: 
2022-08-26 17:15:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433411814592512 [0;39m <==    Updates: 8
2022-08-26 17:15:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20433411814592512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:15:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433432765140992 [0;39m 生成今日电子书快照开始
2022-08-26 17:15:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433432765140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:15:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433432765140992 [0;39m ==> Parameters: 
2022-08-26 17:15:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433432765140992 [0;39m <==    Updates: 0
2022-08-26 17:15:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433432765140992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:15:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433453766021120 [0;39m 生成今日电子书快照开始
2022-08-26 17:15:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433453766021120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:15:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433453766021120 [0;39m ==> Parameters: 
2022-08-26 17:15:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433453766021120 [0;39m <==    Updates: 0
2022-08-26 17:15:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433453766021120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:15:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433474687209472 [0;39m 生成今日电子书快照开始
2022-08-26 17:15:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433474687209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:15:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433474687209472 [0;39m ==> Parameters: 
2022-08-26 17:15:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433474687209472 [0;39m <==    Updates: 0
2022-08-26 17:15:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433474687209472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:15:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433495671312384 [0;39m 生成今日电子书快照开始
2022-08-26 17:15:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433495671312384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:15:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433495671312384 [0;39m ==> Parameters: 
2022-08-26 17:15:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433495671312384 [0;39m <==    Updates: 0
2022-08-26 17:15:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433495671312384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:15:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433516684775424 [0;39m 生成今日电子书快照开始
2022-08-26 17:15:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433516684775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:15:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433516684775424 [0;39m ==> Parameters: 
2022-08-26 17:15:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433516684775424 [0;39m <==    Updates: 0
2022-08-26 17:15:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433516684775424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:15:35.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433537601769472 [0;39m 生成今日电子书快照开始
2022-08-26 17:15:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433537601769472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:15:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433537601769472 [0;39m ==> Parameters: 
2022-08-26 17:15:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433537601769472 [0;39m <==    Updates: 0
2022-08-26 17:15:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433537601769472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:15:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20433537614352384 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:15:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433537614352384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:15:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433537614352384 [0;39m ==> Parameters: 
2022-08-26 17:15:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433537614352384 [0;39m <==    Updates: 8
2022-08-26 17:15:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20433537614352384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:15:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433558623621120 [0;39m 生成今日电子书快照开始
2022-08-26 17:15:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433558623621120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:15:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433558623621120 [0;39m ==> Parameters: 
2022-08-26 17:15:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433558623621120 [0;39m <==    Updates: 0
2022-08-26 17:15:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433558623621120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:15:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433579574169600 [0;39m 生成今日电子书快照开始
2022-08-26 17:15:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433579574169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:15:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433579574169600 [0;39m ==> Parameters: 
2022-08-26 17:15:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433579574169600 [0;39m <==    Updates: 0
2022-08-26 17:15:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433579574169600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:15:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433600562466816 [0;39m 生成今日电子书快照开始
2022-08-26 17:15:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433600562466816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:15:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433600562466816 [0;39m ==> Parameters: 
2022-08-26 17:15:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433600562466816 [0;39m <==    Updates: 0
2022-08-26 17:15:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433600562466816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:15:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433621533986816 [0;39m 生成今日电子书快照开始
2022-08-26 17:15:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433621533986816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:15:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433621533986816 [0;39m ==> Parameters: 
2022-08-26 17:15:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433621533986816 [0;39m <==    Updates: 0
2022-08-26 17:15:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433621533986816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:16:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433642480340992 [0;39m 生成今日电子书快照开始
2022-08-26 17:16:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433642480340992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:16:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433642480340992 [0;39m ==> Parameters: 
2022-08-26 17:16:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433642480340992 [0;39m <==    Updates: 0
2022-08-26 17:16:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433642480340992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:16:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20433663489609728 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:16:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433663489609728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:16:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433663489609728 [0;39m ==> Parameters: 
2022-08-26 17:16:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433663489609728 [0;39m <==    Updates: 8
2022-08-26 17:16:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20433663489609728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:16:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433663493804032 [0;39m 生成今日电子书快照开始
2022-08-26 17:16:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433663493804032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:16:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433663493804032 [0;39m ==> Parameters: 
2022-08-26 17:16:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433663493804032 [0;39m <==    Updates: 0
2022-08-26 17:16:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433663493804032 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:16:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433684444352512 [0;39m 生成今日电子书快照开始
2022-08-26 17:16:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433684444352512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:16:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433684444352512 [0;39m ==> Parameters: 
2022-08-26 17:16:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433684444352512 [0;39m <==    Updates: 0
2022-08-26 17:16:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433684444352512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:16:15.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433705369735168 [0;39m 生成今日电子书快照开始
2022-08-26 17:16:15.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433705369735168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:16:15.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433705369735168 [0;39m ==> Parameters: 
2022-08-26 17:16:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433705369735168 [0;39m <==    Updates: 0
2022-08-26 17:16:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433705369735168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:16:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433726370615296 [0;39m 生成今日电子书快照开始
2022-08-26 17:16:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433726370615296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:16:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433726370615296 [0;39m ==> Parameters: 
2022-08-26 17:16:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433726370615296 [0;39m <==    Updates: 0
2022-08-26 17:16:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433726370615296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:16:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433747367301120 [0;39m 生成今日电子书快照开始
2022-08-26 17:16:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433747367301120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:16:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433747367301120 [0;39m ==> Parameters: 
2022-08-26 17:16:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433747367301120 [0;39m <==    Updates: 0
2022-08-26 17:16:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433747367301120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:16:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433768322043904 [0;39m 生成今日电子书快照开始
2022-08-26 17:16:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433768322043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:16:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433768322043904 [0;39m ==> Parameters: 
2022-08-26 17:16:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433768322043904 [0;39m <==    Updates: 0
2022-08-26 17:16:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433768322043904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:16:35.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433789260009472 [0;39m 生成今日电子书快照开始
2022-08-26 17:16:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433789260009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:16:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433789260009472 [0;39m ==> Parameters: 
2022-08-26 17:16:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433789260009472 [0;39m <==    Updates: 0
2022-08-26 17:16:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433789260009472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:16:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20433789268398080 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:16:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433789268398080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:16:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433789268398080 [0;39m ==> Parameters: 
2022-08-26 17:16:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433789268398080 [0;39m <==    Updates: 8
2022-08-26 17:16:35.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20433789268398080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:16:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433810256695296 [0;39m 生成今日电子书快照开始
2022-08-26 17:16:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433810256695296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:16:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433810256695296 [0;39m ==> Parameters: 
2022-08-26 17:16:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433810256695296 [0;39m <==    Updates: 0
2022-08-26 17:16:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433810256695296 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:16:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433831211438080 [0;39m 生成今日电子书快照开始
2022-08-26 17:16:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433831211438080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:16:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433831211438080 [0;39m ==> Parameters: 
2022-08-26 17:16:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433831211438080 [0;39m <==    Updates: 0
2022-08-26 17:16:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433831211438080 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:16:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433852178763776 [0;39m 生成今日电子书快照开始
2022-08-26 17:16:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433852178763776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:16:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433852178763776 [0;39m ==> Parameters: 
2022-08-26 17:16:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433852178763776 [0;39m <==    Updates: 0
2022-08-26 17:16:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433852178763776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:16:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433873200615424 [0;39m 生成今日电子书快照开始
2022-08-26 17:16:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433873200615424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:16:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433873200615424 [0;39m ==> Parameters: 
2022-08-26 17:16:55.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433873200615424 [0;39m <==    Updates: 0
2022-08-26 17:16:55.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433873200615424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:17:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433894163746816 [0;39m 生成今日电子书快照开始
2022-08-26 17:17:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433894163746816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:17:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433894163746816 [0;39m ==> Parameters: 
2022-08-26 17:17:00.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433894163746816 [0;39m <==    Updates: 0
2022-08-26 17:17:00.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433894163746816 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 17:17:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433915097518080 [0;39m 生成今日电子书快照开始
2022-08-26 17:17:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433915097518080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:17:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433915097518080 [0;39m ==> Parameters: 
2022-08-26 17:17:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433915097518080 [0;39m <==    Updates: 0
2022-08-26 17:17:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433915097518080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:17:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20433915105906688 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:17:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433915105906688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:17:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433915105906688 [0;39m ==> Parameters: 
2022-08-26 17:17:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20433915105906688 [0;39m <==    Updates: 8
2022-08-26 17:17:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20433915105906688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:17:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433936060649472 [0;39m 生成今日电子书快照开始
2022-08-26 17:17:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433936060649472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:17:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433936060649472 [0;39m ==> Parameters: 
2022-08-26 17:17:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433936060649472 [0;39m <==    Updates: 0
2022-08-26 17:17:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433936060649472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:17:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433957057335296 [0;39m 生成今日电子书快照开始
2022-08-26 17:17:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433957057335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:17:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433957057335296 [0;39m ==> Parameters: 
2022-08-26 17:17:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433957057335296 [0;39m <==    Updates: 0
2022-08-26 17:17:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433957057335296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:17:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433978049826816 [0;39m 生成今日电子书快照开始
2022-08-26 17:17:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433978049826816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:17:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433978049826816 [0;39m ==> Parameters: 
2022-08-26 17:17:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433978049826816 [0;39m <==    Updates: 0
2022-08-26 17:17:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433978049826816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:17:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20433998983598080 [0;39m 生成今日电子书快照开始
2022-08-26 17:17:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433998983598080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:17:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433998983598080 [0;39m ==> Parameters: 
2022-08-26 17:17:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20433998983598080 [0;39m <==    Updates: 0
2022-08-26 17:17:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20433998983598080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:17:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434019946729472 [0;39m 生成今日电子书快照开始
2022-08-26 17:17:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434019946729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:17:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434019946729472 [0;39m ==> Parameters: 
2022-08-26 17:17:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434019946729472 [0;39m <==    Updates: 0
2022-08-26 17:17:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434019946729472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:17:35.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20434040918249472 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:17:35.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434040918249472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:17:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434040918249472 [0;39m ==> Parameters: 
2022-08-26 17:17:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434040918249472 [0;39m <==    Updates: 8
2022-08-26 17:17:35.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20434040918249472 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:17:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434040926638080 [0;39m 生成今日电子书快照开始
2022-08-26 17:17:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434040926638080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:17:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434040926638080 [0;39m ==> Parameters: 
2022-08-26 17:17:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434040926638080 [0;39m <==    Updates: 0
2022-08-26 17:17:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434040926638080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:17:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434061893963776 [0;39m 生成今日电子书快照开始
2022-08-26 17:17:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434061893963776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:17:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434061893963776 [0;39m ==> Parameters: 
2022-08-26 17:17:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434061893963776 [0;39m <==    Updates: 0
2022-08-26 17:17:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434061893963776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:17:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434082903232512 [0;39m 生成今日电子书快照开始
2022-08-26 17:17:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434082903232512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:17:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434082903232512 [0;39m ==> Parameters: 
2022-08-26 17:17:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434082903232512 [0;39m <==    Updates: 0
2022-08-26 17:17:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434082903232512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:17:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434103866363904 [0;39m 生成今日电子书快照开始
2022-08-26 17:17:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434103866363904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:17:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434103866363904 [0;39m ==> Parameters: 
2022-08-26 17:17:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434103866363904 [0;39m <==    Updates: 0
2022-08-26 17:17:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434103866363904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:17:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434124863049728 [0;39m 生成今日电子书快照开始
2022-08-26 17:17:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434124863049728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:17:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434124863049728 [0;39m ==> Parameters: 
2022-08-26 17:17:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434124863049728 [0;39m <==    Updates: 0
2022-08-26 17:17:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434124863049728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:18:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434145821986816 [0;39m 生成今日电子书快照开始
2022-08-26 17:18:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434145821986816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:18:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434145821986816 [0;39m ==> Parameters: 
2022-08-26 17:18:00.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434145821986816 [0;39m <==    Updates: 0
2022-08-26 17:18:00.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434145821986816 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:18:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434166780923904 [0;39m 生成今日电子书快照开始
2022-08-26 17:18:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434166780923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:18:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434166780923904 [0;39m ==> Parameters: 
2022-08-26 17:18:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434166780923904 [0;39m <==    Updates: 0
2022-08-26 17:18:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434166780923904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:18:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20434166789312512 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:18:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434166789312512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:18:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434166789312512 [0;39m ==> Parameters: 
2022-08-26 17:18:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434166789312512 [0;39m <==    Updates: 8
2022-08-26 17:18:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20434166789312512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:18:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434187756638208 [0;39m 生成今日电子书快照开始
2022-08-26 17:18:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434187756638208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:18:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434187756638208 [0;39m ==> Parameters: 
2022-08-26 17:18:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434187756638208 [0;39m <==    Updates: 0
2022-08-26 17:18:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434187756638208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:18:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434208753324032 [0;39m 生成今日电子书快照开始
2022-08-26 17:18:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434208753324032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:18:15.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434208753324032 [0;39m ==> Parameters: 
2022-08-26 17:18:15.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434208753324032 [0;39m <==    Updates: 0
2022-08-26 17:18:15.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434208753324032 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:18:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434229703872512 [0;39m 生成今日电子书快照开始
2022-08-26 17:18:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434229703872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:18:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434229703872512 [0;39m ==> Parameters: 
2022-08-26 17:18:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434229703872512 [0;39m <==    Updates: 0
2022-08-26 17:18:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434229703872512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:18:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434250679586816 [0;39m 生成今日电子书快照开始
2022-08-26 17:18:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434250679586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:18:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434250679586816 [0;39m ==> Parameters: 
2022-08-26 17:18:25.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434250679586816 [0;39m <==    Updates: 0
2022-08-26 17:18:25.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434250679586816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:18:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434271617552384 [0;39m 生成今日电子书快照开始
2022-08-26 17:18:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434271617552384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:18:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434271617552384 [0;39m ==> Parameters: 
2022-08-26 17:18:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434271617552384 [0;39m <==    Updates: 0
2022-08-26 17:18:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434271617552384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:18:35.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20434292580683776 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:18:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434292580683776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:18:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434292580683776 [0;39m ==> Parameters: 
2022-08-26 17:18:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434292580683776 [0;39m <==    Updates: 8
2022-08-26 17:18:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20434292580683776 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 17:18:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434292605849600 [0;39m 生成今日电子书快照开始
2022-08-26 17:18:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434292605849600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:18:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434292605849600 [0;39m ==> Parameters: 
2022-08-26 17:18:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434292605849600 [0;39m <==    Updates: 0
2022-08-26 17:18:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434292605849600 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:18:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434313581563904 [0;39m 生成今日电子书快照开始
2022-08-26 17:18:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434313581563904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:18:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434313581563904 [0;39m ==> Parameters: 
2022-08-26 17:18:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434313581563904 [0;39m <==    Updates: 0
2022-08-26 17:18:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434313581563904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:18:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434334536306688 [0;39m 生成今日电子书快照开始
2022-08-26 17:18:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434334536306688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:18:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434334536306688 [0;39m ==> Parameters: 
2022-08-26 17:18:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434334536306688 [0;39m <==    Updates: 0
2022-08-26 17:18:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434334536306688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:18:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434355532992512 [0;39m 生成今日电子书快照开始
2022-08-26 17:18:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434355532992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:18:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434355532992512 [0;39m ==> Parameters: 
2022-08-26 17:18:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434355532992512 [0;39m <==    Updates: 0
2022-08-26 17:18:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434355532992512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:18:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434376479346688 [0;39m 生成今日电子书快照开始
2022-08-26 17:18:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434376479346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:18:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434376479346688 [0;39m ==> Parameters: 
2022-08-26 17:18:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434376479346688 [0;39m <==    Updates: 0
2022-08-26 17:18:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434376479346688 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:19:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434397497004032 [0;39m 生成今日电子书快照开始
2022-08-26 17:19:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434397497004032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:19:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434397497004032 [0;39m ==> Parameters: 
2022-08-26 17:19:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434397497004032 [0;39m <==    Updates: 0
2022-08-26 17:19:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434397497004032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:19:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434418443358208 [0;39m 生成今日电子书快照开始
2022-08-26 17:19:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434418443358208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:19:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434418443358208 [0;39m ==> Parameters: 
2022-08-26 17:19:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434418443358208 [0;39m <==    Updates: 0
2022-08-26 17:19:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434418443358208 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:19:05.019 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20434418481106944 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:19:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434418481106944 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:19:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434418481106944 [0;39m ==> Parameters: 
2022-08-26 17:19:05.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434418481106944 [0;39m <==    Updates: 8
2022-08-26 17:19:05.023 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20434418481106944 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 17:19:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434439377129472 [0;39m 生成今日电子书快照开始
2022-08-26 17:19:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434439377129472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:19:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434439377129472 [0;39m ==> Parameters: 
2022-08-26 17:19:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434439377129472 [0;39m <==    Updates: 0
2022-08-26 17:19:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434439377129472 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:19:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434460394786816 [0;39m 生成今日电子书快照开始
2022-08-26 17:19:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434460394786816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:19:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434460394786816 [0;39m ==> Parameters: 
2022-08-26 17:19:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434460394786816 [0;39m <==    Updates: 0
2022-08-26 17:19:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434460394786816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:19:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434481362112512 [0;39m 生成今日电子书快照开始
2022-08-26 17:19:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434481362112512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:19:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434481362112512 [0;39m ==> Parameters: 
2022-08-26 17:19:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434481362112512 [0;39m <==    Updates: 0
2022-08-26 17:19:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434481362112512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:19:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434502321049600 [0;39m 生成今日电子书快照开始
2022-08-26 17:19:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434502321049600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:19:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434502321049600 [0;39m ==> Parameters: 
2022-08-26 17:19:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434502321049600 [0;39m <==    Updates: 0
2022-08-26 17:19:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434502321049600 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:19:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434523271598080 [0;39m 生成今日电子书快照开始
2022-08-26 17:19:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434523271598080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:19:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434523271598080 [0;39m ==> Parameters: 
2022-08-26 17:19:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434523271598080 [0;39m <==    Updates: 0
2022-08-26 17:19:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434523271598080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:19:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20434544247312384 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:19:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434544247312384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:19:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434544247312384 [0;39m ==> Parameters: 
2022-08-26 17:19:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434544247312384 [0;39m <==    Updates: 8
2022-08-26 17:19:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20434544247312384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:19:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434544255700992 [0;39m 生成今日电子书快照开始
2022-08-26 17:19:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434544255700992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:19:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434544255700992 [0;39m ==> Parameters: 
2022-08-26 17:19:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434544255700992 [0;39m <==    Updates: 0
2022-08-26 17:19:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434544255700992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:19:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434565248192512 [0;39m 生成今日电子书快照开始
2022-08-26 17:19:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434565248192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:19:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434565248192512 [0;39m ==> Parameters: 
2022-08-26 17:19:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434565248192512 [0;39m <==    Updates: 0
2022-08-26 17:19:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434565248192512 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:19:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434586219712512 [0;39m 生成今日电子书快照开始
2022-08-26 17:19:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434586219712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:19:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434586219712512 [0;39m ==> Parameters: 
2022-08-26 17:19:45.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434586219712512 [0;39m <==    Updates: 0
2022-08-26 17:19:45.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434586219712512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:19:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434607203815424 [0;39m 生成今日电子书快照开始
2022-08-26 17:19:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434607203815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:19:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434607203815424 [0;39m ==> Parameters: 
2022-08-26 17:19:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434607203815424 [0;39m <==    Updates: 0
2022-08-26 17:19:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434607203815424 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:19:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434628175335424 [0;39m 生成今日电子书快照开始
2022-08-26 17:19:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434628175335424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:19:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434628175335424 [0;39m ==> Parameters: 
2022-08-26 17:19:55.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434628175335424 [0;39m <==    Updates: 0
2022-08-26 17:19:55.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434628175335424 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:20:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434649092329472 [0;39m 生成今日电子书快照开始
2022-08-26 17:20:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434649092329472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:20:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434649092329472 [0;39m ==> Parameters: 
2022-08-26 17:20:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434649092329472 [0;39m <==    Updates: 0
2022-08-26 17:20:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434649092329472 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:20:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20434670101598208 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:20:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434670101598208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:20:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434670101598208 [0;39m ==> Parameters: 
2022-08-26 17:20:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434670101598208 [0;39m <==    Updates: 8
2022-08-26 17:20:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20434670101598208 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-26 17:20:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434670130958336 [0;39m 生成今日电子书快照开始
2022-08-26 17:20:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434670130958336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:20:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434670130958336 [0;39m ==> Parameters: 
2022-08-26 17:20:05.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434670130958336 [0;39m <==    Updates: 0
2022-08-26 17:20:05.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434670130958336 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:20:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434691056340992 [0;39m 生成今日电子书快照开始
2022-08-26 17:20:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434691056340992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:20:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434691056340992 [0;39m ==> Parameters: 
2022-08-26 17:20:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434691056340992 [0;39m <==    Updates: 0
2022-08-26 17:20:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434691056340992 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:20:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434712040443904 [0;39m 生成今日电子书快照开始
2022-08-26 17:20:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434712040443904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:20:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434712040443904 [0;39m ==> Parameters: 
2022-08-26 17:20:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434712040443904 [0;39m <==    Updates: 0
2022-08-26 17:20:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434712040443904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:20:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434732995186688 [0;39m 生成今日电子书快照开始
2022-08-26 17:20:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434732995186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:20:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434732995186688 [0;39m ==> Parameters: 
2022-08-26 17:20:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434732995186688 [0;39m <==    Updates: 0
2022-08-26 17:20:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434732995186688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:20:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434753958318080 [0;39m 生成今日电子书快照开始
2022-08-26 17:20:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434753958318080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:20:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434753958318080 [0;39m ==> Parameters: 
2022-08-26 17:20:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434753958318080 [0;39m <==    Updates: 0
2022-08-26 17:20:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434753958318080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:20:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434774967586816 [0;39m 生成今日电子书快照开始
2022-08-26 17:20:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434774967586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:20:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434774967586816 [0;39m ==> Parameters: 
2022-08-26 17:20:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434774967586816 [0;39m <==    Updates: 0
2022-08-26 17:20:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434774967586816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:20:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434795909746688 [0;39m 生成今日电子书快照开始
2022-08-26 17:20:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434795909746688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:20:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434795909746688 [0;39m ==> Parameters: 
2022-08-26 17:20:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434795909746688 [0;39m <==    Updates: 0
2022-08-26 17:20:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434795909746688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:20:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20434795918135296 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:20:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434795918135296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:20:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434795918135296 [0;39m ==> Parameters: 
2022-08-26 17:20:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434795918135296 [0;39m <==    Updates: 8
2022-08-26 17:20:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20434795918135296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:20:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434816902238208 [0;39m 生成今日电子书快照开始
2022-08-26 17:20:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434816902238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:20:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434816902238208 [0;39m ==> Parameters: 
2022-08-26 17:20:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434816902238208 [0;39m <==    Updates: 0
2022-08-26 17:20:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434816902238208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:20:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434837890535424 [0;39m 生成今日电子书快照开始
2022-08-26 17:20:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434837890535424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:20:45.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434837890535424 [0;39m ==> Parameters: 
2022-08-26 17:20:45.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434837890535424 [0;39m <==    Updates: 0
2022-08-26 17:20:45.025 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434837890535424 [0;39m 生成今日电子书快照结束，耗时：11 毫秒
2022-08-26 17:20:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434858828500992 [0;39m 生成今日电子书快照开始
2022-08-26 17:20:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434858828500992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:20:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434858828500992 [0;39m ==> Parameters: 
2022-08-26 17:20:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434858828500992 [0;39m <==    Updates: 0
2022-08-26 17:20:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434858828500992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:20:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434879800020992 [0;39m 生成今日电子书快照开始
2022-08-26 17:20:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434879800020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:20:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434879800020992 [0;39m ==> Parameters: 
2022-08-26 17:20:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434879800020992 [0;39m <==    Updates: 0
2022-08-26 17:20:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434879800020992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:21:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434900758958080 [0;39m 生成今日电子书快照开始
2022-08-26 17:21:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434900758958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:21:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434900758958080 [0;39m ==> Parameters: 
2022-08-26 17:21:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434900758958080 [0;39m <==    Updates: 0
2022-08-26 17:21:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434900758958080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:21:05.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20434921722089472 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:21:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434921722089472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:21:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434921722089472 [0;39m ==> Parameters: 
2022-08-26 17:21:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20434921722089472 [0;39m <==    Updates: 8
2022-08-26 17:21:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20434921722089472 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-26 17:21:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434921747255296 [0;39m 生成今日电子书快照开始
2022-08-26 17:21:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434921747255296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:21:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434921747255296 [0;39m ==> Parameters: 
2022-08-26 17:21:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434921747255296 [0;39m <==    Updates: 0
2022-08-26 17:21:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434921747255296 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:21:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434942731358208 [0;39m 生成今日电子书快照开始
2022-08-26 17:21:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434942731358208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:21:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434942731358208 [0;39m ==> Parameters: 
2022-08-26 17:21:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434942731358208 [0;39m <==    Updates: 0
2022-08-26 17:21:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434942731358208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:21:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434963698683904 [0;39m 生成今日电子书快照开始
2022-08-26 17:21:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434963698683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:21:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434963698683904 [0;39m ==> Parameters: 
2022-08-26 17:21:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434963698683904 [0;39m <==    Updates: 0
2022-08-26 17:21:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434963698683904 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:21:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20434984695369728 [0;39m 生成今日电子书快照开始
2022-08-26 17:21:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434984695369728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:21:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434984695369728 [0;39m ==> Parameters: 
2022-08-26 17:21:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20434984695369728 [0;39m <==    Updates: 0
2022-08-26 17:21:20.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20434984695369728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:21:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435005612363776 [0;39m 生成今日电子书快照开始
2022-08-26 17:21:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435005612363776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:21:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435005612363776 [0;39m ==> Parameters: 
2022-08-26 17:21:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435005612363776 [0;39m <==    Updates: 0
2022-08-26 17:21:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435005612363776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:21:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435026596466688 [0;39m 生成今日电子书快照开始
2022-08-26 17:21:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435026596466688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:21:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435026596466688 [0;39m ==> Parameters: 
2022-08-26 17:21:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435026596466688 [0;39m <==    Updates: 0
2022-08-26 17:21:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435026596466688 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:21:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435047601541120 [0;39m 生成今日电子书快照开始
2022-08-26 17:21:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435047601541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:21:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435047601541120 [0;39m ==> Parameters: 
2022-08-26 17:21:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435047601541120 [0;39m <==    Updates: 0
2022-08-26 17:21:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435047601541120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:21:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20435047614124032 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:21:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435047614124032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:21:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435047614124032 [0;39m ==> Parameters: 
2022-08-26 17:21:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435047614124032 [0;39m <==    Updates: 8
2022-08-26 17:21:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20435047614124032 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:21:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435068535312384 [0;39m 生成今日电子书快照开始
2022-08-26 17:21:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435068535312384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:21:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435068535312384 [0;39m ==> Parameters: 
2022-08-26 17:21:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435068535312384 [0;39m <==    Updates: 0
2022-08-26 17:21:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435068535312384 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:21:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435089531998208 [0;39m 生成今日电子书快照开始
2022-08-26 17:21:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435089531998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:21:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435089531998208 [0;39m ==> Parameters: 
2022-08-26 17:21:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435089531998208 [0;39m <==    Updates: 0
2022-08-26 17:21:45.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435089531998208 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:21:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435110490935296 [0;39m 生成今日电子书快照开始
2022-08-26 17:21:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435110490935296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:21:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435110490935296 [0;39m ==> Parameters: 
2022-08-26 17:21:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435110490935296 [0;39m <==    Updates: 0
2022-08-26 17:21:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435110490935296 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:21:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435131475038208 [0;39m 生成今日电子书快照开始
2022-08-26 17:21:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435131475038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:21:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435131475038208 [0;39m ==> Parameters: 
2022-08-26 17:21:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435131475038208 [0;39m <==    Updates: 0
2022-08-26 17:21:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435131475038208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:22:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435152429780992 [0;39m 生成今日电子书快照开始
2022-08-26 17:22:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435152429780992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:22:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435152429780992 [0;39m ==> Parameters: 
2022-08-26 17:22:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435152429780992 [0;39m <==    Updates: 0
2022-08-26 17:22:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435152429780992 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 17:22:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20435173397106688 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:22:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435173397106688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:22:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435173397106688 [0;39m ==> Parameters: 
2022-08-26 17:22:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435173397106688 [0;39m <==    Updates: 8
2022-08-26 17:22:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20435173397106688 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-26 17:22:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435173426466816 [0;39m 生成今日电子书快照开始
2022-08-26 17:22:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435173426466816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:22:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435173426466816 [0;39m ==> Parameters: 
2022-08-26 17:22:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435173426466816 [0;39m <==    Updates: 0
2022-08-26 17:22:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435173426466816 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:22:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435194381209600 [0;39m 生成今日电子书快照开始
2022-08-26 17:22:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435194381209600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:22:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435194381209600 [0;39m ==> Parameters: 
2022-08-26 17:22:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435194381209600 [0;39m <==    Updates: 0
2022-08-26 17:22:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435194381209600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:22:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435215335952384 [0;39m 生成今日电子书快照开始
2022-08-26 17:22:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435215335952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:22:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435215335952384 [0;39m ==> Parameters: 
2022-08-26 17:22:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435215335952384 [0;39m <==    Updates: 0
2022-08-26 17:22:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435215335952384 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:22:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435236294889472 [0;39m 生成今日电子书快照开始
2022-08-26 17:22:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435236294889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:22:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435236294889472 [0;39m ==> Parameters: 
2022-08-26 17:22:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435236294889472 [0;39m <==    Updates: 0
2022-08-26 17:22:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435236294889472 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:22:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435257316741120 [0;39m 生成今日电子书快照开始
2022-08-26 17:22:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435257316741120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:22:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435257316741120 [0;39m ==> Parameters: 
2022-08-26 17:22:25.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435257316741120 [0;39m <==    Updates: 0
2022-08-26 17:22:25.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435257316741120 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:22:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435278263095296 [0;39m 生成今日电子书快照开始
2022-08-26 17:22:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435278263095296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:22:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435278263095296 [0;39m ==> Parameters: 
2022-08-26 17:22:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435278263095296 [0;39m <==    Updates: 0
2022-08-26 17:22:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435278263095296 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:22:35.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435299205255168 [0;39m 生成今日电子书快照开始
2022-08-26 17:22:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435299205255168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:22:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435299205255168 [0;39m ==> Parameters: 
2022-08-26 17:22:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435299205255168 [0;39m <==    Updates: 0
2022-08-26 17:22:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435299205255168 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:22:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20435299238809600 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:22:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435299238809600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:22:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435299238809600 [0;39m ==> Parameters: 
2022-08-26 17:22:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435299238809600 [0;39m <==    Updates: 8
2022-08-26 17:22:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20435299238809600 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 17:22:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435320214523904 [0;39m 生成今日电子书快照开始
2022-08-26 17:22:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435320214523904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:22:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435320214523904 [0;39m ==> Parameters: 
2022-08-26 17:22:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435320214523904 [0;39m <==    Updates: 0
2022-08-26 17:22:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435320214523904 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:22:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435341169266688 [0;39m 生成今日电子书快照开始
2022-08-26 17:22:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435341169266688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:22:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435341169266688 [0;39m ==> Parameters: 
2022-08-26 17:22:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435341169266688 [0;39m <==    Updates: 0
2022-08-26 17:22:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435341169266688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:22:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435362182729728 [0;39m 生成今日电子书快照开始
2022-08-26 17:22:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435362182729728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:22:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435362182729728 [0;39m ==> Parameters: 
2022-08-26 17:22:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435362182729728 [0;39m <==    Updates: 0
2022-08-26 17:22:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435362182729728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:22:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435383112306688 [0;39m 生成今日电子书快照开始
2022-08-26 17:22:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435383112306688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:22:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435383112306688 [0;39m ==> Parameters: 
2022-08-26 17:22:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435383112306688 [0;39m <==    Updates: 0
2022-08-26 17:22:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435383112306688 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:23:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435404100603904 [0;39m 生成今日电子书快照开始
2022-08-26 17:23:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435404100603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:23:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435404100603904 [0;39m ==> Parameters: 
2022-08-26 17:23:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435404100603904 [0;39m <==    Updates: 0
2022-08-26 17:23:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435404100603904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:23:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435425080512512 [0;39m 生成今日电子书快照开始
2022-08-26 17:23:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435425080512512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:23:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435425080512512 [0;39m ==> Parameters: 
2022-08-26 17:23:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435425080512512 [0;39m <==    Updates: 0
2022-08-26 17:23:05.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435425080512512 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:23:05.019 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20435425114066944 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:23:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435425114066944 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:23:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435425114066944 [0;39m ==> Parameters: 
2022-08-26 17:23:05.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435425114066944 [0;39m <==    Updates: 8
2022-08-26 17:23:05.023 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20435425114066944 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 17:23:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435446056226816 [0;39m 生成今日电子书快照开始
2022-08-26 17:23:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435446056226816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:23:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435446056226816 [0;39m ==> Parameters: 
2022-08-26 17:23:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435446056226816 [0;39m <==    Updates: 0
2022-08-26 17:23:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435446056226816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:23:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435467006775296 [0;39m 生成今日电子书快照开始
2022-08-26 17:23:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435467006775296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:23:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435467006775296 [0;39m ==> Parameters: 
2022-08-26 17:23:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435467006775296 [0;39m <==    Updates: 0
2022-08-26 17:23:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435467006775296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:23:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435487961518080 [0;39m 生成今日电子书快照开始
2022-08-26 17:23:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435487961518080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:23:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435487961518080 [0;39m ==> Parameters: 
2022-08-26 17:23:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435487961518080 [0;39m <==    Updates: 0
2022-08-26 17:23:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435487961518080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:23:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435508924649472 [0;39m 生成今日电子书快照开始
2022-08-26 17:23:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435508924649472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:23:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435508924649472 [0;39m ==> Parameters: 
2022-08-26 17:23:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435508924649472 [0;39m <==    Updates: 0
2022-08-26 17:23:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435508924649472 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:23:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435529959084032 [0;39m 生成今日电子书快照开始
2022-08-26 17:23:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435529959084032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:23:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435529959084032 [0;39m ==> Parameters: 
2022-08-26 17:23:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435529959084032 [0;39m <==    Updates: 0
2022-08-26 17:23:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435529959084032 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:23:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20435550892855296 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:23:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435550892855296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:23:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435550892855296 [0;39m ==> Parameters: 
2022-08-26 17:23:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435550892855296 [0;39m <==    Updates: 8
2022-08-26 17:23:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20435550892855296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:23:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435550901243904 [0;39m 生成今日电子书快照开始
2022-08-26 17:23:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435550901243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:23:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435550901243904 [0;39m ==> Parameters: 
2022-08-26 17:23:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435550901243904 [0;39m <==    Updates: 0
2022-08-26 17:23:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435550901243904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:23:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435571893735424 [0;39m 生成今日电子书快照开始
2022-08-26 17:23:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435571893735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:23:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435571893735424 [0;39m ==> Parameters: 
2022-08-26 17:23:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435571893735424 [0;39m <==    Updates: 0
2022-08-26 17:23:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435571893735424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:23:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435592814923776 [0;39m 生成今日电子书快照开始
2022-08-26 17:23:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435592814923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:23:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435592814923776 [0;39m ==> Parameters: 
2022-08-26 17:23:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435592814923776 [0;39m <==    Updates: 0
2022-08-26 17:23:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435592814923776 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:23:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435613794832384 [0;39m 生成今日电子书快照开始
2022-08-26 17:23:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435613794832384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:23:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435613794832384 [0;39m ==> Parameters: 
2022-08-26 17:23:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435613794832384 [0;39m <==    Updates: 0
2022-08-26 17:23:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435613794832384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:23:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435634816684032 [0;39m 生成今日电子书快照开始
2022-08-26 17:23:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435634816684032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:23:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435634816684032 [0;39m ==> Parameters: 
2022-08-26 17:23:55.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435634816684032 [0;39m <==    Updates: 0
2022-08-26 17:23:55.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435634816684032 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:24:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435655784009728 [0;39m 生成今日电子书快照开始
2022-08-26 17:24:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435655784009728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:24:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435655784009728 [0;39m ==> Parameters: 
2022-08-26 17:24:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435655784009728 [0;39m <==    Updates: 0
2022-08-26 17:24:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435655784009728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:24:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435676755529728 [0;39m 生成今日电子书快照开始
2022-08-26 17:24:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435676755529728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:24:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435676755529728 [0;39m ==> Parameters: 
2022-08-26 17:24:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435676755529728 [0;39m <==    Updates: 0
2022-08-26 17:24:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435676755529728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:24:05.017 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20435676763918336 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:24:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435676763918336 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:24:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435676763918336 [0;39m ==> Parameters: 
2022-08-26 17:24:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435676763918336 [0;39m <==    Updates: 8
2022-08-26 17:24:05.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20435676763918336 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:24:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435697714466816 [0;39m 生成今日电子书快照开始
2022-08-26 17:24:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435697714466816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:24:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435697714466816 [0;39m ==> Parameters: 
2022-08-26 17:24:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435697714466816 [0;39m <==    Updates: 0
2022-08-26 17:24:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435697714466816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:24:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435718694375424 [0;39m 生成今日电子书快照开始
2022-08-26 17:24:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435718694375424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:24:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435718694375424 [0;39m ==> Parameters: 
2022-08-26 17:24:15.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435718694375424 [0;39m <==    Updates: 0
2022-08-26 17:24:15.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435718694375424 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:24:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435739623952384 [0;39m 生成今日电子书快照开始
2022-08-26 17:24:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435739623952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:24:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435739623952384 [0;39m ==> Parameters: 
2022-08-26 17:24:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435739623952384 [0;39m <==    Updates: 0
2022-08-26 17:24:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435739623952384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:24:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435760641609728 [0;39m 生成今日电子书快照开始
2022-08-26 17:24:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435760641609728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:24:25.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435760641609728 [0;39m ==> Parameters: 
2022-08-26 17:24:25.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435760641609728 [0;39m <==    Updates: 0
2022-08-26 17:24:25.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435760641609728 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:24:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435781587963904 [0;39m 生成今日电子书快照开始
2022-08-26 17:24:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435781587963904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:24:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435781587963904 [0;39m ==> Parameters: 
2022-08-26 17:24:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435781587963904 [0;39m <==    Updates: 0
2022-08-26 17:24:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435781587963904 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:24:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20435802538512384 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:24:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435802538512384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:24:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435802538512384 [0;39m ==> Parameters: 
2022-08-26 17:24:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435802538512384 [0;39m <==    Updates: 8
2022-08-26 17:24:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20435802538512384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:24:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435802546900992 [0;39m 生成今日电子书快照开始
2022-08-26 17:24:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435802546900992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:24:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435802546900992 [0;39m ==> Parameters: 
2022-08-26 17:24:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435802546900992 [0;39m <==    Updates: 0
2022-08-26 17:24:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435802546900992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:24:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435823505838080 [0;39m 生成今日电子书快照开始
2022-08-26 17:24:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435823505838080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:24:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435823505838080 [0;39m ==> Parameters: 
2022-08-26 17:24:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435823505838080 [0;39m <==    Updates: 0
2022-08-26 17:24:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435823505838080 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:24:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435844473163776 [0;39m 生成今日电子书快照开始
2022-08-26 17:24:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435844473163776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:24:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435844473163776 [0;39m ==> Parameters: 
2022-08-26 17:24:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435844473163776 [0;39m <==    Updates: 0
2022-08-26 17:24:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435844473163776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:24:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435865474043904 [0;39m 生成今日电子书快照开始
2022-08-26 17:24:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435865474043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:24:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435865474043904 [0;39m ==> Parameters: 
2022-08-26 17:24:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435865474043904 [0;39m <==    Updates: 0
2022-08-26 17:24:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435865474043904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:24:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435886437175296 [0;39m 生成今日电子书快照开始
2022-08-26 17:24:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435886437175296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:24:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435886437175296 [0;39m ==> Parameters: 
2022-08-26 17:24:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435886437175296 [0;39m <==    Updates: 0
2022-08-26 17:24:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435886437175296 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:25:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435907433861120 [0;39m 生成今日电子书快照开始
2022-08-26 17:25:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435907433861120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:25:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435907433861120 [0;39m ==> Parameters: 
2022-08-26 17:25:00.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435907433861120 [0;39m <==    Updates: 0
2022-08-26 17:25:00.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435907433861120 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 17:25:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20435928392798208 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:25:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435928392798208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:25:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435928392798208 [0;39m ==> Parameters: 
2022-08-26 17:25:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20435928392798208 [0;39m <==    Updates: 8
2022-08-26 17:25:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20435928392798208 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:25:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435928401186816 [0;39m 生成今日电子书快照开始
2022-08-26 17:25:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435928401186816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:25:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435928401186816 [0;39m ==> Parameters: 
2022-08-26 17:25:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435928401186816 [0;39m <==    Updates: 0
2022-08-26 17:25:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435928401186816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:25:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435949376901120 [0;39m 生成今日电子书快照开始
2022-08-26 17:25:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435949376901120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:25:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435949376901120 [0;39m ==> Parameters: 
2022-08-26 17:25:10.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435949376901120 [0;39m <==    Updates: 0
2022-08-26 17:25:10.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435949376901120 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:25:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435970319060992 [0;39m 生成今日电子书快照开始
2022-08-26 17:25:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435970319060992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:25:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435970319060992 [0;39m ==> Parameters: 
2022-08-26 17:25:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435970319060992 [0;39m <==    Updates: 0
2022-08-26 17:25:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435970319060992 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:25:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20435991294775296 [0;39m 生成今日电子书快照开始
2022-08-26 17:25:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435991294775296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:25:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435991294775296 [0;39m ==> Parameters: 
2022-08-26 17:25:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20435991294775296 [0;39m <==    Updates: 0
2022-08-26 17:25:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20435991294775296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:25:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436012299849728 [0;39m 生成今日电子书快照开始
2022-08-26 17:25:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436012299849728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:25:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436012299849728 [0;39m ==> Parameters: 
2022-08-26 17:25:25.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436012299849728 [0;39m <==    Updates: 0
2022-08-26 17:25:25.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436012299849728 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:25:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436033262981120 [0;39m 生成今日电子书快照开始
2022-08-26 17:25:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436033262981120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:25:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436033262981120 [0;39m ==> Parameters: 
2022-08-26 17:25:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436033262981120 [0;39m <==    Updates: 0
2022-08-26 17:25:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436033262981120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:25:35.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20436054188363776 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:25:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436054188363776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:25:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436054188363776 [0;39m ==> Parameters: 
2022-08-26 17:25:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436054188363776 [0;39m <==    Updates: 8
2022-08-26 17:25:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20436054188363776 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 17:25:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436054213529600 [0;39m 生成今日电子书快照开始
2022-08-26 17:25:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436054213529600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:25:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436054213529600 [0;39m ==> Parameters: 
2022-08-26 17:25:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436054213529600 [0;39m <==    Updates: 0
2022-08-26 17:25:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436054213529600 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:25:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436075193438208 [0;39m 生成今日电子书快照开始
2022-08-26 17:25:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436075193438208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:25:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436075193438208 [0;39m ==> Parameters: 
2022-08-26 17:25:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436075193438208 [0;39m <==    Updates: 0
2022-08-26 17:25:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436075193438208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:25:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436096190124032 [0;39m 生成今日电子书快照开始
2022-08-26 17:25:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436096190124032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:25:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436096190124032 [0;39m ==> Parameters: 
2022-08-26 17:25:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436096190124032 [0;39m <==    Updates: 0
2022-08-26 17:25:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436096190124032 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:25:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436117115506688 [0;39m 生成今日电子书快照开始
2022-08-26 17:25:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436117115506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:25:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436117115506688 [0;39m ==> Parameters: 
2022-08-26 17:25:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436117115506688 [0;39m <==    Updates: 0
2022-08-26 17:25:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436117115506688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:25:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436138107998208 [0;39m 生成今日电子书快照开始
2022-08-26 17:25:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436138107998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:25:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436138107998208 [0;39m ==> Parameters: 
2022-08-26 17:25:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436138107998208 [0;39m <==    Updates: 0
2022-08-26 17:25:55.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436138107998208 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:26:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436159066935296 [0;39m 生成今日电子书快照开始
2022-08-26 17:26:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436159066935296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:26:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436159066935296 [0;39m ==> Parameters: 
2022-08-26 17:26:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436159066935296 [0;39m <==    Updates: 0
2022-08-26 17:26:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436159066935296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:26:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20436180067815424 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:26:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436180067815424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:26:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436180067815424 [0;39m ==> Parameters: 
2022-08-26 17:26:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436180067815424 [0;39m <==    Updates: 8
2022-08-26 17:26:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20436180067815424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:26:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436180072009728 [0;39m 生成今日电子书快照开始
2022-08-26 17:26:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436180072009728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:26:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436180072009728 [0;39m ==> Parameters: 
2022-08-26 17:26:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436180072009728 [0;39m <==    Updates: 0
2022-08-26 17:26:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436180072009728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:26:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436200989003776 [0;39m 生成今日电子书快照开始
2022-08-26 17:26:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436200989003776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:26:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436200989003776 [0;39m ==> Parameters: 
2022-08-26 17:26:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436200989003776 [0;39m <==    Updates: 0
2022-08-26 17:26:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436200989003776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:26:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436221964718080 [0;39m 生成今日电子书快照开始
2022-08-26 17:26:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436221964718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:26:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436221964718080 [0;39m ==> Parameters: 
2022-08-26 17:26:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436221964718080 [0;39m <==    Updates: 0
2022-08-26 17:26:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436221964718080 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:26:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436242965598208 [0;39m 生成今日电子书快照开始
2022-08-26 17:26:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436242965598208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:26:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436242965598208 [0;39m ==> Parameters: 
2022-08-26 17:26:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436242965598208 [0;39m <==    Updates: 0
2022-08-26 17:26:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436242965598208 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:26:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436263937118208 [0;39m 生成今日电子书快照开始
2022-08-26 17:26:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436263937118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:26:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436263937118208 [0;39m ==> Parameters: 
2022-08-26 17:26:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436263937118208 [0;39m <==    Updates: 0
2022-08-26 17:26:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436263937118208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:26:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436284891860992 [0;39m 生成今日电子书快照开始
2022-08-26 17:26:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436284891860992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:26:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436284891860992 [0;39m ==> Parameters: 
2022-08-26 17:26:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436284891860992 [0;39m <==    Updates: 0
2022-08-26 17:26:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436284891860992 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:26:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436305850798080 [0;39m 生成今日电子书快照开始
2022-08-26 17:26:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436305850798080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:26:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436305850798080 [0;39m ==> Parameters: 
2022-08-26 17:26:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436305850798080 [0;39m <==    Updates: 0
2022-08-26 17:26:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436305850798080 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:26:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20436305884352512 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:26:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436305884352512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:26:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436305884352512 [0;39m ==> Parameters: 
2022-08-26 17:26:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436305884352512 [0;39m <==    Updates: 8
2022-08-26 17:26:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20436305884352512 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 17:26:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436326834900992 [0;39m 生成今日电子书快照开始
2022-08-26 17:26:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436326834900992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:26:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436326834900992 [0;39m ==> Parameters: 
2022-08-26 17:26:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436326834900992 [0;39m <==    Updates: 0
2022-08-26 17:26:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436326834900992 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 17:26:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436347839975424 [0;39m 生成今日电子书快照开始
2022-08-26 17:26:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436347839975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:26:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436347839975424 [0;39m ==> Parameters: 
2022-08-26 17:26:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436347839975424 [0;39m <==    Updates: 0
2022-08-26 17:26:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436347839975424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:26:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436368777940992 [0;39m 生成今日电子书快照开始
2022-08-26 17:26:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436368777940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:26:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436368777940992 [0;39m ==> Parameters: 
2022-08-26 17:26:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436368777940992 [0;39m <==    Updates: 0
2022-08-26 17:26:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436368777940992 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:26:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436389774626816 [0;39m 生成今日电子书快照开始
2022-08-26 17:26:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436389774626816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:26:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436389774626816 [0;39m ==> Parameters: 
2022-08-26 17:26:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436389774626816 [0;39m <==    Updates: 0
2022-08-26 17:26:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436389774626816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:27:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436410716786688 [0;39m 生成今日电子书快照开始
2022-08-26 17:27:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436410716786688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:27:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436410716786688 [0;39m ==> Parameters: 
2022-08-26 17:27:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436410716786688 [0;39m <==    Updates: 0
2022-08-26 17:27:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436410716786688 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 17:27:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436431679918080 [0;39m 生成今日电子书快照开始
2022-08-26 17:27:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436431679918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:27:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436431679918080 [0;39m ==> Parameters: 
2022-08-26 17:27:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436431679918080 [0;39m <==    Updates: 0
2022-08-26 17:27:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436431679918080 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:27:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20436431713472512 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:27:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436431713472512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:27:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436431713472512 [0;39m ==> Parameters: 
2022-08-26 17:27:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436431713472512 [0;39m <==    Updates: 8
2022-08-26 17:27:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20436431713472512 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 17:27:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436452664020992 [0;39m 生成今日电子书快照开始
2022-08-26 17:27:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436452664020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:27:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436452664020992 [0;39m ==> Parameters: 
2022-08-26 17:27:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436452664020992 [0;39m <==    Updates: 0
2022-08-26 17:27:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436452664020992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:27:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436473660706816 [0;39m 生成今日电子书快照开始
2022-08-26 17:27:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436473660706816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:27:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436473660706816 [0;39m ==> Parameters: 
2022-08-26 17:27:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436473660706816 [0;39m <==    Updates: 0
2022-08-26 17:27:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436473660706816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:27:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436494602866688 [0;39m 生成今日电子书快照开始
2022-08-26 17:27:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436494602866688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:27:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436494602866688 [0;39m ==> Parameters: 
2022-08-26 17:27:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436494602866688 [0;39m <==    Updates: 0
2022-08-26 17:27:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436494602866688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:27:25.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436515553415168 [0;39m 生成今日电子书快照开始
2022-08-26 17:27:25.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436515553415168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:27:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436515553415168 [0;39m ==> Parameters: 
2022-08-26 17:27:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436515553415168 [0;39m <==    Updates: 0
2022-08-26 17:27:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436515553415168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:27:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436536562683904 [0;39m 生成今日电子书快照开始
2022-08-26 17:27:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436536562683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:27:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436536562683904 [0;39m ==> Parameters: 
2022-08-26 17:27:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436536562683904 [0;39m <==    Updates: 0
2022-08-26 17:27:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436536562683904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:27:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20436557538398208 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:27:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436557538398208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:27:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436557538398208 [0;39m ==> Parameters: 
2022-08-26 17:27:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436557538398208 [0;39m <==    Updates: 8
2022-08-26 17:27:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20436557538398208 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 17:27:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436557563564032 [0;39m 生成今日电子书快照开始
2022-08-26 17:27:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436557563564032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:27:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436557563564032 [0;39m ==> Parameters: 
2022-08-26 17:27:35.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436557563564032 [0;39m <==    Updates: 0
2022-08-26 17:27:35.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436557563564032 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:27:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436578518306816 [0;39m 生成今日电子书快照开始
2022-08-26 17:27:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436578518306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:27:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436578518306816 [0;39m ==> Parameters: 
2022-08-26 17:27:40.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436578518306816 [0;39m <==    Updates: 0
2022-08-26 17:27:40.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436578518306816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:27:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436599464660992 [0;39m 生成今日电子书快照开始
2022-08-26 17:27:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436599464660992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:27:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436599464660992 [0;39m ==> Parameters: 
2022-08-26 17:27:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436599464660992 [0;39m <==    Updates: 0
2022-08-26 17:27:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436599464660992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:27:50.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436620415209472 [0;39m 生成今日电子书快照开始
2022-08-26 17:27:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436620415209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:27:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436620415209472 [0;39m ==> Parameters: 
2022-08-26 17:27:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436620415209472 [0;39m <==    Updates: 0
2022-08-26 17:27:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436620415209472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:27:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436641420283904 [0;39m 生成今日电子书快照开始
2022-08-26 17:27:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436641420283904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:27:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436641420283904 [0;39m ==> Parameters: 
2022-08-26 17:27:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436641420283904 [0;39m <==    Updates: 0
2022-08-26 17:27:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436641420283904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:28:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436662358249472 [0;39m 生成今日电子书快照开始
2022-08-26 17:28:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436662358249472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:28:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436662358249472 [0;39m ==> Parameters: 
2022-08-26 17:28:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436662358249472 [0;39m <==    Updates: 0
2022-08-26 17:28:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436662358249472 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:28:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20436683363323904 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:28:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436683363323904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:28:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436683363323904 [0;39m ==> Parameters: 
2022-08-26 17:28:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436683363323904 [0;39m <==    Updates: 8
2022-08-26 17:28:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20436683363323904 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 17:28:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436683388489728 [0;39m 生成今日电子书快照开始
2022-08-26 17:28:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436683388489728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:28:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436683388489728 [0;39m ==> Parameters: 
2022-08-26 17:28:05.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436683388489728 [0;39m <==    Updates: 0
2022-08-26 17:28:05.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436683388489728 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:28:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436704343232512 [0;39m 生成今日电子书快照开始
2022-08-26 17:28:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436704343232512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:28:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436704343232512 [0;39m ==> Parameters: 
2022-08-26 17:28:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436704343232512 [0;39m <==    Updates: 0
2022-08-26 17:28:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436704343232512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:28:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436725302169600 [0;39m 生成今日电子书快照开始
2022-08-26 17:28:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436725302169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:28:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436725302169600 [0;39m ==> Parameters: 
2022-08-26 17:28:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436725302169600 [0;39m <==    Updates: 0
2022-08-26 17:28:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436725302169600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:28:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436746256912384 [0;39m 生成今日电子书快照开始
2022-08-26 17:28:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436746256912384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:28:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436746256912384 [0;39m ==> Parameters: 
2022-08-26 17:28:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436746256912384 [0;39m <==    Updates: 0
2022-08-26 17:28:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436746256912384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:28:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436767236820992 [0;39m 生成今日电子书快照开始
2022-08-26 17:28:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436767236820992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:28:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436767236820992 [0;39m ==> Parameters: 
2022-08-26 17:28:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436767236820992 [0;39m <==    Updates: 0
2022-08-26 17:28:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436767236820992 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:28:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436788237701120 [0;39m 生成今日电子书快照开始
2022-08-26 17:28:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436788237701120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:28:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436788237701120 [0;39m ==> Parameters: 
2022-08-26 17:28:30.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436788237701120 [0;39m <==    Updates: 0
2022-08-26 17:28:30.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436788237701120 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:28:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20436809171472384 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:28:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436809171472384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:28:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436809171472384 [0;39m ==> Parameters: 
2022-08-26 17:28:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436809171472384 [0;39m <==    Updates: 8
2022-08-26 17:28:35.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20436809171472384 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-26 17:28:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436809196638208 [0;39m 生成今日电子书快照开始
2022-08-26 17:28:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436809196638208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:28:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436809196638208 [0;39m ==> Parameters: 
2022-08-26 17:28:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436809196638208 [0;39m <==    Updates: 0
2022-08-26 17:28:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436809196638208 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:28:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436830159769600 [0;39m 生成今日电子书快照开始
2022-08-26 17:28:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436830159769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:28:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436830159769600 [0;39m ==> Parameters: 
2022-08-26 17:28:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436830159769600 [0;39m <==    Updates: 0
2022-08-26 17:28:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436830159769600 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:28:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436851118706688 [0;39m 生成今日电子书快照开始
2022-08-26 17:28:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436851118706688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:28:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436851118706688 [0;39m ==> Parameters: 
2022-08-26 17:28:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436851118706688 [0;39m <==    Updates: 0
2022-08-26 17:28:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436851118706688 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:28:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436872086032384 [0;39m 生成今日电子书快照开始
2022-08-26 17:28:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436872086032384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:28:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436872086032384 [0;39m ==> Parameters: 
2022-08-26 17:28:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436872086032384 [0;39m <==    Updates: 0
2022-08-26 17:28:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436872086032384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:28:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436893091106816 [0;39m 生成今日电子书快照开始
2022-08-26 17:28:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436893091106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:28:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436893091106816 [0;39m ==> Parameters: 
2022-08-26 17:28:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436893091106816 [0;39m <==    Updates: 0
2022-08-26 17:28:55.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436893091106816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:29:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436914062626816 [0;39m 生成今日电子书快照开始
2022-08-26 17:29:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436914062626816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:29:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436914062626816 [0;39m ==> Parameters: 
2022-08-26 17:29:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436914062626816 [0;39m <==    Updates: 0
2022-08-26 17:29:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436914062626816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:29:05.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20436934988009472 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:29:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436934988009472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:29:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436934988009472 [0;39m ==> Parameters: 
2022-08-26 17:29:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20436934988009472 [0;39m <==    Updates: 8
2022-08-26 17:29:05.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20436934988009472 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:29:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436934996398080 [0;39m 生成今日电子书快照开始
2022-08-26 17:29:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436934996398080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:29:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436934996398080 [0;39m ==> Parameters: 
2022-08-26 17:29:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436934996398080 [0;39m <==    Updates: 0
2022-08-26 17:29:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436934996398080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:29:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436955997278208 [0;39m 生成今日电子书快照开始
2022-08-26 17:29:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436955997278208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:29:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436955997278208 [0;39m ==> Parameters: 
2022-08-26 17:29:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436955997278208 [0;39m <==    Updates: 0
2022-08-26 17:29:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436955997278208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:29:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436976989769728 [0;39m 生成今日电子书快照开始
2022-08-26 17:29:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436976989769728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:29:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436976989769728 [0;39m ==> Parameters: 
2022-08-26 17:29:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436976989769728 [0;39m <==    Updates: 0
2022-08-26 17:29:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436976989769728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:29:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20436997961289728 [0;39m 生成今日电子书快照开始
2022-08-26 17:29:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436997961289728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:29:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436997961289728 [0;39m ==> Parameters: 
2022-08-26 17:29:20.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20436997961289728 [0;39m <==    Updates: 0
2022-08-26 17:29:20.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20436997961289728 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:29:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437018916032512 [0;39m 生成今日电子书快照开始
2022-08-26 17:29:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437018916032512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:29:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437018916032512 [0;39m ==> Parameters: 
2022-08-26 17:29:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437018916032512 [0;39m <==    Updates: 0
2022-08-26 17:29:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437018916032512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:29:30.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437039841415168 [0;39m 生成今日电子书快照开始
2022-08-26 17:29:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437039841415168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:29:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437039841415168 [0;39m ==> Parameters: 
2022-08-26 17:29:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437039841415168 [0;39m <==    Updates: 0
2022-08-26 17:29:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437039841415168 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:29:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20437060846489600 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:29:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437060846489600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:29:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437060846489600 [0;39m ==> Parameters: 
2022-08-26 17:29:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437060846489600 [0;39m <==    Updates: 8
2022-08-26 17:29:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20437060846489600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:29:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437060850683904 [0;39m 生成今日电子书快照开始
2022-08-26 17:29:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437060850683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:29:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437060850683904 [0;39m ==> Parameters: 
2022-08-26 17:29:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437060850683904 [0;39m <==    Updates: 0
2022-08-26 17:29:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437060850683904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:29:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437081838981120 [0;39m 生成今日电子书快照开始
2022-08-26 17:29:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437081838981120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:29:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437081838981120 [0;39m ==> Parameters: 
2022-08-26 17:29:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437081838981120 [0;39m <==    Updates: 0
2022-08-26 17:29:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437081838981120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:29:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437102802112512 [0;39m 生成今日电子书快照开始
2022-08-26 17:29:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437102802112512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:29:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437102802112512 [0;39m ==> Parameters: 
2022-08-26 17:29:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437102802112512 [0;39m <==    Updates: 0
2022-08-26 17:29:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437102802112512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:29:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437123735883776 [0;39m 生成今日电子书快照开始
2022-08-26 17:29:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437123735883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:29:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437123735883776 [0;39m ==> Parameters: 
2022-08-26 17:29:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437123735883776 [0;39m <==    Updates: 0
2022-08-26 17:29:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437123735883776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:29:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437144732569600 [0;39m 生成今日电子书快照开始
2022-08-26 17:29:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437144732569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:29:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437144732569600 [0;39m ==> Parameters: 
2022-08-26 17:29:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437144732569600 [0;39m <==    Updates: 0
2022-08-26 17:29:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437144732569600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:30:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437165725061120 [0;39m 生成今日电子书快照开始
2022-08-26 17:30:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437165725061120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:30:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437165725061120 [0;39m ==> Parameters: 
2022-08-26 17:30:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437165725061120 [0;39m <==    Updates: 0
2022-08-26 17:30:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437165725061120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:30:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437186692386816 [0;39m 生成今日电子书快照开始
2022-08-26 17:30:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437186692386816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:30:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437186692386816 [0;39m ==> Parameters: 
2022-08-26 17:30:05.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437186692386816 [0;39m <==    Updates: 0
2022-08-26 17:30:05.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437186692386816 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:30:05.021 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20437186730135552 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:30:05.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437186730135552 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:30:05.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437186730135552 [0;39m ==> Parameters: 
2022-08-26 17:30:05.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437186730135552 [0;39m <==    Updates: 8
2022-08-26 17:30:05.024 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20437186730135552 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 17:30:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437207634546688 [0;39m 生成今日电子书快照开始
2022-08-26 17:30:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437207634546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:30:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437207634546688 [0;39m ==> Parameters: 
2022-08-26 17:30:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437207634546688 [0;39m <==    Updates: 0
2022-08-26 17:30:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437207634546688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:30:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437228606066688 [0;39m 生成今日电子书快照开始
2022-08-26 17:30:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437228606066688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:30:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437228606066688 [0;39m ==> Parameters: 
2022-08-26 17:30:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437228606066688 [0;39m <==    Updates: 0
2022-08-26 17:30:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437228606066688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:30:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437249611141120 [0;39m 生成今日电子书快照开始
2022-08-26 17:30:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437249611141120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:30:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437249611141120 [0;39m ==> Parameters: 
2022-08-26 17:30:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437249611141120 [0;39m <==    Updates: 0
2022-08-26 17:30:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437249611141120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:30:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437270578466816 [0;39m 生成今日电子书快照开始
2022-08-26 17:30:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437270578466816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:30:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437270578466816 [0;39m ==> Parameters: 
2022-08-26 17:30:25.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437270578466816 [0;39m <==    Updates: 0
2022-08-26 17:30:25.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437270578466816 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:30:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437291503849472 [0;39m 生成今日电子书快照开始
2022-08-26 17:30:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437291503849472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:30:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437291503849472 [0;39m ==> Parameters: 
2022-08-26 17:30:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437291503849472 [0;39m <==    Updates: 0
2022-08-26 17:30:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437291503849472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:30:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20437312525701120 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:30:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437312525701120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:30:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437312525701120 [0;39m ==> Parameters: 
2022-08-26 17:30:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437312525701120 [0;39m <==    Updates: 8
2022-08-26 17:30:35.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20437312525701120 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 17:30:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437312550866944 [0;39m 生成今日电子书快照开始
2022-08-26 17:30:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437312550866944 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:30:35.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437312550866944 [0;39m ==> Parameters: 
2022-08-26 17:30:35.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437312550866944 [0;39m <==    Updates: 0
2022-08-26 17:30:35.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437312550866944 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:30:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437333472055296 [0;39m 生成今日电子书快照开始
2022-08-26 17:30:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437333472055296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:30:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437333472055296 [0;39m ==> Parameters: 
2022-08-26 17:30:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437333472055296 [0;39m <==    Updates: 0
2022-08-26 17:30:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437333472055296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:30:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437354477129728 [0;39m 生成今日电子书快照开始
2022-08-26 17:30:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437354477129728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:30:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437354477129728 [0;39m ==> Parameters: 
2022-08-26 17:30:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437354477129728 [0;39m <==    Updates: 0
2022-08-26 17:30:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437354477129728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:30:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437375448649728 [0;39m 生成今日电子书快照开始
2022-08-26 17:30:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437375448649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:30:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437375448649728 [0;39m ==> Parameters: 
2022-08-26 17:30:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437375448649728 [0;39m <==    Updates: 0
2022-08-26 17:30:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437375448649728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:30:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437396407586816 [0;39m 生成今日电子书快照开始
2022-08-26 17:30:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437396407586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:30:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437396407586816 [0;39m ==> Parameters: 
2022-08-26 17:30:55.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437396407586816 [0;39m <==    Updates: 0
2022-08-26 17:30:55.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437396407586816 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:31:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437417353940992 [0;39m 生成今日电子书快照开始
2022-08-26 17:31:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437417353940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:31:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437417353940992 [0;39m ==> Parameters: 
2022-08-26 17:31:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437417353940992 [0;39m <==    Updates: 0
2022-08-26 17:31:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437417353940992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:31:05.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20437438308683776 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:31:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437438308683776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:31:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437438308683776 [0;39m ==> Parameters: 
2022-08-26 17:31:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437438308683776 [0;39m <==    Updates: 8
2022-08-26 17:31:05.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20437438308683776 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 17:31:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437438333849600 [0;39m 生成今日电子书快照开始
2022-08-26 17:31:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437438333849600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:31:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437438333849600 [0;39m ==> Parameters: 
2022-08-26 17:31:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437438333849600 [0;39m <==    Updates: 0
2022-08-26 17:31:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437438333849600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:31:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437459301175296 [0;39m 生成今日电子书快照开始
2022-08-26 17:31:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437459301175296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:31:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437459301175296 [0;39m ==> Parameters: 
2022-08-26 17:31:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437459301175296 [0;39m <==    Updates: 0
2022-08-26 17:31:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437459301175296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:31:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437480293666816 [0;39m 生成今日电子书快照开始
2022-08-26 17:31:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437480293666816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:31:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437480293666816 [0;39m ==> Parameters: 
2022-08-26 17:31:15.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437480293666816 [0;39m <==    Updates: 0
2022-08-26 17:31:15.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437480293666816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:31:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437501248409600 [0;39m 生成今日电子书快照开始
2022-08-26 17:31:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437501248409600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:31:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437501248409600 [0;39m ==> Parameters: 
2022-08-26 17:31:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437501248409600 [0;39m <==    Updates: 0
2022-08-26 17:31:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437501248409600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:31:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437522211540992 [0;39m 生成今日电子书快照开始
2022-08-26 17:31:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437522211540992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:31:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437522211540992 [0;39m ==> Parameters: 
2022-08-26 17:31:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437522211540992 [0;39m <==    Updates: 0
2022-08-26 17:31:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437522211540992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:31:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437543174672384 [0;39m 生成今日电子书快照开始
2022-08-26 17:31:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437543174672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:31:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437543174672384 [0;39m ==> Parameters: 
2022-08-26 17:31:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437543174672384 [0;39m <==    Updates: 0
2022-08-26 17:31:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437543174672384 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:31:35.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20437564192329728 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:31:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437564192329728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:31:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437564192329728 [0;39m ==> Parameters: 
2022-08-26 17:31:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437564192329728 [0;39m <==    Updates: 8
2022-08-26 17:31:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20437564192329728 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:31:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437564200718336 [0;39m 生成今日电子书快照开始
2022-08-26 17:31:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437564200718336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:31:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437564200718336 [0;39m ==> Parameters: 
2022-08-26 17:31:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437564200718336 [0;39m <==    Updates: 0
2022-08-26 17:31:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437564200718336 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:31:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437585147072512 [0;39m 生成今日电子书快照开始
2022-08-26 17:31:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437585147072512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:31:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437585147072512 [0;39m ==> Parameters: 
2022-08-26 17:31:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437585147072512 [0;39m <==    Updates: 0
2022-08-26 17:31:40.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437585147072512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:31:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437606110203904 [0;39m 生成今日电子书快照开始
2022-08-26 17:31:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437606110203904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:31:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437606110203904 [0;39m ==> Parameters: 
2022-08-26 17:31:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437606110203904 [0;39m <==    Updates: 0
2022-08-26 17:31:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437606110203904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:31:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437627090112512 [0;39m 生成今日电子书快照开始
2022-08-26 17:31:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437627090112512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:31:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437627090112512 [0;39m ==> Parameters: 
2022-08-26 17:31:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437627090112512 [0;39m <==    Updates: 0
2022-08-26 17:31:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437627090112512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:31:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437648070021120 [0;39m 生成今日电子书快照开始
2022-08-26 17:31:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437648070021120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:31:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437648070021120 [0;39m ==> Parameters: 
2022-08-26 17:31:55.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437648070021120 [0;39m <==    Updates: 0
2022-08-26 17:31:55.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437648070021120 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:32:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437669045735424 [0;39m 生成今日电子书快照开始
2022-08-26 17:32:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437669045735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:32:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437669045735424 [0;39m ==> Parameters: 
2022-08-26 17:32:00.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437669045735424 [0;39m <==    Updates: 0
2022-08-26 17:32:00.025 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437669045735424 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 17:32:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20437689996283904 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:32:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437689996283904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:32:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437689996283904 [0;39m ==> Parameters: 
2022-08-26 17:32:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437689996283904 [0;39m <==    Updates: 8
2022-08-26 17:32:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20437689996283904 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-26 17:32:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437690021449728 [0;39m 生成今日电子书快照开始
2022-08-26 17:32:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437690021449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:32:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437690021449728 [0;39m ==> Parameters: 
2022-08-26 17:32:05.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437690021449728 [0;39m <==    Updates: 0
2022-08-26 17:32:05.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437690021449728 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:32:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437710988775424 [0;39m 生成今日电子书快照开始
2022-08-26 17:32:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437710988775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:32:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437710988775424 [0;39m ==> Parameters: 
2022-08-26 17:32:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437710988775424 [0;39m <==    Updates: 0
2022-08-26 17:32:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437710988775424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:32:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437731951906816 [0;39m 生成今日电子书快照开始
2022-08-26 17:32:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437731951906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:32:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437731951906816 [0;39m ==> Parameters: 
2022-08-26 17:32:15.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437731951906816 [0;39m <==    Updates: 0
2022-08-26 17:32:15.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437731951906816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:32:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437752931815424 [0;39m 生成今日电子书快照开始
2022-08-26 17:32:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437752931815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:32:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437752931815424 [0;39m ==> Parameters: 
2022-08-26 17:32:20.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437752931815424 [0;39m <==    Updates: 0
2022-08-26 17:32:20.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437752931815424 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:32:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437773865586688 [0;39m 生成今日电子书快照开始
2022-08-26 17:32:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437773865586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:32:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437773865586688 [0;39m ==> Parameters: 
2022-08-26 17:32:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437773865586688 [0;39m <==    Updates: 0
2022-08-26 17:32:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437773865586688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:32:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437794837106688 [0;39m 生成今日电子书快照开始
2022-08-26 17:32:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437794837106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:32:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437794837106688 [0;39m ==> Parameters: 
2022-08-26 17:32:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437794837106688 [0;39m <==    Updates: 0
2022-08-26 17:32:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437794837106688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:32:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437815854764032 [0;39m 生成今日电子书快照开始
2022-08-26 17:32:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437815854764032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:32:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437815854764032 [0;39m ==> Parameters: 
2022-08-26 17:32:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437815854764032 [0;39m <==    Updates: 0
2022-08-26 17:32:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437815854764032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:32:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20437815863152640 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:32:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437815863152640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:32:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437815863152640 [0;39m ==> Parameters: 
2022-08-26 17:32:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437815863152640 [0;39m <==    Updates: 8
2022-08-26 17:32:35.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20437815863152640 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:32:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437836826284032 [0;39m 生成今日电子书快照开始
2022-08-26 17:32:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437836826284032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:32:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437836826284032 [0;39m ==> Parameters: 
2022-08-26 17:32:40.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437836826284032 [0;39m <==    Updates: 0
2022-08-26 17:32:40.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437836826284032 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:32:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437857789415424 [0;39m 生成今日电子书快照开始
2022-08-26 17:32:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437857789415424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:32:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437857789415424 [0;39m ==> Parameters: 
2022-08-26 17:32:45.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437857789415424 [0;39m <==    Updates: 0
2022-08-26 17:32:45.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437857789415424 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:32:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437878723186688 [0;39m 生成今日电子书快照开始
2022-08-26 17:32:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437878723186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:32:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437878723186688 [0;39m ==> Parameters: 
2022-08-26 17:32:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437878723186688 [0;39m <==    Updates: 0
2022-08-26 17:32:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437878723186688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:32:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437899715678208 [0;39m 生成今日电子书快照开始
2022-08-26 17:32:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437899715678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:32:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437899715678208 [0;39m ==> Parameters: 
2022-08-26 17:32:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437899715678208 [0;39m <==    Updates: 0
2022-08-26 17:32:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437899715678208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:33:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437920691392512 [0;39m 生成今日电子书快照开始
2022-08-26 17:33:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437920691392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:33:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437920691392512 [0;39m ==> Parameters: 
2022-08-26 17:33:00.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437920691392512 [0;39m <==    Updates: 0
2022-08-26 17:33:00.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437920691392512 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 17:33:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20437941633552384 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:33:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437941633552384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:33:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437941633552384 [0;39m ==> Parameters: 
2022-08-26 17:33:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20437941633552384 [0;39m <==    Updates: 8
2022-08-26 17:33:05.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20437941633552384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:33:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437941641940992 [0;39m 生成今日电子书快照开始
2022-08-26 17:33:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437941641940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:33:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437941641940992 [0;39m ==> Parameters: 
2022-08-26 17:33:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437941641940992 [0;39m <==    Updates: 0
2022-08-26 17:33:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437941641940992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:33:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437962647015424 [0;39m 生成今日电子书快照开始
2022-08-26 17:33:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437962647015424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:33:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437962647015424 [0;39m ==> Parameters: 
2022-08-26 17:33:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437962647015424 [0;39m <==    Updates: 0
2022-08-26 17:33:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437962647015424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:33:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20437983622729728 [0;39m 生成今日电子书快照开始
2022-08-26 17:33:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437983622729728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:33:15.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437983622729728 [0;39m ==> Parameters: 
2022-08-26 17:33:15.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20437983622729728 [0;39m <==    Updates: 0
2022-08-26 17:33:15.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20437983622729728 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:33:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438004543918080 [0;39m 生成今日电子书快照开始
2022-08-26 17:33:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438004543918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:33:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438004543918080 [0;39m ==> Parameters: 
2022-08-26 17:33:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438004543918080 [0;39m <==    Updates: 0
2022-08-26 17:33:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438004543918080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:33:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438025528020992 [0;39m 生成今日电子书快照开始
2022-08-26 17:33:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438025528020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:33:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438025528020992 [0;39m ==> Parameters: 
2022-08-26 17:33:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438025528020992 [0;39m <==    Updates: 0
2022-08-26 17:33:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438025528020992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:33:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438046528901120 [0;39m 生成今日电子书快照开始
2022-08-26 17:33:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438046528901120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:33:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438046528901120 [0;39m ==> Parameters: 
2022-08-26 17:33:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438046528901120 [0;39m <==    Updates: 0
2022-08-26 17:33:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438046528901120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:33:35.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20438067454283776 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:33:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438067454283776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:33:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438067454283776 [0;39m ==> Parameters: 
2022-08-26 17:33:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438067454283776 [0;39m <==    Updates: 8
2022-08-26 17:33:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20438067454283776 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-26 17:33:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438067479449600 [0;39m 生成今日电子书快照开始
2022-08-26 17:33:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438067479449600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:33:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438067479449600 [0;39m ==> Parameters: 
2022-08-26 17:33:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438067479449600 [0;39m <==    Updates: 0
2022-08-26 17:33:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438067479449600 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:33:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438088476135424 [0;39m 生成今日电子书快照开始
2022-08-26 17:33:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438088476135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:33:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438088476135424 [0;39m ==> Parameters: 
2022-08-26 17:33:40.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438088476135424 [0;39m <==    Updates: 0
2022-08-26 17:33:40.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438088476135424 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 17:33:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438109456044032 [0;39m 生成今日电子书快照开始
2022-08-26 17:33:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438109456044032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:33:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438109456044032 [0;39m ==> Parameters: 
2022-08-26 17:33:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438109456044032 [0;39m <==    Updates: 0
2022-08-26 17:33:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438109456044032 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:33:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438130368843776 [0;39m 生成今日电子书快照开始
2022-08-26 17:33:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438130368843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:33:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438130368843776 [0;39m ==> Parameters: 
2022-08-26 17:33:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438130368843776 [0;39m <==    Updates: 0
2022-08-26 17:33:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438130368843776 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 17:33:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438151361335296 [0;39m 生成今日电子书快照开始
2022-08-26 17:33:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438151361335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:33:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438151361335296 [0;39m ==> Parameters: 
2022-08-26 17:33:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438151361335296 [0;39m <==    Updates: 0
2022-08-26 17:33:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438151361335296 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 17:34:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438172349632512 [0;39m 生成今日电子书快照开始
2022-08-26 17:34:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438172349632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:34:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438172349632512 [0;39m ==> Parameters: 
2022-08-26 17:34:00.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438172349632512 [0;39m <==    Updates: 0
2022-08-26 17:34:00.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438172349632512 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 17:34:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20438193333735424 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:34:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438193333735424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:34:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438193333735424 [0;39m ==> Parameters: 
2022-08-26 17:34:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438193333735424 [0;39m <==    Updates: 8
2022-08-26 17:34:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20438193333735424 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 17:34:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438193346318336 [0;39m 生成今日电子书快照开始
2022-08-26 17:34:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438193346318336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:34:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438193346318336 [0;39m ==> Parameters: 
2022-08-26 17:34:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438193346318336 [0;39m <==    Updates: 0
2022-08-26 17:34:05.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438193346318336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:34:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438214292672512 [0;39m 生成今日电子书快照开始
2022-08-26 17:34:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438214292672512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:34:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438214292672512 [0;39m ==> Parameters: 
2022-08-26 17:34:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438214292672512 [0;39m <==    Updates: 0
2022-08-26 17:34:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438214292672512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:34:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438235230638080 [0;39m 生成今日电子书快照开始
2022-08-26 17:34:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438235230638080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:34:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438235230638080 [0;39m ==> Parameters: 
2022-08-26 17:34:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438235230638080 [0;39m <==    Updates: 0
2022-08-26 17:34:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438235230638080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:34:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438256256684032 [0;39m 生成今日电子书快照开始
2022-08-26 17:34:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438256256684032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:34:20.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438256256684032 [0;39m ==> Parameters: 
2022-08-26 17:34:20.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438256256684032 [0;39m <==    Updates: 0
2022-08-26 17:34:20.025 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438256256684032 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:34:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438277215621120 [0;39m 生成今日电子书快照开始
2022-08-26 17:34:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438277215621120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:34:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438277215621120 [0;39m ==> Parameters: 
2022-08-26 17:34:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438277215621120 [0;39m <==    Updates: 0
2022-08-26 17:34:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438277215621120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:34:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438298191335424 [0;39m 生成今日电子书快照开始
2022-08-26 17:34:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438298191335424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:34:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438298191335424 [0;39m ==> Parameters: 
2022-08-26 17:34:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438298191335424 [0;39m <==    Updates: 0
2022-08-26 17:34:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438298191335424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:34:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20438319137689600 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:34:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438319137689600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:34:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438319137689600 [0;39m ==> Parameters: 
2022-08-26 17:34:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438319137689600 [0;39m <==    Updates: 8
2022-08-26 17:34:35.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20438319137689600 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:34:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438319146078208 [0;39m 生成今日电子书快照开始
2022-08-26 17:34:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438319146078208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:34:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438319146078208 [0;39m ==> Parameters: 
2022-08-26 17:34:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438319146078208 [0;39m <==    Updates: 0
2022-08-26 17:34:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438319146078208 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:34:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438340121792512 [0;39m 生成今日电子书快照开始
2022-08-26 17:34:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438340121792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:34:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438340121792512 [0;39m ==> Parameters: 
2022-08-26 17:34:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438340121792512 [0;39m <==    Updates: 0
2022-08-26 17:34:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438340121792512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:34:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438361110089728 [0;39m 生成今日电子书快照开始
2022-08-26 17:34:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438361110089728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:34:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438361110089728 [0;39m ==> Parameters: 
2022-08-26 17:34:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438361110089728 [0;39m <==    Updates: 0
2022-08-26 17:34:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438361110089728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:34:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438382027083776 [0;39m 生成今日电子书快照开始
2022-08-26 17:34:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438382027083776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:34:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438382027083776 [0;39m ==> Parameters: 
2022-08-26 17:34:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438382027083776 [0;39m <==    Updates: 0
2022-08-26 17:34:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438382027083776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:34:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438403032158208 [0;39m 生成今日电子书快照开始
2022-08-26 17:34:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438403032158208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:34:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438403032158208 [0;39m ==> Parameters: 
2022-08-26 17:34:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438403032158208 [0;39m <==    Updates: 0
2022-08-26 17:34:55.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438403032158208 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:35:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438424020455424 [0;39m 生成今日电子书快照开始
2022-08-26 17:35:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438424020455424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:35:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438424020455424 [0;39m ==> Parameters: 
2022-08-26 17:35:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438424020455424 [0;39m <==    Updates: 0
2022-08-26 17:35:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438424020455424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:35:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20438444958420992 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:35:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438444958420992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:35:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438444958420992 [0;39m ==> Parameters: 
2022-08-26 17:35:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438444958420992 [0;39m <==    Updates: 8
2022-08-26 17:35:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20438444958420992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:35:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438444962615296 [0;39m 生成今日电子书快照开始
2022-08-26 17:35:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438444962615296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:35:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438444962615296 [0;39m ==> Parameters: 
2022-08-26 17:35:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438444962615296 [0;39m <==    Updates: 0
2022-08-26 17:35:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438444962615296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:35:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438465955106816 [0;39m 生成今日电子书快照开始
2022-08-26 17:35:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438465955106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:35:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438465955106816 [0;39m ==> Parameters: 
2022-08-26 17:35:10.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438465955106816 [0;39m <==    Updates: 0
2022-08-26 17:35:10.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438465955106816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:35:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438486893072384 [0;39m 生成今日电子书快照开始
2022-08-26 17:35:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438486893072384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:35:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438486893072384 [0;39m ==> Parameters: 
2022-08-26 17:35:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438486893072384 [0;39m <==    Updates: 0
2022-08-26 17:35:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438486893072384 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:35:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438507893952512 [0;39m 生成今日电子书快照开始
2022-08-26 17:35:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438507893952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:35:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438507893952512 [0;39m ==> Parameters: 
2022-08-26 17:35:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438507893952512 [0;39m <==    Updates: 0
2022-08-26 17:35:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438507893952512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:35:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438528878055424 [0;39m 生成今日电子书快照开始
2022-08-26 17:35:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438528878055424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:35:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438528878055424 [0;39m ==> Parameters: 
2022-08-26 17:35:25.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438528878055424 [0;39m <==    Updates: 0
2022-08-26 17:35:25.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438528878055424 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:35:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438549853769728 [0;39m 生成今日电子书快照开始
2022-08-26 17:35:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438549853769728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:35:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438549853769728 [0;39m ==> Parameters: 
2022-08-26 17:35:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438549853769728 [0;39m <==    Updates: 0
2022-08-26 17:35:30.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438549853769728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:35:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438570779152384 [0;39m 生成今日电子书快照开始
2022-08-26 17:35:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438570779152384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:35:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438570779152384 [0;39m ==> Parameters: 
2022-08-26 17:35:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438570779152384 [0;39m <==    Updates: 0
2022-08-26 17:35:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438570779152384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:35:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20438570787540992 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:35:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438570787540992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:35:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438570787540992 [0;39m ==> Parameters: 
2022-08-26 17:35:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438570787540992 [0;39m <==    Updates: 8
2022-08-26 17:35:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20438570787540992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:35:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438591801004032 [0;39m 生成今日电子书快照开始
2022-08-26 17:35:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438591801004032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:35:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438591801004032 [0;39m ==> Parameters: 
2022-08-26 17:35:40.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438591801004032 [0;39m <==    Updates: 0
2022-08-26 17:35:40.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438591801004032 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:35:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438612722192384 [0;39m 生成今日电子书快照开始
2022-08-26 17:35:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438612722192384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:35:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438612722192384 [0;39m ==> Parameters: 
2022-08-26 17:35:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438612722192384 [0;39m <==    Updates: 0
2022-08-26 17:35:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438612722192384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:35:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438633702100992 [0;39m 生成今日电子书快照开始
2022-08-26 17:35:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438633702100992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:35:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438633702100992 [0;39m ==> Parameters: 
2022-08-26 17:35:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438633702100992 [0;39m <==    Updates: 0
2022-08-26 17:35:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438633702100992 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:35:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438654686203904 [0;39m 生成今日电子书快照开始
2022-08-26 17:35:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438654686203904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:35:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438654686203904 [0;39m ==> Parameters: 
2022-08-26 17:35:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438654686203904 [0;39m <==    Updates: 0
2022-08-26 17:35:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438654686203904 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:36:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438675674501120 [0;39m 生成今日电子书快照开始
2022-08-26 17:36:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438675674501120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:36:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438675674501120 [0;39m ==> Parameters: 
2022-08-26 17:36:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438675674501120 [0;39m <==    Updates: 0
2022-08-26 17:36:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438675674501120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:36:05.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20438696599883776 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:36:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438696599883776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:36:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438696599883776 [0;39m ==> Parameters: 
2022-08-26 17:36:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438696599883776 [0;39m <==    Updates: 8
2022-08-26 17:36:05.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20438696599883776 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:36:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438696608272384 [0;39m 生成今日电子书快照开始
2022-08-26 17:36:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438696608272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:36:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438696608272384 [0;39m ==> Parameters: 
2022-08-26 17:36:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438696608272384 [0;39m <==    Updates: 0
2022-08-26 17:36:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438696608272384 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:36:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438717588180992 [0;39m 生成今日电子书快照开始
2022-08-26 17:36:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438717588180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:36:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438717588180992 [0;39m ==> Parameters: 
2022-08-26 17:36:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438717588180992 [0;39m <==    Updates: 0
2022-08-26 17:36:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438717588180992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:36:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438738584866816 [0;39m 生成今日电子书快照开始
2022-08-26 17:36:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438738584866816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:36:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438738584866816 [0;39m ==> Parameters: 
2022-08-26 17:36:15.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438738584866816 [0;39m <==    Updates: 0
2022-08-26 17:36:15.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438738584866816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:36:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438759564775424 [0;39m 生成今日电子书快照开始
2022-08-26 17:36:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438759564775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:36:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438759564775424 [0;39m ==> Parameters: 
2022-08-26 17:36:20.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438759564775424 [0;39m <==    Updates: 0
2022-08-26 17:36:20.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438759564775424 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:36:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438780536295424 [0;39m 生成今日电子书快照开始
2022-08-26 17:36:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438780536295424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:36:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438780536295424 [0;39m ==> Parameters: 
2022-08-26 17:36:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438780536295424 [0;39m <==    Updates: 0
2022-08-26 17:36:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438780536295424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:36:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438801474260992 [0;39m 生成今日电子书快照开始
2022-08-26 17:36:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438801474260992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:36:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438801474260992 [0;39m ==> Parameters: 
2022-08-26 17:36:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438801474260992 [0;39m <==    Updates: 0
2022-08-26 17:36:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438801474260992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:36:35.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438822424809472 [0;39m 生成今日电子书快照开始
2022-08-26 17:36:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438822424809472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:36:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438822424809472 [0;39m ==> Parameters: 
2022-08-26 17:36:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438822424809472 [0;39m <==    Updates: 0
2022-08-26 17:36:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438822424809472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:36:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20438822433198080 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:36:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438822433198080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:36:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438822433198080 [0;39m ==> Parameters: 
2022-08-26 17:36:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438822433198080 [0;39m <==    Updates: 8
2022-08-26 17:36:35.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20438822433198080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:36:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438843446661120 [0;39m 生成今日电子书快照开始
2022-08-26 17:36:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438843446661120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:36:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438843446661120 [0;39m ==> Parameters: 
2022-08-26 17:36:40.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438843446661120 [0;39m <==    Updates: 0
2022-08-26 17:36:40.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438843446661120 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:36:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438864384626688 [0;39m 生成今日电子书快照开始
2022-08-26 17:36:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438864384626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:36:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438864384626688 [0;39m ==> Parameters: 
2022-08-26 17:36:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438864384626688 [0;39m <==    Updates: 0
2022-08-26 17:36:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438864384626688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:36:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438885356146688 [0;39m 生成今日电子书快照开始
2022-08-26 17:36:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438885356146688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:36:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438885356146688 [0;39m ==> Parameters: 
2022-08-26 17:36:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438885356146688 [0;39m <==    Updates: 0
2022-08-26 17:36:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438885356146688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:36:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438906319278080 [0;39m 生成今日电子书快照开始
2022-08-26 17:36:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438906319278080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:36:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438906319278080 [0;39m ==> Parameters: 
2022-08-26 17:36:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438906319278080 [0;39m <==    Updates: 0
2022-08-26 17:36:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438906319278080 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:37:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438927328546816 [0;39m 生成今日电子书快照开始
2022-08-26 17:37:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438927328546816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:37:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438927328546816 [0;39m ==> Parameters: 
2022-08-26 17:37:00.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438927328546816 [0;39m <==    Updates: 0
2022-08-26 17:37:00.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438927328546816 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 17:37:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20438948270706688 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:37:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438948270706688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:37:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438948270706688 [0;39m ==> Parameters: 
2022-08-26 17:37:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20438948270706688 [0;39m <==    Updates: 8
2022-08-26 17:37:05.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20438948270706688 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 17:37:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438948283289600 [0;39m 生成今日电子书快照开始
2022-08-26 17:37:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438948283289600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:37:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438948283289600 [0;39m ==> Parameters: 
2022-08-26 17:37:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438948283289600 [0;39m <==    Updates: 0
2022-08-26 17:37:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438948283289600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:37:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438969288364032 [0;39m 生成今日电子书快照开始
2022-08-26 17:37:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438969288364032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:37:10.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438969288364032 [0;39m ==> Parameters: 
2022-08-26 17:37:10.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438969288364032 [0;39m <==    Updates: 0
2022-08-26 17:37:10.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438969288364032 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:37:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20438990201163776 [0;39m 生成今日电子书快照开始
2022-08-26 17:37:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438990201163776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:37:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438990201163776 [0;39m ==> Parameters: 
2022-08-26 17:37:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20438990201163776 [0;39m <==    Updates: 0
2022-08-26 17:37:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20438990201163776 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:37:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439011189460992 [0;39m 生成今日电子书快照开始
2022-08-26 17:37:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439011189460992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:37:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439011189460992 [0;39m ==> Parameters: 
2022-08-26 17:37:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439011189460992 [0;39m <==    Updates: 0
2022-08-26 17:37:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439011189460992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:37:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439032140009472 [0;39m 生成今日电子书快照开始
2022-08-26 17:37:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439032140009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:37:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439032140009472 [0;39m ==> Parameters: 
2022-08-26 17:37:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439032140009472 [0;39m <==    Updates: 0
2022-08-26 17:37:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439032140009472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:37:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439053140889600 [0;39m 生成今日电子书快照开始
2022-08-26 17:37:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439053140889600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:37:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439053140889600 [0;39m ==> Parameters: 
2022-08-26 17:37:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439053140889600 [0;39m <==    Updates: 0
2022-08-26 17:37:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439053140889600 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:37:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20439074099826688 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:37:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439074099826688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:37:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439074099826688 [0;39m ==> Parameters: 
2022-08-26 17:37:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439074099826688 [0;39m <==    Updates: 8
2022-08-26 17:37:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20439074099826688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:37:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439074104020992 [0;39m 生成今日电子书快照开始
2022-08-26 17:37:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439074104020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:37:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439074104020992 [0;39m ==> Parameters: 
2022-08-26 17:37:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439074104020992 [0;39m <==    Updates: 0
2022-08-26 17:37:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439074104020992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:37:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439095062958080 [0;39m 生成今日电子书快照开始
2022-08-26 17:37:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439095062958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:37:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439095062958080 [0;39m ==> Parameters: 
2022-08-26 17:37:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439095062958080 [0;39m <==    Updates: 0
2022-08-26 17:37:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439095062958080 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:37:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439116084809728 [0;39m 生成今日电子书快照开始
2022-08-26 17:37:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439116084809728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:37:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439116084809728 [0;39m ==> Parameters: 
2022-08-26 17:37:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439116084809728 [0;39m <==    Updates: 0
2022-08-26 17:37:45.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439116084809728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:37:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439137047941120 [0;39m 生成今日电子书快照开始
2022-08-26 17:37:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439137047941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:37:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439137047941120 [0;39m ==> Parameters: 
2022-08-26 17:37:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439137047941120 [0;39m <==    Updates: 0
2022-08-26 17:37:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439137047941120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:37:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439158002683904 [0;39m 生成今日电子书快照开始
2022-08-26 17:37:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439158002683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:37:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439158002683904 [0;39m ==> Parameters: 
2022-08-26 17:37:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439158002683904 [0;39m <==    Updates: 0
2022-08-26 17:37:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439158002683904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:38:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439178965815296 [0;39m 生成今日电子书快照开始
2022-08-26 17:38:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439178965815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:38:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439178965815296 [0;39m ==> Parameters: 
2022-08-26 17:38:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439178965815296 [0;39m <==    Updates: 0
2022-08-26 17:38:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439178965815296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:38:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20439199945723904 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:38:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439199945723904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:38:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439199945723904 [0;39m ==> Parameters: 
2022-08-26 17:38:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439199945723904 [0;39m <==    Updates: 8
2022-08-26 17:38:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20439199945723904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:38:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439199954112512 [0;39m 生成今日电子书快照开始
2022-08-26 17:38:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439199954112512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:38:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439199954112512 [0;39m ==> Parameters: 
2022-08-26 17:38:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439199954112512 [0;39m <==    Updates: 0
2022-08-26 17:38:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439199954112512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:38:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439220887883776 [0;39m 生成今日电子书快照开始
2022-08-26 17:38:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439220887883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:38:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439220887883776 [0;39m ==> Parameters: 
2022-08-26 17:38:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439220887883776 [0;39m <==    Updates: 0
2022-08-26 17:38:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439220887883776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:38:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439241918124032 [0;39m 生成今日电子书快照开始
2022-08-26 17:38:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439241918124032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:38:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439241918124032 [0;39m ==> Parameters: 
2022-08-26 17:38:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439241918124032 [0;39m <==    Updates: 0
2022-08-26 17:38:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439241918124032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:38:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439262868672512 [0;39m 生成今日电子书快照开始
2022-08-26 17:38:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439262868672512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:38:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439262868672512 [0;39m ==> Parameters: 
2022-08-26 17:38:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439262868672512 [0;39m <==    Updates: 0
2022-08-26 17:38:20.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439262868672512 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:38:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439283848581120 [0;39m 生成今日电子书快照开始
2022-08-26 17:38:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439283848581120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:38:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439283848581120 [0;39m ==> Parameters: 
2022-08-26 17:38:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439283848581120 [0;39m <==    Updates: 0
2022-08-26 17:38:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439283848581120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:38:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439304769769472 [0;39m 生成今日电子书快照开始
2022-08-26 17:38:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439304769769472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:38:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439304769769472 [0;39m ==> Parameters: 
2022-08-26 17:38:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439304769769472 [0;39m <==    Updates: 0
2022-08-26 17:38:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439304769769472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:38:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439325749678080 [0;39m 生成今日电子书快照开始
2022-08-26 17:38:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439325749678080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:38:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439325749678080 [0;39m ==> Parameters: 
2022-08-26 17:38:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439325749678080 [0;39m <==    Updates: 0
2022-08-26 17:38:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439325749678080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:38:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20439325758066688 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:38:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439325758066688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:38:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439325758066688 [0;39m ==> Parameters: 
2022-08-26 17:38:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439325758066688 [0;39m <==    Updates: 8
2022-08-26 17:38:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20439325758066688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:38:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439346771529728 [0;39m 生成今日电子书快照开始
2022-08-26 17:38:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439346771529728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:38:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439346771529728 [0;39m ==> Parameters: 
2022-08-26 17:38:40.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439346771529728 [0;39m <==    Updates: 0
2022-08-26 17:38:40.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439346771529728 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:38:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439367726272512 [0;39m 生成今日电子书快照开始
2022-08-26 17:38:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439367726272512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:38:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439367726272512 [0;39m ==> Parameters: 
2022-08-26 17:38:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439367726272512 [0;39m <==    Updates: 0
2022-08-26 17:38:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439367726272512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:38:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439388697792512 [0;39m 生成今日电子书快照开始
2022-08-26 17:38:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439388697792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:38:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439388697792512 [0;39m ==> Parameters: 
2022-08-26 17:38:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439388697792512 [0;39m <==    Updates: 0
2022-08-26 17:38:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439388697792512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:38:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439409660923904 [0;39m 生成今日电子书快照开始
2022-08-26 17:38:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439409660923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:38:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439409660923904 [0;39m ==> Parameters: 
2022-08-26 17:38:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439409660923904 [0;39m <==    Updates: 0
2022-08-26 17:38:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439409660923904 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:39:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439430628249600 [0;39m 生成今日电子书快照开始
2022-08-26 17:39:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439430628249600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:39:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439430628249600 [0;39m ==> Parameters: 
2022-08-26 17:39:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439430628249600 [0;39m <==    Updates: 0
2022-08-26 17:39:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439430628249600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:39:05.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20439451578798080 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:39:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439451578798080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:39:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439451578798080 [0;39m ==> Parameters: 
2022-08-26 17:39:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439451578798080 [0;39m <==    Updates: 8
2022-08-26 17:39:05.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20439451578798080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:39:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439451582992384 [0;39m 生成今日电子书快照开始
2022-08-26 17:39:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439451582992384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:39:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439451582992384 [0;39m ==> Parameters: 
2022-08-26 17:39:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439451582992384 [0;39m <==    Updates: 0
2022-08-26 17:39:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439451582992384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:39:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439472583872512 [0;39m 生成今日电子书快照开始
2022-08-26 17:39:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439472583872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:39:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439472583872512 [0;39m ==> Parameters: 
2022-08-26 17:39:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439472583872512 [0;39m <==    Updates: 0
2022-08-26 17:39:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439472583872512 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:39:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439493538615296 [0;39m 生成今日电子书快照开始
2022-08-26 17:39:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439493538615296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:39:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439493538615296 [0;39m ==> Parameters: 
2022-08-26 17:39:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439493538615296 [0;39m <==    Updates: 0
2022-08-26 17:39:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439493538615296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:39:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439514535301120 [0;39m 生成今日电子书快照开始
2022-08-26 17:39:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439514535301120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:39:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439514535301120 [0;39m ==> Parameters: 
2022-08-26 17:39:20.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439514535301120 [0;39m <==    Updates: 0
2022-08-26 17:39:20.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439514535301120 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:39:25.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439535452295168 [0;39m 生成今日电子书快照开始
2022-08-26 17:39:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439535452295168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:39:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439535452295168 [0;39m ==> Parameters: 
2022-08-26 17:39:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439535452295168 [0;39m <==    Updates: 0
2022-08-26 17:39:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439535452295168 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:39:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439556482535424 [0;39m 生成今日电子书快照开始
2022-08-26 17:39:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439556482535424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:39:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439556482535424 [0;39m ==> Parameters: 
2022-08-26 17:39:30.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439556482535424 [0;39m <==    Updates: 0
2022-08-26 17:39:30.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439556482535424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:39:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439577437278208 [0;39m 生成今日电子书快照开始
2022-08-26 17:39:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439577437278208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:39:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439577437278208 [0;39m ==> Parameters: 
2022-08-26 17:39:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439577437278208 [0;39m <==    Updates: 0
2022-08-26 17:39:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439577437278208 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:39:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20439577462444032 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:39:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439577462444032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:39:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439577462444032 [0;39m ==> Parameters: 
2022-08-26 17:39:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439577462444032 [0;39m <==    Updates: 8
2022-08-26 17:39:35.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20439577462444032 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 17:39:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439598429769728 [0;39m 生成今日电子书快照开始
2022-08-26 17:39:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439598429769728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:39:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439598429769728 [0;39m ==> Parameters: 
2022-08-26 17:39:40.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439598429769728 [0;39m <==    Updates: 0
2022-08-26 17:39:40.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439598429769728 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:39:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439619388706816 [0;39m 生成今日电子书快照开始
2022-08-26 17:39:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439619388706816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:39:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439619388706816 [0;39m ==> Parameters: 
2022-08-26 17:39:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439619388706816 [0;39m <==    Updates: 0
2022-08-26 17:39:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439619388706816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:39:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439640372809728 [0;39m 生成今日电子书快照开始
2022-08-26 17:39:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439640372809728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:39:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439640372809728 [0;39m ==> Parameters: 
2022-08-26 17:39:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439640372809728 [0;39m <==    Updates: 0
2022-08-26 17:39:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439640372809728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:39:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439661323358208 [0;39m 生成今日电子书快照开始
2022-08-26 17:39:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439661323358208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:39:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439661323358208 [0;39m ==> Parameters: 
2022-08-26 17:39:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439661323358208 [0;39m <==    Updates: 0
2022-08-26 17:39:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439661323358208 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:40:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439682294878208 [0;39m 生成今日电子书快照开始
2022-08-26 17:40:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439682294878208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:40:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439682294878208 [0;39m ==> Parameters: 
2022-08-26 17:40:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439682294878208 [0;39m <==    Updates: 0
2022-08-26 17:40:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439682294878208 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:40:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439703278981120 [0;39m 生成今日电子书快照开始
2022-08-26 17:40:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439703278981120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:40:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439703278981120 [0;39m ==> Parameters: 
2022-08-26 17:40:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439703278981120 [0;39m <==    Updates: 0
2022-08-26 17:40:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439703278981120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:40:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20439703287369728 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:40:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439703287369728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:40:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439703287369728 [0;39m ==> Parameters: 
2022-08-26 17:40:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439703287369728 [0;39m <==    Updates: 8
2022-08-26 17:40:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20439703287369728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:40:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439724221140992 [0;39m 生成今日电子书快照开始
2022-08-26 17:40:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439724221140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:40:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439724221140992 [0;39m ==> Parameters: 
2022-08-26 17:40:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439724221140992 [0;39m <==    Updates: 0
2022-08-26 17:40:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439724221140992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:40:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439745192660992 [0;39m 生成今日电子书快照开始
2022-08-26 17:40:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439745192660992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:40:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439745192660992 [0;39m ==> Parameters: 
2022-08-26 17:40:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439745192660992 [0;39m <==    Updates: 0
2022-08-26 17:40:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439745192660992 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:40:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439766172569600 [0;39m 生成今日电子书快照开始
2022-08-26 17:40:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439766172569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:40:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439766172569600 [0;39m ==> Parameters: 
2022-08-26 17:40:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439766172569600 [0;39m <==    Updates: 0
2022-08-26 17:40:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439766172569600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:40:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439787148283904 [0;39m 生成今日电子书快照开始
2022-08-26 17:40:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439787148283904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:40:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439787148283904 [0;39m ==> Parameters: 
2022-08-26 17:40:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439787148283904 [0;39m <==    Updates: 0
2022-08-26 17:40:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439787148283904 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:40:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439808103026688 [0;39m 生成今日电子书快照开始
2022-08-26 17:40:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439808103026688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:40:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439808103026688 [0;39m ==> Parameters: 
2022-08-26 17:40:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439808103026688 [0;39m <==    Updates: 0
2022-08-26 17:40:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439808103026688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:40:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20439829095518208 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:40:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439829095518208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:40:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439829095518208 [0;39m ==> Parameters: 
2022-08-26 17:40:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439829095518208 [0;39m <==    Updates: 8
2022-08-26 17:40:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20439829095518208 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:40:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439829103906816 [0;39m 生成今日电子书快照开始
2022-08-26 17:40:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439829103906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:40:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439829103906816 [0;39m ==> Parameters: 
2022-08-26 17:40:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439829103906816 [0;39m <==    Updates: 0
2022-08-26 17:40:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439829103906816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:40:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439850037678080 [0;39m 生成今日电子书快照开始
2022-08-26 17:40:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439850037678080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:40:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439850037678080 [0;39m ==> Parameters: 
2022-08-26 17:40:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439850037678080 [0;39m <==    Updates: 0
2022-08-26 17:40:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439850037678080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:40:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439871038558208 [0;39m 生成今日电子书快照开始
2022-08-26 17:40:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439871038558208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:40:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439871038558208 [0;39m ==> Parameters: 
2022-08-26 17:40:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439871038558208 [0;39m <==    Updates: 0
2022-08-26 17:40:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439871038558208 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:40:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439892026855424 [0;39m 生成今日电子书快照开始
2022-08-26 17:40:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439892026855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:40:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439892026855424 [0;39m ==> Parameters: 
2022-08-26 17:40:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439892026855424 [0;39m <==    Updates: 0
2022-08-26 17:40:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439892026855424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:40:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439913002569728 [0;39m 生成今日电子书快照开始
2022-08-26 17:40:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439913002569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:40:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439913002569728 [0;39m ==> Parameters: 
2022-08-26 17:40:55.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439913002569728 [0;39m <==    Updates: 0
2022-08-26 17:40:55.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439913002569728 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:41:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439933953118208 [0;39m 生成今日电子书快照开始
2022-08-26 17:41:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439933953118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:41:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439933953118208 [0;39m ==> Parameters: 
2022-08-26 17:41:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439933953118208 [0;39m <==    Updates: 0
2022-08-26 17:41:00.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439933953118208 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:41:05.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439954891083776 [0;39m 生成今日电子书快照开始
2022-08-26 17:41:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439954891083776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:41:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439954891083776 [0;39m ==> Parameters: 
2022-08-26 17:41:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439954891083776 [0;39m <==    Updates: 0
2022-08-26 17:41:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439954891083776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:41:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20439954903666688 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:41:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439954903666688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:41:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439954903666688 [0;39m ==> Parameters: 
2022-08-26 17:41:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20439954903666688 [0;39m <==    Updates: 8
2022-08-26 17:41:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20439954903666688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:41:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439975912935424 [0;39m 生成今日电子书快照开始
2022-08-26 17:41:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439975912935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:41:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439975912935424 [0;39m ==> Parameters: 
2022-08-26 17:41:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439975912935424 [0;39m <==    Updates: 0
2022-08-26 17:41:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439975912935424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:41:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20439996871872512 [0;39m 生成今日电子书快照开始
2022-08-26 17:41:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439996871872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:41:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439996871872512 [0;39m ==> Parameters: 
2022-08-26 17:41:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20439996871872512 [0;39m <==    Updates: 0
2022-08-26 17:41:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20439996871872512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:41:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440017860169728 [0;39m 生成今日电子书快照开始
2022-08-26 17:41:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440017860169728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:41:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440017860169728 [0;39m ==> Parameters: 
2022-08-26 17:41:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440017860169728 [0;39m <==    Updates: 0
2022-08-26 17:41:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440017860169728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:41:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440038802329600 [0;39m 生成今日电子书快照开始
2022-08-26 17:41:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440038802329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:41:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440038802329600 [0;39m ==> Parameters: 
2022-08-26 17:41:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440038802329600 [0;39m <==    Updates: 0
2022-08-26 17:41:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440038802329600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:41:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440059786432512 [0;39m 生成今日电子书快照开始
2022-08-26 17:41:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440059786432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:41:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440059786432512 [0;39m ==> Parameters: 
2022-08-26 17:41:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440059786432512 [0;39m <==    Updates: 0
2022-08-26 17:41:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440059786432512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:41:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20440080757952512 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:41:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440080757952512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:41:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440080757952512 [0;39m ==> Parameters: 
2022-08-26 17:41:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440080757952512 [0;39m <==    Updates: 8
2022-08-26 17:41:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20440080757952512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:41:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440080766341120 [0;39m 生成今日电子书快照开始
2022-08-26 17:41:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440080766341120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:41:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440080766341120 [0;39m ==> Parameters: 
2022-08-26 17:41:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440080766341120 [0;39m <==    Updates: 0
2022-08-26 17:41:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440080766341120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:41:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440101729472512 [0;39m 生成今日电子书快照开始
2022-08-26 17:41:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440101729472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:41:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440101729472512 [0;39m ==> Parameters: 
2022-08-26 17:41:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440101729472512 [0;39m <==    Updates: 0
2022-08-26 17:41:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440101729472512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:41:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440122684215296 [0;39m 生成今日电子书快照开始
2022-08-26 17:41:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440122684215296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:41:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440122684215296 [0;39m ==> Parameters: 
2022-08-26 17:41:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440122684215296 [0;39m <==    Updates: 0
2022-08-26 17:41:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440122684215296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:41:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440143685095424 [0;39m 生成今日电子书快照开始
2022-08-26 17:41:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440143685095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:41:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440143685095424 [0;39m ==> Parameters: 
2022-08-26 17:41:50.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440143685095424 [0;39m <==    Updates: 0
2022-08-26 17:41:50.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440143685095424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:41:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440164635643904 [0;39m 生成今日电子书快照开始
2022-08-26 17:41:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440164635643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:41:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440164635643904 [0;39m ==> Parameters: 
2022-08-26 17:41:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440164635643904 [0;39m <==    Updates: 0
2022-08-26 17:41:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440164635643904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:42:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440185628135424 [0;39m 生成今日电子书快照开始
2022-08-26 17:42:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440185628135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:42:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440185628135424 [0;39m ==> Parameters: 
2022-08-26 17:42:00.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440185628135424 [0;39m <==    Updates: 0
2022-08-26 17:42:00.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440185628135424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:42:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20440206557712384 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:42:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440206557712384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:42:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440206557712384 [0;39m ==> Parameters: 
2022-08-26 17:42:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440206557712384 [0;39m <==    Updates: 8
2022-08-26 17:42:05.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20440206557712384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:42:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440206561906688 [0;39m 生成今日电子书快照开始
2022-08-26 17:42:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440206561906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:42:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440206561906688 [0;39m ==> Parameters: 
2022-08-26 17:42:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440206561906688 [0;39m <==    Updates: 0
2022-08-26 17:42:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440206561906688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:42:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440227516649472 [0;39m 生成今日电子书快照开始
2022-08-26 17:42:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440227516649472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:42:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440227516649472 [0;39m ==> Parameters: 
2022-08-26 17:42:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440227516649472 [0;39m <==    Updates: 0
2022-08-26 17:42:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440227516649472 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:42:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440248551084032 [0;39m 生成今日电子书快照开始
2022-08-26 17:42:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440248551084032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:42:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440248551084032 [0;39m ==> Parameters: 
2022-08-26 17:42:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440248551084032 [0;39m <==    Updates: 0
2022-08-26 17:42:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440248551084032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:42:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440269505826816 [0;39m 生成今日电子书快照开始
2022-08-26 17:42:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440269505826816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:42:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440269505826816 [0;39m ==> Parameters: 
2022-08-26 17:42:20.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440269505826816 [0;39m <==    Updates: 0
2022-08-26 17:42:20.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440269505826816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:42:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440290468958208 [0;39m 生成今日电子书快照开始
2022-08-26 17:42:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440290468958208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:42:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440290468958208 [0;39m ==> Parameters: 
2022-08-26 17:42:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440290468958208 [0;39m <==    Updates: 0
2022-08-26 17:42:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440290468958208 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:42:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440311469838336 [0;39m 生成今日电子书快照开始
2022-08-26 17:42:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440311469838336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:42:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440311469838336 [0;39m ==> Parameters: 
2022-08-26 17:42:30.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440311469838336 [0;39m <==    Updates: 0
2022-08-26 17:42:30.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440311469838336 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:42:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20440332386832384 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:42:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440332386832384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:42:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440332386832384 [0;39m ==> Parameters: 
2022-08-26 17:42:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440332386832384 [0;39m <==    Updates: 8
2022-08-26 17:42:35.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20440332386832384 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 17:42:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440332416192512 [0;39m 生成今日电子书快照开始
2022-08-26 17:42:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440332416192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:42:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440332416192512 [0;39m ==> Parameters: 
2022-08-26 17:42:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440332416192512 [0;39m <==    Updates: 0
2022-08-26 17:42:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440332416192512 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:42:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440353396101120 [0;39m 生成今日电子书快照开始
2022-08-26 17:42:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440353396101120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:42:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440353396101120 [0;39m ==> Parameters: 
2022-08-26 17:42:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440353396101120 [0;39m <==    Updates: 0
2022-08-26 17:42:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440353396101120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:42:45.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440374313095168 [0;39m 生成今日电子书快照开始
2022-08-26 17:42:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440374313095168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:42:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440374313095168 [0;39m ==> Parameters: 
2022-08-26 17:42:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440374313095168 [0;39m <==    Updates: 0
2022-08-26 17:42:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440374313095168 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:42:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440395339141120 [0;39m 生成今日电子书快照开始
2022-08-26 17:42:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440395339141120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:42:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440395339141120 [0;39m ==> Parameters: 
2022-08-26 17:42:50.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440395339141120 [0;39m <==    Updates: 0
2022-08-26 17:42:50.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440395339141120 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:42:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440416314855424 [0;39m 生成今日电子书快照开始
2022-08-26 17:42:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440416314855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:42:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440416314855424 [0;39m ==> Parameters: 
2022-08-26 17:42:55.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440416314855424 [0;39m <==    Updates: 0
2022-08-26 17:42:55.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440416314855424 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:43:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440437257015296 [0;39m 生成今日电子书快照开始
2022-08-26 17:43:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440437257015296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:43:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440437257015296 [0;39m ==> Parameters: 
2022-08-26 17:43:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440437257015296 [0;39m <==    Updates: 0
2022-08-26 17:43:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440437257015296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:43:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20440458232729600 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:43:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440458232729600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:43:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440458232729600 [0;39m ==> Parameters: 
2022-08-26 17:43:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440458232729600 [0;39m <==    Updates: 8
2022-08-26 17:43:05.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20440458232729600 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:43:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440458241118208 [0;39m 生成今日电子书快照开始
2022-08-26 17:43:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440458241118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:43:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440458241118208 [0;39m ==> Parameters: 
2022-08-26 17:43:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440458241118208 [0;39m <==    Updates: 0
2022-08-26 17:43:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440458241118208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:43:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440479237804032 [0;39m 生成今日电子书快照开始
2022-08-26 17:43:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440479237804032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:43:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440479237804032 [0;39m ==> Parameters: 
2022-08-26 17:43:10.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440479237804032 [0;39m <==    Updates: 0
2022-08-26 17:43:10.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440479237804032 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:43:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440500200935424 [0;39m 生成今日电子书快照开始
2022-08-26 17:43:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440500200935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:43:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440500200935424 [0;39m ==> Parameters: 
2022-08-26 17:43:15.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440500200935424 [0;39m <==    Updates: 0
2022-08-26 17:43:15.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440500200935424 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:43:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440521130512384 [0;39m 生成今日电子书快照开始
2022-08-26 17:43:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440521130512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:43:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440521130512384 [0;39m ==> Parameters: 
2022-08-26 17:43:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440521130512384 [0;39m <==    Updates: 0
2022-08-26 17:43:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440521130512384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:43:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440542139781120 [0;39m 生成今日电子书快照开始
2022-08-26 17:43:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440542139781120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:43:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440542139781120 [0;39m ==> Parameters: 
2022-08-26 17:43:25.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440542139781120 [0;39m <==    Updates: 0
2022-08-26 17:43:25.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440542139781120 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:43:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440563069358080 [0;39m 生成今日电子书快照开始
2022-08-26 17:43:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440563069358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:43:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440563069358080 [0;39m ==> Parameters: 
2022-08-26 17:43:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440563069358080 [0;39m <==    Updates: 0
2022-08-26 17:43:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440563069358080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:43:35.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440584032489472 [0;39m 生成今日电子书快照开始
2022-08-26 17:43:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440584032489472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:43:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440584032489472 [0;39m ==> Parameters: 
2022-08-26 17:43:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440584032489472 [0;39m <==    Updates: 0
2022-08-26 17:43:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440584032489472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:43:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20440584045072384 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:43:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440584045072384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:43:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440584045072384 [0;39m ==> Parameters: 
2022-08-26 17:43:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440584045072384 [0;39m <==    Updates: 8
2022-08-26 17:43:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20440584045072384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:43:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440605058535424 [0;39m 生成今日电子书快照开始
2022-08-26 17:43:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440605058535424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:43:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440605058535424 [0;39m ==> Parameters: 
2022-08-26 17:43:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440605058535424 [0;39m <==    Updates: 0
2022-08-26 17:43:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440605058535424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:43:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440625975529472 [0;39m 生成今日电子书快照开始
2022-08-26 17:43:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440625975529472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:43:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440625975529472 [0;39m ==> Parameters: 
2022-08-26 17:43:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440625975529472 [0;39m <==    Updates: 0
2022-08-26 17:43:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440625975529472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:43:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440646951243776 [0;39m 生成今日电子书快照开始
2022-08-26 17:43:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440646951243776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:43:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440646951243776 [0;39m ==> Parameters: 
2022-08-26 17:43:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440646951243776 [0;39m <==    Updates: 0
2022-08-26 17:43:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440646951243776 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:43:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440667922763776 [0;39m 生成今日电子书快照开始
2022-08-26 17:43:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440667922763776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:43:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440667922763776 [0;39m ==> Parameters: 
2022-08-26 17:43:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440667922763776 [0;39m <==    Updates: 0
2022-08-26 17:43:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440667922763776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:44:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440688953004032 [0;39m 生成今日电子书快照开始
2022-08-26 17:44:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440688953004032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:44:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440688953004032 [0;39m ==> Parameters: 
2022-08-26 17:44:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440688953004032 [0;39m <==    Updates: 0
2022-08-26 17:44:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440688953004032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:44:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20440709874192384 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:44:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440709874192384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:44:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440709874192384 [0;39m ==> Parameters: 
2022-08-26 17:44:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440709874192384 [0;39m <==    Updates: 8
2022-08-26 17:44:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20440709874192384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:44:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440709882580992 [0;39m 生成今日电子书快照开始
2022-08-26 17:44:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440709882580992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:44:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440709882580992 [0;39m ==> Parameters: 
2022-08-26 17:44:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440709882580992 [0;39m <==    Updates: 0
2022-08-26 17:44:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440709882580992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:44:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440730854100992 [0;39m 生成今日电子书快照开始
2022-08-26 17:44:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440730854100992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:44:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440730854100992 [0;39m ==> Parameters: 
2022-08-26 17:44:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440730854100992 [0;39m <==    Updates: 0
2022-08-26 17:44:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440730854100992 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:44:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440751834009600 [0;39m 生成今日电子书快照开始
2022-08-26 17:44:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440751834009600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:44:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440751834009600 [0;39m ==> Parameters: 
2022-08-26 17:44:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440751834009600 [0;39m <==    Updates: 0
2022-08-26 17:44:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440751834009600 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:44:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440772826501120 [0;39m 生成今日电子书快照开始
2022-08-26 17:44:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440772826501120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:44:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440772826501120 [0;39m ==> Parameters: 
2022-08-26 17:44:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440772826501120 [0;39m <==    Updates: 0
2022-08-26 17:44:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440772826501120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:44:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440793781243904 [0;39m 生成今日电子书快照开始
2022-08-26 17:44:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440793781243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:44:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440793781243904 [0;39m ==> Parameters: 
2022-08-26 17:44:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440793781243904 [0;39m <==    Updates: 0
2022-08-26 17:44:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440793781243904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:44:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440814744375296 [0;39m 生成今日电子书快照开始
2022-08-26 17:44:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440814744375296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:44:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440814744375296 [0;39m ==> Parameters: 
2022-08-26 17:44:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440814744375296 [0;39m <==    Updates: 0
2022-08-26 17:44:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440814744375296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:44:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20440835745255424 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:44:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440835745255424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:44:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440835745255424 [0;39m ==> Parameters: 
2022-08-26 17:44:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440835745255424 [0;39m <==    Updates: 8
2022-08-26 17:44:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20440835745255424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:44:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440835749449728 [0;39m 生成今日电子书快照开始
2022-08-26 17:44:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440835749449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:44:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440835749449728 [0;39m ==> Parameters: 
2022-08-26 17:44:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440835749449728 [0;39m <==    Updates: 0
2022-08-26 17:44:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440835749449728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:44:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440856666443776 [0;39m 生成今日电子书快照开始
2022-08-26 17:44:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440856666443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:44:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440856666443776 [0;39m ==> Parameters: 
2022-08-26 17:44:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440856666443776 [0;39m <==    Updates: 0
2022-08-26 17:44:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440856666443776 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:44:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440877650546688 [0;39m 生成今日电子书快照开始
2022-08-26 17:44:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440877650546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:44:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440877650546688 [0;39m ==> Parameters: 
2022-08-26 17:44:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440877650546688 [0;39m <==    Updates: 0
2022-08-26 17:44:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440877650546688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:44:50.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440898601095168 [0;39m 生成今日电子书快照开始
2022-08-26 17:44:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440898601095168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:44:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440898601095168 [0;39m ==> Parameters: 
2022-08-26 17:44:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440898601095168 [0;39m <==    Updates: 0
2022-08-26 17:44:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440898601095168 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:44:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440919622946816 [0;39m 生成今日电子书快照开始
2022-08-26 17:44:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440919622946816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:44:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440919622946816 [0;39m ==> Parameters: 
2022-08-26 17:44:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440919622946816 [0;39m <==    Updates: 0
2022-08-26 17:44:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440919622946816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:45:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440940548329472 [0;39m 生成今日电子书快照开始
2022-08-26 17:45:00.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440940548329472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:45:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440940548329472 [0;39m ==> Parameters: 
2022-08-26 17:45:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440940548329472 [0;39m <==    Updates: 0
2022-08-26 17:45:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440940548329472 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:45:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20440961582764032 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:45:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440961582764032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:45:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440961582764032 [0;39m ==> Parameters: 
2022-08-26 17:45:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20440961582764032 [0;39m <==    Updates: 8
2022-08-26 17:45:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20440961582764032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:45:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440961591152640 [0;39m 生成今日电子书快照开始
2022-08-26 17:45:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440961591152640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:45:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440961591152640 [0;39m ==> Parameters: 
2022-08-26 17:45:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440961591152640 [0;39m <==    Updates: 0
2022-08-26 17:45:05.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440961591152640 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:45:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20440982499758080 [0;39m 生成今日电子书快照开始
2022-08-26 17:45:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440982499758080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:45:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440982499758080 [0;39m ==> Parameters: 
2022-08-26 17:45:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20440982499758080 [0;39m <==    Updates: 0
2022-08-26 17:45:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20440982499758080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:45:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441003509026816 [0;39m 生成今日电子书快照开始
2022-08-26 17:45:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441003509026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:45:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441003509026816 [0;39m ==> Parameters: 
2022-08-26 17:45:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441003509026816 [0;39m <==    Updates: 0
2022-08-26 17:45:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441003509026816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:45:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441024455380992 [0;39m 生成今日电子书快照开始
2022-08-26 17:45:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441024455380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:45:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441024455380992 [0;39m ==> Parameters: 
2022-08-26 17:45:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441024455380992 [0;39m <==    Updates: 0
2022-08-26 17:45:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441024455380992 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 17:45:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441045435289600 [0;39m 生成今日电子书快照开始
2022-08-26 17:45:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441045435289600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:45:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441045435289600 [0;39m ==> Parameters: 
2022-08-26 17:45:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441045435289600 [0;39m <==    Updates: 0
2022-08-26 17:45:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441045435289600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:45:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441066402615296 [0;39m 生成今日电子书快照开始
2022-08-26 17:45:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441066402615296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:45:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441066402615296 [0;39m ==> Parameters: 
2022-08-26 17:45:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441066402615296 [0;39m <==    Updates: 0
2022-08-26 17:45:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441066402615296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:45:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441087403495424 [0;39m 生成今日电子书快照开始
2022-08-26 17:45:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441087403495424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:45:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441087403495424 [0;39m ==> Parameters: 
2022-08-26 17:45:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441087403495424 [0;39m <==    Updates: 0
2022-08-26 17:45:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441087403495424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:45:35.019 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20441087424466944 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:45:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441087424466944 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:45:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441087424466944 [0;39m ==> Parameters: 
2022-08-26 17:45:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441087424466944 [0;39m <==    Updates: 8
2022-08-26 17:45:35.020 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20441087424466944 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:45:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441108379209728 [0;39m 生成今日电子书快照开始
2022-08-26 17:45:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441108379209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:45:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441108379209728 [0;39m ==> Parameters: 
2022-08-26 17:45:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441108379209728 [0;39m <==    Updates: 0
2022-08-26 17:45:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441108379209728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:45:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441129333952512 [0;39m 生成今日电子书快照开始
2022-08-26 17:45:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441129333952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:45:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441129333952512 [0;39m ==> Parameters: 
2022-08-26 17:45:45.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441129333952512 [0;39m <==    Updates: 0
2022-08-26 17:45:45.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441129333952512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:45:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441150280306688 [0;39m 生成今日电子书快照开始
2022-08-26 17:45:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441150280306688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:45:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441150280306688 [0;39m ==> Parameters: 
2022-08-26 17:45:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441150280306688 [0;39m <==    Updates: 0
2022-08-26 17:45:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441150280306688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:45:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441171272798208 [0;39m 生成今日电子书快照开始
2022-08-26 17:45:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441171272798208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:45:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441171272798208 [0;39m ==> Parameters: 
2022-08-26 17:45:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441171272798208 [0;39m <==    Updates: 0
2022-08-26 17:45:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441171272798208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:46:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441192235929600 [0;39m 生成今日电子书快照开始
2022-08-26 17:46:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441192235929600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:46:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441192235929600 [0;39m ==> Parameters: 
2022-08-26 17:46:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441192235929600 [0;39m <==    Updates: 0
2022-08-26 17:46:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441192235929600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:46:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441213228421120 [0;39m 生成今日电子书快照开始
2022-08-26 17:46:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441213228421120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:46:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441213228421120 [0;39m ==> Parameters: 
2022-08-26 17:46:05.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441213228421120 [0;39m <==    Updates: 0
2022-08-26 17:46:05.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441213228421120 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:46:05.022 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20441213266169856 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:46:05.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441213266169856 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:46:05.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441213266169856 [0;39m ==> Parameters: 
2022-08-26 17:46:05.026 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441213266169856 [0;39m <==    Updates: 8
2022-08-26 17:46:05.026 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20441213266169856 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 17:46:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441234204135424 [0;39m 生成今日电子书快照开始
2022-08-26 17:46:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441234204135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:46:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441234204135424 [0;39m ==> Parameters: 
2022-08-26 17:46:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441234204135424 [0;39m <==    Updates: 0
2022-08-26 17:46:10.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441234204135424 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:46:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441255150489600 [0;39m 生成今日电子书快照开始
2022-08-26 17:46:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441255150489600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:46:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441255150489600 [0;39m ==> Parameters: 
2022-08-26 17:46:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441255150489600 [0;39m <==    Updates: 0
2022-08-26 17:46:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441255150489600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:46:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441276147175424 [0;39m 生成今日电子书快照开始
2022-08-26 17:46:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441276147175424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:46:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441276147175424 [0;39m ==> Parameters: 
2022-08-26 17:46:20.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441276147175424 [0;39m <==    Updates: 0
2022-08-26 17:46:20.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441276147175424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:46:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441297110306816 [0;39m 生成今日电子书快照开始
2022-08-26 17:46:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441297110306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:46:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441297110306816 [0;39m ==> Parameters: 
2022-08-26 17:46:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441297110306816 [0;39m <==    Updates: 0
2022-08-26 17:46:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441297110306816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:46:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441318060855296 [0;39m 生成今日电子书快照开始
2022-08-26 17:46:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441318060855296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:46:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441318060855296 [0;39m ==> Parameters: 
2022-08-26 17:46:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441318060855296 [0;39m <==    Updates: 0
2022-08-26 17:46:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441318060855296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:46:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441339036569600 [0;39m 生成今日电子书快照开始
2022-08-26 17:46:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441339036569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:46:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441339036569600 [0;39m ==> Parameters: 
2022-08-26 17:46:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441339036569600 [0;39m <==    Updates: 0
2022-08-26 17:46:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441339036569600 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:46:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20441339061735424 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:46:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441339061735424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:46:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441339061735424 [0;39m ==> Parameters: 
2022-08-26 17:46:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441339061735424 [0;39m <==    Updates: 8
2022-08-26 17:46:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20441339061735424 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 17:46:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441359987118080 [0;39m 生成今日电子书快照开始
2022-08-26 17:46:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441359987118080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:46:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441359987118080 [0;39m ==> Parameters: 
2022-08-26 17:46:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441359987118080 [0;39m <==    Updates: 0
2022-08-26 17:46:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441359987118080 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:46:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441380996386816 [0;39m 生成今日电子书快照开始
2022-08-26 17:46:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441380996386816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:46:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441380996386816 [0;39m ==> Parameters: 
2022-08-26 17:46:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441380996386816 [0;39m <==    Updates: 0
2022-08-26 17:46:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441380996386816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:46:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441401951129600 [0;39m 生成今日电子书快照开始
2022-08-26 17:46:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441401951129600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:46:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441401951129600 [0;39m ==> Parameters: 
2022-08-26 17:46:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441401951129600 [0;39m <==    Updates: 0
2022-08-26 17:46:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441401951129600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:46:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441422931038208 [0;39m 生成今日电子书快照开始
2022-08-26 17:46:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441422931038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:46:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441422931038208 [0;39m ==> Parameters: 
2022-08-26 17:46:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441422931038208 [0;39m <==    Updates: 0
2022-08-26 17:46:55.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441422931038208 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:47:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441443906752512 [0;39m 生成今日电子书快照开始
2022-08-26 17:47:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441443906752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:47:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441443906752512 [0;39m ==> Parameters: 
2022-08-26 17:47:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441443906752512 [0;39m <==    Updates: 0
2022-08-26 17:47:00.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441443906752512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:47:05.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441464840523776 [0;39m 生成今日电子书快照开始
2022-08-26 17:47:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441464840523776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:47:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441464840523776 [0;39m ==> Parameters: 
2022-08-26 17:47:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441464840523776 [0;39m <==    Updates: 0
2022-08-26 17:47:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441464840523776 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:47:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20441464874078208 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:47:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441464874078208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:47:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441464874078208 [0;39m ==> Parameters: 
2022-08-26 17:47:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441464874078208 [0;39m <==    Updates: 8
2022-08-26 17:47:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20441464874078208 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 17:47:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441485820432384 [0;39m 生成今日电子书快照开始
2022-08-26 17:47:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441485820432384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:47:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441485820432384 [0;39m ==> Parameters: 
2022-08-26 17:47:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441485820432384 [0;39m <==    Updates: 0
2022-08-26 17:47:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441485820432384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:47:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441506783563776 [0;39m 生成今日电子书快照开始
2022-08-26 17:47:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441506783563776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:47:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441506783563776 [0;39m ==> Parameters: 
2022-08-26 17:47:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441506783563776 [0;39m <==    Updates: 0
2022-08-26 17:47:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441506783563776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:47:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441527801221120 [0;39m 生成今日电子书快照开始
2022-08-26 17:47:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441527801221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:47:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441527801221120 [0;39m ==> Parameters: 
2022-08-26 17:47:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441527801221120 [0;39m <==    Updates: 0
2022-08-26 17:47:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441527801221120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:47:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441548739186688 [0;39m 生成今日电子书快照开始
2022-08-26 17:47:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441548739186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:47:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441548739186688 [0;39m ==> Parameters: 
2022-08-26 17:47:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441548739186688 [0;39m <==    Updates: 0
2022-08-26 17:47:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441548739186688 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:47:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441569748455424 [0;39m 生成今日电子书快照开始
2022-08-26 17:47:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441569748455424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:47:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441569748455424 [0;39m ==> Parameters: 
2022-08-26 17:47:30.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441569748455424 [0;39m <==    Updates: 0
2022-08-26 17:47:30.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441569748455424 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:47:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441590669643776 [0;39m 生成今日电子书快照开始
2022-08-26 17:47:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441590669643776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:47:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441590669643776 [0;39m ==> Parameters: 
2022-08-26 17:47:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441590669643776 [0;39m <==    Updates: 0
2022-08-26 17:47:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441590669643776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:47:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20441590678032384 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:47:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441590678032384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:47:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441590678032384 [0;39m ==> Parameters: 
2022-08-26 17:47:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441590678032384 [0;39m <==    Updates: 8
2022-08-26 17:47:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20441590678032384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:47:40.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441611632775168 [0;39m 生成今日电子书快照开始
2022-08-26 17:47:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441611632775168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:47:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441611632775168 [0;39m ==> Parameters: 
2022-08-26 17:47:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441611632775168 [0;39m <==    Updates: 0
2022-08-26 17:47:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441611632775168 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:47:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441632654626816 [0;39m 生成今日电子书快照开始
2022-08-26 17:47:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441632654626816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:47:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441632654626816 [0;39m ==> Parameters: 
2022-08-26 17:47:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441632654626816 [0;39m <==    Updates: 0
2022-08-26 17:47:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441632654626816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:47:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441653584203776 [0;39m 生成今日电子书快照开始
2022-08-26 17:47:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441653584203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:47:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441653584203776 [0;39m ==> Parameters: 
2022-08-26 17:47:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441653584203776 [0;39m <==    Updates: 0
2022-08-26 17:47:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441653584203776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:47:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441674606055424 [0;39m 生成今日电子书快照开始
2022-08-26 17:47:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441674606055424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:47:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441674606055424 [0;39m ==> Parameters: 
2022-08-26 17:47:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441674606055424 [0;39m <==    Updates: 0
2022-08-26 17:47:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441674606055424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:48:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441695523049472 [0;39m 生成今日电子书快照开始
2022-08-26 17:48:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441695523049472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:48:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441695523049472 [0;39m ==> Parameters: 
2022-08-26 17:48:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441695523049472 [0;39m <==    Updates: 0
2022-08-26 17:48:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441695523049472 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:48:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20441716532318208 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:48:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441716532318208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:48:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441716532318208 [0;39m ==> Parameters: 
2022-08-26 17:48:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441716532318208 [0;39m <==    Updates: 8
2022-08-26 17:48:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20441716532318208 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 17:48:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441716549095424 [0;39m 生成今日电子书快照开始
2022-08-26 17:48:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441716549095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:48:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441716549095424 [0;39m ==> Parameters: 
2022-08-26 17:48:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441716549095424 [0;39m <==    Updates: 0
2022-08-26 17:48:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441716549095424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:48:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441737470283776 [0;39m 生成今日电子书快照开始
2022-08-26 17:48:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441737470283776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:48:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441737470283776 [0;39m ==> Parameters: 
2022-08-26 17:48:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441737470283776 [0;39m <==    Updates: 0
2022-08-26 17:48:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441737470283776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:48:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441758454386688 [0;39m 生成今日电子书快照开始
2022-08-26 17:48:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441758454386688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:48:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441758454386688 [0;39m ==> Parameters: 
2022-08-26 17:48:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441758454386688 [0;39m <==    Updates: 0
2022-08-26 17:48:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441758454386688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:48:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441779438489600 [0;39m 生成今日电子书快照开始
2022-08-26 17:48:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441779438489600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:48:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441779438489600 [0;39m ==> Parameters: 
2022-08-26 17:48:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441779438489600 [0;39m <==    Updates: 0
2022-08-26 17:48:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441779438489600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:48:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441800389038080 [0;39m 生成今日电子书快照开始
2022-08-26 17:48:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441800389038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:48:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441800389038080 [0;39m ==> Parameters: 
2022-08-26 17:48:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441800389038080 [0;39m <==    Updates: 0
2022-08-26 17:48:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441800389038080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:48:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441821373140992 [0;39m 生成今日电子书快照开始
2022-08-26 17:48:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441821373140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:48:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441821373140992 [0;39m ==> Parameters: 
2022-08-26 17:48:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441821373140992 [0;39m <==    Updates: 0
2022-08-26 17:48:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441821373140992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:48:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20441842340466688 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:48:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441842340466688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:48:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441842340466688 [0;39m ==> Parameters: 
2022-08-26 17:48:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441842340466688 [0;39m <==    Updates: 8
2022-08-26 17:48:35.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20441842340466688 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-26 17:48:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441842365632512 [0;39m 生成今日电子书快照开始
2022-08-26 17:48:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441842365632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:48:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441842365632512 [0;39m ==> Parameters: 
2022-08-26 17:48:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441842365632512 [0;39m <==    Updates: 0
2022-08-26 17:48:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441842365632512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:48:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441863353929728 [0;39m 生成今日电子书快照开始
2022-08-26 17:48:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441863353929728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:48:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441863353929728 [0;39m ==> Parameters: 
2022-08-26 17:48:40.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441863353929728 [0;39m <==    Updates: 0
2022-08-26 17:48:40.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441863353929728 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:48:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441884279312384 [0;39m 生成今日电子书快照开始
2022-08-26 17:48:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441884279312384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:48:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441884279312384 [0;39m ==> Parameters: 
2022-08-26 17:48:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441884279312384 [0;39m <==    Updates: 0
2022-08-26 17:48:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441884279312384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:48:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441905280192512 [0;39m 生成今日电子书快照开始
2022-08-26 17:48:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441905280192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:48:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441905280192512 [0;39m ==> Parameters: 
2022-08-26 17:48:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441905280192512 [0;39m <==    Updates: 0
2022-08-26 17:48:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441905280192512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:48:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441926251712512 [0;39m 生成今日电子书快照开始
2022-08-26 17:48:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441926251712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:48:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441926251712512 [0;39m ==> Parameters: 
2022-08-26 17:48:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441926251712512 [0;39m <==    Updates: 0
2022-08-26 17:48:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441926251712512 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:49:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441947227426816 [0;39m 生成今日电子书快照开始
2022-08-26 17:49:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441947227426816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:49:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441947227426816 [0;39m ==> Parameters: 
2022-08-26 17:49:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441947227426816 [0;39m <==    Updates: 0
2022-08-26 17:49:00.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441947227426816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:49:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441968190558208 [0;39m 生成今日电子书快照开始
2022-08-26 17:49:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441968190558208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:49:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441968190558208 [0;39m ==> Parameters: 
2022-08-26 17:49:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441968190558208 [0;39m <==    Updates: 0
2022-08-26 17:49:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441968190558208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:49:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20441968198946816 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:49:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441968198946816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:49:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441968198946816 [0;39m ==> Parameters: 
2022-08-26 17:49:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20441968198946816 [0;39m <==    Updates: 8
2022-08-26 17:49:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20441968198946816 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:49:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20441989170466816 [0;39m 生成今日电子书快照开始
2022-08-26 17:49:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441989170466816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:49:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441989170466816 [0;39m ==> Parameters: 
2022-08-26 17:49:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20441989170466816 [0;39m <==    Updates: 0
2022-08-26 17:49:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20441989170466816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:49:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442010108432384 [0;39m 生成今日电子书快照开始
2022-08-26 17:49:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442010108432384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:49:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442010108432384 [0;39m ==> Parameters: 
2022-08-26 17:49:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442010108432384 [0;39m <==    Updates: 0
2022-08-26 17:49:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442010108432384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:49:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442031071563776 [0;39m 生成今日电子书快照开始
2022-08-26 17:49:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442031071563776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:49:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442031071563776 [0;39m ==> Parameters: 
2022-08-26 17:49:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442031071563776 [0;39m <==    Updates: 0
2022-08-26 17:49:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442031071563776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:49:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442052068249600 [0;39m 生成今日电子书快照开始
2022-08-26 17:49:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442052068249600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:49:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442052068249600 [0;39m ==> Parameters: 
2022-08-26 17:49:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442052068249600 [0;39m <==    Updates: 0
2022-08-26 17:49:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442052068249600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:49:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442073031380992 [0;39m 生成今日电子书快照开始
2022-08-26 17:49:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442073031380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:49:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442073031380992 [0;39m ==> Parameters: 
2022-08-26 17:49:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442073031380992 [0;39m <==    Updates: 0
2022-08-26 17:49:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442073031380992 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 17:49:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442094036455424 [0;39m 生成今日电子书快照开始
2022-08-26 17:49:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442094036455424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:49:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442094036455424 [0;39m ==> Parameters: 
2022-08-26 17:49:35.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442094036455424 [0;39m <==    Updates: 0
2022-08-26 17:49:35.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442094036455424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:49:35.021 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20442094065815552 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:49:35.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442094065815552 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:49:35.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442094065815552 [0;39m ==> Parameters: 
2022-08-26 17:49:35.025 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442094065815552 [0;39m <==    Updates: 8
2022-08-26 17:49:35.025 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20442094065815552 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 17:49:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442115007975424 [0;39m 生成今日电子书快照开始
2022-08-26 17:49:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442115007975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:49:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442115007975424 [0;39m ==> Parameters: 
2022-08-26 17:49:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442115007975424 [0;39m <==    Updates: 0
2022-08-26 17:49:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442115007975424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:49:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442135954329600 [0;39m 生成今日电子书快照开始
2022-08-26 17:49:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442135954329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:49:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442135954329600 [0;39m ==> Parameters: 
2022-08-26 17:49:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442135954329600 [0;39m <==    Updates: 0
2022-08-26 17:49:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442135954329600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:49:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442156946821120 [0;39m 生成今日电子书快照开始
2022-08-26 17:49:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442156946821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:49:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442156946821120 [0;39m ==> Parameters: 
2022-08-26 17:49:50.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442156946821120 [0;39m <==    Updates: 0
2022-08-26 17:49:50.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442156946821120 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:49:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442177893175296 [0;39m 生成今日电子书快照开始
2022-08-26 17:49:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442177893175296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:49:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442177893175296 [0;39m ==> Parameters: 
2022-08-26 17:49:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442177893175296 [0;39m <==    Updates: 0
2022-08-26 17:49:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442177893175296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:50:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442198847918080 [0;39m 生成今日电子书快照开始
2022-08-26 17:50:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442198847918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:50:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442198847918080 [0;39m ==> Parameters: 
2022-08-26 17:50:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442198847918080 [0;39m <==    Updates: 0
2022-08-26 17:50:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442198847918080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:50:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20442219857186816 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:50:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442219857186816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:50:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442219857186816 [0;39m ==> Parameters: 
2022-08-26 17:50:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442219857186816 [0;39m <==    Updates: 8
2022-08-26 17:50:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20442219857186816 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 17:50:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442219878158336 [0;39m 生成今日电子书快照开始
2022-08-26 17:50:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442219878158336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:50:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442219878158336 [0;39m ==> Parameters: 
2022-08-26 17:50:05.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442219878158336 [0;39m <==    Updates: 0
2022-08-26 17:50:05.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442219878158336 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:50:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442240828706816 [0;39m 生成今日电子书快照开始
2022-08-26 17:50:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442240828706816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:50:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442240828706816 [0;39m ==> Parameters: 
2022-08-26 17:50:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442240828706816 [0;39m <==    Updates: 0
2022-08-26 17:50:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442240828706816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:50:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442261754089472 [0;39m 生成今日电子书快照开始
2022-08-26 17:50:15.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442261754089472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:50:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442261754089472 [0;39m ==> Parameters: 
2022-08-26 17:50:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442261754089472 [0;39m <==    Updates: 0
2022-08-26 17:50:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442261754089472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:50:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442282742386688 [0;39m 生成今日电子书快照开始
2022-08-26 17:50:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442282742386688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:50:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442282742386688 [0;39m ==> Parameters: 
2022-08-26 17:50:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442282742386688 [0;39m <==    Updates: 0
2022-08-26 17:50:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442282742386688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:50:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442303730683904 [0;39m 生成今日电子书快照开始
2022-08-26 17:50:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442303730683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:50:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442303730683904 [0;39m ==> Parameters: 
2022-08-26 17:50:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442303730683904 [0;39m <==    Updates: 0
2022-08-26 17:50:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442303730683904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:50:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442324706398208 [0;39m 生成今日电子书快照开始
2022-08-26 17:50:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442324706398208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:50:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442324706398208 [0;39m ==> Parameters: 
2022-08-26 17:50:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442324706398208 [0;39m <==    Updates: 0
2022-08-26 17:50:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442324706398208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:50:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20442345677918208 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:50:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442345677918208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:50:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442345677918208 [0;39m ==> Parameters: 
2022-08-26 17:50:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442345677918208 [0;39m <==    Updates: 8
2022-08-26 17:50:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20442345677918208 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:50:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442345686306816 [0;39m 生成今日电子书快照开始
2022-08-26 17:50:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442345686306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:50:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442345686306816 [0;39m ==> Parameters: 
2022-08-26 17:50:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442345686306816 [0;39m <==    Updates: 0
2022-08-26 17:50:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442345686306816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:50:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442366628466688 [0;39m 生成今日电子书快照开始
2022-08-26 17:50:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442366628466688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:50:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442366628466688 [0;39m ==> Parameters: 
2022-08-26 17:50:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442366628466688 [0;39m <==    Updates: 0
2022-08-26 17:50:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442366628466688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:50:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442387633541120 [0;39m 生成今日电子书快照开始
2022-08-26 17:50:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442387633541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:50:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442387633541120 [0;39m ==> Parameters: 
2022-08-26 17:50:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442387633541120 [0;39m <==    Updates: 0
2022-08-26 17:50:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442387633541120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:50:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442408592478208 [0;39m 生成今日电子书快照开始
2022-08-26 17:50:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442408592478208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:50:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442408592478208 [0;39m ==> Parameters: 
2022-08-26 17:50:50.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442408592478208 [0;39m <==    Updates: 0
2022-08-26 17:50:50.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442408592478208 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 17:50:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442429555609600 [0;39m 生成今日电子书快照开始
2022-08-26 17:50:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442429555609600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:50:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442429555609600 [0;39m ==> Parameters: 
2022-08-26 17:50:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442429555609600 [0;39m <==    Updates: 0
2022-08-26 17:50:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442429555609600 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:51:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442450552295424 [0;39m 生成今日电子书快照开始
2022-08-26 17:51:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442450552295424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:51:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442450552295424 [0;39m ==> Parameters: 
2022-08-26 17:51:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442450552295424 [0;39m <==    Updates: 0
2022-08-26 17:51:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442450552295424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:51:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20442471515426816 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:51:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442471515426816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:51:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442471515426816 [0;39m ==> Parameters: 
2022-08-26 17:51:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442471515426816 [0;39m <==    Updates: 8
2022-08-26 17:51:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20442471515426816 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:51:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442471523815424 [0;39m 生成今日电子书快照开始
2022-08-26 17:51:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442471523815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:51:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442471523815424 [0;39m ==> Parameters: 
2022-08-26 17:51:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442471523815424 [0;39m <==    Updates: 0
2022-08-26 17:51:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442471523815424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:51:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442492491141120 [0;39m 生成今日电子书快照开始
2022-08-26 17:51:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442492491141120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:51:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442492491141120 [0;39m ==> Parameters: 
2022-08-26 17:51:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442492491141120 [0;39m <==    Updates: 0
2022-08-26 17:51:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442492491141120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:51:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442513433300992 [0;39m 生成今日电子书快照开始
2022-08-26 17:51:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442513433300992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:51:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442513433300992 [0;39m ==> Parameters: 
2022-08-26 17:51:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442513433300992 [0;39m <==    Updates: 0
2022-08-26 17:51:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442513433300992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:51:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442534383849472 [0;39m 生成今日电子书快照开始
2022-08-26 17:51:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442534383849472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:51:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442534383849472 [0;39m ==> Parameters: 
2022-08-26 17:51:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442534383849472 [0;39m <==    Updates: 0
2022-08-26 17:51:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442534383849472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:51:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442555359563776 [0;39m 生成今日电子书快照开始
2022-08-26 17:51:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442555359563776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:51:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442555359563776 [0;39m ==> Parameters: 
2022-08-26 17:51:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442555359563776 [0;39m <==    Updates: 0
2022-08-26 17:51:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442555359563776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:51:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442576377221120 [0;39m 生成今日电子书快照开始
2022-08-26 17:51:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442576377221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:51:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442576377221120 [0;39m ==> Parameters: 
2022-08-26 17:51:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442576377221120 [0;39m <==    Updates: 0
2022-08-26 17:51:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442576377221120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:51:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20442597336158208 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:51:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442597336158208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:51:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442597336158208 [0;39m ==> Parameters: 
2022-08-26 17:51:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442597336158208 [0;39m <==    Updates: 8
2022-08-26 17:51:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20442597336158208 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 17:51:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442597357129728 [0;39m 生成今日电子书快照开始
2022-08-26 17:51:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442597357129728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:51:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442597357129728 [0;39m ==> Parameters: 
2022-08-26 17:51:35.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442597357129728 [0;39m <==    Updates: 0
2022-08-26 17:51:35.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442597357129728 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:51:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442618307678208 [0;39m 生成今日电子书快照开始
2022-08-26 17:51:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442618307678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:51:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442618307678208 [0;39m ==> Parameters: 
2022-08-26 17:51:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442618307678208 [0;39m <==    Updates: 0
2022-08-26 17:51:40.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442618307678208 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:51:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442639241449472 [0;39m 生成今日电子书快照开始
2022-08-26 17:51:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442639241449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:51:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442639241449472 [0;39m ==> Parameters: 
2022-08-26 17:51:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442639241449472 [0;39m <==    Updates: 0
2022-08-26 17:51:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442639241449472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:51:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442660233940992 [0;39m 生成今日电子书快照开始
2022-08-26 17:51:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442660233940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:51:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442660233940992 [0;39m ==> Parameters: 
2022-08-26 17:51:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442660233940992 [0;39m <==    Updates: 0
2022-08-26 17:51:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442660233940992 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:51:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442681197072384 [0;39m 生成今日电子书快照开始
2022-08-26 17:51:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442681197072384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:51:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442681197072384 [0;39m ==> Parameters: 
2022-08-26 17:51:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442681197072384 [0;39m <==    Updates: 0
2022-08-26 17:51:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442681197072384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:52:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442702202146816 [0;39m 生成今日电子书快照开始
2022-08-26 17:52:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442702202146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:52:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442702202146816 [0;39m ==> Parameters: 
2022-08-26 17:52:00.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442702202146816 [0;39m <==    Updates: 0
2022-08-26 17:52:00.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442702202146816 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:52:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442723190444032 [0;39m 生成今日电子书快照开始
2022-08-26 17:52:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442723190444032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:52:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442723190444032 [0;39m ==> Parameters: 
2022-08-26 17:52:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442723190444032 [0;39m <==    Updates: 0
2022-08-26 17:52:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442723190444032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:52:05.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20442723198832640 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:52:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442723198832640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:52:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442723198832640 [0;39m ==> Parameters: 
2022-08-26 17:52:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442723198832640 [0;39m <==    Updates: 8
2022-08-26 17:52:05.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20442723198832640 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:52:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442744120020992 [0;39m 生成今日电子书快照开始
2022-08-26 17:52:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442744120020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:52:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442744120020992 [0;39m ==> Parameters: 
2022-08-26 17:52:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442744120020992 [0;39m <==    Updates: 0
2022-08-26 17:52:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442744120020992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:52:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442765112512512 [0;39m 生成今日电子书快照开始
2022-08-26 17:52:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442765112512512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:52:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442765112512512 [0;39m ==> Parameters: 
2022-08-26 17:52:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442765112512512 [0;39m <==    Updates: 0
2022-08-26 17:52:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442765112512512 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:52:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442786079838208 [0;39m 生成今日电子书快照开始
2022-08-26 17:52:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442786079838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:52:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442786079838208 [0;39m ==> Parameters: 
2022-08-26 17:52:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442786079838208 [0;39m <==    Updates: 0
2022-08-26 17:52:20.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442786079838208 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:52:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442807068135424 [0;39m 生成今日电子书快照开始
2022-08-26 17:52:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442807068135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:52:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442807068135424 [0;39m ==> Parameters: 
2022-08-26 17:52:25.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442807068135424 [0;39m <==    Updates: 0
2022-08-26 17:52:25.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442807068135424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:52:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442828010295296 [0;39m 生成今日电子书快照开始
2022-08-26 17:52:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442828010295296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:52:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442828010295296 [0;39m ==> Parameters: 
2022-08-26 17:52:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442828010295296 [0;39m <==    Updates: 0
2022-08-26 17:52:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442828010295296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:52:35.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20442848960843776 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:52:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442848960843776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:52:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442848960843776 [0;39m ==> Parameters: 
2022-08-26 17:52:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442848960843776 [0;39m <==    Updates: 8
2022-08-26 17:52:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20442848960843776 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 17:52:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442848981815296 [0;39m 生成今日电子书快照开始
2022-08-26 17:52:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442848981815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:52:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442848981815296 [0;39m ==> Parameters: 
2022-08-26 17:52:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442848981815296 [0;39m <==    Updates: 0
2022-08-26 17:52:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442848981815296 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:52:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442869953335296 [0;39m 生成今日电子书快照开始
2022-08-26 17:52:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442869953335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:52:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442869953335296 [0;39m ==> Parameters: 
2022-08-26 17:52:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442869953335296 [0;39m <==    Updates: 0
2022-08-26 17:52:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442869953335296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:52:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442890912272384 [0;39m 生成今日电子书快照开始
2022-08-26 17:52:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442890912272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:52:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442890912272384 [0;39m ==> Parameters: 
2022-08-26 17:52:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442890912272384 [0;39m <==    Updates: 0
2022-08-26 17:52:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442890912272384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:52:50.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442911867015168 [0;39m 生成今日电子书快照开始
2022-08-26 17:52:50.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442911867015168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:52:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442911867015168 [0;39m ==> Parameters: 
2022-08-26 17:52:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442911867015168 [0;39m <==    Updates: 0
2022-08-26 17:52:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442911867015168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:52:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442932855312384 [0;39m 生成今日电子书快照开始
2022-08-26 17:52:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442932855312384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:52:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442932855312384 [0;39m ==> Parameters: 
2022-08-26 17:52:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442932855312384 [0;39m <==    Updates: 0
2022-08-26 17:52:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442932855312384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:53:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442953847803904 [0;39m 生成今日电子书快照开始
2022-08-26 17:53:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442953847803904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:53:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442953847803904 [0;39m ==> Parameters: 
2022-08-26 17:53:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442953847803904 [0;39m <==    Updates: 0
2022-08-26 17:53:00.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442953847803904 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 17:53:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20442974836101120 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:53:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442974836101120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:53:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442974836101120 [0;39m ==> Parameters: 
2022-08-26 17:53:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20442974836101120 [0;39m <==    Updates: 8
2022-08-26 17:53:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20442974836101120 [0;39m 更新电子书下的文档数据结束，耗时：0 毫秒
2022-08-26 17:53:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442974836101121 [0;39m 生成今日电子书快照开始
2022-08-26 17:53:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442974836101121 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:53:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442974836101121 [0;39m ==> Parameters: 
2022-08-26 17:53:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442974836101121 [0;39m <==    Updates: 0
2022-08-26 17:53:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442974836101121 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:53:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20442995811815424 [0;39m 生成今日电子书快照开始
2022-08-26 17:53:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442995811815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:53:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442995811815424 [0;39m ==> Parameters: 
2022-08-26 17:53:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20442995811815424 [0;39m <==    Updates: 0
2022-08-26 17:53:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20442995811815424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:53:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443016770752512 [0;39m 生成今日电子书快照开始
2022-08-26 17:53:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443016770752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:53:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443016770752512 [0;39m ==> Parameters: 
2022-08-26 17:53:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443016770752512 [0;39m <==    Updates: 0
2022-08-26 17:53:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443016770752512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:53:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443037700329472 [0;39m 生成今日电子书快照开始
2022-08-26 17:53:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443037700329472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:53:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443037700329472 [0;39m ==> Parameters: 
2022-08-26 17:53:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443037700329472 [0;39m <==    Updates: 0
2022-08-26 17:53:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443037700329472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:53:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443058730569728 [0;39m 生成今日电子书快照开始
2022-08-26 17:53:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443058730569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:53:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443058730569728 [0;39m ==> Parameters: 
2022-08-26 17:53:25.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443058730569728 [0;39m <==    Updates: 0
2022-08-26 17:53:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443058730569728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:53:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443079655952384 [0;39m 生成今日电子书快照开始
2022-08-26 17:53:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443079655952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:53:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443079655952384 [0;39m ==> Parameters: 
2022-08-26 17:53:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443079655952384 [0;39m <==    Updates: 0
2022-08-26 17:53:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443079655952384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:53:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443100656832512 [0;39m 生成今日电子书快照开始
2022-08-26 17:53:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443100656832512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:53:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443100656832512 [0;39m ==> Parameters: 
2022-08-26 17:53:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443100656832512 [0;39m <==    Updates: 0
2022-08-26 17:53:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443100656832512 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:53:35.019 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20443100690386944 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:53:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443100690386944 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:53:35.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443100690386944 [0;39m ==> Parameters: 
2022-08-26 17:53:35.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443100690386944 [0;39m <==    Updates: 8
2022-08-26 17:53:35.023 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20443100690386944 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 17:53:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443121594798080 [0;39m 生成今日电子书快照开始
2022-08-26 17:53:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443121594798080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:53:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443121594798080 [0;39m ==> Parameters: 
2022-08-26 17:53:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443121594798080 [0;39m <==    Updates: 0
2022-08-26 17:53:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443121594798080 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:53:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443142587289600 [0;39m 生成今日电子书快照开始
2022-08-26 17:53:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443142587289600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:53:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443142587289600 [0;39m ==> Parameters: 
2022-08-26 17:53:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443142587289600 [0;39m <==    Updates: 0
2022-08-26 17:53:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443142587289600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:53:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443163563003904 [0;39m 生成今日电子书快照开始
2022-08-26 17:53:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443163563003904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:53:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443163563003904 [0;39m ==> Parameters: 
2022-08-26 17:53:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443163563003904 [0;39m <==    Updates: 0
2022-08-26 17:53:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443163563003904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:53:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443184521940992 [0;39m 生成今日电子书快照开始
2022-08-26 17:53:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443184521940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:53:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443184521940992 [0;39m ==> Parameters: 
2022-08-26 17:53:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443184521940992 [0;39m <==    Updates: 0
2022-08-26 17:53:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443184521940992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:54:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443205493460992 [0;39m 生成今日电子书快照开始
2022-08-26 17:54:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443205493460992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:54:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443205493460992 [0;39m ==> Parameters: 
2022-08-26 17:54:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443205493460992 [0;39m <==    Updates: 0
2022-08-26 17:54:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443205493460992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:54:05.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443226444009472 [0;39m 生成今日电子书快照开始
2022-08-26 17:54:05.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443226444009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:54:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443226444009472 [0;39m ==> Parameters: 
2022-08-26 17:54:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443226444009472 [0;39m <==    Updates: 0
2022-08-26 17:54:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443226444009472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:54:05.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20443226452398080 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:54:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443226452398080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:54:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443226452398080 [0;39m ==> Parameters: 
2022-08-26 17:54:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443226452398080 [0;39m <==    Updates: 8
2022-08-26 17:54:05.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20443226452398080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:54:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443247440695296 [0;39m 生成今日电子书快照开始
2022-08-26 17:54:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443247440695296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:54:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443247440695296 [0;39m ==> Parameters: 
2022-08-26 17:54:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443247440695296 [0;39m <==    Updates: 0
2022-08-26 17:54:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443247440695296 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:54:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443268428992512 [0;39m 生成今日电子书快照开始
2022-08-26 17:54:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443268428992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:54:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443268428992512 [0;39m ==> Parameters: 
2022-08-26 17:54:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443268428992512 [0;39m <==    Updates: 0
2022-08-26 17:54:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443268428992512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:54:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443289379540992 [0;39m 生成今日电子书快照开始
2022-08-26 17:54:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443289379540992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:54:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443289379540992 [0;39m ==> Parameters: 
2022-08-26 17:54:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443289379540992 [0;39m <==    Updates: 0
2022-08-26 17:54:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443289379540992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:54:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443310355255296 [0;39m 生成今日电子书快照开始
2022-08-26 17:54:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443310355255296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:54:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443310355255296 [0;39m ==> Parameters: 
2022-08-26 17:54:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443310355255296 [0;39m <==    Updates: 0
2022-08-26 17:54:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443310355255296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:54:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443331330969600 [0;39m 生成今日电子书快照开始
2022-08-26 17:54:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443331330969600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:54:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443331330969600 [0;39m ==> Parameters: 
2022-08-26 17:54:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443331330969600 [0;39m <==    Updates: 0
2022-08-26 17:54:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443331330969600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:54:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20443352315072512 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:54:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443352315072512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:54:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443352315072512 [0;39m ==> Parameters: 
2022-08-26 17:54:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443352315072512 [0;39m <==    Updates: 8
2022-08-26 17:54:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20443352315072512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:54:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443352323461120 [0;39m 生成今日电子书快照开始
2022-08-26 17:54:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443352323461120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:54:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443352323461120 [0;39m ==> Parameters: 
2022-08-26 17:54:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443352323461120 [0;39m <==    Updates: 0
2022-08-26 17:54:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443352323461120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:54:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443373307564032 [0;39m 生成今日电子书快照开始
2022-08-26 17:54:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443373307564032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:54:40.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443373307564032 [0;39m ==> Parameters: 
2022-08-26 17:54:40.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443373307564032 [0;39m <==    Updates: 0
2022-08-26 17:54:40.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443373307564032 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:54:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443394270695424 [0;39m 生成今日电子书快照开始
2022-08-26 17:54:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443394270695424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:54:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443394270695424 [0;39m ==> Parameters: 
2022-08-26 17:54:45.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443394270695424 [0;39m <==    Updates: 0
2022-08-26 17:54:45.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443394270695424 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:54:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443415196078080 [0;39m 生成今日电子书快照开始
2022-08-26 17:54:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443415196078080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:54:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443415196078080 [0;39m ==> Parameters: 
2022-08-26 17:54:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443415196078080 [0;39m <==    Updates: 0
2022-08-26 17:54:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443415196078080 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:54:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443436201152512 [0;39m 生成今日电子书快照开始
2022-08-26 17:54:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443436201152512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:54:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443436201152512 [0;39m ==> Parameters: 
2022-08-26 17:54:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443436201152512 [0;39m <==    Updates: 0
2022-08-26 17:54:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443436201152512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:55:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443457189449728 [0;39m 生成今日电子书快照开始
2022-08-26 17:55:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443457189449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:55:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443457189449728 [0;39m ==> Parameters: 
2022-08-26 17:55:00.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443457189449728 [0;39m <==    Updates: 0
2022-08-26 17:55:00.025 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443457189449728 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 17:55:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443478148386816 [0;39m 生成今日电子书快照开始
2022-08-26 17:55:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443478148386816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:55:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443478148386816 [0;39m ==> Parameters: 
2022-08-26 17:55:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443478148386816 [0;39m <==    Updates: 0
2022-08-26 17:55:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443478148386816 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:55:05.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20443478173552640 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:55:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443478173552640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:55:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443478173552640 [0;39m ==> Parameters: 
2022-08-26 17:55:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443478173552640 [0;39m <==    Updates: 8
2022-08-26 17:55:05.020 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20443478173552640 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:55:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443499136684032 [0;39m 生成今日电子书快照开始
2022-08-26 17:55:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443499136684032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:55:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443499136684032 [0;39m ==> Parameters: 
2022-08-26 17:55:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443499136684032 [0;39m <==    Updates: 0
2022-08-26 17:55:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443499136684032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:55:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443520066260992 [0;39m 生成今日电子书快照开始
2022-08-26 17:55:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443520066260992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:55:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443520066260992 [0;39m ==> Parameters: 
2022-08-26 17:55:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443520066260992 [0;39m <==    Updates: 0
2022-08-26 17:55:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443520066260992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:55:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443541062946816 [0;39m 生成今日电子书快照开始
2022-08-26 17:55:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443541062946816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:55:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443541062946816 [0;39m ==> Parameters: 
2022-08-26 17:55:20.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443541062946816 [0;39m <==    Updates: 0
2022-08-26 17:55:20.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443541062946816 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:55:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443561996718080 [0;39m 生成今日电子书快照开始
2022-08-26 17:55:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443561996718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:55:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443561996718080 [0;39m ==> Parameters: 
2022-08-26 17:55:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443561996718080 [0;39m <==    Updates: 0
2022-08-26 17:55:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443561996718080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:55:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443582964043776 [0;39m 生成今日电子书快照开始
2022-08-26 17:55:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443582964043776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:55:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443582964043776 [0;39m ==> Parameters: 
2022-08-26 17:55:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443582964043776 [0;39m <==    Updates: 0
2022-08-26 17:55:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443582964043776 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:55:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20443603939758080 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:55:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443603939758080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:55:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443603939758080 [0;39m ==> Parameters: 
2022-08-26 17:55:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443603939758080 [0;39m <==    Updates: 8
2022-08-26 17:55:35.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20443603939758080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:55:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443603943952384 [0;39m 生成今日电子书快照开始
2022-08-26 17:55:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443603943952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:55:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443603943952384 [0;39m ==> Parameters: 
2022-08-26 17:55:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443603943952384 [0;39m <==    Updates: 0
2022-08-26 17:55:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443603943952384 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 17:55:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443624944832512 [0;39m 生成今日电子书快照开始
2022-08-26 17:55:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443624944832512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:55:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443624944832512 [0;39m ==> Parameters: 
2022-08-26 17:55:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443624944832512 [0;39m <==    Updates: 0
2022-08-26 17:55:40.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443624944832512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:55:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443645878603776 [0;39m 生成今日电子书快照开始
2022-08-26 17:55:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443645878603776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:55:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443645878603776 [0;39m ==> Parameters: 
2022-08-26 17:55:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443645878603776 [0;39m <==    Updates: 0
2022-08-26 17:55:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443645878603776 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 17:55:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443666875289600 [0;39m 生成今日电子书快照开始
2022-08-26 17:55:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443666875289600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:55:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443666875289600 [0;39m ==> Parameters: 
2022-08-26 17:55:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443666875289600 [0;39m <==    Updates: 0
2022-08-26 17:55:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443666875289600 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:55:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443687863586816 [0;39m 生成今日电子书快照开始
2022-08-26 17:55:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443687863586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:55:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443687863586816 [0;39m ==> Parameters: 
2022-08-26 17:55:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443687863586816 [0;39m <==    Updates: 0
2022-08-26 17:55:55.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443687863586816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:56:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443708830912512 [0;39m 生成今日电子书快照开始
2022-08-26 17:56:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443708830912512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:56:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443708830912512 [0;39m ==> Parameters: 
2022-08-26 17:56:00.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443708830912512 [0;39m <==    Updates: 0
2022-08-26 17:56:00.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443708830912512 [0;39m 生成今日电子书快照结束，耗时：11 毫秒
2022-08-26 17:56:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443729789849600 [0;39m 生成今日电子书快照开始
2022-08-26 17:56:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443729789849600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:56:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443729789849600 [0;39m ==> Parameters: 
2022-08-26 17:56:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443729789849600 [0;39m <==    Updates: 0
2022-08-26 17:56:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443729789849600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:56:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20443729798238208 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:56:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443729798238208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:56:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443729798238208 [0;39m ==> Parameters: 
2022-08-26 17:56:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443729798238208 [0;39m <==    Updates: 8
2022-08-26 17:56:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20443729798238208 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:56:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443750748786688 [0;39m 生成今日电子书快照开始
2022-08-26 17:56:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443750748786688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:56:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443750748786688 [0;39m ==> Parameters: 
2022-08-26 17:56:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443750748786688 [0;39m <==    Updates: 0
2022-08-26 17:56:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443750748786688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:56:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443771716112384 [0;39m 生成今日电子书快照开始
2022-08-26 17:56:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443771716112384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:56:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443771716112384 [0;39m ==> Parameters: 
2022-08-26 17:56:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443771716112384 [0;39m <==    Updates: 0
2022-08-26 17:56:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443771716112384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:56:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443792704409600 [0;39m 生成今日电子书快照开始
2022-08-26 17:56:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443792704409600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:56:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443792704409600 [0;39m ==> Parameters: 
2022-08-26 17:56:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443792704409600 [0;39m <==    Updates: 0
2022-08-26 17:56:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443792704409600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:56:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443813663346688 [0;39m 生成今日电子书快照开始
2022-08-26 17:56:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443813663346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:56:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443813663346688 [0;39m ==> Parameters: 
2022-08-26 17:56:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443813663346688 [0;39m <==    Updates: 0
2022-08-26 17:56:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443813663346688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:56:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443834622283776 [0;39m 生成今日电子书快照开始
2022-08-26 17:56:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443834622283776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:56:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443834622283776 [0;39m ==> Parameters: 
2022-08-26 17:56:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443834622283776 [0;39m <==    Updates: 0
2022-08-26 17:56:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443834622283776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:56:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20443855644135424 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:56:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443855644135424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:56:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443855644135424 [0;39m ==> Parameters: 
2022-08-26 17:56:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443855644135424 [0;39m <==    Updates: 8
2022-08-26 17:56:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20443855644135424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 17:56:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443855648329728 [0;39m 生成今日电子书快照开始
2022-08-26 17:56:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443855648329728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:56:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443855648329728 [0;39m ==> Parameters: 
2022-08-26 17:56:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443855648329728 [0;39m <==    Updates: 0
2022-08-26 17:56:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443855648329728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:56:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443876598878208 [0;39m 生成今日电子书快照开始
2022-08-26 17:56:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443876598878208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:56:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443876598878208 [0;39m ==> Parameters: 
2022-08-26 17:56:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443876598878208 [0;39m <==    Updates: 0
2022-08-26 17:56:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443876598878208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:56:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443897562009600 [0;39m 生成今日电子书快照开始
2022-08-26 17:56:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443897562009600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:56:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443897562009600 [0;39m ==> Parameters: 
2022-08-26 17:56:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443897562009600 [0;39m <==    Updates: 0
2022-08-26 17:56:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443897562009600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:56:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443918533529600 [0;39m 生成今日电子书快照开始
2022-08-26 17:56:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443918533529600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:56:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443918533529600 [0;39m ==> Parameters: 
2022-08-26 17:56:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443918533529600 [0;39m <==    Updates: 0
2022-08-26 17:56:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443918533529600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:56:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443939530215424 [0;39m 生成今日电子书快照开始
2022-08-26 17:56:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443939530215424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:56:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443939530215424 [0;39m ==> Parameters: 
2022-08-26 17:56:55.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443939530215424 [0;39m <==    Updates: 0
2022-08-26 17:56:55.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443939530215424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:57:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443960463986688 [0;39m 生成今日电子书快照开始
2022-08-26 17:57:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443960463986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:57:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443960463986688 [0;39m ==> Parameters: 
2022-08-26 17:57:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443960463986688 [0;39m <==    Updates: 0
2022-08-26 17:57:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443960463986688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:57:05.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20443981418729472 [0;39m 生成今日电子书快照开始
2022-08-26 17:57:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443981418729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:57:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443981418729472 [0;39m ==> Parameters: 
2022-08-26 17:57:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20443981418729472 [0;39m <==    Updates: 0
2022-08-26 17:57:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20443981418729472 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:57:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20443981452283904 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:57:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443981452283904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:57:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443981452283904 [0;39m ==> Parameters: 
2022-08-26 17:57:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20443981452283904 [0;39m <==    Updates: 8
2022-08-26 17:57:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20443981452283904 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 17:57:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444002390249472 [0;39m 生成今日电子书快照开始
2022-08-26 17:57:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444002390249472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:57:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444002390249472 [0;39m ==> Parameters: 
2022-08-26 17:57:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444002390249472 [0;39m <==    Updates: 0
2022-08-26 17:57:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444002390249472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:57:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444023403712512 [0;39m 生成今日电子书快照开始
2022-08-26 17:57:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444023403712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:57:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444023403712512 [0;39m ==> Parameters: 
2022-08-26 17:57:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444023403712512 [0;39m <==    Updates: 0
2022-08-26 17:57:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444023403712512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:57:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444044350066688 [0;39m 生成今日电子书快照开始
2022-08-26 17:57:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444044350066688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:57:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444044350066688 [0;39m ==> Parameters: 
2022-08-26 17:57:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444044350066688 [0;39m <==    Updates: 0
2022-08-26 17:57:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444044350066688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:57:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444065355141120 [0;39m 生成今日电子书快照开始
2022-08-26 17:57:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444065355141120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:57:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444065355141120 [0;39m ==> Parameters: 
2022-08-26 17:57:25.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444065355141120 [0;39m <==    Updates: 0
2022-08-26 17:57:25.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444065355141120 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:57:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444086276329472 [0;39m 生成今日电子书快照开始
2022-08-26 17:57:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444086276329472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:57:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444086276329472 [0;39m ==> Parameters: 
2022-08-26 17:57:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444086276329472 [0;39m <==    Updates: 0
2022-08-26 17:57:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444086276329472 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:57:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444107273015296 [0;39m 生成今日电子书快照开始
2022-08-26 17:57:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444107273015296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:57:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444107273015296 [0;39m ==> Parameters: 
2022-08-26 17:57:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444107273015296 [0;39m <==    Updates: 0
2022-08-26 17:57:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444107273015296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:57:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20444107289792512 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:57:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444107289792512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:57:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444107289792512 [0;39m ==> Parameters: 
2022-08-26 17:57:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444107289792512 [0;39m <==    Updates: 8
2022-08-26 17:57:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20444107289792512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:57:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444128282284032 [0;39m 生成今日电子书快照开始
2022-08-26 17:57:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444128282284032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:57:40.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444128282284032 [0;39m ==> Parameters: 
2022-08-26 17:57:40.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444128282284032 [0;39m <==    Updates: 0
2022-08-26 17:57:40.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444128282284032 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:57:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444149224443904 [0;39m 生成今日电子书快照开始
2022-08-26 17:57:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444149224443904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:57:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444149224443904 [0;39m ==> Parameters: 
2022-08-26 17:57:45.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444149224443904 [0;39m <==    Updates: 0
2022-08-26 17:57:45.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444149224443904 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 17:57:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444170191769600 [0;39m 生成今日电子书快照开始
2022-08-26 17:57:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444170191769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:57:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444170191769600 [0;39m ==> Parameters: 
2022-08-26 17:57:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444170191769600 [0;39m <==    Updates: 0
2022-08-26 17:57:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444170191769600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:57:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444191146512384 [0;39m 生成今日电子书快照开始
2022-08-26 17:57:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444191146512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:57:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444191146512384 [0;39m ==> Parameters: 
2022-08-26 17:57:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444191146512384 [0;39m <==    Updates: 0
2022-08-26 17:57:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444191146512384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:58:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444212159975424 [0;39m 生成今日电子书快照开始
2022-08-26 17:58:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444212159975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:58:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444212159975424 [0;39m ==> Parameters: 
2022-08-26 17:58:00.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444212159975424 [0;39m <==    Updates: 0
2022-08-26 17:58:00.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444212159975424 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 17:58:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444233135689728 [0;39m 生成今日电子书快照开始
2022-08-26 17:58:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444233135689728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:58:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444233135689728 [0;39m ==> Parameters: 
2022-08-26 17:58:05.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444233135689728 [0;39m <==    Updates: 0
2022-08-26 17:58:05.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444233135689728 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:58:05.023 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20444233169244160 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:58:05.024 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444233169244160 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:58:05.025 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444233169244160 [0;39m ==> Parameters: 
2022-08-26 17:58:05.027 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444233169244160 [0;39m <==    Updates: 8
2022-08-26 17:58:05.028 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20444233169244160 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 17:58:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444254086238208 [0;39m 生成今日电子书快照开始
2022-08-26 17:58:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444254086238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:58:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444254086238208 [0;39m ==> Parameters: 
2022-08-26 17:58:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444254086238208 [0;39m <==    Updates: 0
2022-08-26 17:58:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444254086238208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:58:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444275078729728 [0;39m 生成今日电子书快照开始
2022-08-26 17:58:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444275078729728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:58:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444275078729728 [0;39m ==> Parameters: 
2022-08-26 17:58:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444275078729728 [0;39m <==    Updates: 0
2022-08-26 17:58:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444275078729728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:58:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444296050249728 [0;39m 生成今日电子书快照开始
2022-08-26 17:58:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444296050249728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:58:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444296050249728 [0;39m ==> Parameters: 
2022-08-26 17:58:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444296050249728 [0;39m <==    Updates: 0
2022-08-26 17:58:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444296050249728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:58:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444317009186816 [0;39m 生成今日电子书快照开始
2022-08-26 17:58:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444317009186816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:58:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444317009186816 [0;39m ==> Parameters: 
2022-08-26 17:58:25.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444317009186816 [0;39m <==    Updates: 0
2022-08-26 17:58:25.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444317009186816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:58:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444337980706816 [0;39m 生成今日电子书快照开始
2022-08-26 17:58:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444337980706816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:58:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444337980706816 [0;39m ==> Parameters: 
2022-08-26 17:58:30.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444337980706816 [0;39m <==    Updates: 0
2022-08-26 17:58:30.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444337980706816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:58:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444358922866688 [0;39m 生成今日电子书快照开始
2022-08-26 17:58:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444358922866688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:58:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444358922866688 [0;39m ==> Parameters: 
2022-08-26 17:58:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444358922866688 [0;39m <==    Updates: 0
2022-08-26 17:58:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444358922866688 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:58:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20444358956421120 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:58:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444358956421120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:58:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444358956421120 [0;39m ==> Parameters: 
2022-08-26 17:58:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444358956421120 [0;39m <==    Updates: 8
2022-08-26 17:58:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20444358956421120 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 17:58:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444379881803776 [0;39m 生成今日电子书快照开始
2022-08-26 17:58:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444379881803776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:58:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444379881803776 [0;39m ==> Parameters: 
2022-08-26 17:58:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444379881803776 [0;39m <==    Updates: 0
2022-08-26 17:58:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444379881803776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:58:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444400899461120 [0;39m 生成今日电子书快照开始
2022-08-26 17:58:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444400899461120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:58:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444400899461120 [0;39m ==> Parameters: 
2022-08-26 17:58:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444400899461120 [0;39m <==    Updates: 0
2022-08-26 17:58:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444400899461120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:58:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444421854203904 [0;39m 生成今日电子书快照开始
2022-08-26 17:58:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444421854203904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:58:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444421854203904 [0;39m ==> Parameters: 
2022-08-26 17:58:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444421854203904 [0;39m <==    Updates: 0
2022-08-26 17:58:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444421854203904 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:58:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444442796363776 [0;39m 生成今日电子书快照开始
2022-08-26 17:58:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444442796363776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:58:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444442796363776 [0;39m ==> Parameters: 
2022-08-26 17:58:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444442796363776 [0;39m <==    Updates: 0
2022-08-26 17:58:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444442796363776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:59:00.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444463759495168 [0;39m 生成今日电子书快照开始
2022-08-26 17:59:00.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444463759495168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:59:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444463759495168 [0;39m ==> Parameters: 
2022-08-26 17:59:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444463759495168 [0;39m <==    Updates: 0
2022-08-26 17:59:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444463759495168 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:59:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20444484772958208 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:59:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444484772958208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:59:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444484772958208 [0;39m ==> Parameters: 
2022-08-26 17:59:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444484772958208 [0;39m <==    Updates: 8
2022-08-26 17:59:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20444484772958208 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-26 17:59:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444484798124032 [0;39m 生成今日电子书快照开始
2022-08-26 17:59:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444484798124032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:59:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444484798124032 [0;39m ==> Parameters: 
2022-08-26 17:59:05.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444484798124032 [0;39m <==    Updates: 0
2022-08-26 17:59:05.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444484798124032 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 17:59:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444505744478208 [0;39m 生成今日电子书快照开始
2022-08-26 17:59:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444505744478208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:59:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444505744478208 [0;39m ==> Parameters: 
2022-08-26 17:59:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444505744478208 [0;39m <==    Updates: 0
2022-08-26 17:59:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444505744478208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:59:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444526741164032 [0;39m 生成今日电子书快照开始
2022-08-26 17:59:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444526741164032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:59:15.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444526741164032 [0;39m ==> Parameters: 
2022-08-26 17:59:15.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444526741164032 [0;39m <==    Updates: 0
2022-08-26 17:59:15.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444526741164032 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 17:59:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444547691712512 [0;39m 生成今日电子书快照开始
2022-08-26 17:59:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444547691712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:59:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444547691712512 [0;39m ==> Parameters: 
2022-08-26 17:59:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444547691712512 [0;39m <==    Updates: 0
2022-08-26 17:59:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444547691712512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:59:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444568663232512 [0;39m 生成今日电子书快照开始
2022-08-26 17:59:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444568663232512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:59:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444568663232512 [0;39m ==> Parameters: 
2022-08-26 17:59:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444568663232512 [0;39m <==    Updates: 0
2022-08-26 17:59:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444568663232512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:59:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444589609586688 [0;39m 生成今日电子书快照开始
2022-08-26 17:59:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444589609586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:59:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444589609586688 [0;39m ==> Parameters: 
2022-08-26 17:59:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444589609586688 [0;39m <==    Updates: 0
2022-08-26 17:59:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444589609586688 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 17:59:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444610568523776 [0;39m 生成今日电子书快照开始
2022-08-26 17:59:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444610568523776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:59:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444610568523776 [0;39m ==> Parameters: 
2022-08-26 17:59:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444610568523776 [0;39m <==    Updates: 0
2022-08-26 17:59:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444610568523776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 17:59:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20444610581106688 [0;39m 更新电子书下的文档数据开始
2022-08-26 17:59:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444610581106688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 17:59:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444610581106688 [0;39m ==> Parameters: 
2022-08-26 17:59:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444610581106688 [0;39m <==    Updates: 8
2022-08-26 17:59:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20444610581106688 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 17:59:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444631561015296 [0;39m 生成今日电子书快照开始
2022-08-26 17:59:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444631561015296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:59:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444631561015296 [0;39m ==> Parameters: 
2022-08-26 17:59:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444631561015296 [0;39m <==    Updates: 0
2022-08-26 17:59:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444631561015296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:59:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444652519952384 [0;39m 生成今日电子书快照开始
2022-08-26 17:59:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444652519952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:59:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444652519952384 [0;39m ==> Parameters: 
2022-08-26 17:59:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444652519952384 [0;39m <==    Updates: 0
2022-08-26 17:59:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444652519952384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 17:59:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444673533415424 [0;39m 生成今日电子书快照开始
2022-08-26 17:59:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444673533415424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:59:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444673533415424 [0;39m ==> Parameters: 
2022-08-26 17:59:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444673533415424 [0;39m <==    Updates: 0
2022-08-26 17:59:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444673533415424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 17:59:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444694492352512 [0;39m 生成今日电子书快照开始
2022-08-26 17:59:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444694492352512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 17:59:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444694492352512 [0;39m ==> Parameters: 
2022-08-26 17:59:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444694492352512 [0;39m <==    Updates: 0
2022-08-26 17:59:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444694492352512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:00:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444715459678208 [0;39m 生成今日电子书快照开始
2022-08-26 18:00:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444715459678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:00:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444715459678208 [0;39m ==> Parameters: 
2022-08-26 18:00:00.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444715459678208 [0;39m <==    Updates: 0
2022-08-26 18:00:00.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444715459678208 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 18:00:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444736447975424 [0;39m 生成今日电子书快照开始
2022-08-26 18:00:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444736447975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:00:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444736447975424 [0;39m ==> Parameters: 
2022-08-26 18:00:05.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444736447975424 [0;39m <==    Updates: 0
2022-08-26 18:00:05.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444736447975424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:00:05.023 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20444736481529856 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:00:05.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444736481529856 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:00:05.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444736481529856 [0;39m ==> Parameters: 
2022-08-26 18:00:05.025 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444736481529856 [0;39m <==    Updates: 8
2022-08-26 18:00:05.026 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20444736481529856 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 18:00:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444757423689728 [0;39m 生成今日电子书快照开始
2022-08-26 18:00:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444757423689728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:00:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444757423689728 [0;39m ==> Parameters: 
2022-08-26 18:00:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444757423689728 [0;39m <==    Updates: 0
2022-08-26 18:00:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444757423689728 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:00:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444778340683776 [0;39m 生成今日电子书快照开始
2022-08-26 18:00:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444778340683776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:00:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444778340683776 [0;39m ==> Parameters: 
2022-08-26 18:00:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444778340683776 [0;39m <==    Updates: 0
2022-08-26 18:00:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444778340683776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:00:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444799345758208 [0;39m 生成今日电子书快照开始
2022-08-26 18:00:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444799345758208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:00:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444799345758208 [0;39m ==> Parameters: 
2022-08-26 18:00:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444799345758208 [0;39m <==    Updates: 0
2022-08-26 18:00:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444799345758208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:00:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444820334055424 [0;39m 生成今日电子书快照开始
2022-08-26 18:00:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444820334055424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:00:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444820334055424 [0;39m ==> Parameters: 
2022-08-26 18:00:25.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444820334055424 [0;39m <==    Updates: 0
2022-08-26 18:00:25.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444820334055424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:00:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444841276215296 [0;39m 生成今日电子书快照开始
2022-08-26 18:00:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444841276215296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:00:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444841276215296 [0;39m ==> Parameters: 
2022-08-26 18:00:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444841276215296 [0;39m <==    Updates: 0
2022-08-26 18:00:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444841276215296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:00:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20444862251929600 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:00:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444862251929600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:00:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444862251929600 [0;39m ==> Parameters: 
2022-08-26 18:00:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444862251929600 [0;39m <==    Updates: 8
2022-08-26 18:00:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20444862251929600 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 18:00:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444862277095424 [0;39m 生成今日电子书快照开始
2022-08-26 18:00:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444862277095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:00:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444862277095424 [0;39m ==> Parameters: 
2022-08-26 18:00:35.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444862277095424 [0;39m <==    Updates: 0
2022-08-26 18:00:35.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444862277095424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:00:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444883248615424 [0;39m 生成今日电子书快照开始
2022-08-26 18:00:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444883248615424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:00:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444883248615424 [0;39m ==> Parameters: 
2022-08-26 18:00:40.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444883248615424 [0;39m <==    Updates: 0
2022-08-26 18:00:40.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444883248615424 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:00:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444904169803776 [0;39m 生成今日电子书快照开始
2022-08-26 18:00:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444904169803776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:00:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444904169803776 [0;39m ==> Parameters: 
2022-08-26 18:00:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444904169803776 [0;39m <==    Updates: 0
2022-08-26 18:00:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444904169803776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:00:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444925174878208 [0;39m 生成今日电子书快照开始
2022-08-26 18:00:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444925174878208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:00:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444925174878208 [0;39m ==> Parameters: 
2022-08-26 18:00:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444925174878208 [0;39m <==    Updates: 0
2022-08-26 18:00:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444925174878208 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:00:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444946150592512 [0;39m 生成今日电子书快照开始
2022-08-26 18:00:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444946150592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:00:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444946150592512 [0;39m ==> Parameters: 
2022-08-26 18:00:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444946150592512 [0;39m <==    Updates: 0
2022-08-26 18:00:55.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444946150592512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:01:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444967130501120 [0;39m 生成今日电子书快照开始
2022-08-26 18:01:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444967130501120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:01:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444967130501120 [0;39m ==> Parameters: 
2022-08-26 18:01:00.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444967130501120 [0;39m <==    Updates: 0
2022-08-26 18:01:00.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444967130501120 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 18:01:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20444988068466688 [0;39m 生成今日电子书快照开始
2022-08-26 18:01:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444988068466688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:01:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444988068466688 [0;39m ==> Parameters: 
2022-08-26 18:01:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20444988068466688 [0;39m <==    Updates: 0
2022-08-26 18:01:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20444988068466688 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:01:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20444988102021120 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:01:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444988102021120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:01:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444988102021120 [0;39m ==> Parameters: 
2022-08-26 18:01:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20444988102021120 [0;39m <==    Updates: 8
2022-08-26 18:01:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20444988102021120 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 18:01:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445009039986688 [0;39m 生成今日电子书快照开始
2022-08-26 18:01:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445009039986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:01:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445009039986688 [0;39m ==> Parameters: 
2022-08-26 18:01:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445009039986688 [0;39m <==    Updates: 0
2022-08-26 18:01:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445009039986688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:01:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445030024089600 [0;39m 生成今日电子书快照开始
2022-08-26 18:01:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445030024089600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:01:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445030024089600 [0;39m ==> Parameters: 
2022-08-26 18:01:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445030024089600 [0;39m <==    Updates: 0
2022-08-26 18:01:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445030024089600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:01:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445050995609600 [0;39m 生成今日电子书快照开始
2022-08-26 18:01:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445050995609600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:01:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445050995609600 [0;39m ==> Parameters: 
2022-08-26 18:01:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445050995609600 [0;39m <==    Updates: 0
2022-08-26 18:01:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445050995609600 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:01:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445071950352384 [0;39m 生成今日电子书快照开始
2022-08-26 18:01:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445071950352384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:01:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445071950352384 [0;39m ==> Parameters: 
2022-08-26 18:01:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445071950352384 [0;39m <==    Updates: 0
2022-08-26 18:01:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445071950352384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:01:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445092909289472 [0;39m 生成今日电子书快照开始
2022-08-26 18:01:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445092909289472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:01:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445092909289472 [0;39m ==> Parameters: 
2022-08-26 18:01:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445092909289472 [0;39m <==    Updates: 0
2022-08-26 18:01:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445092909289472 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:01:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20445113897586688 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:01:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445113897586688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:01:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445113897586688 [0;39m ==> Parameters: 
2022-08-26 18:01:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445113897586688 [0;39m <==    Updates: 8
2022-08-26 18:01:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20445113897586688 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:01:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445113905975296 [0;39m 生成今日电子书快照开始
2022-08-26 18:01:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445113905975296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:01:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445113905975296 [0;39m ==> Parameters: 
2022-08-26 18:01:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445113905975296 [0;39m <==    Updates: 0
2022-08-26 18:01:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445113905975296 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:01:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445134885883904 [0;39m 生成今日电子书快照开始
2022-08-26 18:01:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445134885883904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:01:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445134885883904 [0;39m ==> Parameters: 
2022-08-26 18:01:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445134885883904 [0;39m <==    Updates: 0
2022-08-26 18:01:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445134885883904 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:01:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445155832238080 [0;39m 生成今日电子书快照开始
2022-08-26 18:01:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445155832238080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:01:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445155832238080 [0;39m ==> Parameters: 
2022-08-26 18:01:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445155832238080 [0;39m <==    Updates: 0
2022-08-26 18:01:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445155832238080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:01:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445176828923904 [0;39m 生成今日电子书快照开始
2022-08-26 18:01:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445176828923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:01:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445176828923904 [0;39m ==> Parameters: 
2022-08-26 18:01:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445176828923904 [0;39m <==    Updates: 0
2022-08-26 18:01:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445176828923904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:01:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445197800443904 [0;39m 生成今日电子书快照开始
2022-08-26 18:01:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445197800443904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:01:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445197800443904 [0;39m ==> Parameters: 
2022-08-26 18:01:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445197800443904 [0;39m <==    Updates: 0
2022-08-26 18:01:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445197800443904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:02:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445218759380992 [0;39m 生成今日电子书快照开始
2022-08-26 18:02:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445218759380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:02:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445218759380992 [0;39m ==> Parameters: 
2022-08-26 18:02:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445218759380992 [0;39m <==    Updates: 0
2022-08-26 18:02:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445218759380992 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 18:02:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20445239726706688 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:02:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445239726706688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:02:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445239726706688 [0;39m ==> Parameters: 
2022-08-26 18:02:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445239726706688 [0;39m <==    Updates: 8
2022-08-26 18:02:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20445239726706688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:02:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445239730900992 [0;39m 生成今日电子书快照开始
2022-08-26 18:02:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445239730900992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:02:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445239730900992 [0;39m ==> Parameters: 
2022-08-26 18:02:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445239730900992 [0;39m <==    Updates: 0
2022-08-26 18:02:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445239730900992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:02:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445260719198208 [0;39m 生成今日电子书快照开始
2022-08-26 18:02:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445260719198208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:02:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445260719198208 [0;39m ==> Parameters: 
2022-08-26 18:02:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445260719198208 [0;39m <==    Updates: 0
2022-08-26 18:02:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445260719198208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:02:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445281699106816 [0;39m 生成今日电子书快照开始
2022-08-26 18:02:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445281699106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:02:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445281699106816 [0;39m ==> Parameters: 
2022-08-26 18:02:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445281699106816 [0;39m <==    Updates: 0
2022-08-26 18:02:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445281699106816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:02:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445302653849600 [0;39m 生成今日电子书快照开始
2022-08-26 18:02:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445302653849600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:02:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445302653849600 [0;39m ==> Parameters: 
2022-08-26 18:02:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445302653849600 [0;39m <==    Updates: 0
2022-08-26 18:02:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445302653849600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:02:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445323612786688 [0;39m 生成今日电子书快照开始
2022-08-26 18:02:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445323612786688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:02:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445323612786688 [0;39m ==> Parameters: 
2022-08-26 18:02:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445323612786688 [0;39m <==    Updates: 0
2022-08-26 18:02:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445323612786688 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:02:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445344571723776 [0;39m 生成今日电子书快照开始
2022-08-26 18:02:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445344571723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:02:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445344571723776 [0;39m ==> Parameters: 
2022-08-26 18:02:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445344571723776 [0;39m <==    Updates: 0
2022-08-26 18:02:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445344571723776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:02:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445365576798208 [0;39m 生成今日电子书快照开始
2022-08-26 18:02:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445365576798208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:02:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445365576798208 [0;39m ==> Parameters: 
2022-08-26 18:02:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445365576798208 [0;39m <==    Updates: 0
2022-08-26 18:02:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445365576798208 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 18:02:35.019 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20445365614546944 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:02:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445365614546944 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:02:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445365614546944 [0;39m ==> Parameters: 
2022-08-26 18:02:35.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445365614546944 [0;39m <==    Updates: 8
2022-08-26 18:02:35.023 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20445365614546944 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 18:02:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445386569289728 [0;39m 生成今日电子书快照开始
2022-08-26 18:02:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445386569289728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:02:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445386569289728 [0;39m ==> Parameters: 
2022-08-26 18:02:40.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445386569289728 [0;39m <==    Updates: 0
2022-08-26 18:02:40.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445386569289728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:02:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445407486283776 [0;39m 生成今日电子书快照开始
2022-08-26 18:02:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445407486283776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:02:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445407486283776 [0;39m ==> Parameters: 
2022-08-26 18:02:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445407486283776 [0;39m <==    Updates: 0
2022-08-26 18:02:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445407486283776 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:02:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445428516524032 [0;39m 生成今日电子书快照开始
2022-08-26 18:02:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445428516524032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:02:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445428516524032 [0;39m ==> Parameters: 
2022-08-26 18:02:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445428516524032 [0;39m <==    Updates: 0
2022-08-26 18:02:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445428516524032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:02:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445449433518080 [0;39m 生成今日电子书快照开始
2022-08-26 18:02:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445449433518080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:02:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445449433518080 [0;39m ==> Parameters: 
2022-08-26 18:02:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445449433518080 [0;39m <==    Updates: 0
2022-08-26 18:02:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445449433518080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:03:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445470405038080 [0;39m 生成今日电子书快照开始
2022-08-26 18:03:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445470405038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:03:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445470405038080 [0;39m ==> Parameters: 
2022-08-26 18:03:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445470405038080 [0;39m <==    Updates: 0
2022-08-26 18:03:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445470405038080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:03:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20445491431084032 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:03:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445491431084032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:03:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445491431084032 [0;39m ==> Parameters: 
2022-08-26 18:03:05.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445491431084032 [0;39m <==    Updates: 8
2022-08-26 18:03:05.022 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20445491431084032 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-26 18:03:05.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445491460444160 [0;39m 生成今日电子书快照开始
2022-08-26 18:03:05.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445491460444160 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:03:05.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445491460444160 [0;39m ==> Parameters: 
2022-08-26 18:03:05.027 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445491460444160 [0;39m <==    Updates: 0
2022-08-26 18:03:05.027 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445491460444160 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:03:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445512360660992 [0;39m 生成今日电子书快照开始
2022-08-26 18:03:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445512360660992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:03:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445512360660992 [0;39m ==> Parameters: 
2022-08-26 18:03:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445512360660992 [0;39m <==    Updates: 0
2022-08-26 18:03:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445512360660992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:03:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445533369929728 [0;39m 生成今日电子书快照开始
2022-08-26 18:03:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445533369929728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:03:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445533369929728 [0;39m ==> Parameters: 
2022-08-26 18:03:15.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445533369929728 [0;39m <==    Updates: 0
2022-08-26 18:03:15.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445533369929728 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:03:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445554295312384 [0;39m 生成今日电子书快照开始
2022-08-26 18:03:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445554295312384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:03:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445554295312384 [0;39m ==> Parameters: 
2022-08-26 18:03:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445554295312384 [0;39m <==    Updates: 0
2022-08-26 18:03:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445554295312384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:03:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445575262638080 [0;39m 生成今日电子书快照开始
2022-08-26 18:03:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445575262638080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:03:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445575262638080 [0;39m ==> Parameters: 
2022-08-26 18:03:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445575262638080 [0;39m <==    Updates: 0
2022-08-26 18:03:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445575262638080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:03:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445596255129600 [0;39m 生成今日电子书快照开始
2022-08-26 18:03:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445596255129600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:03:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445596255129600 [0;39m ==> Parameters: 
2022-08-26 18:03:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445596255129600 [0;39m <==    Updates: 0
2022-08-26 18:03:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445596255129600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:03:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20445617247621120 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:03:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445617247621120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:03:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445617247621120 [0;39m ==> Parameters: 
2022-08-26 18:03:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445617247621120 [0;39m <==    Updates: 8
2022-08-26 18:03:35.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20445617247621120 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 18:03:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445617272786944 [0;39m 生成今日电子书快照开始
2022-08-26 18:03:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445617272786944 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:03:35.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445617272786944 [0;39m ==> Parameters: 
2022-08-26 18:03:35.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445617272786944 [0;39m <==    Updates: 0
2022-08-26 18:03:35.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445617272786944 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:03:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445638168809472 [0;39m 生成今日电子书快照开始
2022-08-26 18:03:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445638168809472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:03:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445638168809472 [0;39m ==> Parameters: 
2022-08-26 18:03:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445638168809472 [0;39m <==    Updates: 0
2022-08-26 18:03:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445638168809472 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:03:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445659169689600 [0;39m 生成今日电子书快照开始
2022-08-26 18:03:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445659169689600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:03:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445659169689600 [0;39m ==> Parameters: 
2022-08-26 18:03:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445659169689600 [0;39m <==    Updates: 0
2022-08-26 18:03:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445659169689600 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:03:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445680153792512 [0;39m 生成今日电子书快照开始
2022-08-26 18:03:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445680153792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:03:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445680153792512 [0;39m ==> Parameters: 
2022-08-26 18:03:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445680153792512 [0;39m <==    Updates: 0
2022-08-26 18:03:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445680153792512 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:03:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445701095952384 [0;39m 生成今日电子书快照开始
2022-08-26 18:03:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445701095952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:03:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445701095952384 [0;39m ==> Parameters: 
2022-08-26 18:03:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445701095952384 [0;39m <==    Updates: 0
2022-08-26 18:03:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445701095952384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:04:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445722063278080 [0;39m 生成今日电子书快照开始
2022-08-26 18:04:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445722063278080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:04:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445722063278080 [0;39m ==> Parameters: 
2022-08-26 18:04:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445722063278080 [0;39m <==    Updates: 0
2022-08-26 18:04:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445722063278080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:04:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20445743076741120 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:04:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445743076741120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:04:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445743076741120 [0;39m ==> Parameters: 
2022-08-26 18:04:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445743076741120 [0;39m <==    Updates: 8
2022-08-26 18:04:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20445743076741120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:04:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445743085129728 [0;39m 生成今日电子书快照开始
2022-08-26 18:04:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445743085129728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:04:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445743085129728 [0;39m ==> Parameters: 
2022-08-26 18:04:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445743085129728 [0;39m <==    Updates: 0
2022-08-26 18:04:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445743085129728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:04:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445764039872512 [0;39m 生成今日电子书快照开始
2022-08-26 18:04:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445764039872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:04:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445764039872512 [0;39m ==> Parameters: 
2022-08-26 18:04:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445764039872512 [0;39m <==    Updates: 0
2022-08-26 18:04:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445764039872512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:04:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445784982032384 [0;39m 生成今日电子书快照开始
2022-08-26 18:04:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445784982032384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:04:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445784982032384 [0;39m ==> Parameters: 
2022-08-26 18:04:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445784982032384 [0;39m <==    Updates: 0
2022-08-26 18:04:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445784982032384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:04:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445805961940992 [0;39m 生成今日电子书快照开始
2022-08-26 18:04:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445805961940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:04:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445805961940992 [0;39m ==> Parameters: 
2022-08-26 18:04:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445805961940992 [0;39m <==    Updates: 0
2022-08-26 18:04:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445805961940992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:04:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445826937655296 [0;39m 生成今日电子书快照开始
2022-08-26 18:04:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445826937655296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:04:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445826937655296 [0;39m ==> Parameters: 
2022-08-26 18:04:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445826937655296 [0;39m <==    Updates: 0
2022-08-26 18:04:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445826937655296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:04:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445847904980992 [0;39m 生成今日电子书快照开始
2022-08-26 18:04:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445847904980992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:04:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445847904980992 [0;39m ==> Parameters: 
2022-08-26 18:04:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445847904980992 [0;39m <==    Updates: 0
2022-08-26 18:04:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445847904980992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:04:35.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20445868889083904 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:04:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445868889083904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:04:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445868889083904 [0;39m ==> Parameters: 
2022-08-26 18:04:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445868889083904 [0;39m <==    Updates: 8
2022-08-26 18:04:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20445868889083904 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 18:04:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445868914249728 [0;39m 生成今日电子书快照开始
2022-08-26 18:04:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445868914249728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:04:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445868914249728 [0;39m ==> Parameters: 
2022-08-26 18:04:35.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445868914249728 [0;39m <==    Updates: 0
2022-08-26 18:04:35.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445868914249728 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:04:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445889827049472 [0;39m 生成今日电子书快照开始
2022-08-26 18:04:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445889827049472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:04:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445889827049472 [0;39m ==> Parameters: 
2022-08-26 18:04:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445889827049472 [0;39m <==    Updates: 0
2022-08-26 18:04:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445889827049472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:04:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445910844706816 [0;39m 生成今日电子书快照开始
2022-08-26 18:04:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445910844706816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:04:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445910844706816 [0;39m ==> Parameters: 
2022-08-26 18:04:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445910844706816 [0;39m <==    Updates: 0
2022-08-26 18:04:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445910844706816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:04:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445931791060992 [0;39m 生成今日电子书快照开始
2022-08-26 18:04:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445931791060992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:04:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445931791060992 [0;39m ==> Parameters: 
2022-08-26 18:04:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445931791060992 [0;39m <==    Updates: 0
2022-08-26 18:04:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445931791060992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:04:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445952762580992 [0;39m 生成今日电子书快照开始
2022-08-26 18:04:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445952762580992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:04:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445952762580992 [0;39m ==> Parameters: 
2022-08-26 18:04:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445952762580992 [0;39m <==    Updates: 0
2022-08-26 18:04:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445952762580992 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:05:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445973742489600 [0;39m 生成今日电子书快照开始
2022-08-26 18:05:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445973742489600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:05:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445973742489600 [0;39m ==> Parameters: 
2022-08-26 18:05:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445973742489600 [0;39m <==    Updates: 0
2022-08-26 18:05:00.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445973742489600 [0;39m 生成今日电子书快照结束，耗时：11 毫秒
2022-08-26 18:05:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20445994714009600 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:05:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445994714009600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:05:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445994714009600 [0;39m ==> Parameters: 
2022-08-26 18:05:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20445994714009600 [0;39m <==    Updates: 8
2022-08-26 18:05:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20445994714009600 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 18:05:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20445994739175424 [0;39m 生成今日电子书快照开始
2022-08-26 18:05:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445994739175424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:05:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445994739175424 [0;39m ==> Parameters: 
2022-08-26 18:05:05.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20445994739175424 [0;39m <==    Updates: 0
2022-08-26 18:05:05.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20445994739175424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:05:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446015664558080 [0;39m 生成今日电子书快照开始
2022-08-26 18:05:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446015664558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:05:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446015664558080 [0;39m ==> Parameters: 
2022-08-26 18:05:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446015664558080 [0;39m <==    Updates: 0
2022-08-26 18:05:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446015664558080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:05:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446036690604032 [0;39m 生成今日电子书快照开始
2022-08-26 18:05:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446036690604032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:05:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446036690604032 [0;39m ==> Parameters: 
2022-08-26 18:05:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446036690604032 [0;39m <==    Updates: 0
2022-08-26 18:05:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446036690604032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:05:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446057620180992 [0;39m 生成今日电子书快照开始
2022-08-26 18:05:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446057620180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:05:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446057620180992 [0;39m ==> Parameters: 
2022-08-26 18:05:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446057620180992 [0;39m <==    Updates: 0
2022-08-26 18:05:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446057620180992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:05:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446078595895296 [0;39m 生成今日电子书快照开始
2022-08-26 18:05:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446078595895296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:05:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446078595895296 [0;39m ==> Parameters: 
2022-08-26 18:05:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446078595895296 [0;39m <==    Updates: 0
2022-08-26 18:05:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446078595895296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:05:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446099559026688 [0;39m 生成今日电子书快照开始
2022-08-26 18:05:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446099559026688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:05:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446099559026688 [0;39m ==> Parameters: 
2022-08-26 18:05:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446099559026688 [0;39m <==    Updates: 0
2022-08-26 18:05:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446099559026688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:05:35.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20446120547323904 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:05:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446120547323904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:05:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446120547323904 [0;39m ==> Parameters: 
2022-08-26 18:05:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446120547323904 [0;39m <==    Updates: 8
2022-08-26 18:05:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20446120547323904 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 18:05:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446120568295424 [0;39m 生成今日电子书快照开始
2022-08-26 18:05:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446120568295424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:05:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446120568295424 [0;39m ==> Parameters: 
2022-08-26 18:05:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446120568295424 [0;39m <==    Updates: 0
2022-08-26 18:05:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446120568295424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:05:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446141548204032 [0;39m 生成今日电子书快照开始
2022-08-26 18:05:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446141548204032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:05:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446141548204032 [0;39m ==> Parameters: 
2022-08-26 18:05:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446141548204032 [0;39m <==    Updates: 0
2022-08-26 18:05:40.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446141548204032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:05:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446162511335424 [0;39m 生成今日电子书快照开始
2022-08-26 18:05:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446162511335424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:05:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446162511335424 [0;39m ==> Parameters: 
2022-08-26 18:05:45.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446162511335424 [0;39m <==    Updates: 0
2022-08-26 18:05:45.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446162511335424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:05:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446183474466816 [0;39m 生成今日电子书快照开始
2022-08-26 18:05:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446183474466816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:05:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446183474466816 [0;39m ==> Parameters: 
2022-08-26 18:05:50.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446183474466816 [0;39m <==    Updates: 0
2022-08-26 18:05:50.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446183474466816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:05:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446204441792512 [0;39m 生成今日电子书快照开始
2022-08-26 18:05:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446204441792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:05:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446204441792512 [0;39m ==> Parameters: 
2022-08-26 18:05:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446204441792512 [0;39m <==    Updates: 0
2022-08-26 18:05:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446204441792512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:06:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446225375563776 [0;39m 生成今日电子书快照开始
2022-08-26 18:06:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446225375563776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:06:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446225375563776 [0;39m ==> Parameters: 
2022-08-26 18:06:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446225375563776 [0;39m <==    Updates: 0
2022-08-26 18:06:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446225375563776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:06:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446246389026816 [0;39m 生成今日电子书快照开始
2022-08-26 18:06:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446246389026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:06:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446246389026816 [0;39m ==> Parameters: 
2022-08-26 18:06:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446246389026816 [0;39m <==    Updates: 0
2022-08-26 18:06:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446246389026816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:06:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20446246397415424 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:06:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446246397415424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:06:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446246397415424 [0;39m ==> Parameters: 
2022-08-26 18:06:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446246397415424 [0;39m <==    Updates: 8
2022-08-26 18:06:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20446246397415424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:06:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446267347963904 [0;39m 生成今日电子书快照开始
2022-08-26 18:06:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446267347963904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:06:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446267347963904 [0;39m ==> Parameters: 
2022-08-26 18:06:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446267347963904 [0;39m <==    Updates: 0
2022-08-26 18:06:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446267347963904 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:06:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446288298512384 [0;39m 生成今日电子书快照开始
2022-08-26 18:06:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446288298512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:06:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446288298512384 [0;39m ==> Parameters: 
2022-08-26 18:06:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446288298512384 [0;39m <==    Updates: 0
2022-08-26 18:06:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446288298512384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:06:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446309307781120 [0;39m 生成今日电子书快照开始
2022-08-26 18:06:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446309307781120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:06:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446309307781120 [0;39m ==> Parameters: 
2022-08-26 18:06:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446309307781120 [0;39m <==    Updates: 0
2022-08-26 18:06:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446309307781120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:06:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446330237358080 [0;39m 生成今日电子书快照开始
2022-08-26 18:06:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446330237358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:06:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446330237358080 [0;39m ==> Parameters: 
2022-08-26 18:06:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446330237358080 [0;39m <==    Updates: 0
2022-08-26 18:06:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446330237358080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:06:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446351250821120 [0;39m 生成今日电子书快照开始
2022-08-26 18:06:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446351250821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:06:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446351250821120 [0;39m ==> Parameters: 
2022-08-26 18:06:30.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446351250821120 [0;39m <==    Updates: 0
2022-08-26 18:06:30.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446351250821120 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:06:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446372226535424 [0;39m 生成今日电子书快照开始
2022-08-26 18:06:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446372226535424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:06:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446372226535424 [0;39m ==> Parameters: 
2022-08-26 18:06:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446372226535424 [0;39m <==    Updates: 0
2022-08-26 18:06:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446372226535424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:06:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20446372243312640 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:06:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446372243312640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:06:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446372243312640 [0;39m ==> Parameters: 
2022-08-26 18:06:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446372243312640 [0;39m <==    Updates: 8
2022-08-26 18:06:35.020 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20446372243312640 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:06:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446393147723776 [0;39m 生成今日电子书快照开始
2022-08-26 18:06:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446393147723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:06:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446393147723776 [0;39m ==> Parameters: 
2022-08-26 18:06:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446393147723776 [0;39m <==    Updates: 0
2022-08-26 18:06:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446393147723776 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 18:06:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446414123438080 [0;39m 生成今日电子书快照开始
2022-08-26 18:06:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446414123438080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:06:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446414123438080 [0;39m ==> Parameters: 
2022-08-26 18:06:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446414123438080 [0;39m <==    Updates: 0
2022-08-26 18:06:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446414123438080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:06:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446435141095424 [0;39m 生成今日电子书快照开始
2022-08-26 18:06:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446435141095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:06:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446435141095424 [0;39m ==> Parameters: 
2022-08-26 18:06:50.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446435141095424 [0;39m <==    Updates: 0
2022-08-26 18:06:50.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446435141095424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:06:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446456066478080 [0;39m 生成今日电子书快照开始
2022-08-26 18:06:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446456066478080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:06:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446456066478080 [0;39m ==> Parameters: 
2022-08-26 18:06:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446456066478080 [0;39m <==    Updates: 0
2022-08-26 18:06:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446456066478080 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:07:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446477037998080 [0;39m 生成今日电子书快照开始
2022-08-26 18:07:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446477037998080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:07:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446477037998080 [0;39m ==> Parameters: 
2022-08-26 18:07:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446477037998080 [0;39m <==    Updates: 0
2022-08-26 18:07:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446477037998080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:07:05.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20446498001129472 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:07:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446498001129472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:07:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446498001129472 [0;39m ==> Parameters: 
2022-08-26 18:07:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446498001129472 [0;39m <==    Updates: 8
2022-08-26 18:07:05.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20446498001129472 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 18:07:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446498013712384 [0;39m 生成今日电子书快照开始
2022-08-26 18:07:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446498013712384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:07:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446498013712384 [0;39m ==> Parameters: 
2022-08-26 18:07:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446498013712384 [0;39m <==    Updates: 0
2022-08-26 18:07:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446498013712384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:07:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446518985232384 [0;39m 生成今日电子书快照开始
2022-08-26 18:07:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446518985232384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:07:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446518985232384 [0;39m ==> Parameters: 
2022-08-26 18:07:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446518985232384 [0;39m <==    Updates: 0
2022-08-26 18:07:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446518985232384 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:07:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446539973529600 [0;39m 生成今日电子书快照开始
2022-08-26 18:07:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446539973529600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:07:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446539973529600 [0;39m ==> Parameters: 
2022-08-26 18:07:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446539973529600 [0;39m <==    Updates: 0
2022-08-26 18:07:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446539973529600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:07:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446560953438208 [0;39m 生成今日电子书快照开始
2022-08-26 18:07:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446560953438208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:07:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446560953438208 [0;39m ==> Parameters: 
2022-08-26 18:07:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446560953438208 [0;39m <==    Updates: 0
2022-08-26 18:07:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446560953438208 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:07:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446581950124032 [0;39m 生成今日电子书快照开始
2022-08-26 18:07:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446581950124032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:07:25.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446581950124032 [0;39m ==> Parameters: 
2022-08-26 18:07:25.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446581950124032 [0;39m <==    Updates: 0
2022-08-26 18:07:25.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446581950124032 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:07:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446602879700992 [0;39m 生成今日电子书快照开始
2022-08-26 18:07:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446602879700992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:07:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446602879700992 [0;39m ==> Parameters: 
2022-08-26 18:07:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446602879700992 [0;39m <==    Updates: 0
2022-08-26 18:07:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446602879700992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:07:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20446623884775424 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:07:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446623884775424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:07:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446623884775424 [0;39m ==> Parameters: 
2022-08-26 18:07:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446623884775424 [0;39m <==    Updates: 8
2022-08-26 18:07:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20446623884775424 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 18:07:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446623897358336 [0;39m 生成今日电子书快照开始
2022-08-26 18:07:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446623897358336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:07:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446623897358336 [0;39m ==> Parameters: 
2022-08-26 18:07:35.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446623897358336 [0;39m <==    Updates: 0
2022-08-26 18:07:35.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446623897358336 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:07:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446644839518208 [0;39m 生成今日电子书快照开始
2022-08-26 18:07:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446644839518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:07:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446644839518208 [0;39m ==> Parameters: 
2022-08-26 18:07:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446644839518208 [0;39m <==    Updates: 0
2022-08-26 18:07:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446644839518208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:07:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446665815232512 [0;39m 生成今日电子书快照开始
2022-08-26 18:07:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446665815232512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:07:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446665815232512 [0;39m ==> Parameters: 
2022-08-26 18:07:45.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446665815232512 [0;39m <==    Updates: 0
2022-08-26 18:07:45.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446665815232512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:07:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446686765780992 [0;39m 生成今日电子书快照开始
2022-08-26 18:07:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446686765780992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:07:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446686765780992 [0;39m ==> Parameters: 
2022-08-26 18:07:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446686765780992 [0;39m <==    Updates: 0
2022-08-26 18:07:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446686765780992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:07:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446707720523776 [0;39m 生成今日电子书快照开始
2022-08-26 18:07:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446707720523776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:07:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446707720523776 [0;39m ==> Parameters: 
2022-08-26 18:07:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446707720523776 [0;39m <==    Updates: 0
2022-08-26 18:07:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446707720523776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:08:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446728696238080 [0;39m 生成今日电子书快照开始
2022-08-26 18:08:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446728696238080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:08:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446728696238080 [0;39m ==> Parameters: 
2022-08-26 18:08:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446728696238080 [0;39m <==    Updates: 0
2022-08-26 18:08:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446728696238080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:08:05.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20446749663563776 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:08:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446749663563776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:08:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446749663563776 [0;39m ==> Parameters: 
2022-08-26 18:08:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446749663563776 [0;39m <==    Updates: 8
2022-08-26 18:08:05.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20446749663563776 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:08:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446749671952384 [0;39m 生成今日电子书快照开始
2022-08-26 18:08:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446749671952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:08:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446749671952384 [0;39m ==> Parameters: 
2022-08-26 18:08:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446749671952384 [0;39m <==    Updates: 0
2022-08-26 18:08:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446749671952384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:08:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446770660249600 [0;39m 生成今日电子书快照开始
2022-08-26 18:08:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446770660249600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:08:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446770660249600 [0;39m ==> Parameters: 
2022-08-26 18:08:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446770660249600 [0;39m <==    Updates: 0
2022-08-26 18:08:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446770660249600 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:08:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446791619186688 [0;39m 生成今日电子书快照开始
2022-08-26 18:08:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446791619186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:08:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446791619186688 [0;39m ==> Parameters: 
2022-08-26 18:08:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446791619186688 [0;39m <==    Updates: 0
2022-08-26 18:08:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446791619186688 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:08:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446812586512384 [0;39m 生成今日电子书快照开始
2022-08-26 18:08:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446812586512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:08:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446812586512384 [0;39m ==> Parameters: 
2022-08-26 18:08:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446812586512384 [0;39m <==    Updates: 0
2022-08-26 18:08:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446812586512384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:08:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446833553838080 [0;39m 生成今日电子书快照开始
2022-08-26 18:08:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446833553838080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:08:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446833553838080 [0;39m ==> Parameters: 
2022-08-26 18:08:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446833553838080 [0;39m <==    Updates: 0
2022-08-26 18:08:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446833553838080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:08:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446854554718208 [0;39m 生成今日电子书快照开始
2022-08-26 18:08:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446854554718208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:08:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446854554718208 [0;39m ==> Parameters: 
2022-08-26 18:08:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446854554718208 [0;39m <==    Updates: 0
2022-08-26 18:08:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446854554718208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:08:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446875509460992 [0;39m 生成今日电子书快照开始
2022-08-26 18:08:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446875509460992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:08:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446875509460992 [0;39m ==> Parameters: 
2022-08-26 18:08:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446875509460992 [0;39m <==    Updates: 0
2022-08-26 18:08:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446875509460992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:08:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20446875517849600 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:08:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446875517849600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:08:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446875517849600 [0;39m ==> Parameters: 
2022-08-26 18:08:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20446875517849600 [0;39m <==    Updates: 8
2022-08-26 18:08:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20446875517849600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:08:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446896480980992 [0;39m 生成今日电子书快照开始
2022-08-26 18:08:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446896480980992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:08:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446896480980992 [0;39m ==> Parameters: 
2022-08-26 18:08:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446896480980992 [0;39m <==    Updates: 0
2022-08-26 18:08:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446896480980992 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:08:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446917494444032 [0;39m 生成今日电子书快照开始
2022-08-26 18:08:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446917494444032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:08:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446917494444032 [0;39m ==> Parameters: 
2022-08-26 18:08:45.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446917494444032 [0;39m <==    Updates: 0
2022-08-26 18:08:45.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446917494444032 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:08:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446938419826688 [0;39m 生成今日电子书快照开始
2022-08-26 18:08:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446938419826688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:08:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446938419826688 [0;39m ==> Parameters: 
2022-08-26 18:08:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446938419826688 [0;39m <==    Updates: 0
2022-08-26 18:08:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446938419826688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:08:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446959391346688 [0;39m 生成今日电子书快照开始
2022-08-26 18:08:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446959391346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:08:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446959391346688 [0;39m ==> Parameters: 
2022-08-26 18:08:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446959391346688 [0;39m <==    Updates: 0
2022-08-26 18:08:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446959391346688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:09:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20446980379643904 [0;39m 生成今日电子书快照开始
2022-08-26 18:09:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446980379643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:09:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446980379643904 [0;39m ==> Parameters: 
2022-08-26 18:09:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20446980379643904 [0;39m <==    Updates: 0
2022-08-26 18:09:00.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20446980379643904 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 18:09:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20447001334386688 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:09:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447001334386688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:09:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447001334386688 [0;39m ==> Parameters: 
2022-08-26 18:09:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447001334386688 [0;39m <==    Updates: 8
2022-08-26 18:09:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20447001334386688 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:09:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447001342775296 [0;39m 生成今日电子书快照开始
2022-08-26 18:09:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447001342775296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:09:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447001342775296 [0;39m ==> Parameters: 
2022-08-26 18:09:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447001342775296 [0;39m <==    Updates: 0
2022-08-26 18:09:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447001342775296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:09:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447022289129472 [0;39m 生成今日电子书快照开始
2022-08-26 18:09:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447022289129472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:09:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447022289129472 [0;39m ==> Parameters: 
2022-08-26 18:09:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447022289129472 [0;39m <==    Updates: 0
2022-08-26 18:09:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447022289129472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:09:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447043264843776 [0;39m 生成今日电子书快照开始
2022-08-26 18:09:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447043264843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:09:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447043264843776 [0;39m ==> Parameters: 
2022-08-26 18:09:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447043264843776 [0;39m <==    Updates: 0
2022-08-26 18:09:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447043264843776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:09:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447064240558080 [0;39m 生成今日电子书快照开始
2022-08-26 18:09:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447064240558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:09:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447064240558080 [0;39m ==> Parameters: 
2022-08-26 18:09:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447064240558080 [0;39m <==    Updates: 0
2022-08-26 18:09:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447064240558080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:09:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447085207883776 [0;39m 生成今日电子书快照开始
2022-08-26 18:09:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447085207883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:09:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447085207883776 [0;39m ==> Parameters: 
2022-08-26 18:09:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447085207883776 [0;39m <==    Updates: 0
2022-08-26 18:09:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447085207883776 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:09:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447106200375296 [0;39m 生成今日电子书快照开始
2022-08-26 18:09:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447106200375296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:09:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447106200375296 [0;39m ==> Parameters: 
2022-08-26 18:09:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447106200375296 [0;39m <==    Updates: 0
2022-08-26 18:09:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447106200375296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:09:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20447127163506688 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:09:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447127163506688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:09:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447127163506688 [0;39m ==> Parameters: 
2022-08-26 18:09:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447127163506688 [0;39m <==    Updates: 8
2022-08-26 18:09:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20447127163506688 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:09:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447127171895296 [0;39m 生成今日电子书快照开始
2022-08-26 18:09:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447127171895296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:09:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447127171895296 [0;39m ==> Parameters: 
2022-08-26 18:09:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447127171895296 [0;39m <==    Updates: 0
2022-08-26 18:09:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447127171895296 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:09:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447148160192512 [0;39m 生成今日电子书快照开始
2022-08-26 18:09:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447148160192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:09:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447148160192512 [0;39m ==> Parameters: 
2022-08-26 18:09:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447148160192512 [0;39m <==    Updates: 0
2022-08-26 18:09:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447148160192512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:09:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447169140101120 [0;39m 生成今日电子书快照开始
2022-08-26 18:09:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447169140101120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:09:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447169140101120 [0;39m ==> Parameters: 
2022-08-26 18:09:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447169140101120 [0;39m <==    Updates: 0
2022-08-26 18:09:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447169140101120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:09:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447190069678080 [0;39m 生成今日电子书快照开始
2022-08-26 18:09:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447190069678080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:09:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447190069678080 [0;39m ==> Parameters: 
2022-08-26 18:09:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447190069678080 [0;39m <==    Updates: 0
2022-08-26 18:09:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447190069678080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:09:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447211066363904 [0;39m 生成今日电子书快照开始
2022-08-26 18:09:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447211066363904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:09:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447211066363904 [0;39m ==> Parameters: 
2022-08-26 18:09:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447211066363904 [0;39m <==    Updates: 0
2022-08-26 18:09:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447211066363904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:10:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447232029495296 [0;39m 生成今日电子书快照开始
2022-08-26 18:10:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447232029495296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:10:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447232029495296 [0;39m ==> Parameters: 
2022-08-26 18:10:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447232029495296 [0;39m <==    Updates: 0
2022-08-26 18:10:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447232029495296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:10:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447253021986816 [0;39m 生成今日电子书快照开始
2022-08-26 18:10:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447253021986816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:10:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447253021986816 [0;39m ==> Parameters: 
2022-08-26 18:10:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447253021986816 [0;39m <==    Updates: 0
2022-08-26 18:10:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447253021986816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:10:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20447253034569728 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:10:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447253034569728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:10:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447253034569728 [0;39m ==> Parameters: 
2022-08-26 18:10:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447253034569728 [0;39m <==    Updates: 8
2022-08-26 18:10:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20447253034569728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:10:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447273947369472 [0;39m 生成今日电子书快照开始
2022-08-26 18:10:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447273947369472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:10:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447273947369472 [0;39m ==> Parameters: 
2022-08-26 18:10:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447273947369472 [0;39m <==    Updates: 0
2022-08-26 18:10:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447273947369472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:10:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447294952443904 [0;39m 生成今日电子书快照开始
2022-08-26 18:10:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447294952443904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:10:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447294952443904 [0;39m ==> Parameters: 
2022-08-26 18:10:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447294952443904 [0;39m <==    Updates: 0
2022-08-26 18:10:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447294952443904 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:10:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447315944935424 [0;39m 生成今日电子书快照开始
2022-08-26 18:10:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447315944935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:10:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447315944935424 [0;39m ==> Parameters: 
2022-08-26 18:10:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447315944935424 [0;39m <==    Updates: 0
2022-08-26 18:10:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447315944935424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:10:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447336866123776 [0;39m 生成今日电子书快照开始
2022-08-26 18:10:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447336866123776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:10:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447336866123776 [0;39m ==> Parameters: 
2022-08-26 18:10:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447336866123776 [0;39m <==    Updates: 0
2022-08-26 18:10:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447336866123776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:10:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447357850226688 [0;39m 生成今日电子书快照开始
2022-08-26 18:10:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447357850226688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:10:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447357850226688 [0;39m ==> Parameters: 
2022-08-26 18:10:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447357850226688 [0;39m <==    Updates: 0
2022-08-26 18:10:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447357850226688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:10:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20447378817552384 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:10:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447378817552384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:10:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447378817552384 [0;39m ==> Parameters: 
2022-08-26 18:10:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447378817552384 [0;39m <==    Updates: 8
2022-08-26 18:10:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20447378817552384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:10:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447378825940992 [0;39m 生成今日电子书快照开始
2022-08-26 18:10:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447378825940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:10:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447378825940992 [0;39m ==> Parameters: 
2022-08-26 18:10:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447378825940992 [0;39m <==    Updates: 0
2022-08-26 18:10:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447378825940992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:10:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447399818432512 [0;39m 生成今日电子书快照开始
2022-08-26 18:10:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447399818432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:10:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447399818432512 [0;39m ==> Parameters: 
2022-08-26 18:10:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447399818432512 [0;39m <==    Updates: 0
2022-08-26 18:10:40.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447399818432512 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:10:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447420789952512 [0;39m 生成今日电子书快照开始
2022-08-26 18:10:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447420789952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:10:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447420789952512 [0;39m ==> Parameters: 
2022-08-26 18:10:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447420789952512 [0;39m <==    Updates: 0
2022-08-26 18:10:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447420789952512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:10:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447441736306688 [0;39m 生成今日电子书快照开始
2022-08-26 18:10:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447441736306688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:10:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447441736306688 [0;39m ==> Parameters: 
2022-08-26 18:10:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447441736306688 [0;39m <==    Updates: 0
2022-08-26 18:10:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447441736306688 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:10:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447462707826688 [0;39m 生成今日电子书快照开始
2022-08-26 18:10:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447462707826688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:10:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447462707826688 [0;39m ==> Parameters: 
2022-08-26 18:10:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447462707826688 [0;39m <==    Updates: 0
2022-08-26 18:10:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447462707826688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:11:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447483679346688 [0;39m 生成今日电子书快照开始
2022-08-26 18:11:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447483679346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:11:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447483679346688 [0;39m ==> Parameters: 
2022-08-26 18:11:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447483679346688 [0;39m <==    Updates: 0
2022-08-26 18:11:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447483679346688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:11:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447504642478080 [0;39m 生成今日电子书快照开始
2022-08-26 18:11:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447504642478080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:11:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447504642478080 [0;39m ==> Parameters: 
2022-08-26 18:11:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447504642478080 [0;39m <==    Updates: 0
2022-08-26 18:11:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447504642478080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:11:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20447504650866688 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:11:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447504650866688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:11:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447504650866688 [0;39m ==> Parameters: 
2022-08-26 18:11:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447504650866688 [0;39m <==    Updates: 8
2022-08-26 18:11:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20447504650866688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:11:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447525613998080 [0;39m 生成今日电子书快照开始
2022-08-26 18:11:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447525613998080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:11:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447525613998080 [0;39m ==> Parameters: 
2022-08-26 18:11:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447525613998080 [0;39m <==    Updates: 0
2022-08-26 18:11:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447525613998080 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:11:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447546623266816 [0;39m 生成今日电子书快照开始
2022-08-26 18:11:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447546623266816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:11:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447546623266816 [0;39m ==> Parameters: 
2022-08-26 18:11:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447546623266816 [0;39m <==    Updates: 0
2022-08-26 18:11:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447546623266816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:11:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447567548649472 [0;39m 生成今日电子书快照开始
2022-08-26 18:11:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447567548649472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:11:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447567548649472 [0;39m ==> Parameters: 
2022-08-26 18:11:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447567548649472 [0;39m <==    Updates: 0
2022-08-26 18:11:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447567548649472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:11:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447588541140992 [0;39m 生成今日电子书快照开始
2022-08-26 18:11:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447588541140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:11:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447588541140992 [0;39m ==> Parameters: 
2022-08-26 18:11:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447588541140992 [0;39m <==    Updates: 0
2022-08-26 18:11:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447588541140992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:11:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447609546215424 [0;39m 生成今日电子书快照开始
2022-08-26 18:11:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447609546215424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:11:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447609546215424 [0;39m ==> Parameters: 
2022-08-26 18:11:30.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447609546215424 [0;39m <==    Updates: 0
2022-08-26 18:11:30.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447609546215424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:11:35.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20447630521929728 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:11:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447630521929728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:11:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447630521929728 [0;39m ==> Parameters: 
2022-08-26 18:11:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447630521929728 [0;39m <==    Updates: 8
2022-08-26 18:11:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20447630521929728 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:11:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447630530318336 [0;39m 生成今日电子书快照开始
2022-08-26 18:11:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447630530318336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:11:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447630530318336 [0;39m ==> Parameters: 
2022-08-26 18:11:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447630530318336 [0;39m <==    Updates: 0
2022-08-26 18:11:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447630530318336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:11:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447651485061120 [0;39m 生成今日电子书快照开始
2022-08-26 18:11:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447651485061120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:11:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447651485061120 [0;39m ==> Parameters: 
2022-08-26 18:11:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447651485061120 [0;39m <==    Updates: 0
2022-08-26 18:11:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447651485061120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:11:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447672414638080 [0;39m 生成今日电子书快照开始
2022-08-26 18:11:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447672414638080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:11:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447672414638080 [0;39m ==> Parameters: 
2022-08-26 18:11:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447672414638080 [0;39m <==    Updates: 0
2022-08-26 18:11:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447672414638080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:11:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447693415518208 [0;39m 生成今日电子书快照开始
2022-08-26 18:11:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447693415518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:11:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447693415518208 [0;39m ==> Parameters: 
2022-08-26 18:11:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447693415518208 [0;39m <==    Updates: 0
2022-08-26 18:11:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447693415518208 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:11:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447714357678080 [0;39m 生成今日电子书快照开始
2022-08-26 18:11:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447714357678080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:11:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447714357678080 [0;39m ==> Parameters: 
2022-08-26 18:11:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447714357678080 [0;39m <==    Updates: 0
2022-08-26 18:11:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447714357678080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:12:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447735366946816 [0;39m 生成今日电子书快照开始
2022-08-26 18:12:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447735366946816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:12:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447735366946816 [0;39m ==> Parameters: 
2022-08-26 18:12:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447735366946816 [0;39m <==    Updates: 0
2022-08-26 18:12:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447735366946816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:12:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447756325883904 [0;39m 生成今日电子书快照开始
2022-08-26 18:12:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447756325883904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:12:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447756325883904 [0;39m ==> Parameters: 
2022-08-26 18:12:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447756325883904 [0;39m <==    Updates: 0
2022-08-26 18:12:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447756325883904 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:12:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20447756346855424 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:12:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447756346855424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:12:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447756346855424 [0;39m ==> Parameters: 
2022-08-26 18:12:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447756346855424 [0;39m <==    Updates: 8
2022-08-26 18:12:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20447756346855424 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:12:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447777326764032 [0;39m 生成今日电子书快照开始
2022-08-26 18:12:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447777326764032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:12:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447777326764032 [0;39m ==> Parameters: 
2022-08-26 18:12:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447777326764032 [0;39m <==    Updates: 0
2022-08-26 18:12:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447777326764032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:12:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447798256340992 [0;39m 生成今日电子书快照开始
2022-08-26 18:12:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447798256340992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:12:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447798256340992 [0;39m ==> Parameters: 
2022-08-26 18:12:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447798256340992 [0;39m <==    Updates: 0
2022-08-26 18:12:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447798256340992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:12:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447819232055296 [0;39m 生成今日电子书快照开始
2022-08-26 18:12:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447819232055296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:12:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447819232055296 [0;39m ==> Parameters: 
2022-08-26 18:12:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447819232055296 [0;39m <==    Updates: 0
2022-08-26 18:12:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447819232055296 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:12:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447840199380992 [0;39m 生成今日电子书快照开始
2022-08-26 18:12:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447840199380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:12:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447840199380992 [0;39m ==> Parameters: 
2022-08-26 18:12:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447840199380992 [0;39m <==    Updates: 0
2022-08-26 18:12:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447840199380992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:12:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447861149929472 [0;39m 生成今日电子书快照开始
2022-08-26 18:12:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447861149929472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:12:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447861149929472 [0;39m ==> Parameters: 
2022-08-26 18:12:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447861149929472 [0;39m <==    Updates: 0
2022-08-26 18:12:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447861149929472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:12:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447882138226688 [0;39m 生成今日电子书快照开始
2022-08-26 18:12:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447882138226688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:12:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447882138226688 [0;39m ==> Parameters: 
2022-08-26 18:12:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447882138226688 [0;39m <==    Updates: 0
2022-08-26 18:12:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447882138226688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:12:35.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20447882155003904 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:12:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447882155003904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:12:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447882155003904 [0;39m ==> Parameters: 
2022-08-26 18:12:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20447882155003904 [0;39m <==    Updates: 8
2022-08-26 18:12:35.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20447882155003904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:12:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447903147495424 [0;39m 生成今日电子书快照开始
2022-08-26 18:12:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447903147495424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:12:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447903147495424 [0;39m ==> Parameters: 
2022-08-26 18:12:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447903147495424 [0;39m <==    Updates: 0
2022-08-26 18:12:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447903147495424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:12:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447924114821120 [0;39m 生成今日电子书快照开始
2022-08-26 18:12:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447924114821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:12:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447924114821120 [0;39m ==> Parameters: 
2022-08-26 18:12:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447924114821120 [0;39m <==    Updates: 0
2022-08-26 18:12:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447924114821120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:12:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447945040203776 [0;39m 生成今日电子书快照开始
2022-08-26 18:12:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447945040203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:12:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447945040203776 [0;39m ==> Parameters: 
2022-08-26 18:12:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447945040203776 [0;39m <==    Updates: 0
2022-08-26 18:12:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447945040203776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:12:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447966053666816 [0;39m 生成今日电子书快照开始
2022-08-26 18:12:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447966053666816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:12:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447966053666816 [0;39m ==> Parameters: 
2022-08-26 18:12:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447966053666816 [0;39m <==    Updates: 0
2022-08-26 18:12:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447966053666816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:13:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20447986987438080 [0;39m 生成今日电子书快照开始
2022-08-26 18:13:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447986987438080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:13:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447986987438080 [0;39m ==> Parameters: 
2022-08-26 18:13:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20447986987438080 [0;39m <==    Updates: 0
2022-08-26 18:13:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20447986987438080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:13:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448007958958080 [0;39m 生成今日电子书快照开始
2022-08-26 18:13:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448007958958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:13:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448007958958080 [0;39m ==> Parameters: 
2022-08-26 18:13:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448007958958080 [0;39m <==    Updates: 0
2022-08-26 18:13:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448007958958080 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:13:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20448007984123904 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:13:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448007984123904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:13:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448007984123904 [0;39m ==> Parameters: 
2022-08-26 18:13:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448007984123904 [0;39m <==    Updates: 8
2022-08-26 18:13:05.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20448007984123904 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:13:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448028980809728 [0;39m 生成今日电子书快照开始
2022-08-26 18:13:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448028980809728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:13:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448028980809728 [0;39m ==> Parameters: 
2022-08-26 18:13:10.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448028980809728 [0;39m <==    Updates: 0
2022-08-26 18:13:10.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448028980809728 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 18:13:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448049956524032 [0;39m 生成今日电子书快照开始
2022-08-26 18:13:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448049956524032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:13:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448049956524032 [0;39m ==> Parameters: 
2022-08-26 18:13:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448049956524032 [0;39m <==    Updates: 0
2022-08-26 18:13:15.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448049956524032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:13:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448070902878208 [0;39m 生成今日电子书快照开始
2022-08-26 18:13:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448070902878208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:13:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448070902878208 [0;39m ==> Parameters: 
2022-08-26 18:13:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448070902878208 [0;39m <==    Updates: 0
2022-08-26 18:13:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448070902878208 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:13:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448091895369728 [0;39m 生成今日电子书快照开始
2022-08-26 18:13:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448091895369728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:13:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448091895369728 [0;39m ==> Parameters: 
2022-08-26 18:13:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448091895369728 [0;39m <==    Updates: 0
2022-08-26 18:13:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448091895369728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:13:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448112862695424 [0;39m 生成今日电子书快照开始
2022-08-26 18:13:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448112862695424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:13:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448112862695424 [0;39m ==> Parameters: 
2022-08-26 18:13:30.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448112862695424 [0;39m <==    Updates: 0
2022-08-26 18:13:30.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448112862695424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:13:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448133834215424 [0;39m 生成今日电子书快照开始
2022-08-26 18:13:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448133834215424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:13:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448133834215424 [0;39m ==> Parameters: 
2022-08-26 18:13:35.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448133834215424 [0;39m <==    Updates: 0
2022-08-26 18:13:35.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448133834215424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:13:35.022 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20448133867769856 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:13:35.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448133867769856 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:13:35.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448133867769856 [0;39m ==> Parameters: 
2022-08-26 18:13:35.025 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448133867769856 [0;39m <==    Updates: 8
2022-08-26 18:13:35.025 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20448133867769856 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:13:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448154809929728 [0;39m 生成今日电子书快照开始
2022-08-26 18:13:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448154809929728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:13:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448154809929728 [0;39m ==> Parameters: 
2022-08-26 18:13:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448154809929728 [0;39m <==    Updates: 0
2022-08-26 18:13:40.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448154809929728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:13:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448175752089600 [0;39m 生成今日电子书快照开始
2022-08-26 18:13:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448175752089600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:13:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448175752089600 [0;39m ==> Parameters: 
2022-08-26 18:13:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448175752089600 [0;39m <==    Updates: 0
2022-08-26 18:13:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448175752089600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:13:50.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448196694249472 [0;39m 生成今日电子书快照开始
2022-08-26 18:13:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448196694249472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:13:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448196694249472 [0;39m ==> Parameters: 
2022-08-26 18:13:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448196694249472 [0;39m <==    Updates: 0
2022-08-26 18:13:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448196694249472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:13:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448217674158080 [0;39m 生成今日电子书快照开始
2022-08-26 18:13:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448217674158080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:13:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448217674158080 [0;39m ==> Parameters: 
2022-08-26 18:13:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448217674158080 [0;39m <==    Updates: 0
2022-08-26 18:13:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448217674158080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:14:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448238691815424 [0;39m 生成今日电子书快照开始
2022-08-26 18:14:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448238691815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:14:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448238691815424 [0;39m ==> Parameters: 
2022-08-26 18:14:00.025 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448238691815424 [0;39m <==    Updates: 0
2022-08-26 18:14:00.026 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448238691815424 [0;39m 生成今日电子书快照结束，耗时：11 毫秒
2022-08-26 18:14:05.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20448259617198080 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:14:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448259617198080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:14:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448259617198080 [0;39m ==> Parameters: 
2022-08-26 18:14:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448259617198080 [0;39m <==    Updates: 8
2022-08-26 18:14:05.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20448259617198080 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:14:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448259625586688 [0;39m 生成今日电子书快照开始
2022-08-26 18:14:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448259625586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:14:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448259625586688 [0;39m ==> Parameters: 
2022-08-26 18:14:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448259625586688 [0;39m <==    Updates: 0
2022-08-26 18:14:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448259625586688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:14:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448280597106688 [0;39m 生成今日电子书快照开始
2022-08-26 18:14:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448280597106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:14:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448280597106688 [0;39m ==> Parameters: 
2022-08-26 18:14:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448280597106688 [0;39m <==    Updates: 0
2022-08-26 18:14:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448280597106688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:14:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448301585403904 [0;39m 生成今日电子书快照开始
2022-08-26 18:14:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448301585403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:14:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448301585403904 [0;39m ==> Parameters: 
2022-08-26 18:14:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448301585403904 [0;39m <==    Updates: 0
2022-08-26 18:14:15.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448301585403904 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 18:14:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448322565312512 [0;39m 生成今日电子书快照开始
2022-08-26 18:14:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448322565312512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:14:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448322565312512 [0;39m ==> Parameters: 
2022-08-26 18:14:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448322565312512 [0;39m <==    Updates: 0
2022-08-26 18:14:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448322565312512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:14:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448343528443904 [0;39m 生成今日电子书快照开始
2022-08-26 18:14:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448343528443904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:14:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448343528443904 [0;39m ==> Parameters: 
2022-08-26 18:14:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448343528443904 [0;39m <==    Updates: 0
2022-08-26 18:14:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448343528443904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:14:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448364487380992 [0;39m 生成今日电子书快照开始
2022-08-26 18:14:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448364487380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:14:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448364487380992 [0;39m ==> Parameters: 
2022-08-26 18:14:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448364487380992 [0;39m <==    Updates: 0
2022-08-26 18:14:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448364487380992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:14:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20448385479872512 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:14:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448385479872512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:14:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448385479872512 [0;39m ==> Parameters: 
2022-08-26 18:14:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448385479872512 [0;39m <==    Updates: 8
2022-08-26 18:14:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20448385479872512 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 18:14:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448385505038336 [0;39m 生成今日电子书快照开始
2022-08-26 18:14:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448385505038336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:14:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448385505038336 [0;39m ==> Parameters: 
2022-08-26 18:14:35.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448385505038336 [0;39m <==    Updates: 0
2022-08-26 18:14:35.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448385505038336 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:14:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448406409449472 [0;39m 生成今日电子书快照开始
2022-08-26 18:14:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448406409449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:14:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448406409449472 [0;39m ==> Parameters: 
2022-08-26 18:14:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448406409449472 [0;39m <==    Updates: 0
2022-08-26 18:14:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448406409449472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:14:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448427389358080 [0;39m 生成今日电子书快照开始
2022-08-26 18:14:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448427389358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:14:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448427389358080 [0;39m ==> Parameters: 
2022-08-26 18:14:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448427389358080 [0;39m <==    Updates: 0
2022-08-26 18:14:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448427389358080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:14:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448448381849600 [0;39m 生成今日电子书快照开始
2022-08-26 18:14:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448448381849600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:14:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448448381849600 [0;39m ==> Parameters: 
2022-08-26 18:14:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448448381849600 [0;39m <==    Updates: 0
2022-08-26 18:14:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448448381849600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:14:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448469332398080 [0;39m 生成今日电子书快照开始
2022-08-26 18:14:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448469332398080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:14:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448469332398080 [0;39m ==> Parameters: 
2022-08-26 18:14:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448469332398080 [0;39m <==    Updates: 0
2022-08-26 18:14:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448469332398080 [0;39m 生成今日电子书快照结束，耗时：0 毫秒
2022-08-26 18:15:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448490354249728 [0;39m 生成今日电子书快照开始
2022-08-26 18:15:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448490354249728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:15:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448490354249728 [0;39m ==> Parameters: 
2022-08-26 18:15:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448490354249728 [0;39m <==    Updates: 0
2022-08-26 18:15:00.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448490354249728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:15:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448511317381120 [0;39m 生成今日电子书快照开始
2022-08-26 18:15:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448511317381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:15:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448511317381120 [0;39m ==> Parameters: 
2022-08-26 18:15:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448511317381120 [0;39m <==    Updates: 0
2022-08-26 18:15:05.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448511317381120 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:15:05.020 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20448511346741248 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:15:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448511346741248 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:15:05.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448511346741248 [0;39m ==> Parameters: 
2022-08-26 18:15:05.024 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448511346741248 [0;39m <==    Updates: 8
2022-08-26 18:15:05.024 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20448511346741248 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 18:15:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448532301484032 [0;39m 生成今日电子书快照开始
2022-08-26 18:15:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448532301484032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:15:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448532301484032 [0;39m ==> Parameters: 
2022-08-26 18:15:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448532301484032 [0;39m <==    Updates: 0
2022-08-26 18:15:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448532301484032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:15:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448553235255296 [0;39m 生成今日电子书快照开始
2022-08-26 18:15:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448553235255296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:15:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448553235255296 [0;39m ==> Parameters: 
2022-08-26 18:15:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448553235255296 [0;39m <==    Updates: 0
2022-08-26 18:15:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448553235255296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:15:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448574219358208 [0;39m 生成今日电子书快照开始
2022-08-26 18:15:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448574219358208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:15:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448574219358208 [0;39m ==> Parameters: 
2022-08-26 18:15:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448574219358208 [0;39m <==    Updates: 0
2022-08-26 18:15:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448574219358208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:15:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448595199266816 [0;39m 生成今日电子书快照开始
2022-08-26 18:15:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448595199266816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:15:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448595199266816 [0;39m ==> Parameters: 
2022-08-26 18:15:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448595199266816 [0;39m <==    Updates: 0
2022-08-26 18:15:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448595199266816 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:15:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448616124649472 [0;39m 生成今日电子书快照开始
2022-08-26 18:15:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448616124649472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:15:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448616124649472 [0;39m ==> Parameters: 
2022-08-26 18:15:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448616124649472 [0;39m <==    Updates: 0
2022-08-26 18:15:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448616124649472 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:15:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448637108752384 [0;39m 生成今日电子书快照开始
2022-08-26 18:15:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448637108752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:15:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448637108752384 [0;39m ==> Parameters: 
2022-08-26 18:15:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448637108752384 [0;39m <==    Updates: 0
2022-08-26 18:15:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448637108752384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:15:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20448637121335296 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:15:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448637121335296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:15:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448637121335296 [0;39m ==> Parameters: 
2022-08-26 18:15:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448637121335296 [0;39m <==    Updates: 8
2022-08-26 18:15:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20448637121335296 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:15:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448658071883776 [0;39m 生成今日电子书快照开始
2022-08-26 18:15:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448658071883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:15:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448658071883776 [0;39m ==> Parameters: 
2022-08-26 18:15:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448658071883776 [0;39m <==    Updates: 0
2022-08-26 18:15:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448658071883776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:15:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448679097929728 [0;39m 生成今日电子书快照开始
2022-08-26 18:15:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448679097929728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:15:45.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448679097929728 [0;39m ==> Parameters: 
2022-08-26 18:15:45.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448679097929728 [0;39m <==    Updates: 0
2022-08-26 18:15:45.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448679097929728 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:15:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448700048478208 [0;39m 生成今日电子书快照开始
2022-08-26 18:15:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448700048478208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:15:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448700048478208 [0;39m ==> Parameters: 
2022-08-26 18:15:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448700048478208 [0;39m <==    Updates: 0
2022-08-26 18:15:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448700048478208 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:15:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448721045164032 [0;39m 生成今日电子书快照开始
2022-08-26 18:15:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448721045164032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:15:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448721045164032 [0;39m ==> Parameters: 
2022-08-26 18:15:55.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448721045164032 [0;39m <==    Updates: 0
2022-08-26 18:15:55.025 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448721045164032 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 18:16:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448741953769472 [0;39m 生成今日电子书快照开始
2022-08-26 18:16:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448741953769472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:16:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448741953769472 [0;39m ==> Parameters: 
2022-08-26 18:16:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448741953769472 [0;39m <==    Updates: 0
2022-08-26 18:16:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448741953769472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:16:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448762946260992 [0;39m 生成今日电子书快照开始
2022-08-26 18:16:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448762946260992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:16:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448762946260992 [0;39m ==> Parameters: 
2022-08-26 18:16:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448762946260992 [0;39m <==    Updates: 0
2022-08-26 18:16:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448762946260992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:16:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20448762954649600 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:16:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448762954649600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:16:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448762954649600 [0;39m ==> Parameters: 
2022-08-26 18:16:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448762954649600 [0;39m <==    Updates: 8
2022-08-26 18:16:05.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20448762954649600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:16:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448783913586688 [0;39m 生成今日电子书快照开始
2022-08-26 18:16:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448783913586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:16:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448783913586688 [0;39m ==> Parameters: 
2022-08-26 18:16:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448783913586688 [0;39m <==    Updates: 0
2022-08-26 18:16:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448783913586688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:16:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448804897689600 [0;39m 生成今日电子书快照开始
2022-08-26 18:16:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448804897689600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:16:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448804897689600 [0;39m ==> Parameters: 
2022-08-26 18:16:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448804897689600 [0;39m <==    Updates: 0
2022-08-26 18:16:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448804897689600 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:16:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448825856626688 [0;39m 生成今日电子书快照开始
2022-08-26 18:16:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448825856626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:16:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448825856626688 [0;39m ==> Parameters: 
2022-08-26 18:16:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448825856626688 [0;39m <==    Updates: 0
2022-08-26 18:16:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448825856626688 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:16:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448846857506816 [0;39m 生成今日电子书快照开始
2022-08-26 18:16:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448846857506816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:16:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448846857506816 [0;39m ==> Parameters: 
2022-08-26 18:16:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448846857506816 [0;39m <==    Updates: 0
2022-08-26 18:16:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448846857506816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:16:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448867787083776 [0;39m 生成今日电子书快照开始
2022-08-26 18:16:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448867787083776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:16:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448867787083776 [0;39m ==> Parameters: 
2022-08-26 18:16:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448867787083776 [0;39m <==    Updates: 0
2022-08-26 18:16:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448867787083776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:16:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20448888783769600 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:16:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448888783769600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:16:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448888783769600 [0;39m ==> Parameters: 
2022-08-26 18:16:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20448888783769600 [0;39m <==    Updates: 8
2022-08-26 18:16:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20448888783769600 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 18:16:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448888800546816 [0;39m 生成今日电子书快照开始
2022-08-26 18:16:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448888800546816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:16:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448888800546816 [0;39m ==> Parameters: 
2022-08-26 18:16:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448888800546816 [0;39m <==    Updates: 0
2022-08-26 18:16:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448888800546816 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:16:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448909772066816 [0;39m 生成今日电子书快照开始
2022-08-26 18:16:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448909772066816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:16:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448909772066816 [0;39m ==> Parameters: 
2022-08-26 18:16:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448909772066816 [0;39m <==    Updates: 0
2022-08-26 18:16:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448909772066816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:16:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448930751975424 [0;39m 生成今日电子书快照开始
2022-08-26 18:16:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448930751975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:16:45.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448930751975424 [0;39m ==> Parameters: 
2022-08-26 18:16:45.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448930751975424 [0;39m <==    Updates: 0
2022-08-26 18:16:45.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448930751975424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:16:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448951723495424 [0;39m 生成今日电子书快照开始
2022-08-26 18:16:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448951723495424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:16:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448951723495424 [0;39m ==> Parameters: 
2022-08-26 18:16:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448951723495424 [0;39m <==    Updates: 0
2022-08-26 18:16:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448951723495424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:16:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448972648878080 [0;39m 生成今日电子书快照开始
2022-08-26 18:16:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448972648878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:16:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448972648878080 [0;39m ==> Parameters: 
2022-08-26 18:16:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448972648878080 [0;39m <==    Updates: 0
2022-08-26 18:16:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448972648878080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:17:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20448993620398080 [0;39m 生成今日电子书快照开始
2022-08-26 18:17:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448993620398080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:17:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448993620398080 [0;39m ==> Parameters: 
2022-08-26 18:17:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20448993620398080 [0;39m <==    Updates: 0
2022-08-26 18:17:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20448993620398080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:17:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449014629666816 [0;39m 生成今日电子书快照开始
2022-08-26 18:17:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449014629666816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:17:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449014629666816 [0;39m ==> Parameters: 
2022-08-26 18:17:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449014629666816 [0;39m <==    Updates: 0
2022-08-26 18:17:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449014629666816 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:17:05.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20449014654832640 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:17:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449014654832640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:17:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449014654832640 [0;39m ==> Parameters: 
2022-08-26 18:17:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449014654832640 [0;39m <==    Updates: 8
2022-08-26 18:17:05.021 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20449014654832640 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 18:17:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449035592798208 [0;39m 生成今日电子书快照开始
2022-08-26 18:17:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449035592798208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:17:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449035592798208 [0;39m ==> Parameters: 
2022-08-26 18:17:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449035592798208 [0;39m <==    Updates: 0
2022-08-26 18:17:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449035592798208 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:17:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449056581095424 [0;39m 生成今日电子书快照开始
2022-08-26 18:17:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449056581095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:17:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449056581095424 [0;39m ==> Parameters: 
2022-08-26 18:17:15.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449056581095424 [0;39m <==    Updates: 0
2022-08-26 18:17:15.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449056581095424 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:17:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449077527449600 [0;39m 生成今日电子书快照开始
2022-08-26 18:17:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449077527449600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:17:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449077527449600 [0;39m ==> Parameters: 
2022-08-26 18:17:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449077527449600 [0;39m <==    Updates: 0
2022-08-26 18:17:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449077527449600 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:17:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449098477998080 [0;39m 生成今日电子书快照开始
2022-08-26 18:17:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449098477998080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:17:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449098477998080 [0;39m ==> Parameters: 
2022-08-26 18:17:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449098477998080 [0;39m <==    Updates: 0
2022-08-26 18:17:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449098477998080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:17:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449119470489600 [0;39m 生成今日电子书快照开始
2022-08-26 18:17:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449119470489600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:17:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449119470489600 [0;39m ==> Parameters: 
2022-08-26 18:17:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449119470489600 [0;39m <==    Updates: 0
2022-08-26 18:17:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449119470489600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:17:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449140467175424 [0;39m 生成今日电子书快照开始
2022-08-26 18:17:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449140467175424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:17:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449140467175424 [0;39m ==> Parameters: 
2022-08-26 18:17:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449140467175424 [0;39m <==    Updates: 0
2022-08-26 18:17:35.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449140467175424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:17:35.020 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20449140492341248 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:17:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449140492341248 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:17:35.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449140492341248 [0;39m ==> Parameters: 
2022-08-26 18:17:35.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449140492341248 [0;39m <==    Updates: 8
2022-08-26 18:17:35.023 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20449140492341248 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 18:17:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449161405140992 [0;39m 生成今日电子书快照开始
2022-08-26 18:17:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449161405140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:17:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449161405140992 [0;39m ==> Parameters: 
2022-08-26 18:17:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449161405140992 [0;39m <==    Updates: 0
2022-08-26 18:17:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449161405140992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:17:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449182372466688 [0;39m 生成今日电子书快照开始
2022-08-26 18:17:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449182372466688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:17:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449182372466688 [0;39m ==> Parameters: 
2022-08-26 18:17:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449182372466688 [0;39m <==    Updates: 0
2022-08-26 18:17:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449182372466688 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:17:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449203348180992 [0;39m 生成今日电子书快照开始
2022-08-26 18:17:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449203348180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:17:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449203348180992 [0;39m ==> Parameters: 
2022-08-26 18:17:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449203348180992 [0;39m <==    Updates: 0
2022-08-26 18:17:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449203348180992 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:17:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449224302923776 [0;39m 生成今日电子书快照开始
2022-08-26 18:17:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449224302923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:17:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449224302923776 [0;39m ==> Parameters: 
2022-08-26 18:17:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449224302923776 [0;39m <==    Updates: 0
2022-08-26 18:17:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449224302923776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:18:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449245307998208 [0;39m 生成今日电子书快照开始
2022-08-26 18:18:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449245307998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:18:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449245307998208 [0;39m ==> Parameters: 
2022-08-26 18:18:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449245307998208 [0;39m <==    Updates: 0
2022-08-26 18:18:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449245307998208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:18:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449266287906816 [0;39m 生成今日电子书快照开始
2022-08-26 18:18:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449266287906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:18:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449266287906816 [0;39m ==> Parameters: 
2022-08-26 18:18:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449266287906816 [0;39m <==    Updates: 0
2022-08-26 18:18:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449266287906816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:18:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20449266296295424 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:18:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449266296295424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:18:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449266296295424 [0;39m ==> Parameters: 
2022-08-26 18:18:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449266296295424 [0;39m <==    Updates: 8
2022-08-26 18:18:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20449266296295424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:18:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449287255232512 [0;39m 生成今日电子书快照开始
2022-08-26 18:18:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449287255232512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:18:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449287255232512 [0;39m ==> Parameters: 
2022-08-26 18:18:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449287255232512 [0;39m <==    Updates: 0
2022-08-26 18:18:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449287255232512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:18:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449308218363904 [0;39m 生成今日电子书快照开始
2022-08-26 18:18:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449308218363904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:18:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449308218363904 [0;39m ==> Parameters: 
2022-08-26 18:18:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449308218363904 [0;39m <==    Updates: 0
2022-08-26 18:18:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449308218363904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:18:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449329177300992 [0;39m 生成今日电子书快照开始
2022-08-26 18:18:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449329177300992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:18:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449329177300992 [0;39m ==> Parameters: 
2022-08-26 18:18:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449329177300992 [0;39m <==    Updates: 0
2022-08-26 18:18:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449329177300992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:18:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449350148820992 [0;39m 生成今日电子书快照开始
2022-08-26 18:18:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449350148820992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:18:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449350148820992 [0;39m ==> Parameters: 
2022-08-26 18:18:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449350148820992 [0;39m <==    Updates: 0
2022-08-26 18:18:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449350148820992 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:18:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449371128729600 [0;39m 生成今日电子书快照开始
2022-08-26 18:18:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449371128729600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:18:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449371128729600 [0;39m ==> Parameters: 
2022-08-26 18:18:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449371128729600 [0;39m <==    Updates: 0
2022-08-26 18:18:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449371128729600 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:18:35.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449392066695168 [0;39m 生成今日电子书快照开始
2022-08-26 18:18:35.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449392066695168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:18:35.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449392066695168 [0;39m ==> Parameters: 
2022-08-26 18:18:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449392066695168 [0;39m <==    Updates: 0
2022-08-26 18:18:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449392066695168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:18:35.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20449392075083776 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:18:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449392075083776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:18:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449392075083776 [0;39m ==> Parameters: 
2022-08-26 18:18:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449392075083776 [0;39m <==    Updates: 8
2022-08-26 18:18:35.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20449392075083776 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:18:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449413071769600 [0;39m 生成今日电子书快照开始
2022-08-26 18:18:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449413071769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:18:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449413071769600 [0;39m ==> Parameters: 
2022-08-26 18:18:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449413071769600 [0;39m <==    Updates: 0
2022-08-26 18:18:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449413071769600 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 18:18:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449434022318080 [0;39m 生成今日电子书快照开始
2022-08-26 18:18:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449434022318080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:18:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449434022318080 [0;39m ==> Parameters: 
2022-08-26 18:18:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449434022318080 [0;39m <==    Updates: 0
2022-08-26 18:18:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449434022318080 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:18:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449455027392512 [0;39m 生成今日电子书快照开始
2022-08-26 18:18:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449455027392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:18:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449455027392512 [0;39m ==> Parameters: 
2022-08-26 18:18:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449455027392512 [0;39m <==    Updates: 0
2022-08-26 18:18:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449455027392512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:18:55.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449475956969472 [0;39m 生成今日电子书快照开始
2022-08-26 18:18:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449475956969472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:18:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449475956969472 [0;39m ==> Parameters: 
2022-08-26 18:18:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449475956969472 [0;39m <==    Updates: 0
2022-08-26 18:18:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449475956969472 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:19:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449496962043904 [0;39m 生成今日电子书快照开始
2022-08-26 18:19:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449496962043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:19:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449496962043904 [0;39m ==> Parameters: 
2022-08-26 18:19:00.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449496962043904 [0;39m <==    Updates: 0
2022-08-26 18:19:00.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449496962043904 [0;39m 生成今日电子书快照结束，耗时：11 毫秒
2022-08-26 18:19:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449517954535424 [0;39m 生成今日电子书快照开始
2022-08-26 18:19:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449517954535424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:19:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449517954535424 [0;39m ==> Parameters: 
2022-08-26 18:19:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449517954535424 [0;39m <==    Updates: 0
2022-08-26 18:19:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449517954535424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:19:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20449517962924032 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:19:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449517962924032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:19:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449517962924032 [0;39m ==> Parameters: 
2022-08-26 18:19:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449517962924032 [0;39m <==    Updates: 8
2022-08-26 18:19:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20449517962924032 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:19:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449538926055424 [0;39m 生成今日电子书快照开始
2022-08-26 18:19:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449538926055424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:19:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449538926055424 [0;39m ==> Parameters: 
2022-08-26 18:19:10.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449538926055424 [0;39m <==    Updates: 0
2022-08-26 18:19:10.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449538926055424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:19:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449559847243776 [0;39m 生成今日电子书快照开始
2022-08-26 18:19:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449559847243776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:19:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449559847243776 [0;39m ==> Parameters: 
2022-08-26 18:19:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449559847243776 [0;39m <==    Updates: 0
2022-08-26 18:19:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449559847243776 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:19:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449580831346688 [0;39m 生成今日电子书快照开始
2022-08-26 18:19:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449580831346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:19:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449580831346688 [0;39m ==> Parameters: 
2022-08-26 18:19:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449580831346688 [0;39m <==    Updates: 0
2022-08-26 18:19:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449580831346688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:19:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449601832226816 [0;39m 生成今日电子书快照开始
2022-08-26 18:19:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449601832226816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:19:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449601832226816 [0;39m ==> Parameters: 
2022-08-26 18:19:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449601832226816 [0;39m <==    Updates: 0
2022-08-26 18:19:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449601832226816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:19:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449622770192384 [0;39m 生成今日电子书快照开始
2022-08-26 18:19:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449622770192384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:19:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449622770192384 [0;39m ==> Parameters: 
2022-08-26 18:19:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449622770192384 [0;39m <==    Updates: 0
2022-08-26 18:19:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449622770192384 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 18:19:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449643771072512 [0;39m 生成今日电子书快照开始
2022-08-26 18:19:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449643771072512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:19:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449643771072512 [0;39m ==> Parameters: 
2022-08-26 18:19:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449643771072512 [0;39m <==    Updates: 0
2022-08-26 18:19:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449643771072512 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:19:35.017 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20449643796238336 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:19:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449643796238336 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:19:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449643796238336 [0;39m ==> Parameters: 
2022-08-26 18:19:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449643796238336 [0;39m <==    Updates: 8
2022-08-26 18:19:35.021 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20449643796238336 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 18:19:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449664704843776 [0;39m 生成今日电子书快照开始
2022-08-26 18:19:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449664704843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:19:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449664704843776 [0;39m ==> Parameters: 
2022-08-26 18:19:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449664704843776 [0;39m <==    Updates: 0
2022-08-26 18:19:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449664704843776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:19:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449685701529600 [0;39m 生成今日电子书快照开始
2022-08-26 18:19:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449685701529600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:19:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449685701529600 [0;39m ==> Parameters: 
2022-08-26 18:19:45.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449685701529600 [0;39m <==    Updates: 0
2022-08-26 18:19:45.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449685701529600 [0;39m 生成今日电子书快照结束，耗时：12 毫秒
2022-08-26 18:19:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449706660466688 [0;39m 生成今日电子书快照开始
2022-08-26 18:19:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449706660466688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:19:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449706660466688 [0;39m ==> Parameters: 
2022-08-26 18:19:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449706660466688 [0;39m <==    Updates: 0
2022-08-26 18:19:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449706660466688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:19:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449727631986688 [0;39m 生成今日电子书快照开始
2022-08-26 18:19:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449727631986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:19:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449727631986688 [0;39m ==> Parameters: 
2022-08-26 18:19:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449727631986688 [0;39m <==    Updates: 0
2022-08-26 18:19:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449727631986688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:20:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449748641255424 [0;39m 生成今日电子书快照开始
2022-08-26 18:20:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449748641255424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:20:00.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449748641255424 [0;39m ==> Parameters: 
2022-08-26 18:20:00.029 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449748641255424 [0;39m <==    Updates: 0
2022-08-26 18:20:00.030 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449748641255424 [0;39m 生成今日电子书快照结束，耗时：15 毫秒
2022-08-26 18:20:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20449769608581120 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:20:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449769608581120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:20:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449769608581120 [0;39m ==> Parameters: 
2022-08-26 18:20:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449769608581120 [0;39m <==    Updates: 8
2022-08-26 18:20:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20449769608581120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:20:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449769616969728 [0;39m 生成今日电子书快照开始
2022-08-26 18:20:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449769616969728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:20:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449769616969728 [0;39m ==> Parameters: 
2022-08-26 18:20:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449769616969728 [0;39m <==    Updates: 0
2022-08-26 18:20:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449769616969728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:20:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449790554935296 [0;39m 生成今日电子书快照开始
2022-08-26 18:20:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449790554935296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:20:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449790554935296 [0;39m ==> Parameters: 
2022-08-26 18:20:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449790554935296 [0;39m <==    Updates: 0
2022-08-26 18:20:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449790554935296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:20:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449811564204032 [0;39m 生成今日电子书快照开始
2022-08-26 18:20:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449811564204032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:20:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449811564204032 [0;39m ==> Parameters: 
2022-08-26 18:20:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449811564204032 [0;39m <==    Updates: 0
2022-08-26 18:20:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449811564204032 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:20:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449832493780992 [0;39m 生成今日电子书快照开始
2022-08-26 18:20:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449832493780992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:20:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449832493780992 [0;39m ==> Parameters: 
2022-08-26 18:20:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449832493780992 [0;39m <==    Updates: 0
2022-08-26 18:20:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449832493780992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:20:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449853482078208 [0;39m 生成今日电子书快照开始
2022-08-26 18:20:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449853482078208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:20:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449853482078208 [0;39m ==> Parameters: 
2022-08-26 18:20:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449853482078208 [0;39m <==    Updates: 0
2022-08-26 18:20:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449853482078208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:20:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449874453598208 [0;39m 生成今日电子书快照开始
2022-08-26 18:20:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449874453598208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:20:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449874453598208 [0;39m ==> Parameters: 
2022-08-26 18:20:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449874453598208 [0;39m <==    Updates: 0
2022-08-26 18:20:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449874453598208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:20:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449895441895424 [0;39m 生成今日电子书快照开始
2022-08-26 18:20:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449895441895424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:20:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449895441895424 [0;39m ==> Parameters: 
2022-08-26 18:20:35.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449895441895424 [0;39m <==    Updates: 0
2022-08-26 18:20:35.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449895441895424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:20:35.022 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20449895475449856 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:20:35.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449895475449856 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:20:35.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449895475449856 [0;39m ==> Parameters: 
2022-08-26 18:20:35.026 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20449895475449856 [0;39m <==    Updates: 8
2022-08-26 18:20:35.026 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20449895475449856 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 18:20:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449916409221120 [0;39m 生成今日电子书快照开始
2022-08-26 18:20:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449916409221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:20:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449916409221120 [0;39m ==> Parameters: 
2022-08-26 18:20:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449916409221120 [0;39m <==    Updates: 0
2022-08-26 18:20:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449916409221120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:20:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449937330409472 [0;39m 生成今日电子书快照开始
2022-08-26 18:20:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449937330409472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:20:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449937330409472 [0;39m ==> Parameters: 
2022-08-26 18:20:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449937330409472 [0;39m <==    Updates: 0
2022-08-26 18:20:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449937330409472 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:20:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449958364844032 [0;39m 生成今日电子书快照开始
2022-08-26 18:20:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449958364844032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:20:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449958364844032 [0;39m ==> Parameters: 
2022-08-26 18:20:50.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449958364844032 [0;39m <==    Updates: 0
2022-08-26 18:20:50.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449958364844032 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:20:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20449979281838080 [0;39m 生成今日电子书快照开始
2022-08-26 18:20:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449979281838080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:20:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449979281838080 [0;39m ==> Parameters: 
2022-08-26 18:20:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20449979281838080 [0;39m <==    Updates: 0
2022-08-26 18:20:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20449979281838080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:21:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450000265940992 [0;39m 生成今日电子书快照开始
2022-08-26 18:21:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450000265940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:21:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450000265940992 [0;39m ==> Parameters: 
2022-08-26 18:21:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450000265940992 [0;39m <==    Updates: 0
2022-08-26 18:21:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450000265940992 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 18:21:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20450021241655296 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:21:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450021241655296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:21:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450021241655296 [0;39m ==> Parameters: 
2022-08-26 18:21:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450021241655296 [0;39m <==    Updates: 8
2022-08-26 18:21:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20450021241655296 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 18:21:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450021266821120 [0;39m 生成今日电子书快照开始
2022-08-26 18:21:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450021266821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:21:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450021266821120 [0;39m ==> Parameters: 
2022-08-26 18:21:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450021266821120 [0;39m <==    Updates: 0
2022-08-26 18:21:05.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450021266821120 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:21:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450042242535424 [0;39m 生成今日电子书快照开始
2022-08-26 18:21:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450042242535424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:21:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450042242535424 [0;39m ==> Parameters: 
2022-08-26 18:21:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450042242535424 [0;39m <==    Updates: 0
2022-08-26 18:21:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450042242535424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:21:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450063167918080 [0;39m 生成今日电子书快照开始
2022-08-26 18:21:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450063167918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:21:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450063167918080 [0;39m ==> Parameters: 
2022-08-26 18:21:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450063167918080 [0;39m <==    Updates: 0
2022-08-26 18:21:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450063167918080 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:21:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450084160409600 [0;39m 生成今日电子书快照开始
2022-08-26 18:21:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450084160409600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:21:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450084160409600 [0;39m ==> Parameters: 
2022-08-26 18:21:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450084160409600 [0;39m <==    Updates: 0
2022-08-26 18:21:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450084160409600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:21:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450105115152384 [0;39m 生成今日电子书快照开始
2022-08-26 18:21:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450105115152384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:21:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450105115152384 [0;39m ==> Parameters: 
2022-08-26 18:21:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450105115152384 [0;39m <==    Updates: 0
2022-08-26 18:21:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450105115152384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:21:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450126078283776 [0;39m 生成今日电子书快照开始
2022-08-26 18:21:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450126078283776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:21:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450126078283776 [0;39m ==> Parameters: 
2022-08-26 18:21:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450126078283776 [0;39m <==    Updates: 0
2022-08-26 18:21:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450126078283776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:21:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20450147100135424 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:21:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450147100135424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:21:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450147100135424 [0;39m ==> Parameters: 
2022-08-26 18:21:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450147100135424 [0;39m <==    Updates: 8
2022-08-26 18:21:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20450147100135424 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:21:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450147108524032 [0;39m 生成今日电子书快照开始
2022-08-26 18:21:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450147108524032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:21:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450147108524032 [0;39m ==> Parameters: 
2022-08-26 18:21:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450147108524032 [0;39m <==    Updates: 0
2022-08-26 18:21:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450147108524032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:21:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450168025518080 [0;39m 生成今日电子书快照开始
2022-08-26 18:21:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450168025518080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:21:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450168025518080 [0;39m ==> Parameters: 
2022-08-26 18:21:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450168025518080 [0;39m <==    Updates: 0
2022-08-26 18:21:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450168025518080 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:21:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450189030592512 [0;39m 生成今日电子书快照开始
2022-08-26 18:21:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450189030592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:21:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450189030592512 [0;39m ==> Parameters: 
2022-08-26 18:21:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450189030592512 [0;39m <==    Updates: 0
2022-08-26 18:21:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450189030592512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:21:50.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450209955975168 [0;39m 生成今日电子书快照开始
2022-08-26 18:21:50.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450209955975168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:21:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450209955975168 [0;39m ==> Parameters: 
2022-08-26 18:21:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450209955975168 [0;39m <==    Updates: 0
2022-08-26 18:21:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450209955975168 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:21:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450230977826816 [0;39m 生成今日电子书快照开始
2022-08-26 18:21:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450230977826816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:21:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450230977826816 [0;39m ==> Parameters: 
2022-08-26 18:21:55.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450230977826816 [0;39m <==    Updates: 0
2022-08-26 18:21:55.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450230977826816 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 18:22:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450251903209472 [0;39m 生成今日电子书快照开始
2022-08-26 18:22:00.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450251903209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:22:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450251903209472 [0;39m ==> Parameters: 
2022-08-26 18:22:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450251903209472 [0;39m <==    Updates: 0
2022-08-26 18:22:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450251903209472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:22:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20450272933449728 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:22:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450272933449728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:22:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450272933449728 [0;39m ==> Parameters: 
2022-08-26 18:22:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450272933449728 [0;39m <==    Updates: 8
2022-08-26 18:22:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20450272933449728 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:22:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450272941838336 [0;39m 生成今日电子书快照开始
2022-08-26 18:22:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450272941838336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:22:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450272941838336 [0;39m ==> Parameters: 
2022-08-26 18:22:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450272941838336 [0;39m <==    Updates: 0
2022-08-26 18:22:05.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450272941838336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:22:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450293867220992 [0;39m 生成今日电子书快照开始
2022-08-26 18:22:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450293867220992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:22:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450293867220992 [0;39m ==> Parameters: 
2022-08-26 18:22:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450293867220992 [0;39m <==    Updates: 0
2022-08-26 18:22:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450293867220992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:22:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450314834546688 [0;39m 生成今日电子书快照开始
2022-08-26 18:22:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450314834546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:22:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450314834546688 [0;39m ==> Parameters: 
2022-08-26 18:22:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450314834546688 [0;39m <==    Updates: 0
2022-08-26 18:22:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450314834546688 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:22:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450335839621120 [0;39m 生成今日电子书快照开始
2022-08-26 18:22:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450335839621120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:22:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450335839621120 [0;39m ==> Parameters: 
2022-08-26 18:22:20.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450335839621120 [0;39m <==    Updates: 0
2022-08-26 18:22:20.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450335839621120 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:22:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450356765003776 [0;39m 生成今日电子书快照开始
2022-08-26 18:22:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450356765003776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:22:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450356765003776 [0;39m ==> Parameters: 
2022-08-26 18:22:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450356765003776 [0;39m <==    Updates: 0
2022-08-26 18:22:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450356765003776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:22:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450377770078208 [0;39m 生成今日电子书快照开始
2022-08-26 18:22:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450377770078208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:22:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450377770078208 [0;39m ==> Parameters: 
2022-08-26 18:22:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450377770078208 [0;39m <==    Updates: 0
2022-08-26 18:22:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450377770078208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:22:35.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20450398708043776 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:22:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450398708043776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:22:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450398708043776 [0;39m ==> Parameters: 
2022-08-26 18:22:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450398708043776 [0;39m <==    Updates: 8
2022-08-26 18:22:35.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20450398708043776 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:22:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450398716432384 [0;39m 生成今日电子书快照开始
2022-08-26 18:22:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450398716432384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:22:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450398716432384 [0;39m ==> Parameters: 
2022-08-26 18:22:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450398716432384 [0;39m <==    Updates: 0
2022-08-26 18:22:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450398716432384 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:22:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450419683758080 [0;39m 生成今日电子书快照开始
2022-08-26 18:22:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450419683758080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:22:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450419683758080 [0;39m ==> Parameters: 
2022-08-26 18:22:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450419683758080 [0;39m <==    Updates: 0
2022-08-26 18:22:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450419683758080 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:22:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450440651083776 [0;39m 生成今日电子书快照开始
2022-08-26 18:22:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450440651083776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:22:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450440651083776 [0;39m ==> Parameters: 
2022-08-26 18:22:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450440651083776 [0;39m <==    Updates: 0
2022-08-26 18:22:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450440651083776 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:22:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450461647769600 [0;39m 生成今日电子书快照开始
2022-08-26 18:22:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450461647769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:22:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450461647769600 [0;39m ==> Parameters: 
2022-08-26 18:22:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450461647769600 [0;39m <==    Updates: 0
2022-08-26 18:22:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450461647769600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:22:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450482610900992 [0;39m 生成今日电子书快照开始
2022-08-26 18:22:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450482610900992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:22:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450482610900992 [0;39m ==> Parameters: 
2022-08-26 18:22:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450482610900992 [0;39m <==    Updates: 0
2022-08-26 18:22:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450482610900992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:23:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450503615975424 [0;39m 生成今日电子书快照开始
2022-08-26 18:23:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450503615975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:23:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450503615975424 [0;39m ==> Parameters: 
2022-08-26 18:23:00.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450503615975424 [0;39m <==    Updates: 0
2022-08-26 18:23:00.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450503615975424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:23:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20450524587495424 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:23:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450524587495424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:23:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450524587495424 [0;39m ==> Parameters: 
2022-08-26 18:23:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450524587495424 [0;39m <==    Updates: 8
2022-08-26 18:23:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20450524587495424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:23:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450524591689728 [0;39m 生成今日电子书快照开始
2022-08-26 18:23:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450524591689728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:23:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450524591689728 [0;39m ==> Parameters: 
2022-08-26 18:23:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450524591689728 [0;39m <==    Updates: 0
2022-08-26 18:23:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450524591689728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:23:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450545521266688 [0;39m 生成今日电子书快照开始
2022-08-26 18:23:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450545521266688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:23:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450545521266688 [0;39m ==> Parameters: 
2022-08-26 18:23:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450545521266688 [0;39m <==    Updates: 0
2022-08-26 18:23:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450545521266688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:23:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450566522146816 [0;39m 生成今日电子书快照开始
2022-08-26 18:23:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450566522146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:23:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450566522146816 [0;39m ==> Parameters: 
2022-08-26 18:23:15.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450566522146816 [0;39m <==    Updates: 0
2022-08-26 18:23:15.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450566522146816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:23:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450587493666816 [0;39m 生成今日电子书快照开始
2022-08-26 18:23:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450587493666816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:23:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450587493666816 [0;39m ==> Parameters: 
2022-08-26 18:23:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450587493666816 [0;39m <==    Updates: 0
2022-08-26 18:23:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450587493666816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:23:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450608452603904 [0;39m 生成今日电子书快照开始
2022-08-26 18:23:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450608452603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:23:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450608452603904 [0;39m ==> Parameters: 
2022-08-26 18:23:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450608452603904 [0;39m <==    Updates: 0
2022-08-26 18:23:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450608452603904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:23:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450629411540992 [0;39m 生成今日电子书快照开始
2022-08-26 18:23:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450629411540992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:23:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450629411540992 [0;39m ==> Parameters: 
2022-08-26 18:23:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450629411540992 [0;39m <==    Updates: 0
2022-08-26 18:23:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450629411540992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:23:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20450650387255296 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:23:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450650387255296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:23:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450650387255296 [0;39m ==> Parameters: 
2022-08-26 18:23:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450650387255296 [0;39m <==    Updates: 8
2022-08-26 18:23:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20450650387255296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:23:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450650395643904 [0;39m 生成今日电子书快照开始
2022-08-26 18:23:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450650395643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:23:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450650395643904 [0;39m ==> Parameters: 
2022-08-26 18:23:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450650395643904 [0;39m <==    Updates: 0
2022-08-26 18:23:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450650395643904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:23:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450671346192384 [0;39m 生成今日电子书快照开始
2022-08-26 18:23:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450671346192384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:23:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450671346192384 [0;39m ==> Parameters: 
2022-08-26 18:23:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450671346192384 [0;39m <==    Updates: 0
2022-08-26 18:23:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450671346192384 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:23:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450692334489600 [0;39m 生成今日电子书快照开始
2022-08-26 18:23:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450692334489600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:23:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450692334489600 [0;39m ==> Parameters: 
2022-08-26 18:23:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450692334489600 [0;39m <==    Updates: 0
2022-08-26 18:23:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450692334489600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:23:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450713318592512 [0;39m 生成今日电子书快照开始
2022-08-26 18:23:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450713318592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:23:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450713318592512 [0;39m ==> Parameters: 
2022-08-26 18:23:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450713318592512 [0;39m <==    Updates: 0
2022-08-26 18:23:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450713318592512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:23:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450734256558080 [0;39m 生成今日电子书快照开始
2022-08-26 18:23:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450734256558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:23:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450734256558080 [0;39m ==> Parameters: 
2022-08-26 18:23:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450734256558080 [0;39m <==    Updates: 0
2022-08-26 18:23:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450734256558080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:24:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450755253243904 [0;39m 生成今日电子书快照开始
2022-08-26 18:24:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450755253243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:24:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450755253243904 [0;39m ==> Parameters: 
2022-08-26 18:24:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450755253243904 [0;39m <==    Updates: 0
2022-08-26 18:24:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450755253243904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:24:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450776220569600 [0;39m 生成今日电子书快照开始
2022-08-26 18:24:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450776220569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:24:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450776220569600 [0;39m ==> Parameters: 
2022-08-26 18:24:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450776220569600 [0;39m <==    Updates: 0
2022-08-26 18:24:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450776220569600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:24:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20450776233152512 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:24:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450776233152512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:24:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450776233152512 [0;39m ==> Parameters: 
2022-08-26 18:24:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450776233152512 [0;39m <==    Updates: 8
2022-08-26 18:24:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20450776233152512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:24:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450797166923776 [0;39m 生成今日电子书快照开始
2022-08-26 18:24:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450797166923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:24:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450797166923776 [0;39m ==> Parameters: 
2022-08-26 18:24:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450797166923776 [0;39m <==    Updates: 0
2022-08-26 18:24:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450797166923776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:24:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450818151026688 [0;39m 生成今日电子书快照开始
2022-08-26 18:24:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450818151026688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:24:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450818151026688 [0;39m ==> Parameters: 
2022-08-26 18:24:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450818151026688 [0;39m <==    Updates: 0
2022-08-26 18:24:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450818151026688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:24:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450839122546688 [0;39m 生成今日电子书快照开始
2022-08-26 18:24:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450839122546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:24:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450839122546688 [0;39m ==> Parameters: 
2022-08-26 18:24:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450839122546688 [0;39m <==    Updates: 0
2022-08-26 18:24:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450839122546688 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:24:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450860077289472 [0;39m 生成今日电子书快照开始
2022-08-26 18:24:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450860077289472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:24:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450860077289472 [0;39m ==> Parameters: 
2022-08-26 18:24:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450860077289472 [0;39m <==    Updates: 0
2022-08-26 18:24:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450860077289472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:24:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450881094946816 [0;39m 生成今日电子书快照开始
2022-08-26 18:24:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450881094946816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:24:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450881094946816 [0;39m ==> Parameters: 
2022-08-26 18:24:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450881094946816 [0;39m <==    Updates: 0
2022-08-26 18:24:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450881094946816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:24:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450902070661120 [0;39m 生成今日电子书快照开始
2022-08-26 18:24:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450902070661120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:24:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450902070661120 [0;39m ==> Parameters: 
2022-08-26 18:24:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450902070661120 [0;39m <==    Updates: 0
2022-08-26 18:24:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450902070661120 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:24:35.019 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20450902095826944 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:24:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450902095826944 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:24:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450902095826944 [0;39m ==> Parameters: 
2022-08-26 18:24:35.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20450902095826944 [0;39m <==    Updates: 8
2022-08-26 18:24:35.022 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20450902095826944 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 18:24:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450923037986816 [0;39m 生成今日电子书快照开始
2022-08-26 18:24:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450923037986816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:24:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450923037986816 [0;39m ==> Parameters: 
2022-08-26 18:24:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450923037986816 [0;39m <==    Updates: 0
2022-08-26 18:24:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450923037986816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:24:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450944001118208 [0;39m 生成今日电子书快照开始
2022-08-26 18:24:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450944001118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:24:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450944001118208 [0;39m ==> Parameters: 
2022-08-26 18:24:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450944001118208 [0;39m <==    Updates: 0
2022-08-26 18:24:45.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450944001118208 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:24:50.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450964934889472 [0;39m 生成今日电子书快照开始
2022-08-26 18:24:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450964934889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:24:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450964934889472 [0;39m ==> Parameters: 
2022-08-26 18:24:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450964934889472 [0;39m <==    Updates: 0
2022-08-26 18:24:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450964934889472 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:24:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20450985960935424 [0;39m 生成今日电子书快照开始
2022-08-26 18:24:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450985960935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:24:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450985960935424 [0;39m ==> Parameters: 
2022-08-26 18:24:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20450985960935424 [0;39m <==    Updates: 0
2022-08-26 18:24:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20450985960935424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:25:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451006919872512 [0;39m 生成今日电子书快照开始
2022-08-26 18:25:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451006919872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:25:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451006919872512 [0;39m ==> Parameters: 
2022-08-26 18:25:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451006919872512 [0;39m <==    Updates: 0
2022-08-26 18:25:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451006919872512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:25:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451027862032384 [0;39m 生成今日电子书快照开始
2022-08-26 18:25:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451027862032384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:25:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451027862032384 [0;39m ==> Parameters: 
2022-08-26 18:25:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451027862032384 [0;39m <==    Updates: 0
2022-08-26 18:25:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451027862032384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:25:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20451027895586816 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:25:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451027895586816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:25:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451027895586816 [0;39m ==> Parameters: 
2022-08-26 18:25:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451027895586816 [0;39m <==    Updates: 8
2022-08-26 18:25:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20451027895586816 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 18:25:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451048867106816 [0;39m 生成今日电子书快照开始
2022-08-26 18:25:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451048867106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:25:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451048867106816 [0;39m ==> Parameters: 
2022-08-26 18:25:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451048867106816 [0;39m <==    Updates: 0
2022-08-26 18:25:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451048867106816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:25:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451069800878080 [0;39m 生成今日电子书快照开始
2022-08-26 18:25:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451069800878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:25:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451069800878080 [0;39m ==> Parameters: 
2022-08-26 18:25:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451069800878080 [0;39m <==    Updates: 0
2022-08-26 18:25:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451069800878080 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:25:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451090764009472 [0;39m 生成今日电子书快照开始
2022-08-26 18:25:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451090764009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:25:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451090764009472 [0;39m ==> Parameters: 
2022-08-26 18:25:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451090764009472 [0;39m <==    Updates: 0
2022-08-26 18:25:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451090764009472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:25:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451111769083904 [0;39m 生成今日电子书快照开始
2022-08-26 18:25:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451111769083904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:25:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451111769083904 [0;39m ==> Parameters: 
2022-08-26 18:25:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451111769083904 [0;39m <==    Updates: 0
2022-08-26 18:25:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451111769083904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:25:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451132719632384 [0;39m 生成今日电子书快照开始
2022-08-26 18:25:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451132719632384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:25:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451132719632384 [0;39m ==> Parameters: 
2022-08-26 18:25:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451132719632384 [0;39m <==    Updates: 0
2022-08-26 18:25:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451132719632384 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:25:35.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451153678569472 [0;39m 生成今日电子书快照开始
2022-08-26 18:25:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451153678569472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:25:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451153678569472 [0;39m ==> Parameters: 
2022-08-26 18:25:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451153678569472 [0;39m <==    Updates: 0
2022-08-26 18:25:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451153678569472 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:25:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20451153703735296 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:25:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451153703735296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:25:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451153703735296 [0;39m ==> Parameters: 
2022-08-26 18:25:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451153703735296 [0;39m <==    Updates: 8
2022-08-26 18:25:35.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20451153703735296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:25:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451174683643904 [0;39m 生成今日电子书快照开始
2022-08-26 18:25:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451174683643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:25:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451174683643904 [0;39m ==> Parameters: 
2022-08-26 18:25:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451174683643904 [0;39m <==    Updates: 0
2022-08-26 18:25:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451174683643904 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:25:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451195642580992 [0;39m 生成今日电子书快照开始
2022-08-26 18:25:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451195642580992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:25:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451195642580992 [0;39m ==> Parameters: 
2022-08-26 18:25:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451195642580992 [0;39m <==    Updates: 0
2022-08-26 18:25:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451195642580992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:25:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451216609906688 [0;39m 生成今日电子书快照开始
2022-08-26 18:25:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451216609906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:25:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451216609906688 [0;39m ==> Parameters: 
2022-08-26 18:25:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451216609906688 [0;39m <==    Updates: 0
2022-08-26 18:25:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451216609906688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:25:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451237610786816 [0;39m 生成今日电子书快照开始
2022-08-26 18:25:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451237610786816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:25:55.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451237610786816 [0;39m ==> Parameters: 
2022-08-26 18:25:55.026 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451237610786816 [0;39m <==    Updates: 0
2022-08-26 18:25:55.027 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451237610786816 [0;39m 生成今日电子书快照结束，耗时：15 毫秒
2022-08-26 18:26:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451258540363776 [0;39m 生成今日电子书快照开始
2022-08-26 18:26:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451258540363776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:26:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451258540363776 [0;39m ==> Parameters: 
2022-08-26 18:26:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451258540363776 [0;39m <==    Updates: 0
2022-08-26 18:26:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451258540363776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:26:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20451279566409728 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:26:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451279566409728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:26:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451279566409728 [0;39m ==> Parameters: 
2022-08-26 18:26:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451279566409728 [0;39m <==    Updates: 8
2022-08-26 18:26:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20451279566409728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:26:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451279570604032 [0;39m 生成今日电子书快照开始
2022-08-26 18:26:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451279570604032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:26:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451279570604032 [0;39m ==> Parameters: 
2022-08-26 18:26:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451279570604032 [0;39m <==    Updates: 0
2022-08-26 18:26:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451279570604032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:26:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451300525346816 [0;39m 生成今日电子书快照开始
2022-08-26 18:26:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451300525346816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:26:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451300525346816 [0;39m ==> Parameters: 
2022-08-26 18:26:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451300525346816 [0;39m <==    Updates: 0
2022-08-26 18:26:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451300525346816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:26:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451321454923776 [0;39m 生成今日电子书快照开始
2022-08-26 18:26:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451321454923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:26:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451321454923776 [0;39m ==> Parameters: 
2022-08-26 18:26:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451321454923776 [0;39m <==    Updates: 0
2022-08-26 18:26:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451321454923776 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:26:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451342476775424 [0;39m 生成今日电子书快照开始
2022-08-26 18:26:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451342476775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:26:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451342476775424 [0;39m ==> Parameters: 
2022-08-26 18:26:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451342476775424 [0;39m <==    Updates: 0
2022-08-26 18:26:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451342476775424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:26:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451363427323904 [0;39m 生成今日电子书快照开始
2022-08-26 18:26:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451363427323904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:26:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451363427323904 [0;39m ==> Parameters: 
2022-08-26 18:26:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451363427323904 [0;39m <==    Updates: 0
2022-08-26 18:26:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451363427323904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:26:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451384369483776 [0;39m 生成今日电子书快照开始
2022-08-26 18:26:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451384369483776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:26:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451384369483776 [0;39m ==> Parameters: 
2022-08-26 18:26:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451384369483776 [0;39m <==    Updates: 0
2022-08-26 18:26:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451384369483776 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:26:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451405349392384 [0;39m 生成今日电子书快照开始
2022-08-26 18:26:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451405349392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:26:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451405349392384 [0;39m ==> Parameters: 
2022-08-26 18:26:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451405349392384 [0;39m <==    Updates: 0
2022-08-26 18:26:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451405349392384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:26:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20451405357780992 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:26:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451405357780992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:26:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451405357780992 [0;39m ==> Parameters: 
2022-08-26 18:26:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451405357780992 [0;39m <==    Updates: 8
2022-08-26 18:26:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20451405357780992 [0;39m 更新电子书下的文档数据结束，耗时：0 毫秒
2022-08-26 18:26:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451426325106688 [0;39m 生成今日电子书快照开始
2022-08-26 18:26:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451426325106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:26:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451426325106688 [0;39m ==> Parameters: 
2022-08-26 18:26:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451426325106688 [0;39m <==    Updates: 0
2022-08-26 18:26:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451426325106688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:26:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451447330181120 [0;39m 生成今日电子书快照开始
2022-08-26 18:26:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451447330181120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:26:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451447330181120 [0;39m ==> Parameters: 
2022-08-26 18:26:45.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451447330181120 [0;39m <==    Updates: 0
2022-08-26 18:26:45.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451447330181120 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:26:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451468289118208 [0;39m 生成今日电子书快照开始
2022-08-26 18:26:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451468289118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:26:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451468289118208 [0;39m ==> Parameters: 
2022-08-26 18:26:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451468289118208 [0;39m <==    Updates: 0
2022-08-26 18:26:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451468289118208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:26:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451489243860992 [0;39m 生成今日电子书快照开始
2022-08-26 18:26:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451489243860992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:26:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451489243860992 [0;39m ==> Parameters: 
2022-08-26 18:26:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451489243860992 [0;39m <==    Updates: 0
2022-08-26 18:26:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451489243860992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:27:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451510248935424 [0;39m 生成今日电子书快照开始
2022-08-26 18:27:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451510248935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:27:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451510248935424 [0;39m ==> Parameters: 
2022-08-26 18:27:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451510248935424 [0;39m <==    Updates: 0
2022-08-26 18:27:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451510248935424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:27:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451531178512384 [0;39m 生成今日电子书快照开始
2022-08-26 18:27:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451531178512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:27:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451531178512384 [0;39m ==> Parameters: 
2022-08-26 18:27:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451531178512384 [0;39m <==    Updates: 0
2022-08-26 18:27:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451531178512384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:27:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20451531212066816 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:27:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451531212066816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:27:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451531212066816 [0;39m ==> Parameters: 
2022-08-26 18:27:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451531212066816 [0;39m <==    Updates: 8
2022-08-26 18:27:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20451531212066816 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 18:27:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451552183586816 [0;39m 生成今日电子书快照开始
2022-08-26 18:27:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451552183586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:27:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451552183586816 [0;39m ==> Parameters: 
2022-08-26 18:27:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451552183586816 [0;39m <==    Updates: 0
2022-08-26 18:27:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451552183586816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:27:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451573129940992 [0;39m 生成今日电子书快照开始
2022-08-26 18:27:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451573129940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:27:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451573129940992 [0;39m ==> Parameters: 
2022-08-26 18:27:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451573129940992 [0;39m <==    Updates: 0
2022-08-26 18:27:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451573129940992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:27:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451594114043904 [0;39m 生成今日电子书快照开始
2022-08-26 18:27:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451594114043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:27:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451594114043904 [0;39m ==> Parameters: 
2022-08-26 18:27:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451594114043904 [0;39m <==    Updates: 0
2022-08-26 18:27:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451594114043904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:27:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451615060398080 [0;39m 生成今日电子书快照开始
2022-08-26 18:27:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451615060398080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:27:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451615060398080 [0;39m ==> Parameters: 
2022-08-26 18:27:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451615060398080 [0;39m <==    Updates: 0
2022-08-26 18:27:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451615060398080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:27:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451636040306688 [0;39m 生成今日电子书快照开始
2022-08-26 18:27:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451636040306688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:27:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451636040306688 [0;39m ==> Parameters: 
2022-08-26 18:27:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451636040306688 [0;39m <==    Updates: 0
2022-08-26 18:27:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451636040306688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:27:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451657036992512 [0;39m 生成今日电子书快照开始
2022-08-26 18:27:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451657036992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:27:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451657036992512 [0;39m ==> Parameters: 
2022-08-26 18:27:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451657036992512 [0;39m <==    Updates: 0
2022-08-26 18:27:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451657036992512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:27:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20451657045381120 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:27:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451657045381120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:27:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451657045381120 [0;39m ==> Parameters: 
2022-08-26 18:27:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451657045381120 [0;39m <==    Updates: 8
2022-08-26 18:27:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20451657045381120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:27:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451677995929600 [0;39m 生成今日电子书快照开始
2022-08-26 18:27:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451677995929600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:27:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451677995929600 [0;39m ==> Parameters: 
2022-08-26 18:27:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451677995929600 [0;39m <==    Updates: 0
2022-08-26 18:27:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451677995929600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:27:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451698942283776 [0;39m 生成今日电子书快照开始
2022-08-26 18:27:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451698942283776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:27:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451698942283776 [0;39m ==> Parameters: 
2022-08-26 18:27:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451698942283776 [0;39m <==    Updates: 0
2022-08-26 18:27:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451698942283776 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:27:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451719913803776 [0;39m 生成今日电子书快照开始
2022-08-26 18:27:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451719913803776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:27:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451719913803776 [0;39m ==> Parameters: 
2022-08-26 18:27:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451719913803776 [0;39m <==    Updates: 0
2022-08-26 18:27:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451719913803776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:27:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451740923072512 [0;39m 生成今日电子书快照开始
2022-08-26 18:27:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451740923072512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:27:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451740923072512 [0;39m ==> Parameters: 
2022-08-26 18:27:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451740923072512 [0;39m <==    Updates: 0
2022-08-26 18:27:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451740923072512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:28:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451761915564032 [0;39m 生成今日电子书快照开始
2022-08-26 18:28:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451761915564032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:28:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451761915564032 [0;39m ==> Parameters: 
2022-08-26 18:28:00.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451761915564032 [0;39m <==    Updates: 0
2022-08-26 18:28:00.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451761915564032 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:28:05.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451782828363776 [0;39m 生成今日电子书快照开始
2022-08-26 18:28:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451782828363776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:28:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451782828363776 [0;39m ==> Parameters: 
2022-08-26 18:28:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451782828363776 [0;39m <==    Updates: 0
2022-08-26 18:28:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451782828363776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:28:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20451782836752384 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:28:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451782836752384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:28:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451782836752384 [0;39m ==> Parameters: 
2022-08-26 18:28:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451782836752384 [0;39m <==    Updates: 8
2022-08-26 18:28:05.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20451782836752384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:28:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451803795689472 [0;39m 生成今日电子书快照开始
2022-08-26 18:28:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451803795689472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:28:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451803795689472 [0;39m ==> Parameters: 
2022-08-26 18:28:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451803795689472 [0;39m <==    Updates: 0
2022-08-26 18:28:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451803795689472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:28:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451824779792384 [0;39m 生成今日电子书快照开始
2022-08-26 18:28:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451824779792384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:28:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451824779792384 [0;39m ==> Parameters: 
2022-08-26 18:28:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451824779792384 [0;39m <==    Updates: 0
2022-08-26 18:28:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451824779792384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:28:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451845751312384 [0;39m 生成今日电子书快照开始
2022-08-26 18:28:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451845751312384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:28:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451845751312384 [0;39m ==> Parameters: 
2022-08-26 18:28:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451845751312384 [0;39m <==    Updates: 0
2022-08-26 18:28:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451845751312384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:28:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451866710249472 [0;39m 生成今日电子书快照开始
2022-08-26 18:28:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451866710249472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:28:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451866710249472 [0;39m ==> Parameters: 
2022-08-26 18:28:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451866710249472 [0;39m <==    Updates: 0
2022-08-26 18:28:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451866710249472 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:28:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451887719518208 [0;39m 生成今日电子书快照开始
2022-08-26 18:28:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451887719518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:28:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451887719518208 [0;39m ==> Parameters: 
2022-08-26 18:28:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451887719518208 [0;39m <==    Updates: 0
2022-08-26 18:28:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451887719518208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:28:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20451908674260992 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:28:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451908674260992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:28:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451908674260992 [0;39m ==> Parameters: 
2022-08-26 18:28:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20451908674260992 [0;39m <==    Updates: 8
2022-08-26 18:28:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20451908674260992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:28:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451908682649600 [0;39m 生成今日电子书快照开始
2022-08-26 18:28:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451908682649600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:28:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451908682649600 [0;39m ==> Parameters: 
2022-08-26 18:28:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451908682649600 [0;39m <==    Updates: 0
2022-08-26 18:28:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451908682649600 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:28:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451929670946816 [0;39m 生成今日电子书快照开始
2022-08-26 18:28:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451929670946816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:28:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451929670946816 [0;39m ==> Parameters: 
2022-08-26 18:28:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451929670946816 [0;39m <==    Updates: 0
2022-08-26 18:28:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451929670946816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:28:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451950621495296 [0;39m 生成今日电子书快照开始
2022-08-26 18:28:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451950621495296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:28:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451950621495296 [0;39m ==> Parameters: 
2022-08-26 18:28:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451950621495296 [0;39m <==    Updates: 0
2022-08-26 18:28:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451950621495296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:28:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451971572043776 [0;39m 生成今日电子书快照开始
2022-08-26 18:28:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451971572043776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:28:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451971572043776 [0;39m ==> Parameters: 
2022-08-26 18:28:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451971572043776 [0;39m <==    Updates: 0
2022-08-26 18:28:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451971572043776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:28:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20451992543563776 [0;39m 生成今日电子书快照开始
2022-08-26 18:28:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451992543563776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:28:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451992543563776 [0;39m ==> Parameters: 
2022-08-26 18:28:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20451992543563776 [0;39m <==    Updates: 0
2022-08-26 18:28:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20451992543563776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:29:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452013527666688 [0;39m 生成今日电子书快照开始
2022-08-26 18:29:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452013527666688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:29:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452013527666688 [0;39m ==> Parameters: 
2022-08-26 18:29:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452013527666688 [0;39m <==    Updates: 0
2022-08-26 18:29:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452013527666688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:29:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20452034524352512 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:29:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452034524352512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:29:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452034524352512 [0;39m ==> Parameters: 
2022-08-26 18:29:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452034524352512 [0;39m <==    Updates: 8
2022-08-26 18:29:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20452034524352512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:29:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452034532741120 [0;39m 生成今日电子书快照开始
2022-08-26 18:29:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452034532741120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:29:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452034532741120 [0;39m ==> Parameters: 
2022-08-26 18:29:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452034532741120 [0;39m <==    Updates: 0
2022-08-26 18:29:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452034532741120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:29:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452055458123776 [0;39m 生成今日电子书快照开始
2022-08-26 18:29:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452055458123776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:29:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452055458123776 [0;39m ==> Parameters: 
2022-08-26 18:29:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452055458123776 [0;39m <==    Updates: 0
2022-08-26 18:29:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452055458123776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:29:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452076463198208 [0;39m 生成今日电子书快照开始
2022-08-26 18:29:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452076463198208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:29:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452076463198208 [0;39m ==> Parameters: 
2022-08-26 18:29:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452076463198208 [0;39m <==    Updates: 0
2022-08-26 18:29:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452076463198208 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:29:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452097438912512 [0;39m 生成今日电子书快照开始
2022-08-26 18:29:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452097438912512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:29:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452097438912512 [0;39m ==> Parameters: 
2022-08-26 18:29:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452097438912512 [0;39m <==    Updates: 0
2022-08-26 18:29:20.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452097438912512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:29:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452118406238208 [0;39m 生成今日电子书快照开始
2022-08-26 18:29:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452118406238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:29:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452118406238208 [0;39m ==> Parameters: 
2022-08-26 18:29:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452118406238208 [0;39m <==    Updates: 0
2022-08-26 18:29:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452118406238208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:29:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452139381952512 [0;39m 生成今日电子书快照开始
2022-08-26 18:29:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452139381952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:29:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452139381952512 [0;39m ==> Parameters: 
2022-08-26 18:29:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452139381952512 [0;39m <==    Updates: 0
2022-08-26 18:29:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452139381952512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:29:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452160324112384 [0;39m 生成今日电子书快照开始
2022-08-26 18:29:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452160324112384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:29:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452160324112384 [0;39m ==> Parameters: 
2022-08-26 18:29:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452160324112384 [0;39m <==    Updates: 0
2022-08-26 18:29:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452160324112384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:29:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20452160332500992 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:29:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452160332500992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:29:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452160332500992 [0;39m ==> Parameters: 
2022-08-26 18:29:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452160332500992 [0;39m <==    Updates: 8
2022-08-26 18:29:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20452160332500992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:29:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452181304020992 [0;39m 生成今日电子书快照开始
2022-08-26 18:29:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452181304020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:29:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452181304020992 [0;39m ==> Parameters: 
2022-08-26 18:29:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452181304020992 [0;39m <==    Updates: 0
2022-08-26 18:29:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452181304020992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:29:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452202271346688 [0;39m 生成今日电子书快照开始
2022-08-26 18:29:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452202271346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:29:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452202271346688 [0;39m ==> Parameters: 
2022-08-26 18:29:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452202271346688 [0;39m <==    Updates: 0
2022-08-26 18:29:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452202271346688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:29:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452223238672384 [0;39m 生成今日电子书快照开始
2022-08-26 18:29:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452223238672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:29:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452223238672384 [0;39m ==> Parameters: 
2022-08-26 18:29:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452223238672384 [0;39m <==    Updates: 0
2022-08-26 18:29:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452223238672384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:29:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452244239552512 [0;39m 生成今日电子书快照开始
2022-08-26 18:29:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452244239552512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:29:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452244239552512 [0;39m ==> Parameters: 
2022-08-26 18:29:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452244239552512 [0;39m <==    Updates: 0
2022-08-26 18:29:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452244239552512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:30:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452265202683904 [0;39m 生成今日电子书快照开始
2022-08-26 18:30:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452265202683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:30:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452265202683904 [0;39m ==> Parameters: 
2022-08-26 18:30:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452265202683904 [0;39m <==    Updates: 0
2022-08-26 18:30:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452265202683904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:30:05.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452286140649472 [0;39m 生成今日电子书快照开始
2022-08-26 18:30:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452286140649472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:30:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452286140649472 [0;39m ==> Parameters: 
2022-08-26 18:30:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452286140649472 [0;39m <==    Updates: 0
2022-08-26 18:30:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452286140649472 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:30:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20452286174203904 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:30:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452286174203904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:30:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452286174203904 [0;39m ==> Parameters: 
2022-08-26 18:30:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452286174203904 [0;39m <==    Updates: 8
2022-08-26 18:30:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20452286174203904 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 18:30:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452307149918208 [0;39m 生成今日电子书快照开始
2022-08-26 18:30:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452307149918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:30:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452307149918208 [0;39m ==> Parameters: 
2022-08-26 18:30:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452307149918208 [0;39m <==    Updates: 0
2022-08-26 18:30:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452307149918208 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:30:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452328083689472 [0;39m 生成今日电子书快照开始
2022-08-26 18:30:15.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452328083689472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:30:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452328083689472 [0;39m ==> Parameters: 
2022-08-26 18:30:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452328083689472 [0;39m <==    Updates: 0
2022-08-26 18:30:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452328083689472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:30:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452349067792384 [0;39m 生成今日电子书快照开始
2022-08-26 18:30:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452349067792384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:30:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452349067792384 [0;39m ==> Parameters: 
2022-08-26 18:30:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452349067792384 [0;39m <==    Updates: 0
2022-08-26 18:30:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452349067792384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:30:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452370026729472 [0;39m 生成今日电子书快照开始
2022-08-26 18:30:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452370026729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:30:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452370026729472 [0;39m ==> Parameters: 
2022-08-26 18:30:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452370026729472 [0;39m <==    Updates: 0
2022-08-26 18:30:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452370026729472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:30:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452391027609600 [0;39m 生成今日电子书快照开始
2022-08-26 18:30:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452391027609600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:30:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452391027609600 [0;39m ==> Parameters: 
2022-08-26 18:30:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452391027609600 [0;39m <==    Updates: 0
2022-08-26 18:30:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452391027609600 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:30:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452412015906816 [0;39m 生成今日电子书快照开始
2022-08-26 18:30:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452412015906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:30:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452412015906816 [0;39m ==> Parameters: 
2022-08-26 18:30:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452412015906816 [0;39m <==    Updates: 0
2022-08-26 18:30:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452412015906816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:30:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20452412024295424 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:30:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452412024295424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:30:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452412024295424 [0;39m ==> Parameters: 
2022-08-26 18:30:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452412024295424 [0;39m <==    Updates: 8
2022-08-26 18:30:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20452412024295424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:30:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452433000009728 [0;39m 生成今日电子书快照开始
2022-08-26 18:30:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452433000009728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:30:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452433000009728 [0;39m ==> Parameters: 
2022-08-26 18:30:40.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452433000009728 [0;39m <==    Updates: 0
2022-08-26 18:30:40.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452433000009728 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:30:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452453958946816 [0;39m 生成今日电子书快照开始
2022-08-26 18:30:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452453958946816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:30:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452453958946816 [0;39m ==> Parameters: 
2022-08-26 18:30:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452453958946816 [0;39m <==    Updates: 0
2022-08-26 18:30:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452453958946816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:30:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452474905300992 [0;39m 生成今日电子书快照开始
2022-08-26 18:30:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452474905300992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:30:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452474905300992 [0;39m ==> Parameters: 
2022-08-26 18:30:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452474905300992 [0;39m <==    Updates: 0
2022-08-26 18:30:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452474905300992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:30:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452495897792512 [0;39m 生成今日电子书快照开始
2022-08-26 18:30:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452495897792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:30:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452495897792512 [0;39m ==> Parameters: 
2022-08-26 18:30:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452495897792512 [0;39m <==    Updates: 0
2022-08-26 18:30:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452495897792512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:31:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452516890284032 [0;39m 生成今日电子书快照开始
2022-08-26 18:31:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452516890284032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:31:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452516890284032 [0;39m ==> Parameters: 
2022-08-26 18:31:00.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452516890284032 [0;39m <==    Updates: 0
2022-08-26 18:31:00.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452516890284032 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:31:05.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452537798889472 [0;39m 生成今日电子书快照开始
2022-08-26 18:31:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452537798889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:31:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452537798889472 [0;39m ==> Parameters: 
2022-08-26 18:31:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452537798889472 [0;39m <==    Updates: 0
2022-08-26 18:31:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452537798889472 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:31:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20452537824055296 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:31:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452537824055296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:31:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452537824055296 [0;39m ==> Parameters: 
2022-08-26 18:31:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452537824055296 [0;39m <==    Updates: 8
2022-08-26 18:31:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20452537824055296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:31:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452558799769600 [0;39m 生成今日电子书快照开始
2022-08-26 18:31:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452558799769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:31:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452558799769600 [0;39m ==> Parameters: 
2022-08-26 18:31:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452558799769600 [0;39m <==    Updates: 0
2022-08-26 18:31:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452558799769600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:31:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452579771289600 [0;39m 生成今日电子书快照开始
2022-08-26 18:31:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452579771289600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:31:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452579771289600 [0;39m ==> Parameters: 
2022-08-26 18:31:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452579771289600 [0;39m <==    Updates: 0
2022-08-26 18:31:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452579771289600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:31:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452600717643776 [0;39m 生成今日电子书快照开始
2022-08-26 18:31:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452600717643776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:31:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452600717643776 [0;39m ==> Parameters: 
2022-08-26 18:31:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452600717643776 [0;39m <==    Updates: 0
2022-08-26 18:31:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452600717643776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:31:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452621684969472 [0;39m 生成今日电子书快照开始
2022-08-26 18:31:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452621684969472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:31:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452621684969472 [0;39m ==> Parameters: 
2022-08-26 18:31:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452621684969472 [0;39m <==    Updates: 0
2022-08-26 18:31:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452621684969472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:31:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452642698432512 [0;39m 生成今日电子书快照开始
2022-08-26 18:31:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452642698432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:31:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452642698432512 [0;39m ==> Parameters: 
2022-08-26 18:31:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452642698432512 [0;39m <==    Updates: 0
2022-08-26 18:31:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452642698432512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:31:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20452663669952512 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:31:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452663669952512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:31:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452663669952512 [0;39m ==> Parameters: 
2022-08-26 18:31:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452663669952512 [0;39m <==    Updates: 8
2022-08-26 18:31:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20452663669952512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:31:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452663678341120 [0;39m 生成今日电子书快照开始
2022-08-26 18:31:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452663678341120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:31:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452663678341120 [0;39m ==> Parameters: 
2022-08-26 18:31:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452663678341120 [0;39m <==    Updates: 0
2022-08-26 18:31:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452663678341120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:31:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452684654055424 [0;39m 生成今日电子书快照开始
2022-08-26 18:31:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452684654055424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:31:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452684654055424 [0;39m ==> Parameters: 
2022-08-26 18:31:40.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452684654055424 [0;39m <==    Updates: 0
2022-08-26 18:31:40.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452684654055424 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:31:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452705612992512 [0;39m 生成今日电子书快照开始
2022-08-26 18:31:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452705612992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:31:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452705612992512 [0;39m ==> Parameters: 
2022-08-26 18:31:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452705612992512 [0;39m <==    Updates: 0
2022-08-26 18:31:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452705612992512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:31:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452726597095424 [0;39m 生成今日电子书快照开始
2022-08-26 18:31:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452726597095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:31:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452726597095424 [0;39m ==> Parameters: 
2022-08-26 18:31:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452726597095424 [0;39m <==    Updates: 0
2022-08-26 18:31:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452726597095424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:31:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452747547643904 [0;39m 生成今日电子书快照开始
2022-08-26 18:31:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452747547643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:31:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452747547643904 [0;39m ==> Parameters: 
2022-08-26 18:31:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452747547643904 [0;39m <==    Updates: 0
2022-08-26 18:31:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452747547643904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:32:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452768535941120 [0;39m 生成今日电子书快照开始
2022-08-26 18:32:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452768535941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:32:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452768535941120 [0;39m ==> Parameters: 
2022-08-26 18:32:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452768535941120 [0;39m <==    Updates: 0
2022-08-26 18:32:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452768535941120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:32:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20452789478100992 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:32:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452789478100992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:32:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452789478100992 [0;39m ==> Parameters: 
2022-08-26 18:32:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452789478100992 [0;39m <==    Updates: 8
2022-08-26 18:32:05.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20452789478100992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:32:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452789486489600 [0;39m 生成今日电子书快照开始
2022-08-26 18:32:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452789486489600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:32:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452789486489600 [0;39m ==> Parameters: 
2022-08-26 18:32:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452789486489600 [0;39m <==    Updates: 0
2022-08-26 18:32:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452789486489600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:32:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452810449620992 [0;39m 生成今日电子书快照开始
2022-08-26 18:32:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452810449620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:32:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452810449620992 [0;39m ==> Parameters: 
2022-08-26 18:32:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452810449620992 [0;39m <==    Updates: 0
2022-08-26 18:32:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452810449620992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:32:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452831421140992 [0;39m 生成今日电子书快照开始
2022-08-26 18:32:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452831421140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:32:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452831421140992 [0;39m ==> Parameters: 
2022-08-26 18:32:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452831421140992 [0;39m <==    Updates: 0
2022-08-26 18:32:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452831421140992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:32:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452852384272384 [0;39m 生成今日电子书快照开始
2022-08-26 18:32:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452852384272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:32:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452852384272384 [0;39m ==> Parameters: 
2022-08-26 18:32:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452852384272384 [0;39m <==    Updates: 0
2022-08-26 18:32:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452852384272384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:32:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452873364180992 [0;39m 生成今日电子书快照开始
2022-08-26 18:32:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452873364180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:32:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452873364180992 [0;39m ==> Parameters: 
2022-08-26 18:32:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452873364180992 [0;39m <==    Updates: 0
2022-08-26 18:32:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452873364180992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:32:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452894360866816 [0;39m 生成今日电子书快照开始
2022-08-26 18:32:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452894360866816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:32:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452894360866816 [0;39m ==> Parameters: 
2022-08-26 18:32:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452894360866816 [0;39m <==    Updates: 0
2022-08-26 18:32:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452894360866816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:32:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20452915307220992 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:32:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452915307220992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:32:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452915307220992 [0;39m ==> Parameters: 
2022-08-26 18:32:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20452915307220992 [0;39m <==    Updates: 8
2022-08-26 18:32:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20452915307220992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:32:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452915311415296 [0;39m 生成今日电子书快照开始
2022-08-26 18:32:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452915311415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:32:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452915311415296 [0;39m ==> Parameters: 
2022-08-26 18:32:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452915311415296 [0;39m <==    Updates: 0
2022-08-26 18:32:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452915311415296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:32:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452936308101120 [0;39m 生成今日电子书快照开始
2022-08-26 18:32:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452936308101120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:32:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452936308101120 [0;39m ==> Parameters: 
2022-08-26 18:32:40.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452936308101120 [0;39m <==    Updates: 0
2022-08-26 18:32:40.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452936308101120 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 18:32:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452957250260992 [0;39m 生成今日电子书快照开始
2022-08-26 18:32:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452957250260992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:32:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452957250260992 [0;39m ==> Parameters: 
2022-08-26 18:32:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452957250260992 [0;39m <==    Updates: 0
2022-08-26 18:32:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452957250260992 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:32:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452978205003776 [0;39m 生成今日电子书快照开始
2022-08-26 18:32:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452978205003776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:32:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452978205003776 [0;39m ==> Parameters: 
2022-08-26 18:32:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452978205003776 [0;39m <==    Updates: 0
2022-08-26 18:32:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452978205003776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:32:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20452999226855424 [0;39m 生成今日电子书快照开始
2022-08-26 18:32:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452999226855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:32:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452999226855424 [0;39m ==> Parameters: 
2022-08-26 18:32:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20452999226855424 [0;39m <==    Updates: 0
2022-08-26 18:32:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20452999226855424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:33:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453020160626688 [0;39m 生成今日电子书快照开始
2022-08-26 18:33:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453020160626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:33:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453020160626688 [0;39m ==> Parameters: 
2022-08-26 18:33:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453020160626688 [0;39m <==    Updates: 0
2022-08-26 18:33:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453020160626688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:33:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20453041161506816 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:33:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453041161506816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:33:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453041161506816 [0;39m ==> Parameters: 
2022-08-26 18:33:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453041161506816 [0;39m <==    Updates: 8
2022-08-26 18:33:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20453041161506816 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-26 18:33:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453041186672640 [0;39m 生成今日电子书快照开始
2022-08-26 18:33:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453041186672640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:33:05.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453041186672640 [0;39m ==> Parameters: 
2022-08-26 18:33:05.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453041186672640 [0;39m <==    Updates: 0
2022-08-26 18:33:05.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453041186672640 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:33:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453062112055296 [0;39m 生成今日电子书快照开始
2022-08-26 18:33:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453062112055296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:33:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453062112055296 [0;39m ==> Parameters: 
2022-08-26 18:33:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453062112055296 [0;39m <==    Updates: 0
2022-08-26 18:33:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453062112055296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:33:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453083066798080 [0;39m 生成今日电子书快照开始
2022-08-26 18:33:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453083066798080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:33:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453083066798080 [0;39m ==> Parameters: 
2022-08-26 18:33:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453083066798080 [0;39m <==    Updates: 0
2022-08-26 18:33:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453083066798080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:33:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453104071872512 [0;39m 生成今日电子书快照开始
2022-08-26 18:33:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453104071872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:33:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453104071872512 [0;39m ==> Parameters: 
2022-08-26 18:33:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453104071872512 [0;39m <==    Updates: 0
2022-08-26 18:33:20.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453104071872512 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:33:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453125001449472 [0;39m 生成今日电子书快照开始
2022-08-26 18:33:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453125001449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:33:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453125001449472 [0;39m ==> Parameters: 
2022-08-26 18:33:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453125001449472 [0;39m <==    Updates: 0
2022-08-26 18:33:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453125001449472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:33:30.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453145968775168 [0;39m 生成今日电子书快照开始
2022-08-26 18:33:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453145968775168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:33:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453145968775168 [0;39m ==> Parameters: 
2022-08-26 18:33:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453145968775168 [0;39m <==    Updates: 0
2022-08-26 18:33:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453145968775168 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:33:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453166990626816 [0;39m 生成今日电子书快照开始
2022-08-26 18:33:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453166990626816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:33:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453166990626816 [0;39m ==> Parameters: 
2022-08-26 18:33:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453166990626816 [0;39m <==    Updates: 0
2022-08-26 18:33:35.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453166990626816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:33:35.020 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20453167024181248 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:33:35.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453167024181248 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:33:35.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453167024181248 [0;39m ==> Parameters: 
2022-08-26 18:33:35.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453167024181248 [0;39m <==    Updates: 8
2022-08-26 18:33:35.024 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20453167024181248 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 18:33:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453187932786688 [0;39m 生成今日电子书快照开始
2022-08-26 18:33:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453187932786688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:33:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453187932786688 [0;39m ==> Parameters: 
2022-08-26 18:33:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453187932786688 [0;39m <==    Updates: 0
2022-08-26 18:33:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453187932786688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:33:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453208895918080 [0;39m 生成今日电子书快照开始
2022-08-26 18:33:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453208895918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:33:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453208895918080 [0;39m ==> Parameters: 
2022-08-26 18:33:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453208895918080 [0;39m <==    Updates: 0
2022-08-26 18:33:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453208895918080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:33:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453229884215296 [0;39m 生成今日电子书快照开始
2022-08-26 18:33:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453229884215296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:33:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453229884215296 [0;39m ==> Parameters: 
2022-08-26 18:33:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453229884215296 [0;39m <==    Updates: 0
2022-08-26 18:33:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453229884215296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:33:55.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453250826375168 [0;39m 生成今日电子书快照开始
2022-08-26 18:33:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453250826375168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:33:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453250826375168 [0;39m ==> Parameters: 
2022-08-26 18:33:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453250826375168 [0;39m <==    Updates: 0
2022-08-26 18:33:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453250826375168 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:34:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453271848226816 [0;39m 生成今日电子书快照开始
2022-08-26 18:34:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453271848226816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:34:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453271848226816 [0;39m ==> Parameters: 
2022-08-26 18:34:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453271848226816 [0;39m <==    Updates: 0
2022-08-26 18:34:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453271848226816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:34:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453292836524032 [0;39m 生成今日电子书快照开始
2022-08-26 18:34:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453292836524032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:34:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453292836524032 [0;39m ==> Parameters: 
2022-08-26 18:34:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453292836524032 [0;39m <==    Updates: 0
2022-08-26 18:34:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453292836524032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:34:05.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20453292844912640 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:34:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453292844912640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:34:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453292844912640 [0;39m ==> Parameters: 
2022-08-26 18:34:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453292844912640 [0;39m <==    Updates: 8
2022-08-26 18:34:05.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20453292844912640 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:34:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453313791266816 [0;39m 生成今日电子书快照开始
2022-08-26 18:34:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453313791266816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:34:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453313791266816 [0;39m ==> Parameters: 
2022-08-26 18:34:10.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453313791266816 [0;39m <==    Updates: 0
2022-08-26 18:34:10.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453313791266816 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:34:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453334737620992 [0;39m 生成今日电子书快照开始
2022-08-26 18:34:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453334737620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:34:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453334737620992 [0;39m ==> Parameters: 
2022-08-26 18:34:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453334737620992 [0;39m <==    Updates: 0
2022-08-26 18:34:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453334737620992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:34:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453355717529600 [0;39m 生成今日电子书快照开始
2022-08-26 18:34:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453355717529600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:34:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453355717529600 [0;39m ==> Parameters: 
2022-08-26 18:34:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453355717529600 [0;39m <==    Updates: 0
2022-08-26 18:34:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453355717529600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:34:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453376672272384 [0;39m 生成今日电子书快照开始
2022-08-26 18:34:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453376672272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:34:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453376672272384 [0;39m ==> Parameters: 
2022-08-26 18:34:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453376672272384 [0;39m <==    Updates: 0
2022-08-26 18:34:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453376672272384 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:34:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453397664763904 [0;39m 生成今日电子书快照开始
2022-08-26 18:34:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453397664763904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:34:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453397664763904 [0;39m ==> Parameters: 
2022-08-26 18:34:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453397664763904 [0;39m <==    Updates: 0
2022-08-26 18:34:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453397664763904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:34:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453418606923776 [0;39m 生成今日电子书快照开始
2022-08-26 18:34:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453418606923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:34:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453418606923776 [0;39m ==> Parameters: 
2022-08-26 18:34:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453418606923776 [0;39m <==    Updates: 0
2022-08-26 18:34:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453418606923776 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:34:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20453418615312384 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:34:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453418615312384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:34:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453418615312384 [0;39m ==> Parameters: 
2022-08-26 18:34:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453418615312384 [0;39m <==    Updates: 8
2022-08-26 18:34:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20453418615312384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:34:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453439574249472 [0;39m 生成今日电子书快照开始
2022-08-26 18:34:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453439574249472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:34:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453439574249472 [0;39m ==> Parameters: 
2022-08-26 18:34:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453439574249472 [0;39m <==    Updates: 0
2022-08-26 18:34:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453439574249472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:34:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453460583518208 [0;39m 生成今日电子书快照开始
2022-08-26 18:34:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453460583518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:34:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453460583518208 [0;39m ==> Parameters: 
2022-08-26 18:34:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453460583518208 [0;39m <==    Updates: 0
2022-08-26 18:34:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453460583518208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:34:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453481538260992 [0;39m 生成今日电子书快照开始
2022-08-26 18:34:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453481538260992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:34:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453481538260992 [0;39m ==> Parameters: 
2022-08-26 18:34:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453481538260992 [0;39m <==    Updates: 0
2022-08-26 18:34:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453481538260992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:34:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453502505586688 [0;39m 生成今日电子书快照开始
2022-08-26 18:34:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453502505586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:34:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453502505586688 [0;39m ==> Parameters: 
2022-08-26 18:34:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453502505586688 [0;39m <==    Updates: 0
2022-08-26 18:34:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453502505586688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:35:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453523477106688 [0;39m 生成今日电子书快照开始
2022-08-26 18:35:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453523477106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:35:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453523477106688 [0;39m ==> Parameters: 
2022-08-26 18:35:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453523477106688 [0;39m <==    Updates: 0
2022-08-26 18:35:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453523477106688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:35:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453544490569728 [0;39m 生成今日电子书快照开始
2022-08-26 18:35:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453544490569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:35:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453544490569728 [0;39m ==> Parameters: 
2022-08-26 18:35:05.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453544490569728 [0;39m <==    Updates: 0
2022-08-26 18:35:05.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453544490569728 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:35:05.023 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20453544524124160 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:35:05.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453544524124160 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:35:05.024 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453544524124160 [0;39m ==> Parameters: 
2022-08-26 18:35:05.027 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453544524124160 [0;39m <==    Updates: 8
2022-08-26 18:35:05.027 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20453544524124160 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 18:35:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453565436923904 [0;39m 生成今日电子书快照开始
2022-08-26 18:35:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453565436923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:35:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453565436923904 [0;39m ==> Parameters: 
2022-08-26 18:35:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453565436923904 [0;39m <==    Updates: 0
2022-08-26 18:35:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453565436923904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:35:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453586383278080 [0;39m 生成今日电子书快照开始
2022-08-26 18:35:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453586383278080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:35:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453586383278080 [0;39m ==> Parameters: 
2022-08-26 18:35:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453586383278080 [0;39m <==    Updates: 0
2022-08-26 18:35:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453586383278080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:35:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453607379963904 [0;39m 生成今日电子书快照开始
2022-08-26 18:35:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453607379963904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:35:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453607379963904 [0;39m ==> Parameters: 
2022-08-26 18:35:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453607379963904 [0;39m <==    Updates: 0
2022-08-26 18:35:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453607379963904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:35:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453628330512384 [0;39m 生成今日电子书快照开始
2022-08-26 18:35:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453628330512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:35:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453628330512384 [0;39m ==> Parameters: 
2022-08-26 18:35:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453628330512384 [0;39m <==    Updates: 0
2022-08-26 18:35:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453628330512384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:35:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453649335586816 [0;39m 生成今日电子书快照开始
2022-08-26 18:35:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453649335586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:35:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453649335586816 [0;39m ==> Parameters: 
2022-08-26 18:35:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453649335586816 [0;39m <==    Updates: 0
2022-08-26 18:35:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453649335586816 [0;39m 生成今日电子书快照结束，耗时：0 毫秒
2022-08-26 18:35:35.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20453670307106816 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:35:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453670307106816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:35:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453670307106816 [0;39m ==> Parameters: 
2022-08-26 18:35:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453670307106816 [0;39m <==    Updates: 8
2022-08-26 18:35:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20453670307106816 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:35:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453670315495424 [0;39m 生成今日电子书快照开始
2022-08-26 18:35:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453670315495424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:35:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453670315495424 [0;39m ==> Parameters: 
2022-08-26 18:35:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453670315495424 [0;39m <==    Updates: 0
2022-08-26 18:35:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453670315495424 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:35:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453691274432512 [0;39m 生成今日电子书快照开始
2022-08-26 18:35:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453691274432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:35:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453691274432512 [0;39m ==> Parameters: 
2022-08-26 18:35:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453691274432512 [0;39m <==    Updates: 0
2022-08-26 18:35:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453691274432512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:35:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453712216592384 [0;39m 生成今日电子书快照开始
2022-08-26 18:35:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453712216592384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:35:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453712216592384 [0;39m ==> Parameters: 
2022-08-26 18:35:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453712216592384 [0;39m <==    Updates: 0
2022-08-26 18:35:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453712216592384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:35:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453733188112384 [0;39m 生成今日电子书快照开始
2022-08-26 18:35:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453733188112384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:35:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453733188112384 [0;39m ==> Parameters: 
2022-08-26 18:35:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453733188112384 [0;39m <==    Updates: 0
2022-08-26 18:35:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453733188112384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:35:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453754188992512 [0;39m 生成今日电子书快照开始
2022-08-26 18:35:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453754188992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:35:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453754188992512 [0;39m ==> Parameters: 
2022-08-26 18:35:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453754188992512 [0;39m <==    Updates: 0
2022-08-26 18:35:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453754188992512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:36:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453775164706816 [0;39m 生成今日电子书快照开始
2022-08-26 18:36:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453775164706816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:36:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453775164706816 [0;39m ==> Parameters: 
2022-08-26 18:36:00.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453775164706816 [0;39m <==    Updates: 0
2022-08-26 18:36:00.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453775164706816 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 18:36:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20453796119449600 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:36:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453796119449600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:36:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453796119449600 [0;39m ==> Parameters: 
2022-08-26 18:36:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453796119449600 [0;39m <==    Updates: 8
2022-08-26 18:36:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20453796119449600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:36:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453796123643904 [0;39m 生成今日电子书快照开始
2022-08-26 18:36:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453796123643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:36:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453796123643904 [0;39m ==> Parameters: 
2022-08-26 18:36:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453796123643904 [0;39m <==    Updates: 0
2022-08-26 18:36:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453796123643904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:36:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453817103552512 [0;39m 生成今日电子书快照开始
2022-08-26 18:36:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453817103552512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:36:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453817103552512 [0;39m ==> Parameters: 
2022-08-26 18:36:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453817103552512 [0;39m <==    Updates: 0
2022-08-26 18:36:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453817103552512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:36:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453838066683904 [0;39m 生成今日电子书快照开始
2022-08-26 18:36:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453838066683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:36:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453838066683904 [0;39m ==> Parameters: 
2022-08-26 18:36:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453838066683904 [0;39m <==    Updates: 0
2022-08-26 18:36:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453838066683904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:36:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453859046592512 [0;39m 生成今日电子书快照开始
2022-08-26 18:36:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453859046592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:36:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453859046592512 [0;39m ==> Parameters: 
2022-08-26 18:36:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453859046592512 [0;39m <==    Updates: 0
2022-08-26 18:36:20.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453859046592512 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:36:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453880001335296 [0;39m 生成今日电子书快照开始
2022-08-26 18:36:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453880001335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:36:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453880001335296 [0;39m ==> Parameters: 
2022-08-26 18:36:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453880001335296 [0;39m <==    Updates: 0
2022-08-26 18:36:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453880001335296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:36:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453900998021120 [0;39m 生成今日电子书快照开始
2022-08-26 18:36:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453900998021120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:36:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453900998021120 [0;39m ==> Parameters: 
2022-08-26 18:36:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453900998021120 [0;39m <==    Updates: 0
2022-08-26 18:36:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453900998021120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:36:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20453921935986688 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:36:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453921935986688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:36:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453921935986688 [0;39m ==> Parameters: 
2022-08-26 18:36:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20453921935986688 [0;39m <==    Updates: 8
2022-08-26 18:36:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20453921935986688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:36:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453921940180992 [0;39m 生成今日电子书快照开始
2022-08-26 18:36:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453921940180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:36:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453921940180992 [0;39m ==> Parameters: 
2022-08-26 18:36:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453921940180992 [0;39m <==    Updates: 0
2022-08-26 18:36:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453921940180992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:36:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453942894923776 [0;39m 生成今日电子书快照开始
2022-08-26 18:36:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453942894923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:36:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453942894923776 [0;39m ==> Parameters: 
2022-08-26 18:36:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453942894923776 [0;39m <==    Updates: 0
2022-08-26 18:36:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453942894923776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:36:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453963904192512 [0;39m 生成今日电子书快照开始
2022-08-26 18:36:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453963904192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:36:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453963904192512 [0;39m ==> Parameters: 
2022-08-26 18:36:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453963904192512 [0;39m <==    Updates: 0
2022-08-26 18:36:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453963904192512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:36:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20453984850546688 [0;39m 生成今日电子书快照开始
2022-08-26 18:36:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453984850546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:36:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453984850546688 [0;39m ==> Parameters: 
2022-08-26 18:36:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20453984850546688 [0;39m <==    Updates: 0
2022-08-26 18:36:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20453984850546688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:36:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454005864009728 [0;39m 生成今日电子书快照开始
2022-08-26 18:36:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454005864009728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:36:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454005864009728 [0;39m ==> Parameters: 
2022-08-26 18:36:55.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454005864009728 [0;39m <==    Updates: 0
2022-08-26 18:36:55.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454005864009728 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:37:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454026776809472 [0;39m 生成今日电子书快照开始
2022-08-26 18:37:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454026776809472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:37:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454026776809472 [0;39m ==> Parameters: 
2022-08-26 18:37:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454026776809472 [0;39m <==    Updates: 0
2022-08-26 18:37:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454026776809472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:37:05.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454047748329472 [0;39m 生成今日电子书快照开始
2022-08-26 18:37:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454047748329472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:37:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454047748329472 [0;39m ==> Parameters: 
2022-08-26 18:37:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454047748329472 [0;39m <==    Updates: 0
2022-08-26 18:37:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454047748329472 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:37:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20454047773495296 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:37:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454047773495296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:37:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454047773495296 [0;39m ==> Parameters: 
2022-08-26 18:37:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454047773495296 [0;39m <==    Updates: 8
2022-08-26 18:37:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20454047773495296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:37:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454068761792512 [0;39m 生成今日电子书快照开始
2022-08-26 18:37:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454068761792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:37:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454068761792512 [0;39m ==> Parameters: 
2022-08-26 18:37:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454068761792512 [0;39m <==    Updates: 0
2022-08-26 18:37:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454068761792512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:37:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454089691369472 [0;39m 生成今日电子书快照开始
2022-08-26 18:37:15.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454089691369472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:37:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454089691369472 [0;39m ==> Parameters: 
2022-08-26 18:37:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454089691369472 [0;39m <==    Updates: 0
2022-08-26 18:37:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454089691369472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:37:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454110679666688 [0;39m 生成今日电子书快照开始
2022-08-26 18:37:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454110679666688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:37:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454110679666688 [0;39m ==> Parameters: 
2022-08-26 18:37:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454110679666688 [0;39m <==    Updates: 0
2022-08-26 18:37:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454110679666688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:37:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454131646992384 [0;39m 生成今日电子书快照开始
2022-08-26 18:37:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454131646992384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:37:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454131646992384 [0;39m ==> Parameters: 
2022-08-26 18:37:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454131646992384 [0;39m <==    Updates: 0
2022-08-26 18:37:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454131646992384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:37:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454152614318080 [0;39m 生成今日电子书快照开始
2022-08-26 18:37:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454152614318080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:37:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454152614318080 [0;39m ==> Parameters: 
2022-08-26 18:37:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454152614318080 [0;39m <==    Updates: 0
2022-08-26 18:37:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454152614318080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:37:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454173606809600 [0;39m 生成今日电子书快照开始
2022-08-26 18:37:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454173606809600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:37:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454173606809600 [0;39m ==> Parameters: 
2022-08-26 18:37:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454173606809600 [0;39m <==    Updates: 0
2022-08-26 18:37:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454173606809600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:37:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20454173619392512 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:37:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454173619392512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:37:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454173619392512 [0;39m ==> Parameters: 
2022-08-26 18:37:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454173619392512 [0;39m <==    Updates: 8
2022-08-26 18:37:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20454173619392512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:37:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454194582523904 [0;39m 生成今日电子书快照开始
2022-08-26 18:37:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454194582523904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:37:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454194582523904 [0;39m ==> Parameters: 
2022-08-26 18:37:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454194582523904 [0;39m <==    Updates: 0
2022-08-26 18:37:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454194582523904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:37:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454215558238208 [0;39m 生成今日电子书快照开始
2022-08-26 18:37:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454215558238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:37:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454215558238208 [0;39m ==> Parameters: 
2022-08-26 18:37:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454215558238208 [0;39m <==    Updates: 0
2022-08-26 18:37:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454215558238208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:37:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454236500398080 [0;39m 生成今日电子书快照开始
2022-08-26 18:37:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454236500398080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:37:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454236500398080 [0;39m ==> Parameters: 
2022-08-26 18:37:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454236500398080 [0;39m <==    Updates: 0
2022-08-26 18:37:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454236500398080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:37:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454257476112384 [0;39m 生成今日电子书快照开始
2022-08-26 18:37:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454257476112384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:37:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454257476112384 [0;39m ==> Parameters: 
2022-08-26 18:37:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454257476112384 [0;39m <==    Updates: 0
2022-08-26 18:37:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454257476112384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:38:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454278481186816 [0;39m 生成今日电子书快照开始
2022-08-26 18:38:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454278481186816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:38:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454278481186816 [0;39m ==> Parameters: 
2022-08-26 18:38:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454278481186816 [0;39m <==    Updates: 0
2022-08-26 18:38:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454278481186816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:38:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20454299419152384 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:38:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454299419152384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:38:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454299419152384 [0;39m ==> Parameters: 
2022-08-26 18:38:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454299419152384 [0;39m <==    Updates: 8
2022-08-26 18:38:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20454299419152384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:38:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454299427540992 [0;39m 生成今日电子书快照开始
2022-08-26 18:38:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454299427540992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:38:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454299427540992 [0;39m ==> Parameters: 
2022-08-26 18:38:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454299427540992 [0;39m <==    Updates: 0
2022-08-26 18:38:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454299427540992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:38:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454320390672384 [0;39m 生成今日电子书快照开始
2022-08-26 18:38:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454320390672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:38:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454320390672384 [0;39m ==> Parameters: 
2022-08-26 18:38:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454320390672384 [0;39m <==    Updates: 0
2022-08-26 18:38:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454320390672384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:38:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454341378969600 [0;39m 生成今日电子书快照开始
2022-08-26 18:38:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454341378969600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:38:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454341378969600 [0;39m ==> Parameters: 
2022-08-26 18:38:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454341378969600 [0;39m <==    Updates: 0
2022-08-26 18:38:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454341378969600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:38:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454362379849728 [0;39m 生成今日电子书快照开始
2022-08-26 18:38:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454362379849728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:38:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454362379849728 [0;39m ==> Parameters: 
2022-08-26 18:38:20.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454362379849728 [0;39m <==    Updates: 0
2022-08-26 18:38:20.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454362379849728 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:38:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454383305232384 [0;39m 生成今日电子书快照开始
2022-08-26 18:38:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454383305232384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:38:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454383305232384 [0;39m ==> Parameters: 
2022-08-26 18:38:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454383305232384 [0;39m <==    Updates: 0
2022-08-26 18:38:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454383305232384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:38:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454404318695424 [0;39m 生成今日电子书快照开始
2022-08-26 18:38:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454404318695424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:38:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454404318695424 [0;39m ==> Parameters: 
2022-08-26 18:38:30.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454404318695424 [0;39m <==    Updates: 0
2022-08-26 18:38:30.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454404318695424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:38:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454425294409728 [0;39m 生成今日电子书快照开始
2022-08-26 18:38:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454425294409728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:38:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454425294409728 [0;39m ==> Parameters: 
2022-08-26 18:38:35.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454425294409728 [0;39m <==    Updates: 0
2022-08-26 18:38:35.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454425294409728 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:38:35.023 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20454425327964160 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:38:35.024 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454425327964160 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:38:35.024 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454425327964160 [0;39m ==> Parameters: 
2022-08-26 18:38:35.027 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454425327964160 [0;39m <==    Updates: 8
2022-08-26 18:38:35.027 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20454425327964160 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 18:38:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454446240763904 [0;39m 生成今日电子书快照开始
2022-08-26 18:38:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454446240763904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:38:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454446240763904 [0;39m ==> Parameters: 
2022-08-26 18:38:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454446240763904 [0;39m <==    Updates: 0
2022-08-26 18:38:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454446240763904 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:38:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454467187118080 [0;39m 生成今日电子书快照开始
2022-08-26 18:38:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454467187118080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:38:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454467187118080 [0;39m ==> Parameters: 
2022-08-26 18:38:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454467187118080 [0;39m <==    Updates: 0
2022-08-26 18:38:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454467187118080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:38:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454488158638080 [0;39m 生成今日电子书快照开始
2022-08-26 18:38:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454488158638080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:38:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454488158638080 [0;39m ==> Parameters: 
2022-08-26 18:38:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454488158638080 [0;39m <==    Updates: 0
2022-08-26 18:38:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454488158638080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:38:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454509146935296 [0;39m 生成今日电子书快照开始
2022-08-26 18:38:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454509146935296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:38:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454509146935296 [0;39m ==> Parameters: 
2022-08-26 18:38:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454509146935296 [0;39m <==    Updates: 0
2022-08-26 18:38:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454509146935296 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:39:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454530114260992 [0;39m 生成今日电子书快照开始
2022-08-26 18:39:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454530114260992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:39:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454530114260992 [0;39m ==> Parameters: 
2022-08-26 18:39:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454530114260992 [0;39m <==    Updates: 0
2022-08-26 18:39:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454530114260992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:39:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20454551089975296 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:39:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454551089975296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:39:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454551089975296 [0;39m ==> Parameters: 
2022-08-26 18:39:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454551089975296 [0;39m <==    Updates: 8
2022-08-26 18:39:05.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20454551089975296 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 18:39:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454551102558208 [0;39m 生成今日电子书快照开始
2022-08-26 18:39:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454551102558208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:39:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454551102558208 [0;39m ==> Parameters: 
2022-08-26 18:39:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454551102558208 [0;39m <==    Updates: 0
2022-08-26 18:39:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454551102558208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:39:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454572090855424 [0;39m 生成今日电子书快照开始
2022-08-26 18:39:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454572090855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:39:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454572090855424 [0;39m ==> Parameters: 
2022-08-26 18:39:10.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454572090855424 [0;39m <==    Updates: 0
2022-08-26 18:39:10.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454572090855424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:39:15.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454593003655168 [0;39m 生成今日电子书快照开始
2022-08-26 18:39:15.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454593003655168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:39:15.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454593003655168 [0;39m ==> Parameters: 
2022-08-26 18:39:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454593003655168 [0;39m <==    Updates: 0
2022-08-26 18:39:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454593003655168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:39:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454613991952384 [0;39m 生成今日电子书快照开始
2022-08-26 18:39:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454613991952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:39:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454613991952384 [0;39m ==> Parameters: 
2022-08-26 18:39:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454613991952384 [0;39m <==    Updates: 0
2022-08-26 18:39:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454613991952384 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:39:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454634988638208 [0;39m 生成今日电子书快照开始
2022-08-26 18:39:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454634988638208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:39:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454634988638208 [0;39m ==> Parameters: 
2022-08-26 18:39:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454634988638208 [0;39m <==    Updates: 0
2022-08-26 18:39:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454634988638208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:39:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454655922409472 [0;39m 生成今日电子书快照开始
2022-08-26 18:39:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454655922409472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:39:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454655922409472 [0;39m ==> Parameters: 
2022-08-26 18:39:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454655922409472 [0;39m <==    Updates: 0
2022-08-26 18:39:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454655922409472 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:39:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454676902318080 [0;39m 生成今日电子书快照开始
2022-08-26 18:39:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454676902318080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:39:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454676902318080 [0;39m ==> Parameters: 
2022-08-26 18:39:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454676902318080 [0;39m <==    Updates: 0
2022-08-26 18:39:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454676902318080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:39:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20454676910706688 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:39:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454676910706688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:39:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454676910706688 [0;39m ==> Parameters: 
2022-08-26 18:39:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454676910706688 [0;39m <==    Updates: 8
2022-08-26 18:39:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20454676910706688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:39:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454697865449472 [0;39m 生成今日电子书快照开始
2022-08-26 18:39:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454697865449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:39:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454697865449472 [0;39m ==> Parameters: 
2022-08-26 18:39:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454697865449472 [0;39m <==    Updates: 0
2022-08-26 18:39:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454697865449472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:39:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454718849552384 [0;39m 生成今日电子书快照开始
2022-08-26 18:39:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454718849552384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:39:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454718849552384 [0;39m ==> Parameters: 
2022-08-26 18:39:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454718849552384 [0;39m <==    Updates: 0
2022-08-26 18:39:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454718849552384 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:39:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454739854626816 [0;39m 生成今日电子书快照开始
2022-08-26 18:39:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454739854626816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:39:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454739854626816 [0;39m ==> Parameters: 
2022-08-26 18:39:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454739854626816 [0;39m <==    Updates: 0
2022-08-26 18:39:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454739854626816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:39:55.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454760780009472 [0;39m 生成今日电子书快照开始
2022-08-26 18:39:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454760780009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:39:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454760780009472 [0;39m ==> Parameters: 
2022-08-26 18:39:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454760780009472 [0;39m <==    Updates: 0
2022-08-26 18:39:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454760780009472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:40:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454781776695296 [0;39m 生成今日电子书快照开始
2022-08-26 18:40:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454781776695296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:40:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454781776695296 [0;39m ==> Parameters: 
2022-08-26 18:40:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454781776695296 [0;39m <==    Updates: 0
2022-08-26 18:40:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454781776695296 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 18:40:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20454802764992512 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:40:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454802764992512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:40:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454802764992512 [0;39m ==> Parameters: 
2022-08-26 18:40:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454802764992512 [0;39m <==    Updates: 8
2022-08-26 18:40:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20454802764992512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:40:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454802773381120 [0;39m 生成今日电子书快照开始
2022-08-26 18:40:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454802773381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:40:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454802773381120 [0;39m ==> Parameters: 
2022-08-26 18:40:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454802773381120 [0;39m <==    Updates: 0
2022-08-26 18:40:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454802773381120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:40:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454823723929600 [0;39m 生成今日电子书快照开始
2022-08-26 18:40:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454823723929600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:40:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454823723929600 [0;39m ==> Parameters: 
2022-08-26 18:40:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454823723929600 [0;39m <==    Updates: 0
2022-08-26 18:40:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454823723929600 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:40:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454844674478080 [0;39m 生成今日电子书快照开始
2022-08-26 18:40:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454844674478080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:40:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454844674478080 [0;39m ==> Parameters: 
2022-08-26 18:40:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454844674478080 [0;39m <==    Updates: 0
2022-08-26 18:40:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454844674478080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:40:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454865683746816 [0;39m 生成今日电子书快照开始
2022-08-26 18:40:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454865683746816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:40:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454865683746816 [0;39m ==> Parameters: 
2022-08-26 18:40:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454865683746816 [0;39m <==    Updates: 0
2022-08-26 18:40:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454865683746816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:40:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454886646878208 [0;39m 生成今日电子书快照开始
2022-08-26 18:40:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454886646878208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:40:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454886646878208 [0;39m ==> Parameters: 
2022-08-26 18:40:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454886646878208 [0;39m <==    Updates: 0
2022-08-26 18:40:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454886646878208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:40:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454907622592512 [0;39m 生成今日电子书快照开始
2022-08-26 18:40:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454907622592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:40:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454907622592512 [0;39m ==> Parameters: 
2022-08-26 18:40:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454907622592512 [0;39m <==    Updates: 0
2022-08-26 18:40:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454907622592512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:40:35.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20454928585723904 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:40:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454928585723904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:40:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454928585723904 [0;39m ==> Parameters: 
2022-08-26 18:40:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20454928585723904 [0;39m <==    Updates: 8
2022-08-26 18:40:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20454928585723904 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 18:40:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454928598306816 [0;39m 生成今日电子书快照开始
2022-08-26 18:40:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454928598306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:40:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454928598306816 [0;39m ==> Parameters: 
2022-08-26 18:40:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454928598306816 [0;39m <==    Updates: 0
2022-08-26 18:40:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454928598306816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:40:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454949582409728 [0;39m 生成今日电子书快照开始
2022-08-26 18:40:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454949582409728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:40:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454949582409728 [0;39m ==> Parameters: 
2022-08-26 18:40:40.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454949582409728 [0;39m <==    Updates: 0
2022-08-26 18:40:40.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454949582409728 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:40:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454970537152512 [0;39m 生成今日电子书快照开始
2022-08-26 18:40:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454970537152512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:40:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454970537152512 [0;39m ==> Parameters: 
2022-08-26 18:40:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454970537152512 [0;39m <==    Updates: 0
2022-08-26 18:40:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454970537152512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:40:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20454991500283904 [0;39m 生成今日电子书快照开始
2022-08-26 18:40:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454991500283904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:40:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454991500283904 [0;39m ==> Parameters: 
2022-08-26 18:40:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20454991500283904 [0;39m <==    Updates: 0
2022-08-26 18:40:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20454991500283904 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:40:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455012492775424 [0;39m 生成今日电子书快照开始
2022-08-26 18:40:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455012492775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:40:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455012492775424 [0;39m ==> Parameters: 
2022-08-26 18:40:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455012492775424 [0;39m <==    Updates: 0
2022-08-26 18:40:55.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455012492775424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:41:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455033451712512 [0;39m 生成今日电子书快照开始
2022-08-26 18:41:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455033451712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:41:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455033451712512 [0;39m ==> Parameters: 
2022-08-26 18:41:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455033451712512 [0;39m <==    Updates: 0
2022-08-26 18:41:00.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455033451712512 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:41:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20455054427426816 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:41:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455054427426816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:41:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455054427426816 [0;39m ==> Parameters: 
2022-08-26 18:41:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455054427426816 [0;39m <==    Updates: 8
2022-08-26 18:41:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20455054427426816 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 18:41:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455054452592640 [0;39m 生成今日电子书快照开始
2022-08-26 18:41:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455054452592640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:41:05.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455054452592640 [0;39m ==> Parameters: 
2022-08-26 18:41:05.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455054452592640 [0;39m <==    Updates: 0
2022-08-26 18:41:05.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455054452592640 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:41:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455075403141120 [0;39m 生成今日电子书快照开始
2022-08-26 18:41:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455075403141120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:41:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455075403141120 [0;39m ==> Parameters: 
2022-08-26 18:41:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455075403141120 [0;39m <==    Updates: 0
2022-08-26 18:41:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455075403141120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:41:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455096345300992 [0;39m 生成今日电子书快照开始
2022-08-26 18:41:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455096345300992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:41:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455096345300992 [0;39m ==> Parameters: 
2022-08-26 18:41:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455096345300992 [0;39m <==    Updates: 0
2022-08-26 18:41:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455096345300992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:41:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455117312626688 [0;39m 生成今日电子书快照开始
2022-08-26 18:41:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455117312626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:41:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455117312626688 [0;39m ==> Parameters: 
2022-08-26 18:41:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455117312626688 [0;39m <==    Updates: 0
2022-08-26 18:41:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455117312626688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:41:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455138321895424 [0;39m 生成今日电子书快照开始
2022-08-26 18:41:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455138321895424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:41:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455138321895424 [0;39m ==> Parameters: 
2022-08-26 18:41:25.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455138321895424 [0;39m <==    Updates: 0
2022-08-26 18:41:25.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455138321895424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:41:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455159238889472 [0;39m 生成今日电子书快照开始
2022-08-26 18:41:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455159238889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:41:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455159238889472 [0;39m ==> Parameters: 
2022-08-26 18:41:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455159238889472 [0;39m <==    Updates: 0
2022-08-26 18:41:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455159238889472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:41:35.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20455180210409472 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:41:35.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455180210409472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:41:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455180210409472 [0;39m ==> Parameters: 
2022-08-26 18:41:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455180210409472 [0;39m <==    Updates: 8
2022-08-26 18:41:35.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20455180210409472 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:41:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455180218798080 [0;39m 生成今日电子书快照开始
2022-08-26 18:41:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455180218798080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:41:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455180218798080 [0;39m ==> Parameters: 
2022-08-26 18:41:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455180218798080 [0;39m <==    Updates: 0
2022-08-26 18:41:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455180218798080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:41:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455201186123776 [0;39m 生成今日电子书快照开始
2022-08-26 18:41:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455201186123776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:41:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455201186123776 [0;39m ==> Parameters: 
2022-08-26 18:41:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455201186123776 [0;39m <==    Updates: 0
2022-08-26 18:41:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455201186123776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:41:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455222195392512 [0;39m 生成今日电子书快照开始
2022-08-26 18:41:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455222195392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:41:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455222195392512 [0;39m ==> Parameters: 
2022-08-26 18:41:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455222195392512 [0;39m <==    Updates: 0
2022-08-26 18:41:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455222195392512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:41:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455243133358080 [0;39m 生成今日电子书快照开始
2022-08-26 18:41:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455243133358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:41:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455243133358080 [0;39m ==> Parameters: 
2022-08-26 18:41:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455243133358080 [0;39m <==    Updates: 0
2022-08-26 18:41:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455243133358080 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:41:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455264138432512 [0;39m 生成今日电子书快照开始
2022-08-26 18:41:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455264138432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:41:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455264138432512 [0;39m ==> Parameters: 
2022-08-26 18:41:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455264138432512 [0;39m <==    Updates: 0
2022-08-26 18:41:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455264138432512 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:42:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455285101563904 [0;39m 生成今日电子书快照开始
2022-08-26 18:42:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455285101563904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:42:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455285101563904 [0;39m ==> Parameters: 
2022-08-26 18:42:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455285101563904 [0;39m <==    Updates: 0
2022-08-26 18:42:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455285101563904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:42:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20455306089861120 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:42:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455306089861120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:42:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455306089861120 [0;39m ==> Parameters: 
2022-08-26 18:42:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455306089861120 [0;39m <==    Updates: 8
2022-08-26 18:42:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20455306089861120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:42:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455306094055424 [0;39m 生成今日电子书快照开始
2022-08-26 18:42:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455306094055424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:42:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455306094055424 [0;39m ==> Parameters: 
2022-08-26 18:42:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455306094055424 [0;39m <==    Updates: 0
2022-08-26 18:42:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455306094055424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:42:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455327036215296 [0;39m 生成今日电子书快照开始
2022-08-26 18:42:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455327036215296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:42:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455327036215296 [0;39m ==> Parameters: 
2022-08-26 18:42:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455327036215296 [0;39m <==    Updates: 0
2022-08-26 18:42:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455327036215296 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:42:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455348003540992 [0;39m 生成今日电子书快照开始
2022-08-26 18:42:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455348003540992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:42:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455348003540992 [0;39m ==> Parameters: 
2022-08-26 18:42:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455348003540992 [0;39m <==    Updates: 0
2022-08-26 18:42:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455348003540992 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:42:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455369012809728 [0;39m 生成今日电子书快照开始
2022-08-26 18:42:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455369012809728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:42:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455369012809728 [0;39m ==> Parameters: 
2022-08-26 18:42:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455369012809728 [0;39m <==    Updates: 0
2022-08-26 18:42:20.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455369012809728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:42:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455389938192384 [0;39m 生成今日电子书快照开始
2022-08-26 18:42:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455389938192384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:42:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455389938192384 [0;39m ==> Parameters: 
2022-08-26 18:42:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455389938192384 [0;39m <==    Updates: 0
2022-08-26 18:42:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455389938192384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:42:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455410905518080 [0;39m 生成今日电子书快照开始
2022-08-26 18:42:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455410905518080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:42:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455410905518080 [0;39m ==> Parameters: 
2022-08-26 18:42:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455410905518080 [0;39m <==    Updates: 0
2022-08-26 18:42:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455410905518080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:42:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455431872843776 [0;39m 生成今日电子书快照开始
2022-08-26 18:42:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455431872843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:42:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455431872843776 [0;39m ==> Parameters: 
2022-08-26 18:42:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455431872843776 [0;39m <==    Updates: 0
2022-08-26 18:42:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455431872843776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:42:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20455431881232384 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:42:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455431881232384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:42:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455431881232384 [0;39m ==> Parameters: 
2022-08-26 18:42:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455431881232384 [0;39m <==    Updates: 8
2022-08-26 18:42:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20455431881232384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:42:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455452848558080 [0;39m 生成今日电子书快照开始
2022-08-26 18:42:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455452848558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:42:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455452848558080 [0;39m ==> Parameters: 
2022-08-26 18:42:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455452848558080 [0;39m <==    Updates: 0
2022-08-26 18:42:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455452848558080 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:42:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455473815883776 [0;39m 生成今日电子书快照开始
2022-08-26 18:42:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455473815883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:42:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455473815883776 [0;39m ==> Parameters: 
2022-08-26 18:42:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455473815883776 [0;39m <==    Updates: 0
2022-08-26 18:42:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455473815883776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:42:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455494825152512 [0;39m 生成今日电子书快照开始
2022-08-26 18:42:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455494825152512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:42:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455494825152512 [0;39m ==> Parameters: 
2022-08-26 18:42:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455494825152512 [0;39m <==    Updates: 0
2022-08-26 18:42:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455494825152512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:42:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455515817644032 [0;39m 生成今日电子书快照开始
2022-08-26 18:42:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455515817644032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:42:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455515817644032 [0;39m ==> Parameters: 
2022-08-26 18:42:55.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455515817644032 [0;39m <==    Updates: 0
2022-08-26 18:42:55.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455515817644032 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:43:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455536738832384 [0;39m 生成今日电子书快照开始
2022-08-26 18:43:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455536738832384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:43:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455536738832384 [0;39m ==> Parameters: 
2022-08-26 18:43:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455536738832384 [0;39m <==    Updates: 0
2022-08-26 18:43:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455536738832384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:43:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455557748101120 [0;39m 生成今日电子书快照开始
2022-08-26 18:43:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455557748101120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:43:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455557748101120 [0;39m ==> Parameters: 
2022-08-26 18:43:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455557748101120 [0;39m <==    Updates: 0
2022-08-26 18:43:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455557748101120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:43:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20455557756489728 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:43:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455557756489728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:43:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455557756489728 [0;39m ==> Parameters: 
2022-08-26 18:43:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455557756489728 [0;39m <==    Updates: 8
2022-08-26 18:43:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20455557756489728 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:43:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455578707038208 [0;39m 生成今日电子书快照开始
2022-08-26 18:43:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455578707038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:43:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455578707038208 [0;39m ==> Parameters: 
2022-08-26 18:43:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455578707038208 [0;39m <==    Updates: 0
2022-08-26 18:43:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455578707038208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:43:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455599640809472 [0;39m 生成今日电子书快照开始
2022-08-26 18:43:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455599640809472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:43:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455599640809472 [0;39m ==> Parameters: 
2022-08-26 18:43:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455599640809472 [0;39m <==    Updates: 0
2022-08-26 18:43:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455599640809472 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:43:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455620650078208 [0;39m 生成今日电子书快照开始
2022-08-26 18:43:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455620650078208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:43:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455620650078208 [0;39m ==> Parameters: 
2022-08-26 18:43:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455620650078208 [0;39m <==    Updates: 0
2022-08-26 18:43:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455620650078208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:43:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455641604820992 [0;39m 生成今日电子书快照开始
2022-08-26 18:43:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455641604820992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:43:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455641604820992 [0;39m ==> Parameters: 
2022-08-26 18:43:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455641604820992 [0;39m <==    Updates: 0
2022-08-26 18:43:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455641604820992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:43:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455662572146688 [0;39m 生成今日电子书快照开始
2022-08-26 18:43:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455662572146688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:43:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455662572146688 [0;39m ==> Parameters: 
2022-08-26 18:43:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455662572146688 [0;39m <==    Updates: 0
2022-08-26 18:43:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455662572146688 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:43:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20455683581415424 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:43:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455683581415424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:43:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455683581415424 [0;39m ==> Parameters: 
2022-08-26 18:43:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455683581415424 [0;39m <==    Updates: 8
2022-08-26 18:43:35.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20455683581415424 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 18:43:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455683602386944 [0;39m 生成今日电子书快照开始
2022-08-26 18:43:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455683602386944 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:43:35.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455683602386944 [0;39m ==> Parameters: 
2022-08-26 18:43:35.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455683602386944 [0;39m <==    Updates: 0
2022-08-26 18:43:35.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455683602386944 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:43:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455704506798080 [0;39m 生成今日电子书快照开始
2022-08-26 18:43:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455704506798080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:43:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455704506798080 [0;39m ==> Parameters: 
2022-08-26 18:43:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455704506798080 [0;39m <==    Updates: 0
2022-08-26 18:43:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455704506798080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:43:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455725478318080 [0;39m 生成今日电子书快照开始
2022-08-26 18:43:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455725478318080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:43:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455725478318080 [0;39m ==> Parameters: 
2022-08-26 18:43:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455725478318080 [0;39m <==    Updates: 0
2022-08-26 18:43:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455725478318080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:43:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455746500169728 [0;39m 生成今日电子书快照开始
2022-08-26 18:43:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455746500169728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:43:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455746500169728 [0;39m ==> Parameters: 
2022-08-26 18:43:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455746500169728 [0;39m <==    Updates: 0
2022-08-26 18:43:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455746500169728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:43:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455767438135296 [0;39m 生成今日电子书快照开始
2022-08-26 18:43:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455767438135296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:43:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455767438135296 [0;39m ==> Parameters: 
2022-08-26 18:43:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455767438135296 [0;39m <==    Updates: 0
2022-08-26 18:43:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455767438135296 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:44:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455788397072384 [0;39m 生成今日电子书快照开始
2022-08-26 18:44:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455788397072384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:44:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455788397072384 [0;39m ==> Parameters: 
2022-08-26 18:44:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455788397072384 [0;39m <==    Updates: 0
2022-08-26 18:44:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455788397072384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:44:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455809406341120 [0;39m 生成今日电子书快照开始
2022-08-26 18:44:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455809406341120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:44:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455809406341120 [0;39m ==> Parameters: 
2022-08-26 18:44:05.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455809406341120 [0;39m <==    Updates: 0
2022-08-26 18:44:05.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455809406341120 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:44:05.022 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20455809444089856 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:44:05.022 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455809444089856 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:44:05.023 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455809444089856 [0;39m ==> Parameters: 
2022-08-26 18:44:05.025 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455809444089856 [0;39m <==    Updates: 8
2022-08-26 18:44:05.026 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20455809444089856 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 18:44:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455830348500992 [0;39m 生成今日电子书快照开始
2022-08-26 18:44:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455830348500992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:44:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455830348500992 [0;39m ==> Parameters: 
2022-08-26 18:44:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455830348500992 [0;39m <==    Updates: 0
2022-08-26 18:44:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455830348500992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:44:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455851315826688 [0;39m 生成今日电子书快照开始
2022-08-26 18:44:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455851315826688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:44:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455851315826688 [0;39m ==> Parameters: 
2022-08-26 18:44:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455851315826688 [0;39m <==    Updates: 0
2022-08-26 18:44:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455851315826688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:44:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455872283152384 [0;39m 生成今日电子书快照开始
2022-08-26 18:44:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455872283152384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:44:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455872283152384 [0;39m ==> Parameters: 
2022-08-26 18:44:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455872283152384 [0;39m <==    Updates: 0
2022-08-26 18:44:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455872283152384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:44:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455893254672384 [0;39m 生成今日电子书快照开始
2022-08-26 18:44:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455893254672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:44:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455893254672384 [0;39m ==> Parameters: 
2022-08-26 18:44:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455893254672384 [0;39m <==    Updates: 0
2022-08-26 18:44:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455893254672384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:44:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455914226192384 [0;39m 生成今日电子书快照开始
2022-08-26 18:44:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455914226192384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:44:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455914226192384 [0;39m ==> Parameters: 
2022-08-26 18:44:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455914226192384 [0;39m <==    Updates: 0
2022-08-26 18:44:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455914226192384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:44:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455935235461120 [0;39m 生成今日电子书快照开始
2022-08-26 18:44:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455935235461120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:44:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455935235461120 [0;39m ==> Parameters: 
2022-08-26 18:44:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455935235461120 [0;39m <==    Updates: 0
2022-08-26 18:44:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455935235461120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:44:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20455935256432640 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:44:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455935256432640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:44:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455935256432640 [0;39m ==> Parameters: 
2022-08-26 18:44:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20455935256432640 [0;39m <==    Updates: 8
2022-08-26 18:44:35.020 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20455935256432640 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:44:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455956156649472 [0;39m 生成今日电子书快照开始
2022-08-26 18:44:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455956156649472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:44:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455956156649472 [0;39m ==> Parameters: 
2022-08-26 18:44:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455956156649472 [0;39m <==    Updates: 0
2022-08-26 18:44:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455956156649472 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:44:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455977161723904 [0;39m 生成今日电子书快照开始
2022-08-26 18:44:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455977161723904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:44:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455977161723904 [0;39m ==> Parameters: 
2022-08-26 18:44:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455977161723904 [0;39m <==    Updates: 0
2022-08-26 18:44:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455977161723904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:44:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20455998141632512 [0;39m 生成今日电子书快照开始
2022-08-26 18:44:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455998141632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:44:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455998141632512 [0;39m ==> Parameters: 
2022-08-26 18:44:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20455998141632512 [0;39m <==    Updates: 0
2022-08-26 18:44:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20455998141632512 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:44:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456019134124032 [0;39m 生成今日电子书快照开始
2022-08-26 18:44:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456019134124032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:44:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456019134124032 [0;39m ==> Parameters: 
2022-08-26 18:44:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456019134124032 [0;39m <==    Updates: 0
2022-08-26 18:44:55.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456019134124032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:45:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456040097255424 [0;39m 生成今日电子书快照开始
2022-08-26 18:45:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456040097255424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:45:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456040097255424 [0;39m ==> Parameters: 
2022-08-26 18:45:00.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456040097255424 [0;39m <==    Updates: 0
2022-08-26 18:45:00.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456040097255424 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 18:45:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20456061043609600 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:45:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456061043609600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:45:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456061043609600 [0;39m ==> Parameters: 
2022-08-26 18:45:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456061043609600 [0;39m <==    Updates: 8
2022-08-26 18:45:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20456061043609600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:45:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456061047803904 [0;39m 生成今日电子书快照开始
2022-08-26 18:45:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456061047803904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:45:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456061047803904 [0;39m ==> Parameters: 
2022-08-26 18:45:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456061047803904 [0;39m <==    Updates: 0
2022-08-26 18:45:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456061047803904 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:45:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456082036101120 [0;39m 生成今日电子书快照开始
2022-08-26 18:45:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456082036101120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:45:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456082036101120 [0;39m ==> Parameters: 
2022-08-26 18:45:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456082036101120 [0;39m <==    Updates: 0
2022-08-26 18:45:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456082036101120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:45:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456103011815424 [0;39m 生成今日电子书快照开始
2022-08-26 18:45:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456103011815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:45:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456103011815424 [0;39m ==> Parameters: 
2022-08-26 18:45:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456103011815424 [0;39m <==    Updates: 0
2022-08-26 18:45:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456103011815424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:45:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456123937198080 [0;39m 生成今日电子书快照开始
2022-08-26 18:45:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456123937198080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:45:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456123937198080 [0;39m ==> Parameters: 
2022-08-26 18:45:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456123937198080 [0;39m <==    Updates: 0
2022-08-26 18:45:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456123937198080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:45:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456144963244032 [0;39m 生成今日电子书快照开始
2022-08-26 18:45:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456144963244032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:45:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456144963244032 [0;39m ==> Parameters: 
2022-08-26 18:45:25.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456144963244032 [0;39m <==    Updates: 0
2022-08-26 18:45:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456144963244032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:45:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456165913792512 [0;39m 生成今日电子书快照开始
2022-08-26 18:45:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456165913792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:45:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456165913792512 [0;39m ==> Parameters: 
2022-08-26 18:45:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456165913792512 [0;39m <==    Updates: 0
2022-08-26 18:45:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456165913792512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:45:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456186868535296 [0;39m 生成今日电子书快照开始
2022-08-26 18:45:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456186868535296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:45:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456186868535296 [0;39m ==> Parameters: 
2022-08-26 18:45:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456186868535296 [0;39m <==    Updates: 0
2022-08-26 18:45:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456186868535296 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:45:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20456186893701120 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:45:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456186893701120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:45:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456186893701120 [0;39m ==> Parameters: 
2022-08-26 18:45:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456186893701120 [0;39m <==    Updates: 8
2022-08-26 18:45:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20456186893701120 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 18:45:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456207831666688 [0;39m 生成今日电子书快照开始
2022-08-26 18:45:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456207831666688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:45:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456207831666688 [0;39m ==> Parameters: 
2022-08-26 18:45:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456207831666688 [0;39m <==    Updates: 0
2022-08-26 18:45:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456207831666688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:45:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456228790603776 [0;39m 生成今日电子书快照开始
2022-08-26 18:45:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456228790603776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:45:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456228790603776 [0;39m ==> Parameters: 
2022-08-26 18:45:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456228790603776 [0;39m <==    Updates: 0
2022-08-26 18:45:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456228790603776 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:45:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456249804066816 [0;39m 生成今日电子书快照开始
2022-08-26 18:45:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456249804066816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:45:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456249804066816 [0;39m ==> Parameters: 
2022-08-26 18:45:50.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456249804066816 [0;39m <==    Updates: 0
2022-08-26 18:45:50.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456249804066816 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:45:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456270750420992 [0;39m 生成今日电子书快照开始
2022-08-26 18:45:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456270750420992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:45:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456270750420992 [0;39m ==> Parameters: 
2022-08-26 18:45:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456270750420992 [0;39m <==    Updates: 0
2022-08-26 18:45:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456270750420992 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:46:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456291721940992 [0;39m 生成今日电子书快照开始
2022-08-26 18:46:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456291721940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:46:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456291721940992 [0;39m ==> Parameters: 
2022-08-26 18:46:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456291721940992 [0;39m <==    Updates: 0
2022-08-26 18:46:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456291721940992 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:46:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20456312710238208 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:46:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456312710238208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:46:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456312710238208 [0;39m ==> Parameters: 
2022-08-26 18:46:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456312710238208 [0;39m <==    Updates: 8
2022-08-26 18:46:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20456312710238208 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 18:46:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456312731209728 [0;39m 生成今日电子书快照开始
2022-08-26 18:46:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456312731209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:46:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456312731209728 [0;39m ==> Parameters: 
2022-08-26 18:46:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456312731209728 [0;39m <==    Updates: 0
2022-08-26 18:46:05.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456312731209728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:46:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456333685952512 [0;39m 生成今日电子书快照开始
2022-08-26 18:46:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456333685952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:46:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456333685952512 [0;39m ==> Parameters: 
2022-08-26 18:46:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456333685952512 [0;39m <==    Updates: 0
2022-08-26 18:46:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456333685952512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:46:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456354632306688 [0;39m 生成今日电子书快照开始
2022-08-26 18:46:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456354632306688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:46:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456354632306688 [0;39m ==> Parameters: 
2022-08-26 18:46:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456354632306688 [0;39m <==    Updates: 0
2022-08-26 18:46:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456354632306688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:46:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456375599632384 [0;39m 生成今日电子书快照开始
2022-08-26 18:46:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456375599632384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:46:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456375599632384 [0;39m ==> Parameters: 
2022-08-26 18:46:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456375599632384 [0;39m <==    Updates: 0
2022-08-26 18:46:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456375599632384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:46:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456396575346688 [0;39m 生成今日电子书快照开始
2022-08-26 18:46:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456396575346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:46:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456396575346688 [0;39m ==> Parameters: 
2022-08-26 18:46:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456396575346688 [0;39m <==    Updates: 0
2022-08-26 18:46:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456396575346688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:46:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456417534283776 [0;39m 生成今日电子书快照开始
2022-08-26 18:46:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456417534283776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:46:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456417534283776 [0;39m ==> Parameters: 
2022-08-26 18:46:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456417534283776 [0;39m <==    Updates: 0
2022-08-26 18:46:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456417534283776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:46:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20456438518386688 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:46:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456438518386688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:46:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456438518386688 [0;39m ==> Parameters: 
2022-08-26 18:46:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456438518386688 [0;39m <==    Updates: 8
2022-08-26 18:46:35.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20456438518386688 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 18:46:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456438539358208 [0;39m 生成今日电子书快照开始
2022-08-26 18:46:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456438539358208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:46:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456438539358208 [0;39m ==> Parameters: 
2022-08-26 18:46:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456438539358208 [0;39m <==    Updates: 0
2022-08-26 18:46:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456438539358208 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:46:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456459527655424 [0;39m 生成今日电子书快照开始
2022-08-26 18:46:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456459527655424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:46:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456459527655424 [0;39m ==> Parameters: 
2022-08-26 18:46:40.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456459527655424 [0;39m <==    Updates: 0
2022-08-26 18:46:40.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456459527655424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:46:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456480444649472 [0;39m 生成今日电子书快照开始
2022-08-26 18:46:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456480444649472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:46:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456480444649472 [0;39m ==> Parameters: 
2022-08-26 18:46:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456480444649472 [0;39m <==    Updates: 0
2022-08-26 18:46:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456480444649472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:46:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456501437140992 [0;39m 生成今日电子书快照开始
2022-08-26 18:46:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456501437140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:46:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456501437140992 [0;39m ==> Parameters: 
2022-08-26 18:46:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456501437140992 [0;39m <==    Updates: 0
2022-08-26 18:46:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456501437140992 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:46:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456522396078080 [0;39m 生成今日电子书快照开始
2022-08-26 18:46:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456522396078080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:46:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456522396078080 [0;39m ==> Parameters: 
2022-08-26 18:46:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456522396078080 [0;39m <==    Updates: 0
2022-08-26 18:46:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456522396078080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:47:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456543375986688 [0;39m 生成今日电子书快照开始
2022-08-26 18:47:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456543375986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:47:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456543375986688 [0;39m ==> Parameters: 
2022-08-26 18:47:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456543375986688 [0;39m <==    Updates: 0
2022-08-26 18:47:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456543375986688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:47:05.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456564334923776 [0;39m 生成今日电子书快照开始
2022-08-26 18:47:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456564334923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:47:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456564334923776 [0;39m ==> Parameters: 
2022-08-26 18:47:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456564334923776 [0;39m <==    Updates: 0
2022-08-26 18:47:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456564334923776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:47:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20456564343312384 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:47:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456564343312384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:47:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456564343312384 [0;39m ==> Parameters: 
2022-08-26 18:47:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456564343312384 [0;39m <==    Updates: 8
2022-08-26 18:47:05.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20456564343312384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:47:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456585323220992 [0;39m 生成今日电子书快照开始
2022-08-26 18:47:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456585323220992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:47:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456585323220992 [0;39m ==> Parameters: 
2022-08-26 18:47:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456585323220992 [0;39m <==    Updates: 0
2022-08-26 18:47:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456585323220992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:47:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456606328295424 [0;39m 生成今日电子书快照开始
2022-08-26 18:47:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456606328295424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:47:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456606328295424 [0;39m ==> Parameters: 
2022-08-26 18:47:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456606328295424 [0;39m <==    Updates: 0
2022-08-26 18:47:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456606328295424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:47:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456627249483776 [0;39m 生成今日电子书快照开始
2022-08-26 18:47:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456627249483776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:47:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456627249483776 [0;39m ==> Parameters: 
2022-08-26 18:47:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456627249483776 [0;39m <==    Updates: 0
2022-08-26 18:47:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456627249483776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:47:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456648246169600 [0;39m 生成今日电子书快照开始
2022-08-26 18:47:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456648246169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:47:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456648246169600 [0;39m ==> Parameters: 
2022-08-26 18:47:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456648246169600 [0;39m <==    Updates: 0
2022-08-26 18:47:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456648246169600 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:47:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456669251244032 [0;39m 生成今日电子书快照开始
2022-08-26 18:47:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456669251244032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:47:30.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456669251244032 [0;39m ==> Parameters: 
2022-08-26 18:47:30.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456669251244032 [0;39m <==    Updates: 0
2022-08-26 18:47:30.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456669251244032 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:47:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456690193403904 [0;39m 生成今日电子书快照开始
2022-08-26 18:47:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456690193403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:47:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456690193403904 [0;39m ==> Parameters: 
2022-08-26 18:47:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456690193403904 [0;39m <==    Updates: 0
2022-08-26 18:47:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456690193403904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:47:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20456690222764032 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:47:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456690222764032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:47:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456690222764032 [0;39m ==> Parameters: 
2022-08-26 18:47:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456690222764032 [0;39m <==    Updates: 8
2022-08-26 18:47:35.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20456690222764032 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 18:47:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456711177506816 [0;39m 生成今日电子书快照开始
2022-08-26 18:47:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456711177506816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:47:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456711177506816 [0;39m ==> Parameters: 
2022-08-26 18:47:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456711177506816 [0;39m <==    Updates: 0
2022-08-26 18:47:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456711177506816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:47:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456732144832512 [0;39m 生成今日电子书快照开始
2022-08-26 18:47:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456732144832512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:47:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456732144832512 [0;39m ==> Parameters: 
2022-08-26 18:47:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456732144832512 [0;39m <==    Updates: 0
2022-08-26 18:47:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456732144832512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:47:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456753124741120 [0;39m 生成今日电子书快照开始
2022-08-26 18:47:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456753124741120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:47:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456753124741120 [0;39m ==> Parameters: 
2022-08-26 18:47:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456753124741120 [0;39m <==    Updates: 0
2022-08-26 18:47:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456753124741120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:47:55.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456774041735168 [0;39m 生成今日电子书快照开始
2022-08-26 18:47:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456774041735168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:47:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456774041735168 [0;39m ==> Parameters: 
2022-08-26 18:47:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456774041735168 [0;39m <==    Updates: 0
2022-08-26 18:47:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456774041735168 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:48:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456795067781120 [0;39m 生成今日电子书快照开始
2022-08-26 18:48:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456795067781120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:48:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456795067781120 [0;39m ==> Parameters: 
2022-08-26 18:48:00.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456795067781120 [0;39m <==    Updates: 0
2022-08-26 18:48:00.024 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456795067781120 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-26 18:48:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456816035106816 [0;39m 生成今日电子书快照开始
2022-08-26 18:48:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456816035106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:48:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456816035106816 [0;39m ==> Parameters: 
2022-08-26 18:48:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456816035106816 [0;39m <==    Updates: 0
2022-08-26 18:48:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456816035106816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:48:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20456816043495424 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:48:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456816043495424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:48:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456816043495424 [0;39m ==> Parameters: 
2022-08-26 18:48:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456816043495424 [0;39m <==    Updates: 8
2022-08-26 18:48:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20456816043495424 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:48:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456836994043904 [0;39m 生成今日电子书快照开始
2022-08-26 18:48:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456836994043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:48:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456836994043904 [0;39m ==> Parameters: 
2022-08-26 18:48:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456836994043904 [0;39m <==    Updates: 0
2022-08-26 18:48:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456836994043904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:48:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456857978146816 [0;39m 生成今日电子书快照开始
2022-08-26 18:48:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456857978146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:48:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456857978146816 [0;39m ==> Parameters: 
2022-08-26 18:48:15.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456857978146816 [0;39m <==    Updates: 0
2022-08-26 18:48:15.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456857978146816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:48:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456878911918080 [0;39m 生成今日电子书快照开始
2022-08-26 18:48:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456878911918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:48:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456878911918080 [0;39m ==> Parameters: 
2022-08-26 18:48:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456878911918080 [0;39m <==    Updates: 0
2022-08-26 18:48:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456878911918080 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:48:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456899896020992 [0;39m 生成今日电子书快照开始
2022-08-26 18:48:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456899896020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:48:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456899896020992 [0;39m ==> Parameters: 
2022-08-26 18:48:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456899896020992 [0;39m <==    Updates: 0
2022-08-26 18:48:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456899896020992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:48:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456920875929600 [0;39m 生成今日电子书快照开始
2022-08-26 18:48:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456920875929600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:48:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456920875929600 [0;39m ==> Parameters: 
2022-08-26 18:48:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456920875929600 [0;39m <==    Updates: 0
2022-08-26 18:48:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456920875929600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:48:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20456941826478080 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:48:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456941826478080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:48:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456941826478080 [0;39m ==> Parameters: 
2022-08-26 18:48:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20456941826478080 [0;39m <==    Updates: 8
2022-08-26 18:48:35.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20456941826478080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:48:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456941830672384 [0;39m 生成今日电子书快照开始
2022-08-26 18:48:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456941830672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:48:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456941830672384 [0;39m ==> Parameters: 
2022-08-26 18:48:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456941830672384 [0;39m <==    Updates: 0
2022-08-26 18:48:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456941830672384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:48:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456962806386688 [0;39m 生成今日电子书快照开始
2022-08-26 18:48:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456962806386688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:48:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456962806386688 [0;39m ==> Parameters: 
2022-08-26 18:48:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456962806386688 [0;39m <==    Updates: 0
2022-08-26 18:48:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456962806386688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:48:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20456983777906688 [0;39m 生成今日电子书快照开始
2022-08-26 18:48:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456983777906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:48:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456983777906688 [0;39m ==> Parameters: 
2022-08-26 18:48:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20456983777906688 [0;39m <==    Updates: 0
2022-08-26 18:48:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20456983777906688 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:48:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457004741038080 [0;39m 生成今日电子书快照开始
2022-08-26 18:48:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457004741038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:48:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457004741038080 [0;39m ==> Parameters: 
2022-08-26 18:48:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457004741038080 [0;39m <==    Updates: 0
2022-08-26 18:48:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457004741038080 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:48:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457025708363776 [0;39m 生成今日电子书快照开始
2022-08-26 18:48:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457025708363776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:48:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457025708363776 [0;39m ==> Parameters: 
2022-08-26 18:48:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457025708363776 [0;39m <==    Updates: 0
2022-08-26 18:48:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457025708363776 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:49:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457046709243904 [0;39m 生成今日电子书快照开始
2022-08-26 18:49:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457046709243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:49:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457046709243904 [0;39m ==> Parameters: 
2022-08-26 18:49:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457046709243904 [0;39m <==    Updates: 0
2022-08-26 18:49:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457046709243904 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:49:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457067697541120 [0;39m 生成今日电子书快照开始
2022-08-26 18:49:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457067697541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:49:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457067697541120 [0;39m ==> Parameters: 
2022-08-26 18:49:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457067697541120 [0;39m <==    Updates: 0
2022-08-26 18:49:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457067697541120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:49:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20457067705929728 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:49:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457067705929728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:49:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457067705929728 [0;39m ==> Parameters: 
2022-08-26 18:49:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457067705929728 [0;39m <==    Updates: 8
2022-08-26 18:49:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20457067705929728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:49:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457088677449728 [0;39m 生成今日电子书快照开始
2022-08-26 18:49:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457088677449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:49:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457088677449728 [0;39m ==> Parameters: 
2022-08-26 18:49:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457088677449728 [0;39m <==    Updates: 0
2022-08-26 18:49:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457088677449728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:49:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457109607026688 [0;39m 生成今日电子书快照开始
2022-08-26 18:49:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457109607026688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:49:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457109607026688 [0;39m ==> Parameters: 
2022-08-26 18:49:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457109607026688 [0;39m <==    Updates: 0
2022-08-26 18:49:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457109607026688 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:49:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457130620489728 [0;39m 生成今日电子书快照开始
2022-08-26 18:49:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457130620489728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:49:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457130620489728 [0;39m ==> Parameters: 
2022-08-26 18:49:20.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457130620489728 [0;39m <==    Updates: 0
2022-08-26 18:49:20.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457130620489728 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:49:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457151541678080 [0;39m 生成今日电子书快照开始
2022-08-26 18:49:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457151541678080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:49:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457151541678080 [0;39m ==> Parameters: 
2022-08-26 18:49:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457151541678080 [0;39m <==    Updates: 0
2022-08-26 18:49:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457151541678080 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:49:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457172555141120 [0;39m 生成今日电子书快照开始
2022-08-26 18:49:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457172555141120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:49:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457172555141120 [0;39m ==> Parameters: 
2022-08-26 18:49:30.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457172555141120 [0;39m <==    Updates: 0
2022-08-26 18:49:30.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457172555141120 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:49:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457193539244032 [0;39m 生成今日电子书快照开始
2022-08-26 18:49:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457193539244032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:49:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457193539244032 [0;39m ==> Parameters: 
2022-08-26 18:49:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457193539244032 [0;39m <==    Updates: 0
2022-08-26 18:49:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457193539244032 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:49:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20457193547632640 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:49:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457193547632640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:49:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457193547632640 [0;39m ==> Parameters: 
2022-08-26 18:49:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457193547632640 [0;39m <==    Updates: 8
2022-08-26 18:49:35.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20457193547632640 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:49:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457214493986816 [0;39m 生成今日电子书快照开始
2022-08-26 18:49:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457214493986816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:49:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457214493986816 [0;39m ==> Parameters: 
2022-08-26 18:49:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457214493986816 [0;39m <==    Updates: 0
2022-08-26 18:49:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457214493986816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:49:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457235473895424 [0;39m 生成今日电子书快照开始
2022-08-26 18:49:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457235473895424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:49:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457235473895424 [0;39m ==> Parameters: 
2022-08-26 18:49:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457235473895424 [0;39m <==    Updates: 0
2022-08-26 18:49:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457235473895424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:49:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457256403472384 [0;39m 生成今日电子书快照开始
2022-08-26 18:49:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457256403472384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:49:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457256403472384 [0;39m ==> Parameters: 
2022-08-26 18:49:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457256403472384 [0;39m <==    Updates: 0
2022-08-26 18:49:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457256403472384 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:49:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457277425324032 [0;39m 生成今日电子书快照开始
2022-08-26 18:49:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457277425324032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:49:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457277425324032 [0;39m ==> Parameters: 
2022-08-26 18:49:55.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457277425324032 [0;39m <==    Updates: 0
2022-08-26 18:49:55.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457277425324032 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:50:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457298384261120 [0;39m 生成今日电子书快照开始
2022-08-26 18:50:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457298384261120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:50:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457298384261120 [0;39m ==> Parameters: 
2022-08-26 18:50:00.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457298384261120 [0;39m <==    Updates: 0
2022-08-26 18:50:00.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457298384261120 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-26 18:50:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457319364169728 [0;39m 生成今日电子书快照开始
2022-08-26 18:50:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457319364169728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:50:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457319364169728 [0;39m ==> Parameters: 
2022-08-26 18:50:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457319364169728 [0;39m <==    Updates: 0
2022-08-26 18:50:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457319364169728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:50:05.017 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20457319372558336 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:50:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457319372558336 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:50:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457319372558336 [0;39m ==> Parameters: 
2022-08-26 18:50:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457319372558336 [0;39m <==    Updates: 8
2022-08-26 18:50:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20457319372558336 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:50:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457340302135296 [0;39m 生成今日电子书快照开始
2022-08-26 18:50:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457340302135296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:50:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457340302135296 [0;39m ==> Parameters: 
2022-08-26 18:50:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457340302135296 [0;39m <==    Updates: 0
2022-08-26 18:50:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457340302135296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:50:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457361277849600 [0;39m 生成今日电子书快照开始
2022-08-26 18:50:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457361277849600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:50:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457361277849600 [0;39m ==> Parameters: 
2022-08-26 18:50:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457361277849600 [0;39m <==    Updates: 0
2022-08-26 18:50:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457361277849600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:50:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457382249369600 [0;39m 生成今日电子书快照开始
2022-08-26 18:50:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457382249369600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:50:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457382249369600 [0;39m ==> Parameters: 
2022-08-26 18:50:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457382249369600 [0;39m <==    Updates: 0
2022-08-26 18:50:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457382249369600 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:50:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457403212500992 [0;39m 生成今日电子书快照开始
2022-08-26 18:50:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457403212500992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:50:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457403212500992 [0;39m ==> Parameters: 
2022-08-26 18:50:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457403212500992 [0;39m <==    Updates: 0
2022-08-26 18:50:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457403212500992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:50:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457424213381120 [0;39m 生成今日电子书快照开始
2022-08-26 18:50:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457424213381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:50:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457424213381120 [0;39m ==> Parameters: 
2022-08-26 18:50:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457424213381120 [0;39m <==    Updates: 0
2022-08-26 18:50:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457424213381120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:50:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20457445163929600 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:50:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457445163929600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:50:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457445163929600 [0;39m ==> Parameters: 
2022-08-26 18:50:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457445163929600 [0;39m <==    Updates: 8
2022-08-26 18:50:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20457445163929600 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 18:50:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457445184901120 [0;39m 生成今日电子书快照开始
2022-08-26 18:50:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457445184901120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:50:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457445184901120 [0;39m ==> Parameters: 
2022-08-26 18:50:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457445184901120 [0;39m <==    Updates: 0
2022-08-26 18:50:35.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457445184901120 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:50:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457466131255296 [0;39m 生成今日电子书快照开始
2022-08-26 18:50:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457466131255296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:50:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457466131255296 [0;39m ==> Parameters: 
2022-08-26 18:50:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457466131255296 [0;39m <==    Updates: 0
2022-08-26 18:50:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457466131255296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:50:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457487123746816 [0;39m 生成今日电子书快照开始
2022-08-26 18:50:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457487123746816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:50:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457487123746816 [0;39m ==> Parameters: 
2022-08-26 18:50:45.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457487123746816 [0;39m <==    Updates: 0
2022-08-26 18:50:45.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457487123746816 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:50:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457508070100992 [0;39m 生成今日电子书快照开始
2022-08-26 18:50:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457508070100992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:50:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457508070100992 [0;39m ==> Parameters: 
2022-08-26 18:50:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457508070100992 [0;39m <==    Updates: 0
2022-08-26 18:50:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457508070100992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:50:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457529024843776 [0;39m 生成今日电子书快照开始
2022-08-26 18:50:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457529024843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:50:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457529024843776 [0;39m ==> Parameters: 
2022-08-26 18:50:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457529024843776 [0;39m <==    Updates: 0
2022-08-26 18:50:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457529024843776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:51:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457550004752384 [0;39m 生成今日电子书快照开始
2022-08-26 18:51:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457550004752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:51:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457550004752384 [0;39m ==> Parameters: 
2022-08-26 18:51:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457550004752384 [0;39m <==    Updates: 0
2022-08-26 18:51:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457550004752384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:51:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457570972078080 [0;39m 生成今日电子书快照开始
2022-08-26 18:51:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457570972078080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:51:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457570972078080 [0;39m ==> Parameters: 
2022-08-26 18:51:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457570972078080 [0;39m <==    Updates: 0
2022-08-26 18:51:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457570972078080 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:51:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20457570997243904 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:51:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457570997243904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:51:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457570997243904 [0;39m ==> Parameters: 
2022-08-26 18:51:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457570997243904 [0;39m <==    Updates: 8
2022-08-26 18:51:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20457570997243904 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 18:51:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457591993929728 [0;39m 生成今日电子书快照开始
2022-08-26 18:51:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457591993929728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:51:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457591993929728 [0;39m ==> Parameters: 
2022-08-26 18:51:10.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457591993929728 [0;39m <==    Updates: 0
2022-08-26 18:51:10.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457591993929728 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:51:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457612906729472 [0;39m 生成今日电子书快照开始
2022-08-26 18:51:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457612906729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:51:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457612906729472 [0;39m ==> Parameters: 
2022-08-26 18:51:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457612906729472 [0;39m <==    Updates: 0
2022-08-26 18:51:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457612906729472 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:51:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457633882443776 [0;39m 生成今日电子书快照开始
2022-08-26 18:51:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457633882443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:51:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457633882443776 [0;39m ==> Parameters: 
2022-08-26 18:51:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457633882443776 [0;39m <==    Updates: 0
2022-08-26 18:51:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457633882443776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:51:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457654879129600 [0;39m 生成今日电子书快照开始
2022-08-26 18:51:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457654879129600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:51:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457654879129600 [0;39m ==> Parameters: 
2022-08-26 18:51:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457654879129600 [0;39m <==    Updates: 0
2022-08-26 18:51:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457654879129600 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:51:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457675825483776 [0;39m 生成今日电子书快照开始
2022-08-26 18:51:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457675825483776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:51:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457675825483776 [0;39m ==> Parameters: 
2022-08-26 18:51:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457675825483776 [0;39m <==    Updates: 0
2022-08-26 18:51:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457675825483776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:51:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20457696830558208 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:51:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457696830558208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:51:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457696830558208 [0;39m ==> Parameters: 
2022-08-26 18:51:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457696830558208 [0;39m <==    Updates: 8
2022-08-26 18:51:35.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20457696830558208 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:51:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457696834752512 [0;39m 生成今日电子书快照开始
2022-08-26 18:51:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457696834752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:51:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457696834752512 [0;39m ==> Parameters: 
2022-08-26 18:51:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457696834752512 [0;39m <==    Updates: 0
2022-08-26 18:51:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457696834752512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:51:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457717772718080 [0;39m 生成今日电子书快照开始
2022-08-26 18:51:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457717772718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:51:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457717772718080 [0;39m ==> Parameters: 
2022-08-26 18:51:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457717772718080 [0;39m <==    Updates: 0
2022-08-26 18:51:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457717772718080 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:51:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457738794569728 [0;39m 生成今日电子书快照开始
2022-08-26 18:51:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457738794569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:51:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457738794569728 [0;39m ==> Parameters: 
2022-08-26 18:51:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457738794569728 [0;39m <==    Updates: 0
2022-08-26 18:51:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457738794569728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:51:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457759745118208 [0;39m 生成今日电子书快照开始
2022-08-26 18:51:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457759745118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:51:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457759745118208 [0;39m ==> Parameters: 
2022-08-26 18:51:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457759745118208 [0;39m <==    Updates: 0
2022-08-26 18:51:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457759745118208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:51:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457780704055296 [0;39m 生成今日电子书快照开始
2022-08-26 18:51:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457780704055296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:51:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457780704055296 [0;39m ==> Parameters: 
2022-08-26 18:51:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457780704055296 [0;39m <==    Updates: 0
2022-08-26 18:51:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457780704055296 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:52:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457801704935424 [0;39m 生成今日电子书快照开始
2022-08-26 18:52:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457801704935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:52:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457801704935424 [0;39m ==> Parameters: 
2022-08-26 18:52:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457801704935424 [0;39m <==    Updates: 0
2022-08-26 18:52:00.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457801704935424 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:52:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457822638706688 [0;39m 生成今日电子书快照开始
2022-08-26 18:52:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457822638706688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:52:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457822638706688 [0;39m ==> Parameters: 
2022-08-26 18:52:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457822638706688 [0;39m <==    Updates: 0
2022-08-26 18:52:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457822638706688 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:52:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20457822672261120 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:52:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457822672261120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:52:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457822672261120 [0;39m ==> Parameters: 
2022-08-26 18:52:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457822672261120 [0;39m <==    Updates: 8
2022-08-26 18:52:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20457822672261120 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 18:52:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457843618615296 [0;39m 生成今日电子书快照开始
2022-08-26 18:52:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457843618615296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:52:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457843618615296 [0;39m ==> Parameters: 
2022-08-26 18:52:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457843618615296 [0;39m <==    Updates: 0
2022-08-26 18:52:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457843618615296 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:52:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457864602718208 [0;39m 生成今日电子书快照开始
2022-08-26 18:52:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457864602718208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:52:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457864602718208 [0;39m ==> Parameters: 
2022-08-26 18:52:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457864602718208 [0;39m <==    Updates: 0
2022-08-26 18:52:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457864602718208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:52:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457885591015424 [0;39m 生成今日电子书快照开始
2022-08-26 18:52:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457885591015424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:52:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457885591015424 [0;39m ==> Parameters: 
2022-08-26 18:52:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457885591015424 [0;39m <==    Updates: 0
2022-08-26 18:52:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457885591015424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:52:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457906512203776 [0;39m 生成今日电子书快照开始
2022-08-26 18:52:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457906512203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:52:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457906512203776 [0;39m ==> Parameters: 
2022-08-26 18:52:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457906512203776 [0;39m <==    Updates: 0
2022-08-26 18:52:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457906512203776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:52:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457927500500992 [0;39m 生成今日电子书快照开始
2022-08-26 18:52:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457927500500992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:52:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457927500500992 [0;39m ==> Parameters: 
2022-08-26 18:52:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457927500500992 [0;39m <==    Updates: 0
2022-08-26 18:52:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457927500500992 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:52:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457948513964032 [0;39m 生成今日电子书快照开始
2022-08-26 18:52:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457948513964032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:52:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457948513964032 [0;39m ==> Parameters: 
2022-08-26 18:52:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457948513964032 [0;39m <==    Updates: 0
2022-08-26 18:52:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457948513964032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:52:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20457948522352640 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:52:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457948522352640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:52:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457948522352640 [0;39m ==> Parameters: 
2022-08-26 18:52:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20457948522352640 [0;39m <==    Updates: 8
2022-08-26 18:52:35.020 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20457948522352640 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:52:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457969435152384 [0;39m 生成今日电子书快照开始
2022-08-26 18:52:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457969435152384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:52:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457969435152384 [0;39m ==> Parameters: 
2022-08-26 18:52:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457969435152384 [0;39m <==    Updates: 0
2022-08-26 18:52:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457969435152384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:52:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20457990394089472 [0;39m 生成今日电子书快照开始
2022-08-26 18:52:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457990394089472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:52:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457990394089472 [0;39m ==> Parameters: 
2022-08-26 18:52:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20457990394089472 [0;39m <==    Updates: 0
2022-08-26 18:52:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20457990394089472 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:52:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458011415941120 [0;39m 生成今日电子书快照开始
2022-08-26 18:52:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458011415941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:52:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458011415941120 [0;39m ==> Parameters: 
2022-08-26 18:52:50.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458011415941120 [0;39m <==    Updates: 0
2022-08-26 18:52:50.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458011415941120 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:52:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458032383266816 [0;39m 生成今日电子书快照开始
2022-08-26 18:52:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458032383266816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:52:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458032383266816 [0;39m ==> Parameters: 
2022-08-26 18:52:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458032383266816 [0;39m <==    Updates: 0
2022-08-26 18:52:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458032383266816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:53:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458053317038080 [0;39m 生成今日电子书快照开始
2022-08-26 18:53:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458053317038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:53:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458053317038080 [0;39m ==> Parameters: 
2022-08-26 18:53:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458053317038080 [0;39m <==    Updates: 0
2022-08-26 18:53:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458053317038080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:53:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458074334695424 [0;39m 生成今日电子书快照开始
2022-08-26 18:53:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458074334695424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:53:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458074334695424 [0;39m ==> Parameters: 
2022-08-26 18:53:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458074334695424 [0;39m <==    Updates: 0
2022-08-26 18:53:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458074334695424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:53:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20458074343084032 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:53:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458074343084032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:53:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458074343084032 [0;39m ==> Parameters: 
2022-08-26 18:53:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458074343084032 [0;39m <==    Updates: 8
2022-08-26 18:53:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20458074343084032 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:53:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458095314604032 [0;39m 生成今日电子书快照开始
2022-08-26 18:53:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458095314604032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:53:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458095314604032 [0;39m ==> Parameters: 
2022-08-26 18:53:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458095314604032 [0;39m <==    Updates: 0
2022-08-26 18:53:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458095314604032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:53:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458116223209472 [0;39m 生成今日电子书快照开始
2022-08-26 18:53:15.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458116223209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:53:15.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458116223209472 [0;39m ==> Parameters: 
2022-08-26 18:53:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458116223209472 [0;39m <==    Updates: 0
2022-08-26 18:53:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458116223209472 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:53:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458137215700992 [0;39m 生成今日电子书快照开始
2022-08-26 18:53:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458137215700992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:53:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458137215700992 [0;39m ==> Parameters: 
2022-08-26 18:53:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458137215700992 [0;39m <==    Updates: 0
2022-08-26 18:53:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458137215700992 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:53:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458158203998208 [0;39m 生成今日电子书快照开始
2022-08-26 18:53:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458158203998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:53:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458158203998208 [0;39m ==> Parameters: 
2022-08-26 18:53:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458158203998208 [0;39m <==    Updates: 0
2022-08-26 18:53:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458158203998208 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:53:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458179171323904 [0;39m 生成今日电子书快照开始
2022-08-26 18:53:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458179171323904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:53:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458179171323904 [0;39m ==> Parameters: 
2022-08-26 18:53:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458179171323904 [0;39m <==    Updates: 0
2022-08-26 18:53:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458179171323904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:53:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20458200163815424 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:53:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458200163815424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:53:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458200163815424 [0;39m ==> Parameters: 
2022-08-26 18:53:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458200163815424 [0;39m <==    Updates: 8
2022-08-26 18:53:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20458200163815424 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-26 18:53:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458200172204032 [0;39m 生成今日电子书快照开始
2022-08-26 18:53:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458200172204032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:53:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458200172204032 [0;39m ==> Parameters: 
2022-08-26 18:53:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458200172204032 [0;39m <==    Updates: 0
2022-08-26 18:53:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458200172204032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:53:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458221131141120 [0;39m 生成今日电子书快照开始
2022-08-26 18:53:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458221131141120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:53:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458221131141120 [0;39m ==> Parameters: 
2022-08-26 18:53:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458221131141120 [0;39m <==    Updates: 0
2022-08-26 18:53:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458221131141120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:53:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458242098466816 [0;39m 生成今日电子书快照开始
2022-08-26 18:53:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458242098466816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:53:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458242098466816 [0;39m ==> Parameters: 
2022-08-26 18:53:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458242098466816 [0;39m <==    Updates: 0
2022-08-26 18:53:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458242098466816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:53:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458263057403904 [0;39m 生成今日电子书快照开始
2022-08-26 18:53:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458263057403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:53:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458263057403904 [0;39m ==> Parameters: 
2022-08-26 18:53:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458263057403904 [0;39m <==    Updates: 0
2022-08-26 18:53:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458263057403904 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:53:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458284016340992 [0;39m 生成今日电子书快照开始
2022-08-26 18:53:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458284016340992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:53:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458284016340992 [0;39m ==> Parameters: 
2022-08-26 18:53:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458284016340992 [0;39m <==    Updates: 0
2022-08-26 18:53:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458284016340992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:54:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458304987860992 [0;39m 生成今日电子书快照开始
2022-08-26 18:54:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458304987860992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:54:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458304987860992 [0;39m ==> Parameters: 
2022-08-26 18:54:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458304987860992 [0;39m <==    Updates: 0
2022-08-26 18:54:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458304987860992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:54:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458325959380992 [0;39m 生成今日电子书快照开始
2022-08-26 18:54:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458325959380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:54:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458325959380992 [0;39m ==> Parameters: 
2022-08-26 18:54:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458325959380992 [0;39m <==    Updates: 0
2022-08-26 18:54:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458325959380992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:54:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20458325967769600 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:54:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458325967769600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:54:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458325967769600 [0;39m ==> Parameters: 
2022-08-26 18:54:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458325967769600 [0;39m <==    Updates: 8
2022-08-26 18:54:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20458325967769600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:54:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458346951872512 [0;39m 生成今日电子书快照开始
2022-08-26 18:54:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458346951872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:54:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458346951872512 [0;39m ==> Parameters: 
2022-08-26 18:54:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458346951872512 [0;39m <==    Updates: 0
2022-08-26 18:54:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458346951872512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:54:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458367898226688 [0;39m 生成今日电子书快照开始
2022-08-26 18:54:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458367898226688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:54:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458367898226688 [0;39m ==> Parameters: 
2022-08-26 18:54:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458367898226688 [0;39m <==    Updates: 0
2022-08-26 18:54:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458367898226688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:54:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458388886523904 [0;39m 生成今日电子书快照开始
2022-08-26 18:54:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458388886523904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:54:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458388886523904 [0;39m ==> Parameters: 
2022-08-26 18:54:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458388886523904 [0;39m <==    Updates: 0
2022-08-26 18:54:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458388886523904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:54:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458409828683776 [0;39m 生成今日电子书快照开始
2022-08-26 18:54:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458409828683776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:54:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458409828683776 [0;39m ==> Parameters: 
2022-08-26 18:54:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458409828683776 [0;39m <==    Updates: 0
2022-08-26 18:54:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458409828683776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:54:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458430854729728 [0;39m 生成今日电子书快照开始
2022-08-26 18:54:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458430854729728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:54:30.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458430854729728 [0;39m ==> Parameters: 
2022-08-26 18:54:30.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458430854729728 [0;39m <==    Updates: 0
2022-08-26 18:54:30.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458430854729728 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:54:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458451771723776 [0;39m 生成今日电子书快照开始
2022-08-26 18:54:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458451771723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:54:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458451771723776 [0;39m ==> Parameters: 
2022-08-26 18:54:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458451771723776 [0;39m <==    Updates: 0
2022-08-26 18:54:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458451771723776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:54:35.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20458451801083904 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:54:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458451801083904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:54:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458451801083904 [0;39m ==> Parameters: 
2022-08-26 18:54:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458451801083904 [0;39m <==    Updates: 8
2022-08-26 18:54:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20458451801083904 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 18:54:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458472739049472 [0;39m 生成今日电子书快照开始
2022-08-26 18:54:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458472739049472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:54:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458472739049472 [0;39m ==> Parameters: 
2022-08-26 18:54:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458472739049472 [0;39m <==    Updates: 0
2022-08-26 18:54:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458472739049472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:54:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458493769289728 [0;39m 生成今日电子书快照开始
2022-08-26 18:54:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458493769289728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:54:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458493769289728 [0;39m ==> Parameters: 
2022-08-26 18:54:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458493769289728 [0;39m <==    Updates: 0
2022-08-26 18:54:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458493769289728 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:54:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458514745004032 [0;39m 生成今日电子书快照开始
2022-08-26 18:54:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458514745004032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:54:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458514745004032 [0;39m ==> Parameters: 
2022-08-26 18:54:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458514745004032 [0;39m <==    Updates: 0
2022-08-26 18:54:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458514745004032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:54:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458535674580992 [0;39m 生成今日电子书快照开始
2022-08-26 18:54:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458535674580992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:54:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458535674580992 [0;39m ==> Parameters: 
2022-08-26 18:54:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458535674580992 [0;39m <==    Updates: 0
2022-08-26 18:54:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458535674580992 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:55:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458556646100992 [0;39m 生成今日电子书快照开始
2022-08-26 18:55:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458556646100992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:55:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458556646100992 [0;39m ==> Parameters: 
2022-08-26 18:55:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458556646100992 [0;39m <==    Updates: 0
2022-08-26 18:55:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458556646100992 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:55:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458577626009600 [0;39m 生成今日电子书快照开始
2022-08-26 18:55:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458577626009600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:55:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458577626009600 [0;39m ==> Parameters: 
2022-08-26 18:55:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458577626009600 [0;39m <==    Updates: 0
2022-08-26 18:55:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458577626009600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:55:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20458577638592512 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:55:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458577638592512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:55:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458577638592512 [0;39m ==> Parameters: 
2022-08-26 18:55:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458577638592512 [0;39m <==    Updates: 8
2022-08-26 18:55:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20458577638592512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:55:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458598593335296 [0;39m 生成今日电子书快照开始
2022-08-26 18:55:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458598593335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:55:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458598593335296 [0;39m ==> Parameters: 
2022-08-26 18:55:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458598593335296 [0;39m <==    Updates: 0
2022-08-26 18:55:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458598593335296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:55:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458619590021120 [0;39m 生成今日电子书快照开始
2022-08-26 18:55:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458619590021120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:55:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458619590021120 [0;39m ==> Parameters: 
2022-08-26 18:55:15.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458619590021120 [0;39m <==    Updates: 0
2022-08-26 18:55:15.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458619590021120 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:55:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458640532180992 [0;39m 生成今日电子书快照开始
2022-08-26 18:55:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458640532180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:55:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458640532180992 [0;39m ==> Parameters: 
2022-08-26 18:55:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458640532180992 [0;39m <==    Updates: 0
2022-08-26 18:55:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458640532180992 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:55:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458661482729472 [0;39m 生成今日电子书快照开始
2022-08-26 18:55:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458661482729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:55:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458661482729472 [0;39m ==> Parameters: 
2022-08-26 18:55:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458661482729472 [0;39m <==    Updates: 0
2022-08-26 18:55:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458661482729472 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:55:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458682479415296 [0;39m 生成今日电子书快照开始
2022-08-26 18:55:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458682479415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:55:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458682479415296 [0;39m ==> Parameters: 
2022-08-26 18:55:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458682479415296 [0;39m <==    Updates: 0
2022-08-26 18:55:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458682479415296 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:55:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20458703488684032 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:55:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458703488684032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:55:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458703488684032 [0;39m ==> Parameters: 
2022-08-26 18:55:35.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458703488684032 [0;39m <==    Updates: 8
2022-08-26 18:55:35.021 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20458703488684032 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 18:55:35.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458703513849856 [0;39m 生成今日电子书快照开始
2022-08-26 18:55:35.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458703513849856 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:55:35.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458703513849856 [0;39m ==> Parameters: 
2022-08-26 18:55:35.027 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458703513849856 [0;39m <==    Updates: 0
2022-08-26 18:55:35.028 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458703513849856 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:55:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458724422455296 [0;39m 生成今日电子书快照开始
2022-08-26 18:55:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458724422455296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:55:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458724422455296 [0;39m ==> Parameters: 
2022-08-26 18:55:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458724422455296 [0;39m <==    Updates: 0
2022-08-26 18:55:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458724422455296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:55:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458745423335424 [0;39m 生成今日电子书快照开始
2022-08-26 18:55:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458745423335424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:55:45.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458745423335424 [0;39m ==> Parameters: 
2022-08-26 18:55:45.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458745423335424 [0;39m <==    Updates: 0
2022-08-26 18:55:45.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458745423335424 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:55:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458766399049728 [0;39m 生成今日电子书快照开始
2022-08-26 18:55:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458766399049728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:55:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458766399049728 [0;39m ==> Parameters: 
2022-08-26 18:55:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458766399049728 [0;39m <==    Updates: 0
2022-08-26 18:55:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458766399049728 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:55:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458787370569728 [0;39m 生成今日电子书快照开始
2022-08-26 18:55:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458787370569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:55:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458787370569728 [0;39m ==> Parameters: 
2022-08-26 18:55:55.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458787370569728 [0;39m <==    Updates: 0
2022-08-26 18:55:55.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458787370569728 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:56:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458808291758080 [0;39m 生成今日电子书快照开始
2022-08-26 18:56:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458808291758080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:56:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458808291758080 [0;39m ==> Parameters: 
2022-08-26 18:56:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458808291758080 [0;39m <==    Updates: 0
2022-08-26 18:56:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458808291758080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:56:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20458829296832512 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:56:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458829296832512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:56:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458829296832512 [0;39m ==> Parameters: 
2022-08-26 18:56:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458829296832512 [0;39m <==    Updates: 8
2022-08-26 18:56:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20458829296832512 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 18:56:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458829321998336 [0;39m 生成今日电子书快照开始
2022-08-26 18:56:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458829321998336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:56:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458829321998336 [0;39m ==> Parameters: 
2022-08-26 18:56:05.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458829321998336 [0;39m <==    Updates: 0
2022-08-26 18:56:05.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458829321998336 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:56:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458850268352512 [0;39m 生成今日电子书快照开始
2022-08-26 18:56:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458850268352512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:56:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458850268352512 [0;39m ==> Parameters: 
2022-08-26 18:56:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458850268352512 [0;39m <==    Updates: 0
2022-08-26 18:56:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458850268352512 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:56:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458871248261120 [0;39m 生成今日电子书快照开始
2022-08-26 18:56:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458871248261120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:56:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458871248261120 [0;39m ==> Parameters: 
2022-08-26 18:56:15.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458871248261120 [0;39m <==    Updates: 0
2022-08-26 18:56:15.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458871248261120 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:56:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458892232364032 [0;39m 生成今日电子书快照开始
2022-08-26 18:56:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458892232364032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:56:20.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458892232364032 [0;39m ==> Parameters: 
2022-08-26 18:56:20.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458892232364032 [0;39m <==    Updates: 0
2022-08-26 18:56:20.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458892232364032 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 18:56:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458913199689728 [0;39m 生成今日电子书快照开始
2022-08-26 18:56:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458913199689728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:56:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458913199689728 [0;39m ==> Parameters: 
2022-08-26 18:56:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458913199689728 [0;39m <==    Updates: 0
2022-08-26 18:56:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458913199689728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:56:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458934162821120 [0;39m 生成今日电子书快照开始
2022-08-26 18:56:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458934162821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:56:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458934162821120 [0;39m ==> Parameters: 
2022-08-26 18:56:30.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458934162821120 [0;39m <==    Updates: 0
2022-08-26 18:56:30.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458934162821120 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:56:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20458955109175296 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:56:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458955109175296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:56:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458955109175296 [0;39m ==> Parameters: 
2022-08-26 18:56:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20458955109175296 [0;39m <==    Updates: 8
2022-08-26 18:56:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20458955109175296 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-26 18:56:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458955142729728 [0;39m 生成今日电子书快照开始
2022-08-26 18:56:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458955142729728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:56:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458955142729728 [0;39m ==> Parameters: 
2022-08-26 18:56:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458955142729728 [0;39m <==    Updates: 0
2022-08-26 18:56:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458955142729728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:56:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458976063918080 [0;39m 生成今日电子书快照开始
2022-08-26 18:56:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458976063918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:56:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458976063918080 [0;39m ==> Parameters: 
2022-08-26 18:56:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458976063918080 [0;39m <==    Updates: 0
2022-08-26 18:56:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458976063918080 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:56:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20458997031243776 [0;39m 生成今日电子书快照开始
2022-08-26 18:56:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458997031243776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:56:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458997031243776 [0;39m ==> Parameters: 
2022-08-26 18:56:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20458997031243776 [0;39m <==    Updates: 0
2022-08-26 18:56:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20458997031243776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:56:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459018053095424 [0;39m 生成今日电子书快照开始
2022-08-26 18:56:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459018053095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:56:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459018053095424 [0;39m ==> Parameters: 
2022-08-26 18:56:50.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459018053095424 [0;39m <==    Updates: 0
2022-08-26 18:56:50.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459018053095424 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 18:56:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459038995255296 [0;39m 生成今日电子书快照开始
2022-08-26 18:56:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459038995255296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:56:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459038995255296 [0;39m ==> Parameters: 
2022-08-26 18:56:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459038995255296 [0;39m <==    Updates: 0
2022-08-26 18:56:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459038995255296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:57:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459059937415168 [0;39m 生成今日电子书快照开始
2022-08-26 18:57:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459059937415168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:57:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459059937415168 [0;39m ==> Parameters: 
2022-08-26 18:57:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459059937415168 [0;39m <==    Updates: 0
2022-08-26 18:57:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459059937415168 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:57:05.000 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20459080908935168 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:57:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459080908935168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:57:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459080908935168 [0;39m ==> Parameters: 
2022-08-26 18:57:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459080908935168 [0;39m <==    Updates: 8
2022-08-26 18:57:05.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20459080908935168 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 18:57:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459080934100992 [0;39m 生成今日电子书快照开始
2022-08-26 18:57:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459080934100992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:57:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459080934100992 [0;39m ==> Parameters: 
2022-08-26 18:57:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459080934100992 [0;39m <==    Updates: 0
2022-08-26 18:57:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459080934100992 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:57:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459101926592512 [0;39m 生成今日电子书快照开始
2022-08-26 18:57:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459101926592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:57:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459101926592512 [0;39m ==> Parameters: 
2022-08-26 18:57:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459101926592512 [0;39m <==    Updates: 0
2022-08-26 18:57:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459101926592512 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:57:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459122868752384 [0;39m 生成今日电子书快照开始
2022-08-26 18:57:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459122868752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:57:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459122868752384 [0;39m ==> Parameters: 
2022-08-26 18:57:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459122868752384 [0;39m <==    Updates: 0
2022-08-26 18:57:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459122868752384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:57:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459143848660992 [0;39m 生成今日电子书快照开始
2022-08-26 18:57:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459143848660992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:57:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459143848660992 [0;39m ==> Parameters: 
2022-08-26 18:57:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459143848660992 [0;39m <==    Updates: 0
2022-08-26 18:57:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459143848660992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:57:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459164799209472 [0;39m 生成今日电子书快照开始
2022-08-26 18:57:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459164799209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:57:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459164799209472 [0;39m ==> Parameters: 
2022-08-26 18:57:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459164799209472 [0;39m <==    Updates: 0
2022-08-26 18:57:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459164799209472 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:57:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459185833644032 [0;39m 生成今日电子书快照开始
2022-08-26 18:57:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459185833644032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:57:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459185833644032 [0;39m ==> Parameters: 
2022-08-26 18:57:30.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459185833644032 [0;39m <==    Updates: 0
2022-08-26 18:57:30.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459185833644032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:57:35.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20459206788386816 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:57:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459206788386816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:57:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459206788386816 [0;39m ==> Parameters: 
2022-08-26 18:57:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459206788386816 [0;39m <==    Updates: 8
2022-08-26 18:57:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20459206788386816 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:57:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459206792581120 [0;39m 生成今日电子书快照开始
2022-08-26 18:57:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459206792581120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:57:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459206792581120 [0;39m ==> Parameters: 
2022-08-26 18:57:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459206792581120 [0;39m <==    Updates: 0
2022-08-26 18:57:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459206792581120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:57:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459227743129600 [0;39m 生成今日电子书快照开始
2022-08-26 18:57:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459227743129600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:57:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459227743129600 [0;39m ==> Parameters: 
2022-08-26 18:57:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459227743129600 [0;39m <==    Updates: 0
2022-08-26 18:57:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459227743129600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:57:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459248706260992 [0;39m 生成今日电子书快照开始
2022-08-26 18:57:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459248706260992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:57:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459248706260992 [0;39m ==> Parameters: 
2022-08-26 18:57:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459248706260992 [0;39m <==    Updates: 0
2022-08-26 18:57:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459248706260992 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:57:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459269669392384 [0;39m 生成今日电子书快照开始
2022-08-26 18:57:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459269669392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:57:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459269669392384 [0;39m ==> Parameters: 
2022-08-26 18:57:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459269669392384 [0;39m <==    Updates: 0
2022-08-26 18:57:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459269669392384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:57:55.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459290628329472 [0;39m 生成今日电子书快照开始
2022-08-26 18:57:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459290628329472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:57:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459290628329472 [0;39m ==> Parameters: 
2022-08-26 18:57:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459290628329472 [0;39m <==    Updates: 0
2022-08-26 18:57:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459290628329472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:58:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459311654375424 [0;39m 生成今日电子书快照开始
2022-08-26 18:58:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459311654375424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:58:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459311654375424 [0;39m ==> Parameters: 
2022-08-26 18:58:00.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459311654375424 [0;39m <==    Updates: 0
2022-08-26 18:58:00.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459311654375424 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:58:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459332579758080 [0;39m 生成今日电子书快照开始
2022-08-26 18:58:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459332579758080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:58:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459332579758080 [0;39m ==> Parameters: 
2022-08-26 18:58:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459332579758080 [0;39m <==    Updates: 0
2022-08-26 18:58:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459332579758080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:58:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20459332588146688 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:58:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459332588146688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:58:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459332588146688 [0;39m ==> Parameters: 
2022-08-26 18:58:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459332588146688 [0;39m <==    Updates: 8
2022-08-26 18:58:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20459332588146688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 18:58:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459353589026816 [0;39m 生成今日电子书快照开始
2022-08-26 18:58:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459353589026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:58:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459353589026816 [0;39m ==> Parameters: 
2022-08-26 18:58:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459353589026816 [0;39m <==    Updates: 0
2022-08-26 18:58:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459353589026816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:58:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459374573129728 [0;39m 生成今日电子书快照开始
2022-08-26 18:58:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459374573129728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:58:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459374573129728 [0;39m ==> Parameters: 
2022-08-26 18:58:15.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459374573129728 [0;39m <==    Updates: 0
2022-08-26 18:58:15.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459374573129728 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:58:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459395548844032 [0;39m 生成今日电子书快照开始
2022-08-26 18:58:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459395548844032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:58:20.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459395548844032 [0;39m ==> Parameters: 
2022-08-26 18:58:20.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459395548844032 [0;39m <==    Updates: 0
2022-08-26 18:58:20.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459395548844032 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:58:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459416499392512 [0;39m 生成今日电子书快照开始
2022-08-26 18:58:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459416499392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:58:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459416499392512 [0;39m ==> Parameters: 
2022-08-26 18:58:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459416499392512 [0;39m <==    Updates: 0
2022-08-26 18:58:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459416499392512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:58:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459437475106816 [0;39m 生成今日电子书快照开始
2022-08-26 18:58:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459437475106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:58:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459437475106816 [0;39m ==> Parameters: 
2022-08-26 18:58:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459437475106816 [0;39m <==    Updates: 0
2022-08-26 18:58:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459437475106816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:58:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20459458408878080 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:58:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459458408878080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:58:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459458408878080 [0;39m ==> Parameters: 
2022-08-26 18:58:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459458408878080 [0;39m <==    Updates: 8
2022-08-26 18:58:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20459458408878080 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-26 18:58:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459458434043904 [0;39m 生成今日电子书快照开始
2022-08-26 18:58:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459458434043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:58:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459458434043904 [0;39m ==> Parameters: 
2022-08-26 18:58:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459458434043904 [0;39m <==    Updates: 0
2022-08-26 18:58:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459458434043904 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:58:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459479401369600 [0;39m 生成今日电子书快照开始
2022-08-26 18:58:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459479401369600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:58:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459479401369600 [0;39m ==> Parameters: 
2022-08-26 18:58:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459479401369600 [0;39m <==    Updates: 0
2022-08-26 18:58:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459479401369600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:58:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459500356112384 [0;39m 生成今日电子书快照开始
2022-08-26 18:58:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459500356112384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:58:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459500356112384 [0;39m ==> Parameters: 
2022-08-26 18:58:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459500356112384 [0;39m <==    Updates: 0
2022-08-26 18:58:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459500356112384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:58:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459521331826688 [0;39m 生成今日电子书快照开始
2022-08-26 18:58:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459521331826688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:58:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459521331826688 [0;39m ==> Parameters: 
2022-08-26 18:58:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459521331826688 [0;39m <==    Updates: 0
2022-08-26 18:58:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459521331826688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:58:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459542294958080 [0;39m 生成今日电子书快照开始
2022-08-26 18:58:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459542294958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:58:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459542294958080 [0;39m ==> Parameters: 
2022-08-26 18:58:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459542294958080 [0;39m <==    Updates: 0
2022-08-26 18:58:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459542294958080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:59:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459563270672384 [0;39m 生成今日电子书快照开始
2022-08-26 18:59:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459563270672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:59:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459563270672384 [0;39m ==> Parameters: 
2022-08-26 18:59:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459563270672384 [0;39m <==    Updates: 0
2022-08-26 18:59:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459563270672384 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:59:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20459584288329728 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:59:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459584288329728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:59:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459584288329728 [0;39m ==> Parameters: 
2022-08-26 18:59:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459584288329728 [0;39m <==    Updates: 8
2022-08-26 18:59:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20459584288329728 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 18:59:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459584300912640 [0;39m 生成今日电子书快照开始
2022-08-26 18:59:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459584300912640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:59:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459584300912640 [0;39m ==> Parameters: 
2022-08-26 18:59:05.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459584300912640 [0;39m <==    Updates: 0
2022-08-26 18:59:05.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459584300912640 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 18:59:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459605247266816 [0;39m 生成今日电子书快照开始
2022-08-26 18:59:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459605247266816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:59:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459605247266816 [0;39m ==> Parameters: 
2022-08-26 18:59:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459605247266816 [0;39m <==    Updates: 0
2022-08-26 18:59:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459605247266816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:59:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459626206203904 [0;39m 生成今日电子书快照开始
2022-08-26 18:59:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459626206203904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:59:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459626206203904 [0;39m ==> Parameters: 
2022-08-26 18:59:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459626206203904 [0;39m <==    Updates: 0
2022-08-26 18:59:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459626206203904 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:59:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459647202889728 [0;39m 生成今日电子书快照开始
2022-08-26 18:59:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459647202889728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:59:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459647202889728 [0;39m ==> Parameters: 
2022-08-26 18:59:20.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459647202889728 [0;39m <==    Updates: 0
2022-08-26 18:59:20.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459647202889728 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 18:59:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459668161826816 [0;39m 生成今日电子书快照开始
2022-08-26 18:59:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459668161826816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:59:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459668161826816 [0;39m ==> Parameters: 
2022-08-26 18:59:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459668161826816 [0;39m <==    Updates: 0
2022-08-26 18:59:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459668161826816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 18:59:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459689116569600 [0;39m 生成今日电子书快照开始
2022-08-26 18:59:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459689116569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:59:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459689116569600 [0;39m ==> Parameters: 
2022-08-26 18:59:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459689116569600 [0;39m <==    Updates: 0
2022-08-26 18:59:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459689116569600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:59:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459710121644032 [0;39m 生成今日电子书快照开始
2022-08-26 18:59:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459710121644032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:59:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459710121644032 [0;39m ==> Parameters: 
2022-08-26 18:59:35.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459710121644032 [0;39m <==    Updates: 0
2022-08-26 18:59:35.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459710121644032 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 18:59:35.024 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20459710155198464 [0;39m 更新电子书下的文档数据开始
2022-08-26 18:59:35.024 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459710155198464 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 18:59:35.025 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459710155198464 [0;39m ==> Parameters: 
2022-08-26 18:59:35.027 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459710155198464 [0;39m <==    Updates: 8
2022-08-26 18:59:35.027 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20459710155198464 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-26 18:59:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459731038638080 [0;39m 生成今日电子书快照开始
2022-08-26 18:59:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459731038638080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:59:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459731038638080 [0;39m ==> Parameters: 
2022-08-26 18:59:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459731038638080 [0;39m <==    Updates: 0
2022-08-26 18:59:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459731038638080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:59:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459752064684032 [0;39m 生成今日电子书快照开始
2022-08-26 18:59:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459752064684032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:59:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459752064684032 [0;39m ==> Parameters: 
2022-08-26 18:59:45.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459752064684032 [0;39m <==    Updates: 0
2022-08-26 18:59:45.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459752064684032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 18:59:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459773002649600 [0;39m 生成今日电子书快照开始
2022-08-26 18:59:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459773002649600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:59:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459773002649600 [0;39m ==> Parameters: 
2022-08-26 18:59:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459773002649600 [0;39m <==    Updates: 0
2022-08-26 18:59:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459773002649600 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 18:59:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459793961586688 [0;39m 生成今日电子书快照开始
2022-08-26 18:59:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459793961586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 18:59:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459793961586688 [0;39m ==> Parameters: 
2022-08-26 18:59:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459793961586688 [0;39m <==    Updates: 0
2022-08-26 18:59:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459793961586688 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 19:00:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459814933106688 [0;39m 生成今日电子书快照开始
2022-08-26 19:00:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459814933106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:00:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459814933106688 [0;39m ==> Parameters: 
2022-08-26 19:00:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459814933106688 [0;39m <==    Updates: 0
2022-08-26 19:00:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459814933106688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:00:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459835921403904 [0;39m 生成今日电子书快照开始
2022-08-26 19:00:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459835921403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:00:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459835921403904 [0;39m ==> Parameters: 
2022-08-26 19:00:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459835921403904 [0;39m <==    Updates: 0
2022-08-26 19:00:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459835921403904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:00:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20459835929792512 [0;39m 更新电子书下的文档数据开始
2022-08-26 19:00:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459835929792512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 19:00:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459835929792512 [0;39m ==> Parameters: 
2022-08-26 19:00:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459835929792512 [0;39m <==    Updates: 8
2022-08-26 19:00:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20459835929792512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 19:00:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459856913895424 [0;39m 生成今日电子书快照开始
2022-08-26 19:00:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459856913895424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:00:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459856913895424 [0;39m ==> Parameters: 
2022-08-26 19:00:10.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459856913895424 [0;39m <==    Updates: 0
2022-08-26 19:00:10.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459856913895424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 19:00:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459877835083776 [0;39m 生成今日电子书快照开始
2022-08-26 19:00:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459877835083776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:00:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459877835083776 [0;39m ==> Parameters: 
2022-08-26 19:00:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459877835083776 [0;39m <==    Updates: 0
2022-08-26 19:00:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459877835083776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:00:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459898856935424 [0;39m 生成今日电子书快照开始
2022-08-26 19:00:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459898856935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:00:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459898856935424 [0;39m ==> Parameters: 
2022-08-26 19:00:20.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459898856935424 [0;39m <==    Updates: 0
2022-08-26 19:00:20.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459898856935424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 19:00:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459919773929472 [0;39m 生成今日电子书快照开始
2022-08-26 19:00:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459919773929472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:00:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459919773929472 [0;39m ==> Parameters: 
2022-08-26 19:00:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459919773929472 [0;39m <==    Updates: 0
2022-08-26 19:00:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459919773929472 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 19:00:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459940753838080 [0;39m 生成今日电子书快照开始
2022-08-26 19:00:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459940753838080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:00:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459940753838080 [0;39m ==> Parameters: 
2022-08-26 19:00:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459940753838080 [0;39m <==    Updates: 0
2022-08-26 19:00:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459940753838080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:00:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459961729552384 [0;39m 生成今日电子书快照开始
2022-08-26 19:00:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459961729552384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:00:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459961729552384 [0;39m ==> Parameters: 
2022-08-26 19:00:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459961729552384 [0;39m <==    Updates: 0
2022-08-26 19:00:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459961729552384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 19:00:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20459961742135296 [0;39m 更新电子书下的文档数据开始
2022-08-26 19:00:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459961742135296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 19:00:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459961742135296 [0;39m ==> Parameters: 
2022-08-26 19:00:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20459961742135296 [0;39m <==    Updates: 8
2022-08-26 19:00:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20459961742135296 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 19:00:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20459982717849600 [0;39m 生成今日电子书快照开始
2022-08-26 19:00:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459982717849600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:00:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459982717849600 [0;39m ==> Parameters: 
2022-08-26 19:00:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20459982717849600 [0;39m <==    Updates: 0
2022-08-26 19:00:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20459982717849600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:00:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460003722924032 [0;39m 生成今日电子书快照开始
2022-08-26 19:00:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460003722924032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:00:45.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460003722924032 [0;39m ==> Parameters: 
2022-08-26 19:00:45.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460003722924032 [0;39m <==    Updates: 0
2022-08-26 19:00:45.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460003722924032 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 19:00:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460024639918080 [0;39m 生成今日电子书快照开始
2022-08-26 19:00:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460024639918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:00:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460024639918080 [0;39m ==> Parameters: 
2022-08-26 19:00:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460024639918080 [0;39m <==    Updates: 0
2022-08-26 19:00:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460024639918080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 19:00:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460045661769728 [0;39m 生成今日电子书快照开始
2022-08-26 19:00:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460045661769728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:00:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460045661769728 [0;39m ==> Parameters: 
2022-08-26 19:00:55.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460045661769728 [0;39m <==    Updates: 0
2022-08-26 19:00:55.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460045661769728 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 19:01:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460066582958080 [0;39m 生成今日电子书快照开始
2022-08-26 19:01:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460066582958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:01:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460066582958080 [0;39m ==> Parameters: 
2022-08-26 19:01:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460066582958080 [0;39m <==    Updates: 0
2022-08-26 19:01:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460066582958080 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 19:01:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460087596421120 [0;39m 生成今日电子书快照开始
2022-08-26 19:01:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460087596421120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:01:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460087596421120 [0;39m ==> Parameters: 
2022-08-26 19:01:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460087596421120 [0;39m <==    Updates: 0
2022-08-26 19:01:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460087596421120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 19:01:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20460087600615424 [0;39m 更新电子书下的文档数据开始
2022-08-26 19:01:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460087600615424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 19:01:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460087600615424 [0;39m ==> Parameters: 
2022-08-26 19:01:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460087600615424 [0;39m <==    Updates: 8
2022-08-26 19:01:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20460087600615424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 19:01:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460108572135424 [0;39m 生成今日电子书快照开始
2022-08-26 19:01:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460108572135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:01:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460108572135424 [0;39m ==> Parameters: 
2022-08-26 19:01:10.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460108572135424 [0;39m <==    Updates: 0
2022-08-26 19:01:10.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460108572135424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 19:01:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460129543655424 [0;39m 生成今日电子书快照开始
2022-08-26 19:01:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460129543655424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:01:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460129543655424 [0;39m ==> Parameters: 
2022-08-26 19:01:15.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460129543655424 [0;39m <==    Updates: 0
2022-08-26 19:01:15.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460129543655424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 19:01:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460150494203904 [0;39m 生成今日电子书快照开始
2022-08-26 19:01:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460150494203904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:01:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460150494203904 [0;39m ==> Parameters: 
2022-08-26 19:01:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460150494203904 [0;39m <==    Updates: 0
2022-08-26 19:01:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460150494203904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:01:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460171478306816 [0;39m 生成今日电子书快照开始
2022-08-26 19:01:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460171478306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:01:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460171478306816 [0;39m ==> Parameters: 
2022-08-26 19:01:25.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460171478306816 [0;39m <==    Updates: 0
2022-08-26 19:01:25.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460171478306816 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-26 19:01:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460192407883776 [0;39m 生成今日电子书快照开始
2022-08-26 19:01:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460192407883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:01:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460192407883776 [0;39m ==> Parameters: 
2022-08-26 19:01:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460192407883776 [0;39m <==    Updates: 0
2022-08-26 19:01:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460192407883776 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 19:01:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460213404569600 [0;39m 生成今日电子书快照开始
2022-08-26 19:01:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460213404569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:01:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460213404569600 [0;39m ==> Parameters: 
2022-08-26 19:01:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460213404569600 [0;39m <==    Updates: 0
2022-08-26 19:01:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460213404569600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:01:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20460213412958208 [0;39m 更新电子书下的文档数据开始
2022-08-26 19:01:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460213412958208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 19:01:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460213412958208 [0;39m ==> Parameters: 
2022-08-26 19:01:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460213412958208 [0;39m <==    Updates: 8
2022-08-26 19:01:35.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20460213412958208 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 19:01:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460234401255424 [0;39m 生成今日电子书快照开始
2022-08-26 19:01:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460234401255424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:01:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460234401255424 [0;39m ==> Parameters: 
2022-08-26 19:01:40.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460234401255424 [0;39m <==    Updates: 0
2022-08-26 19:01:40.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460234401255424 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 19:01:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460255376969728 [0;39m 生成今日电子书快照开始
2022-08-26 19:01:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460255376969728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:01:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460255376969728 [0;39m ==> Parameters: 
2022-08-26 19:01:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460255376969728 [0;39m <==    Updates: 0
2022-08-26 19:01:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460255376969728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:01:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460276310740992 [0;39m 生成今日电子书快照开始
2022-08-26 19:01:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460276310740992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:01:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460276310740992 [0;39m ==> Parameters: 
2022-08-26 19:01:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460276310740992 [0;39m <==    Updates: 0
2022-08-26 19:01:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460276310740992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:01:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460297290649600 [0;39m 生成今日电子书快照开始
2022-08-26 19:01:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460297290649600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:01:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460297290649600 [0;39m ==> Parameters: 
2022-08-26 19:01:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460297290649600 [0;39m <==    Updates: 0
2022-08-26 19:01:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460297290649600 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-26 19:02:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460318232809472 [0;39m 生成今日电子书快照开始
2022-08-26 19:02:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460318232809472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:02:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460318232809472 [0;39m ==> Parameters: 
2022-08-26 19:02:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460318232809472 [0;39m <==    Updates: 0
2022-08-26 19:02:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460318232809472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 19:02:05.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460339200135168 [0;39m 生成今日电子书快照开始
2022-08-26 19:02:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460339200135168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:02:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460339200135168 [0;39m ==> Parameters: 
2022-08-26 19:02:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460339200135168 [0;39m <==    Updates: 0
2022-08-26 19:02:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460339200135168 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 19:02:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20460339233689600 [0;39m 更新电子书下的文档数据开始
2022-08-26 19:02:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460339233689600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 19:02:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460339233689600 [0;39m ==> Parameters: 
2022-08-26 19:02:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460339233689600 [0;39m <==    Updates: 8
2022-08-26 19:02:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20460339233689600 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 19:02:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460360192626688 [0;39m 生成今日电子书快照开始
2022-08-26 19:02:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460360192626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:02:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460360192626688 [0;39m ==> Parameters: 
2022-08-26 19:02:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460360192626688 [0;39m <==    Updates: 0
2022-08-26 19:02:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460360192626688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:02:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460381193506816 [0;39m 生成今日电子书快照开始
2022-08-26 19:02:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460381193506816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:02:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460381193506816 [0;39m ==> Parameters: 
2022-08-26 19:02:15.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460381193506816 [0;39m <==    Updates: 0
2022-08-26 19:02:15.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460381193506816 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 19:02:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460402131472384 [0;39m 生成今日电子书快照开始
2022-08-26 19:02:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460402131472384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:02:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460402131472384 [0;39m ==> Parameters: 
2022-08-26 19:02:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460402131472384 [0;39m <==    Updates: 0
2022-08-26 19:02:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460402131472384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 19:02:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460423107186688 [0;39m 生成今日电子书快照开始
2022-08-26 19:02:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460423107186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:02:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460423107186688 [0;39m ==> Parameters: 
2022-08-26 19:02:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460423107186688 [0;39m <==    Updates: 0
2022-08-26 19:02:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460423107186688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:02:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460444099678208 [0;39m 生成今日电子书快照开始
2022-08-26 19:02:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460444099678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:02:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460444099678208 [0;39m ==> Parameters: 
2022-08-26 19:02:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460444099678208 [0;39m <==    Updates: 0
2022-08-26 19:02:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460444099678208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:02:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460465075392512 [0;39m 生成今日电子书快照开始
2022-08-26 19:02:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460465075392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:02:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460465075392512 [0;39m ==> Parameters: 
2022-08-26 19:02:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460465075392512 [0;39m <==    Updates: 0
2022-08-26 19:02:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460465075392512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:02:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20460465083781120 [0;39m 更新电子书下的文档数据开始
2022-08-26 19:02:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460465083781120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 19:02:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460465083781120 [0;39m ==> Parameters: 
2022-08-26 19:02:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460465083781120 [0;39m <==    Updates: 8
2022-08-26 19:02:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20460465083781120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 19:02:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460486013358080 [0;39m 生成今日电子书快照开始
2022-08-26 19:02:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460486013358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:02:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460486013358080 [0;39m ==> Parameters: 
2022-08-26 19:02:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460486013358080 [0;39m <==    Updates: 0
2022-08-26 19:02:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460486013358080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:02:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460506997460992 [0;39m 生成今日电子书快照开始
2022-08-26 19:02:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460506997460992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:02:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460506997460992 [0;39m ==> Parameters: 
2022-08-26 19:02:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460506997460992 [0;39m <==    Updates: 0
2022-08-26 19:02:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460506997460992 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 19:02:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460527985758208 [0;39m 生成今日电子书快照开始
2022-08-26 19:02:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460527985758208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:02:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460527985758208 [0;39m ==> Parameters: 
2022-08-26 19:02:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460527985758208 [0;39m <==    Updates: 0
2022-08-26 19:02:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460527985758208 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 19:02:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460548927918080 [0;39m 生成今日电子书快照开始
2022-08-26 19:02:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460548927918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:02:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460548927918080 [0;39m ==> Parameters: 
2022-08-26 19:02:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460548927918080 [0;39m <==    Updates: 0
2022-08-26 19:02:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460548927918080 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 19:03:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460569895243776 [0;39m 生成今日电子书快照开始
2022-08-26 19:03:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460569895243776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:03:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460569895243776 [0;39m ==> Parameters: 
2022-08-26 19:03:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460569895243776 [0;39m <==    Updates: 0
2022-08-26 19:03:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460569895243776 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-26 19:03:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20460590887735296 [0;39m 更新电子书下的文档数据开始
2022-08-26 19:03:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460590887735296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 19:03:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460590887735296 [0;39m ==> Parameters: 
2022-08-26 19:03:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460590887735296 [0;39m <==    Updates: 8
2022-08-26 19:03:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20460590887735296 [0;39m 更新电子书下的文档数据结束，耗时：0 毫秒
2022-08-26 19:03:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460590887735297 [0;39m 生成今日电子书快照开始
2022-08-26 19:03:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460590887735297 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:03:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460590887735297 [0;39m ==> Parameters: 
2022-08-26 19:03:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460590887735297 [0;39m <==    Updates: 0
2022-08-26 19:03:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460590887735297 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 19:03:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460611846672384 [0;39m 生成今日电子书快照开始
2022-08-26 19:03:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460611846672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:03:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460611846672384 [0;39m ==> Parameters: 
2022-08-26 19:03:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460611846672384 [0;39m <==    Updates: 0
2022-08-26 19:03:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460611846672384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:03:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460632818192384 [0;39m 生成今日电子书快照开始
2022-08-26 19:03:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460632818192384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:03:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460632818192384 [0;39m ==> Parameters: 
2022-08-26 19:03:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460632818192384 [0;39m <==    Updates: 0
2022-08-26 19:03:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460632818192384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 19:03:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460653814878208 [0;39m 生成今日电子书快照开始
2022-08-26 19:03:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460653814878208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:03:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460653814878208 [0;39m ==> Parameters: 
2022-08-26 19:03:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460653814878208 [0;39m <==    Updates: 0
2022-08-26 19:03:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460653814878208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 19:03:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460674761232384 [0;39m 生成今日电子书快照开始
2022-08-26 19:03:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460674761232384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:03:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460674761232384 [0;39m ==> Parameters: 
2022-08-26 19:03:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460674761232384 [0;39m <==    Updates: 0
2022-08-26 19:03:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460674761232384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 19:03:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460695766306816 [0;39m 生成今日电子书快照开始
2022-08-26 19:03:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460695766306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:03:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460695766306816 [0;39m ==> Parameters: 
2022-08-26 19:03:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460695766306816 [0;39m <==    Updates: 0
2022-08-26 19:03:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460695766306816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:03:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460716712660992 [0;39m 生成今日电子书快照开始
2022-08-26 19:03:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460716712660992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:03:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460716712660992 [0;39m ==> Parameters: 
2022-08-26 19:03:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460716712660992 [0;39m <==    Updates: 0
2022-08-26 19:03:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460716712660992 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-26 19:03:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20460716746215424 [0;39m 更新电子书下的文档数据开始
2022-08-26 19:03:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460716746215424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 19:03:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460716746215424 [0;39m ==> Parameters: 
2022-08-26 19:03:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460716746215424 [0;39m <==    Updates: 8
2022-08-26 19:03:35.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20460716746215424 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-26 19:03:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460737688375296 [0;39m 生成今日电子书快照开始
2022-08-26 19:03:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460737688375296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:03:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460737688375296 [0;39m ==> Parameters: 
2022-08-26 19:03:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460737688375296 [0;39m <==    Updates: 0
2022-08-26 19:03:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460737688375296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:03:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460758634729472 [0;39m 生成今日电子书快照开始
2022-08-26 19:03:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460758634729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:03:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460758634729472 [0;39m ==> Parameters: 
2022-08-26 19:03:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460758634729472 [0;39m <==    Updates: 0
2022-08-26 19:03:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460758634729472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 19:03:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460779627220992 [0;39m 生成今日电子书快照开始
2022-08-26 19:03:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460779627220992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:03:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460779627220992 [0;39m ==> Parameters: 
2022-08-26 19:03:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460779627220992 [0;39m <==    Updates: 0
2022-08-26 19:03:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460779627220992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:03:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460800598740992 [0;39m 生成今日电子书快照开始
2022-08-26 19:03:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460800598740992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:03:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460800598740992 [0;39m ==> Parameters: 
2022-08-26 19:03:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460800598740992 [0;39m <==    Updates: 0
2022-08-26 19:03:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460800598740992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:04:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460821595426816 [0;39m 生成今日电子书快照开始
2022-08-26 19:04:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460821595426816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:04:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460821595426816 [0;39m ==> Parameters: 
2022-08-26 19:04:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460821595426816 [0;39m <==    Updates: 0
2022-08-26 19:04:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460821595426816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-26 19:04:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460842533392384 [0;39m 生成今日电子书快照开始
2022-08-26 19:04:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460842533392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:04:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460842533392384 [0;39m ==> Parameters: 
2022-08-26 19:04:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460842533392384 [0;39m <==    Updates: 0
2022-08-26 19:04:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460842533392384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:04:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20460842541780992 [0;39m 更新电子书下的文档数据开始
2022-08-26 19:04:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460842541780992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 19:04:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460842541780992 [0;39m ==> Parameters: 
2022-08-26 19:04:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460842541780992 [0;39m <==    Updates: 8
2022-08-26 19:04:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20460842541780992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 19:04:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460863542661120 [0;39m 生成今日电子书快照开始
2022-08-26 19:04:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460863542661120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:04:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460863542661120 [0;39m ==> Parameters: 
2022-08-26 19:04:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460863542661120 [0;39m <==    Updates: 0
2022-08-26 19:04:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460863542661120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 19:04:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460884522569728 [0;39m 生成今日电子书快照开始
2022-08-26 19:04:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460884522569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:04:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460884522569728 [0;39m ==> Parameters: 
2022-08-26 19:04:15.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460884522569728 [0;39m <==    Updates: 0
2022-08-26 19:04:15.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460884522569728 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-26 19:04:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460905435369472 [0;39m 生成今日电子书快照开始
2022-08-26 19:04:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460905435369472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:04:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460905435369472 [0;39m ==> Parameters: 
2022-08-26 19:04:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460905435369472 [0;39m <==    Updates: 0
2022-08-26 19:04:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460905435369472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:04:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460926427860992 [0;39m 生成今日电子书快照开始
2022-08-26 19:04:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460926427860992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:04:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460926427860992 [0;39m ==> Parameters: 
2022-08-26 19:04:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460926427860992 [0;39m <==    Updates: 0
2022-08-26 19:04:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460926427860992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:04:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460947416158208 [0;39m 生成今日电子书快照开始
2022-08-26 19:04:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460947416158208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:04:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460947416158208 [0;39m ==> Parameters: 
2022-08-26 19:04:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460947416158208 [0;39m <==    Updates: 0
2022-08-26 19:04:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460947416158208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:04:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460968358318080 [0;39m 生成今日电子书快照开始
2022-08-26 19:04:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460968358318080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:04:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460968358318080 [0;39m ==> Parameters: 
2022-08-26 19:04:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460968358318080 [0;39m <==    Updates: 0
2022-08-26 19:04:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460968358318080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-26 19:04:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m20460968370900992 [0;39m 更新电子书下的文档数据开始
2022-08-26 19:04:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460968370900992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-26 19:04:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460968370900992 [0;39m ==> Parameters: 
2022-08-26 19:04:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m20460968370900992 [0;39m <==    Updates: 8
2022-08-26 19:04:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m20460968370900992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-26 19:04:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20460989334032384 [0;39m 生成今日电子书快照开始
2022-08-26 19:04:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460989334032384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:04:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460989334032384 [0;39m ==> Parameters: 
2022-08-26 19:04:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20460989334032384 [0;39m <==    Updates: 0
2022-08-26 19:04:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20460989334032384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:04:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20461010297163776 [0;39m 生成今日电子书快照开始
2022-08-26 19:04:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20461010297163776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:04:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20461010297163776 [0;39m ==> Parameters: 
2022-08-26 19:04:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20461010297163776 [0;39m <==    Updates: 0
2022-08-26 19:04:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20461010297163776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:04:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m20461031268683776 [0;39m 生成今日电子书快照开始
2022-08-26 19:04:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20461031268683776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-26 19:04:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20461031268683776 [0;39m ==> Parameters: 
2022-08-26 19:04:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m20461031268683776 [0;39m <==    Updates: 0
2022-08-26 19:04:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m20461031268683776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-26 19:04:52.436 INFO  com.zs.wikibb.websocket.WebSocketServer           :41  
                [32m                  [0;39m 连接关闭，token：t1b0lbY4uB，session id：0！当前连接数：0
2022-08-26 19:04:52.479 INFO  com.zaxxer.hikari.HikariDataSource                :350 
                [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-08-26 19:04:52.484 INFO  com.zaxxer.hikari.HikariDataSource                :352 
                [32m                  [0;39m HikariPool-1 - Shutdown completed.
