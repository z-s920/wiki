2022-08-18 22:18:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17610771034935296 [0;39m 生成今日电子书快照开始
2022-08-18 22:18:55.079 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610771034935296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:18:55.080 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610771034935296 [0;39m ==> Parameters: 
2022-08-18 22:18:55.082 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610771034935296 [0;39m <==    Updates: 0
2022-08-18 22:18:55.082 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17610771034935296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:19:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17610792035815424 [0;39m 生成今日电子书快照开始
2022-08-18 22:19:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610792035815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:19:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610792035815424 [0;39m ==> Parameters: 
2022-08-18 22:19:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610792035815424 [0;39m <==    Updates: 0
2022-08-18 22:19:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17610792035815424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:19:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17610812998946816 [0;39m 生成今日电子书快照开始
2022-08-18 22:19:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610812998946816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:19:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610812998946816 [0;39m ==> Parameters: 
2022-08-18 22:19:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610812998946816 [0;39m <==    Updates: 0
2022-08-18 22:19:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17610812998946816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:19:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17610813015724032 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:19:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17610813015724032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:19:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17610813015724032 [0;39m ==> Parameters: 
2022-08-18 22:19:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17610813015724032 [0;39m <==    Updates: 7
2022-08-18 22:19:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17610813015724032 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:19:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17610833928523776 [0;39m 生成今日电子书快照开始
2022-08-18 22:19:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610833928523776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:19:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610833928523776 [0;39m ==> Parameters: 
2022-08-18 22:19:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610833928523776 [0;39m <==    Updates: 0
2022-08-18 22:19:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17610833928523776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:19:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17610854912626688 [0;39m 生成今日电子书快照开始
2022-08-18 22:19:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610854912626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:19:15.092 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610854912626688 [0;39m ==> Parameters: 
2022-08-18 22:19:15.094 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610854912626688 [0;39m <==    Updates: 0
2022-08-18 22:19:15.094 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17610854912626688 [0;39m 生成今日电子书快照结束，耗时：88 毫秒
2022-08-18 22:19:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17610875917701120 [0;39m 生成今日电子书快照开始
2022-08-18 22:19:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610875917701120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:19:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610875917701120 [0;39m ==> Parameters: 
2022-08-18 22:19:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610875917701120 [0;39m <==    Updates: 0
2022-08-18 22:19:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17610875917701120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:19:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17610896876638208 [0;39m 生成今日电子书快照开始
2022-08-18 22:19:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610896876638208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:19:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610896876638208 [0;39m ==> Parameters: 
2022-08-18 22:19:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610896876638208 [0;39m <==    Updates: 0
2022-08-18 22:19:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17610896876638208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:19:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17610917835575296 [0;39m 生成今日电子书快照开始
2022-08-18 22:19:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610917835575296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:19:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610917835575296 [0;39m ==> Parameters: 
2022-08-18 22:19:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610917835575296 [0;39m <==    Updates: 0
2022-08-18 22:19:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17610917835575296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:19:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17610938836455424 [0;39m 生成今日电子书快照开始
2022-08-18 22:19:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610938836455424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:19:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610938836455424 [0;39m ==> Parameters: 
2022-08-18 22:19:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610938836455424 [0;39m <==    Updates: 0
2022-08-18 22:19:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17610938836455424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:19:35.017 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17610938849038336 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:19:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17610938849038336 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:19:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17610938849038336 [0;39m ==> Parameters: 
2022-08-18 22:19:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17610938849038336 [0;39m <==    Updates: 7
2022-08-18 22:19:35.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17610938849038336 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:19:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17610959799586816 [0;39m 生成今日电子书快照开始
2022-08-18 22:19:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610959799586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:19:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610959799586816 [0;39m ==> Parameters: 
2022-08-18 22:19:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610959799586816 [0;39m <==    Updates: 0
2022-08-18 22:19:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17610959799586816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:19:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17610980729163776 [0;39m 生成今日电子书快照开始
2022-08-18 22:19:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610980729163776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:19:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610980729163776 [0;39m ==> Parameters: 
2022-08-18 22:19:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17610980729163776 [0;39m <==    Updates: 0
2022-08-18 22:19:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17610980729163776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:19:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611001738432512 [0;39m 生成今日电子书快照开始
2022-08-18 22:19:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611001738432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:19:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611001738432512 [0;39m ==> Parameters: 
2022-08-18 22:19:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611001738432512 [0;39m <==    Updates: 0
2022-08-18 22:19:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611001738432512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:19:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611022684786688 [0;39m 生成今日电子书快照开始
2022-08-18 22:19:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611022684786688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:19:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611022684786688 [0;39m ==> Parameters: 
2022-08-18 22:19:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611022684786688 [0;39m <==    Updates: 0
2022-08-18 22:19:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611022684786688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:20:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611043652112384 [0;39m 生成今日电子书快照开始
2022-08-18 22:20:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611043652112384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:20:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611043652112384 [0;39m ==> Parameters: 
2022-08-18 22:20:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611043652112384 [0;39m <==    Updates: 0
2022-08-18 22:20:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611043652112384 [0;39m 生成今日电子书快照结束，耗时：12 毫秒
2022-08-18 22:20:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17611064636215296 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:20:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611064636215296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:20:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611064636215296 [0;39m ==> Parameters: 
2022-08-18 22:20:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611064636215296 [0;39m <==    Updates: 7
2022-08-18 22:20:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17611064636215296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:20:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611064644603904 [0;39m 生成今日电子书快照开始
2022-08-18 22:20:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611064644603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:20:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611064644603904 [0;39m ==> Parameters: 
2022-08-18 22:20:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611064644603904 [0;39m <==    Updates: 0
2022-08-18 22:20:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611064644603904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:20:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611085620318208 [0;39m 生成今日电子书快照开始
2022-08-18 22:20:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611085620318208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:20:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611085620318208 [0;39m ==> Parameters: 
2022-08-18 22:20:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611085620318208 [0;39m <==    Updates: 0
2022-08-18 22:20:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611085620318208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:20:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611106608615424 [0;39m 生成今日电子书快照开始
2022-08-18 22:20:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611106608615424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:20:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611106608615424 [0;39m ==> Parameters: 
2022-08-18 22:20:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611106608615424 [0;39m <==    Updates: 0
2022-08-18 22:20:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611106608615424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:20:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611127546580992 [0;39m 生成今日电子书快照开始
2022-08-18 22:20:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611127546580992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:20:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611127546580992 [0;39m ==> Parameters: 
2022-08-18 22:20:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611127546580992 [0;39m <==    Updates: 0
2022-08-18 22:20:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611127546580992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:20:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611148543266816 [0;39m 生成今日电子书快照开始
2022-08-18 22:20:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611148543266816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:20:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611148543266816 [0;39m ==> Parameters: 
2022-08-18 22:20:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611148543266816 [0;39m <==    Updates: 0
2022-08-18 22:20:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611148543266816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:20:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611169498009600 [0;39m 生成今日电子书快照开始
2022-08-18 22:20:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611169498009600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:20:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611169498009600 [0;39m ==> Parameters: 
2022-08-18 22:20:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611169498009600 [0;39m <==    Updates: 0
2022-08-18 22:20:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611169498009600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:20:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611190477918208 [0;39m 生成今日电子书快照开始
2022-08-18 22:20:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611190477918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:20:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611190477918208 [0;39m ==> Parameters: 
2022-08-18 22:20:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611190477918208 [0;39m <==    Updates: 0
2022-08-18 22:20:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611190477918208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:20:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17611190490501120 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:20:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611190490501120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:20:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611190490501120 [0;39m ==> Parameters: 
2022-08-18 22:20:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611190490501120 [0;39m <==    Updates: 7
2022-08-18 22:20:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17611190490501120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:20:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611211411689472 [0;39m 生成今日电子书快照开始
2022-08-18 22:20:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611211411689472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:20:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611211411689472 [0;39m ==> Parameters: 
2022-08-18 22:20:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611211411689472 [0;39m <==    Updates: 0
2022-08-18 22:20:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611211411689472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:20:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611232391598080 [0;39m 生成今日电子书快照开始
2022-08-18 22:20:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611232391598080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:20:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611232391598080 [0;39m ==> Parameters: 
2022-08-18 22:20:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611232391598080 [0;39m <==    Updates: 0
2022-08-18 22:20:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611232391598080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:20:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611253375700992 [0;39m 生成今日电子书快照开始
2022-08-18 22:20:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611253375700992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:20:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611253375700992 [0;39m ==> Parameters: 
2022-08-18 22:20:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611253375700992 [0;39m <==    Updates: 0
2022-08-18 22:20:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611253375700992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:20:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611274347220992 [0;39m 生成今日电子书快照开始
2022-08-18 22:20:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611274347220992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:20:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611274347220992 [0;39m ==> Parameters: 
2022-08-18 22:20:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611274347220992 [0;39m <==    Updates: 0
2022-08-18 22:20:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611274347220992 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-18 22:21:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611295339712512 [0;39m 生成今日电子书快照开始
2022-08-18 22:21:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611295339712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:21:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611295339712512 [0;39m ==> Parameters: 
2022-08-18 22:21:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611295339712512 [0;39m <==    Updates: 0
2022-08-18 22:21:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611295339712512 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 22:21:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611316302843904 [0;39m 生成今日电子书快照开始
2022-08-18 22:21:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611316302843904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:21:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611316302843904 [0;39m ==> Parameters: 
2022-08-18 22:21:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611316302843904 [0;39m <==    Updates: 0
2022-08-18 22:21:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611316302843904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:21:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17611316315426816 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:21:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611316315426816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:21:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611316315426816 [0;39m ==> Parameters: 
2022-08-18 22:21:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611316315426816 [0;39m <==    Updates: 7
2022-08-18 22:21:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17611316315426816 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:21:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611337265975296 [0;39m 生成今日电子书快照开始
2022-08-18 22:21:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611337265975296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:21:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611337265975296 [0;39m ==> Parameters: 
2022-08-18 22:21:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611337265975296 [0;39m <==    Updates: 0
2022-08-18 22:21:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611337265975296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:21:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611358262661120 [0;39m 生成今日电子书快照开始
2022-08-18 22:21:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611358262661120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:21:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611358262661120 [0;39m ==> Parameters: 
2022-08-18 22:21:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611358262661120 [0;39m <==    Updates: 0
2022-08-18 22:21:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611358262661120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:21:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611379204820992 [0;39m 生成今日电子书快照开始
2022-08-18 22:21:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611379204820992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:21:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611379204820992 [0;39m ==> Parameters: 
2022-08-18 22:21:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611379204820992 [0;39m <==    Updates: 0
2022-08-18 22:21:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611379204820992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:21:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611400167952384 [0;39m 生成今日电子书快照开始
2022-08-18 22:21:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611400167952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:21:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611400167952384 [0;39m ==> Parameters: 
2022-08-18 22:21:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611400167952384 [0;39m <==    Updates: 0
2022-08-18 22:21:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611400167952384 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-18 22:21:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611421168832512 [0;39m 生成今日电子书快照开始
2022-08-18 22:21:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611421168832512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:21:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611421168832512 [0;39m ==> Parameters: 
2022-08-18 22:21:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611421168832512 [0;39m <==    Updates: 0
2022-08-18 22:21:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611421168832512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:21:35.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611442098409472 [0;39m 生成今日电子书快照开始
2022-08-18 22:21:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611442098409472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:21:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611442098409472 [0;39m ==> Parameters: 
2022-08-18 22:21:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611442098409472 [0;39m <==    Updates: 0
2022-08-18 22:21:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611442098409472 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:21:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17611442106798080 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:21:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611442106798080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:21:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611442106798080 [0;39m ==> Parameters: 
2022-08-18 22:21:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611442106798080 [0;39m <==    Updates: 7
2022-08-18 22:21:35.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17611442106798080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:21:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611463099289600 [0;39m 生成今日电子书快照开始
2022-08-18 22:21:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611463099289600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:21:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611463099289600 [0;39m ==> Parameters: 
2022-08-18 22:21:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611463099289600 [0;39m <==    Updates: 0
2022-08-18 22:21:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611463099289600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:21:40.093 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17611463455805440 [0;39m ------------- 开始 -------------
2022-08-18 22:21:40.094 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17611463455805440 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2022-08-18 22:21:40.094 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17611463455805440 [0;39m 类名方法: com.zs.wikibb.controller.CategoryController.all
2022-08-18 22:21:40.094 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17611463455805440 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:21:40.095 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17611463455805440 [0;39m 请求参数: []
2022-08-18 22:21:40.096 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m17611463455805440 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-08-18 22:21:40.096 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m17611463455805440 [0;39m ==> Parameters: 
2022-08-18 22:21:40.098 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==    Columns: id, parent, name, sort
2022-08-18 22:21:40.098 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 100, 0, 前端开发, 100
2022-08-18 22:21:40.099 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 101, 100, Vue, 101
2022-08-18 22:21:40.099 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-08-18 22:21:40.100 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 200, 0, Java, 200
2022-08-18 22:21:40.100 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 201, 200, 基础应用, 201
2022-08-18 22:21:40.101 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 202, 200, 框架应用, 202
2022-08-18 22:21:40.101 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 181311914796781568, 200, SpringBoot+Vue3 前后端分离知识库系统, 231
2022-08-18 22:21:40.102 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 300, 0, Python, 300
2022-08-18 22:21:40.102 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 301, 300, 基础应用, 301
2022-08-18 22:21:40.103 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2022-08-18 22:21:40.103 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 400, 0, 数据库, 400
2022-08-18 22:21:40.104 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 401, 400, MySQL, 401
2022-08-18 22:21:40.104 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 500, 0, 其它, 500
2022-08-18 22:21:40.105 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 501, 500, 服务器, 501
2022-08-18 22:21:40.105 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 502, 500, 开发工具, 502
2022-08-18 22:21:40.106 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611463455805440 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2022-08-18 22:21:40.106 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m17611463455805440 [0;39m <==      Total: 16
2022-08-18 22:21:40.107 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17611463455805440 [0;39m 返回结果: {"content":[{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":181311914796781568,"name":"SpringBoot+Vue3 前后端分离知识库系统","parent":200,"sort":231},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2022-08-18 22:21:40.107 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17611463455805440 [0;39m ------------- 结束 耗时：14 ms -------------
2022-08-18 22:21:40.950 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17611467050323968 [0;39m ------------- 开始 -------------
2022-08-18 22:21:40.950 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17611467050323968 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2022-08-18 22:21:40.950 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17611467050323968 [0;39m 类名方法: com.zs.wikibb.controller.CategoryController.all
2022-08-18 22:21:40.950 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17611467050323968 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:21:40.950 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17611467050323968 [0;39m 请求参数: []
2022-08-18 22:21:40.951 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m17611467050323968 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-08-18 22:21:40.951 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m17611467050323968 [0;39m ==> Parameters: 
2022-08-18 22:21:40.952 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==    Columns: id, parent, name, sort
2022-08-18 22:21:40.952 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 100, 0, 前端开发, 100
2022-08-18 22:21:40.953 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 101, 100, Vue, 101
2022-08-18 22:21:40.953 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-08-18 22:21:40.953 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 200, 0, Java, 200
2022-08-18 22:21:40.954 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 201, 200, 基础应用, 201
2022-08-18 22:21:40.954 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 202, 200, 框架应用, 202
2022-08-18 22:21:40.954 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 181311914796781568, 200, SpringBoot+Vue3 前后端分离知识库系统, 231
2022-08-18 22:21:40.954 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 300, 0, Python, 300
2022-08-18 22:21:40.955 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 301, 300, 基础应用, 301
2022-08-18 22:21:40.955 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2022-08-18 22:21:40.955 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 400, 0, 数据库, 400
2022-08-18 22:21:40.955 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 401, 400, MySQL, 401
2022-08-18 22:21:40.956 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 500, 0, 其它, 500
2022-08-18 22:21:40.956 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 501, 500, 服务器, 501
2022-08-18 22:21:40.956 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 502, 500, 开发工具, 502
2022-08-18 22:21:40.956 TRACE c.zs.wikibb.mapper.CategoryMapper.selectByExample :143 
                [32m17611467050323968 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2022-08-18 22:21:40.957 DEBUG c.zs.wikibb.mapper.CategoryMapper.selectByExample :137 
                [32m17611467050323968 [0;39m <==      Total: 16
2022-08-18 22:21:40.958 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17611467050323968 [0;39m 返回结果: {"content":[{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":181311914796781568,"name":"SpringBoot+Vue3 前后端分离知识库系统","parent":200,"sort":231},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2022-08-18 22:21:40.959 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17611467050323968 [0;39m ------------- 结束 耗时：9 ms -------------
2022-08-18 22:21:40.986 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17611467201318912 [0;39m ------------- 开始 -------------
2022-08-18 22:21:40.986 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17611467201318912 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-18 22:21:40.987 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17611467201318912 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-18 22:21:40.987 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17611467201318912 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:21:40.988 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17611467201318912 [0;39m 请求参数: [{"page":1,"size":4}]
2022-08-18 22:21:40.997 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m17611467201318912 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-08-18 22:21:40.997 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m17611467201318912 [0;39m ==> Parameters: 
2022-08-18 22:21:40.998 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m17611467201318912 [0;39m <==    Columns: count(0)
2022-08-18 22:21:40.998 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m17611467201318912 [0;39m <==        Row: 7
2022-08-18 22:21:40.998 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m17611467201318912 [0;39m <==      Total: 1
2022-08-18 22:21:40.999 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m17611467201318912 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-08-18 22:21:40.999 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m17611467201318912 [0;39m ==> Parameters: 4(Integer)
2022-08-18 22:21:41.000 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m17611467201318912 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-18 22:21:41.000 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m17611467201318912 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover1.png, 4, 62, 10
2022-08-18 22:21:41.000 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m17611467201318912 [0;39m <==        Row: 2, Vue 入门教程, 100, 503, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover2.png, 7, 39, 10
2022-08-18 22:21:41.001 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m17611467201318912 [0;39m <==        Row: 3, Python 入门教程, 200, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 2, 1
2022-08-18 22:21:41.001 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m17611467201318912 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, /image/cover2.png, 1, 1, 0
2022-08-18 22:21:41.001 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m17611467201318912 [0;39m <==      Total: 4
2022-08-18 22:21:41.001 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m17611467201318912 [0;39m 总行数：7
2022-08-18 22:21:41.001 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m17611467201318912 [0;39m 总页数：2
2022-08-18 22:21:41.007 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17611467201318912 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover1.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":4,"id":1,"name":"Spring Boot 入门教程","viewCount":62,"voteCount":10},{"category1Id":100,"category2Id":503,"cover":"/image/cover2.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":7,"id":2,"name":"Vue 入门教程","viewCount":39,"voteCount":10},{"category1Id":200,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python 入门教程","viewCount":2,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":1,"voteCount":0}],"total":7},"success":true}
2022-08-18 22:21:41.008 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17611467201318912 [0;39m ------------- 结束 耗时：22 ms -------------
2022-08-18 22:21:42.852 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17611475027890176 [0;39m ------------- 开始 -------------
2022-08-18 22:21:42.852 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17611475027890176 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2022-08-18 22:21:42.852 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17611475027890176 [0;39m 类名方法: com.zs.wikibb.controller.EbookController.list
2022-08-18 22:21:42.852 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17611475027890176 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:21:42.852 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17611475027890176 [0;39m 请求参数: [{"page":2,"size":4}]
2022-08-18 22:21:42.854 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m17611475027890176 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-08-18 22:21:42.854 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m17611475027890176 [0;39m ==> Parameters: 
2022-08-18 22:21:42.855 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m17611475027890176 [0;39m <==    Columns: count(0)
2022-08-18 22:21:42.855 TRACE c.z.w.mapper.EbookMapper.selectByExample_COUNT    :143 
                [32m17611475027890176 [0;39m <==        Row: 7
2022-08-18 22:21:42.856 DEBUG c.z.w.mapper.EbookMapper.selectByExample_COUNT    :137 
                [32m17611475027890176 [0;39m <==      Total: 1
2022-08-18 22:21:42.856 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m17611475027890176 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?, ?
2022-08-18 22:21:42.856 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m17611475027890176 [0;39m ==> Parameters: 4(Long), 4(Integer)
2022-08-18 22:21:42.857 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m17611475027890176 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-08-18 22:21:42.857 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m17611475027890176 [0;39m <==        Row: 5, Oracle入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 0, 0
2022-08-18 22:21:42.858 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m17611475027890176 [0;39m <==        Row: 6, Vue CLI 入门教程, 100, 101, Vue CLI 用于快速搭建基于VUE的前端, /image/cover1.png, 1, 9, 1
2022-08-18 22:21:42.858 TRACE com.zs.wikibb.mapper.EbookMapper.selectByExample  :143 
                [32m17611475027890176 [0;39m <==        Row: 202714600712572928, Wiki个人知识库, 200, 181311914796781568, 本文档讲述了知识库的开发过程以及遇到的问题！, /image/cover2.png, 12, 229, 32
2022-08-18 22:21:42.859 DEBUG com.zs.wikibb.mapper.EbookMapper.selectByExample  :137 
                [32m17611475027890176 [0;39m <==      Total: 3
2022-08-18 22:21:42.859 INFO  com.zs.wikibb.service.EbookService                :46  
                [32m17611475027890176 [0;39m 总行数：7
2022-08-18 22:21:42.860 INFO  com.zs.wikibb.service.EbookService                :47  
                [32m17611475027890176 [0;39m 总页数：2
2022-08-18 22:21:42.860 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17611475027890176 [0;39m 返回结果: {"content":{"list":[{"category1Id":400,"category2Id":401,"cover":"/image/cover1.png","description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle入门教程","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"Vue CLI 用于快速搭建基于VUE的前端","docCount":1,"id":6,"name":"Vue CLI 入门教程","viewCount":9,"voteCount":1},{"category1Id":200,"category2Id":181311914796781568,"cover":"/image/cover2.png","description":"本文档讲述了知识库的开发过程以及遇到的问题！","docCount":12,"id":202714600712572928,"name":"Wiki个人知识库","viewCount":229,"voteCount":32}],"total":7},"success":true}
2022-08-18 22:21:42.860 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17611475027890176 [0;39m ------------- 结束 耗时：8 ms -------------
2022-08-18 22:21:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611484049838080 [0;39m 生成今日电子书快照开始
2022-08-18 22:21:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611484049838080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:21:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611484049838080 [0;39m ==> Parameters: 
2022-08-18 22:21:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611484049838080 [0;39m <==    Updates: 0
2022-08-18 22:21:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611484049838080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:21:45.287 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17611485241020416 [0;39m ------------- 开始 -------------
2022-08-18 22:21:45.287 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17611485241020416 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-18 22:21:45.287 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17611485241020416 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-18 22:21:45.287 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17611485241020416 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:21:45.287 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17611485241020416 [0;39m 请求参数: [202714600712572928]
2022-08-18 22:21:45.294 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17611485241020416 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-18 22:21:45.294 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17611485241020416 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-18 22:21:45.295 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17611485241020416 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-18 22:21:45.295 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17611485241020416 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 47, 5
2022-08-18 22:21:45.296 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17611485241020416 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 39, 4
2022-08-18 22:21:45.296 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17611485241020416 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-18 22:21:45.296 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17611485241020416 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 21, 3
2022-08-18 22:21:45.296 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17611485241020416 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 25, 5
2022-08-18 22:21:45.297 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17611485241020416 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 23, 2
2022-08-18 22:21:45.297 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17611485241020416 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 9, 2
2022-08-18 22:21:45.297 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17611485241020416 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 9, 3
2022-08-18 22:21:45.297 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17611485241020416 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 9, 1
2022-08-18 22:21:45.297 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17611485241020416 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 7, 1
2022-08-18 22:21:45.298 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17611485241020416 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 4, 1
2022-08-18 22:21:45.298 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17611485241020416 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 3, 2
2022-08-18 22:21:45.298 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17611485241020416 [0;39m <==      Total: 12
2022-08-18 22:21:45.310 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17611485241020416 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":47,"voteCount":5},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":39,"voteCount":4},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":21,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":25,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":23,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":9,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":9,"voteCount":3},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":7,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":4,"voteCount":1},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":3,"voteCount":2}],"success":true}
2022-08-18 22:21:45.311 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17611485241020416 [0;39m ------------- 结束 耗时：24 ms -------------
2022-08-18 22:21:47.901 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17611496204931072 [0;39m ------------- 开始 -------------
2022-08-18 22:21:47.901 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17611496204931072 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202715583089872896 GET
2022-08-18 22:21:47.901 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17611496204931072 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-18 22:21:47.901 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17611496204931072 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:21:47.901 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17611496204931072 [0;39m 请求参数: [202715583089872896]
2022-08-18 22:21:47.902 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17611496204931072 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-18 22:21:47.903 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17611496204931072 [0;39m ==> Parameters: 202715583089872896(Long)
2022-08-18 22:21:47.905 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17611496204931072 [0;39m <==    Columns: id, content
2022-08-18 22:21:47.906 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17611496204931072 [0;39m <==        Row: 202715583089872896, <<BLOB>>
2022-08-18 22:21:47.906 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17611496204931072 [0;39m <==      Total: 1
2022-08-18 22:21:47.908 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17611496204931072 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-18 22:21:47.909 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17611496204931072 [0;39m ==> Parameters: 202715583089872896(Long)
2022-08-18 22:21:47.981 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17611496204931072 [0;39m <==    Updates: 1
2022-08-18 22:21:47.982 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17611496204931072 [0;39m 返回结果: {"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote>","success":true}
2022-08-18 22:21:47.982 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17611496204931072 [0;39m ------------- 结束 耗时：81 ms -------------
2022-08-18 22:21:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611505042329600 [0;39m 生成今日电子书快照开始
2022-08-18 22:21:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611505042329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:21:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611505042329600 [0;39m ==> Parameters: 
2022-08-18 22:21:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611505042329600 [0;39m <==    Updates: 0
2022-08-18 22:21:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611505042329600 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-18 22:21:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611526018043904 [0;39m 生成今日电子书快照开始
2022-08-18 22:21:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611526018043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:21:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611526018043904 [0;39m ==> Parameters: 
2022-08-18 22:21:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611526018043904 [0;39m <==    Updates: 0
2022-08-18 22:21:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611526018043904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:22:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611546989563904 [0;39m 生成今日电子书快照开始
2022-08-18 22:22:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611546989563904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:22:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611546989563904 [0;39m ==> Parameters: 
2022-08-18 22:22:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611546989563904 [0;39m <==    Updates: 0
2022-08-18 22:22:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611546989563904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:22:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611567973666816 [0;39m 生成今日电子书快照开始
2022-08-18 22:22:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611567973666816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:22:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611567973666816 [0;39m ==> Parameters: 
2022-08-18 22:22:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611567973666816 [0;39m <==    Updates: 0
2022-08-18 22:22:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611567973666816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:22:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17611567986249728 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:22:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611567986249728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:22:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611567986249728 [0;39m ==> Parameters: 
2022-08-18 22:22:05.130 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611567986249728 [0;39m <==    Updates: 7
2022-08-18 22:22:05.130 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17611567986249728 [0;39m 更新电子书下的文档数据结束，耗时：115 毫秒
2022-08-18 22:22:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611588949381120 [0;39m 生成今日电子书快照开始
2022-08-18 22:22:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611588949381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:22:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611588949381120 [0;39m ==> Parameters: 
2022-08-18 22:22:10.069 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611588949381120 [0;39m <==    Updates: 0
2022-08-18 22:22:10.069 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611588949381120 [0;39m 生成今日电子书快照结束，耗时：56 毫秒
2022-08-18 22:22:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611609878958080 [0;39m 生成今日电子书快照开始
2022-08-18 22:22:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611609878958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:22:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611609878958080 [0;39m ==> Parameters: 
2022-08-18 22:22:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611609878958080 [0;39m <==    Updates: 0
2022-08-18 22:22:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611609878958080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:22:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611630846283776 [0;39m 生成今日电子书快照开始
2022-08-18 22:22:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611630846283776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:22:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611630846283776 [0;39m ==> Parameters: 
2022-08-18 22:22:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611630846283776 [0;39m <==    Updates: 0
2022-08-18 22:22:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611630846283776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:22:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611651863941120 [0;39m 生成今日电子书快照开始
2022-08-18 22:22:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611651863941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:22:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611651863941120 [0;39m ==> Parameters: 
2022-08-18 22:22:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611651863941120 [0;39m <==    Updates: 0
2022-08-18 22:22:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611651863941120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:22:30.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611672780935168 [0;39m 生成今日电子书快照开始
2022-08-18 22:22:30.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611672780935168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:22:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611672780935168 [0;39m ==> Parameters: 
2022-08-18 22:22:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611672780935168 [0;39m <==    Updates: 0
2022-08-18 22:22:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611672780935168 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:22:35.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611693756649472 [0;39m 生成今日电子书快照开始
2022-08-18 22:22:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611693756649472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:22:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611693756649472 [0;39m ==> Parameters: 
2022-08-18 22:22:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611693756649472 [0;39m <==    Updates: 0
2022-08-18 22:22:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611693756649472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:22:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17611693769232384 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:22:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611693769232384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:22:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611693769232384 [0;39m ==> Parameters: 
2022-08-18 22:22:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611693769232384 [0;39m <==    Updates: 7
2022-08-18 22:22:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17611693769232384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:22:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611714761723904 [0;39m 生成今日电子书快照开始
2022-08-18 22:22:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611714761723904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:22:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611714761723904 [0;39m ==> Parameters: 
2022-08-18 22:22:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611714761723904 [0;39m <==    Updates: 0
2022-08-18 22:22:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611714761723904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:22:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611735750021120 [0;39m 生成今日电子书快照开始
2022-08-18 22:22:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611735750021120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:22:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611735750021120 [0;39m ==> Parameters: 
2022-08-18 22:22:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611735750021120 [0;39m <==    Updates: 0
2022-08-18 22:22:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611735750021120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:22:50.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611756671209472 [0;39m 生成今日电子书快照开始
2022-08-18 22:22:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611756671209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:22:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611756671209472 [0;39m ==> Parameters: 
2022-08-18 22:22:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611756671209472 [0;39m <==    Updates: 0
2022-08-18 22:22:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611756671209472 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:22:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611777646923776 [0;39m 生成今日电子书快照开始
2022-08-18 22:22:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611777646923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:22:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611777646923776 [0;39m ==> Parameters: 
2022-08-18 22:22:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611777646923776 [0;39m <==    Updates: 0
2022-08-18 22:22:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611777646923776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:23:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611798656192512 [0;39m 生成今日电子书快照开始
2022-08-18 22:23:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611798656192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:23:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611798656192512 [0;39m ==> Parameters: 
2022-08-18 22:23:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611798656192512 [0;39m <==    Updates: 0
2022-08-18 22:23:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611798656192512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:23:05.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611819585769472 [0;39m 生成今日电子书快照开始
2022-08-18 22:23:05.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611819585769472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:23:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611819585769472 [0;39m ==> Parameters: 
2022-08-18 22:23:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611819585769472 [0;39m <==    Updates: 0
2022-08-18 22:23:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611819585769472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:23:05.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17611819594158080 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:23:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611819594158080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:23:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611819594158080 [0;39m ==> Parameters: 
2022-08-18 22:23:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611819594158080 [0;39m <==    Updates: 7
2022-08-18 22:23:05.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17611819594158080 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:23:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611840620204032 [0;39m 生成今日电子书快照开始
2022-08-18 22:23:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611840620204032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:23:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611840620204032 [0;39m ==> Parameters: 
2022-08-18 22:23:10.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611840620204032 [0;39m <==    Updates: 0
2022-08-18 22:23:10.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611840620204032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:23:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611861558169600 [0;39m 生成今日电子书快照开始
2022-08-18 22:23:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611861558169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:23:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611861558169600 [0;39m ==> Parameters: 
2022-08-18 22:23:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611861558169600 [0;39m <==    Updates: 0
2022-08-18 22:23:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611861558169600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:23:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611882504523776 [0;39m 生成今日电子书快照开始
2022-08-18 22:23:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611882504523776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:23:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611882504523776 [0;39m ==> Parameters: 
2022-08-18 22:23:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611882504523776 [0;39m <==    Updates: 0
2022-08-18 22:23:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611882504523776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:23:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611903497015296 [0;39m 生成今日电子书快照开始
2022-08-18 22:23:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611903497015296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:23:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611903497015296 [0;39m ==> Parameters: 
2022-08-18 22:23:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611903497015296 [0;39m <==    Updates: 0
2022-08-18 22:23:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611903497015296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:23:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611924485312512 [0;39m 生成今日电子书快照开始
2022-08-18 22:23:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611924485312512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:23:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611924485312512 [0;39m ==> Parameters: 
2022-08-18 22:23:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611924485312512 [0;39m <==    Updates: 0
2022-08-18 22:23:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611924485312512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:23:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611945431666688 [0;39m 生成今日电子书快照开始
2022-08-18 22:23:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611945431666688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:23:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611945431666688 [0;39m ==> Parameters: 
2022-08-18 22:23:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611945431666688 [0;39m <==    Updates: 0
2022-08-18 22:23:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611945431666688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:23:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17611945440055296 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:23:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611945440055296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:23:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611945440055296 [0;39m ==> Parameters: 
2022-08-18 22:23:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17611945440055296 [0;39m <==    Updates: 7
2022-08-18 22:23:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17611945440055296 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:23:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611966415769600 [0;39m 生成今日电子书快照开始
2022-08-18 22:23:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611966415769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:23:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611966415769600 [0;39m ==> Parameters: 
2022-08-18 22:23:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611966415769600 [0;39m <==    Updates: 0
2022-08-18 22:23:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611966415769600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:23:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17611987399872512 [0;39m 生成今日电子书快照开始
2022-08-18 22:23:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611987399872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:23:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611987399872512 [0;39m ==> Parameters: 
2022-08-18 22:23:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17611987399872512 [0;39m <==    Updates: 0
2022-08-18 22:23:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17611987399872512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:23:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612008379781120 [0;39m 生成今日电子书快照开始
2022-08-18 22:23:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612008379781120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:23:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612008379781120 [0;39m ==> Parameters: 
2022-08-18 22:23:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612008379781120 [0;39m <==    Updates: 0
2022-08-18 22:23:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612008379781120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:23:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612029334523904 [0;39m 生成今日电子书快照开始
2022-08-18 22:23:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612029334523904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:23:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612029334523904 [0;39m ==> Parameters: 
2022-08-18 22:23:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612029334523904 [0;39m <==    Updates: 0
2022-08-18 22:23:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612029334523904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:24:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612050331209728 [0;39m 生成今日电子书快照开始
2022-08-18 22:24:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612050331209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:24:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612050331209728 [0;39m ==> Parameters: 
2022-08-18 22:24:00.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612050331209728 [0;39m <==    Updates: 0
2022-08-18 22:24:00.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612050331209728 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 22:24:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17612071273369600 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:24:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612071273369600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:24:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612071273369600 [0;39m ==> Parameters: 
2022-08-18 22:24:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612071273369600 [0;39m <==    Updates: 7
2022-08-18 22:24:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17612071273369600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:24:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612071277563904 [0;39m 生成今日电子书快照开始
2022-08-18 22:24:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612071277563904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:24:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612071277563904 [0;39m ==> Parameters: 
2022-08-18 22:24:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612071277563904 [0;39m <==    Updates: 0
2022-08-18 22:24:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612071277563904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:24:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612092244889600 [0;39m 生成今日电子书快照开始
2022-08-18 22:24:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612092244889600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:24:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612092244889600 [0;39m ==> Parameters: 
2022-08-18 22:24:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612092244889600 [0;39m <==    Updates: 0
2022-08-18 22:24:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612092244889600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:24:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612113187049472 [0;39m 生成今日电子书快照开始
2022-08-18 22:24:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612113187049472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:24:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612113187049472 [0;39m ==> Parameters: 
2022-08-18 22:24:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612113187049472 [0;39m <==    Updates: 0
2022-08-18 22:24:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612113187049472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:24:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612134183735296 [0;39m 生成今日电子书快照开始
2022-08-18 22:24:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612134183735296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:24:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612134183735296 [0;39m ==> Parameters: 
2022-08-18 22:24:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612134183735296 [0;39m <==    Updates: 0
2022-08-18 22:24:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612134183735296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:24:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612155155255296 [0;39m 生成今日电子书快照开始
2022-08-18 22:24:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612155155255296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:24:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612155155255296 [0;39m ==> Parameters: 
2022-08-18 22:24:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612155155255296 [0;39m <==    Updates: 0
2022-08-18 22:24:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612155155255296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:24:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612176164524032 [0;39m 生成今日电子书快照开始
2022-08-18 22:24:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612176164524032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:24:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612176164524032 [0;39m ==> Parameters: 
2022-08-18 22:24:30.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612176164524032 [0;39m <==    Updates: 0
2022-08-18 22:24:30.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612176164524032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:24:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612197098295296 [0;39m 生成今日电子书快照开始
2022-08-18 22:24:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612197098295296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:24:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612197098295296 [0;39m ==> Parameters: 
2022-08-18 22:24:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612197098295296 [0;39m <==    Updates: 0
2022-08-18 22:24:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612197098295296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:24:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17612197110878208 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:24:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612197110878208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:24:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612197110878208 [0;39m ==> Parameters: 
2022-08-18 22:24:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612197110878208 [0;39m <==    Updates: 7
2022-08-18 22:24:35.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17612197110878208 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:24:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612218053038080 [0;39m 生成今日电子书快照开始
2022-08-18 22:24:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612218053038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:24:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612218053038080 [0;39m ==> Parameters: 
2022-08-18 22:24:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612218053038080 [0;39m <==    Updates: 0
2022-08-18 22:24:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612218053038080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:24:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612239053918208 [0;39m 生成今日电子书快照开始
2022-08-18 22:24:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612239053918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:24:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612239053918208 [0;39m ==> Parameters: 
2022-08-18 22:24:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612239053918208 [0;39m <==    Updates: 0
2022-08-18 22:24:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612239053918208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:24:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612260046409728 [0;39m 生成今日电子书快照开始
2022-08-18 22:24:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612260046409728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:24:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612260046409728 [0;39m ==> Parameters: 
2022-08-18 22:24:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612260046409728 [0;39m <==    Updates: 0
2022-08-18 22:24:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612260046409728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:24:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612280992763904 [0;39m 生成今日电子书快照开始
2022-08-18 22:24:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612280992763904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:24:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612280992763904 [0;39m ==> Parameters: 
2022-08-18 22:24:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612280992763904 [0;39m <==    Updates: 0
2022-08-18 22:24:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612280992763904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:25:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612301930729472 [0;39m 生成今日电子书快照开始
2022-08-18 22:25:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612301930729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:25:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612301930729472 [0;39m ==> Parameters: 
2022-08-18 22:25:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612301930729472 [0;39m <==    Updates: 0
2022-08-18 22:25:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612301930729472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:25:05.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17612322902249472 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:25:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612322902249472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:25:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612322902249472 [0;39m ==> Parameters: 
2022-08-18 22:25:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612322902249472 [0;39m <==    Updates: 7
2022-08-18 22:25:05.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17612322902249472 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:25:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612322910638080 [0;39m 生成今日电子书快照开始
2022-08-18 22:25:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612322910638080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:25:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612322910638080 [0;39m ==> Parameters: 
2022-08-18 22:25:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612322910638080 [0;39m <==    Updates: 0
2022-08-18 22:25:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612322910638080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:25:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612343882158080 [0;39m 生成今日电子书快照开始
2022-08-18 22:25:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612343882158080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:25:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612343882158080 [0;39m ==> Parameters: 
2022-08-18 22:25:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612343882158080 [0;39m <==    Updates: 0
2022-08-18 22:25:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612343882158080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:25:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612364845289472 [0;39m 生成今日电子书快照开始
2022-08-18 22:25:15.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612364845289472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:25:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612364845289472 [0;39m ==> Parameters: 
2022-08-18 22:25:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612364845289472 [0;39m <==    Updates: 0
2022-08-18 22:25:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612364845289472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:25:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612385862946816 [0;39m 生成今日电子书快照开始
2022-08-18 22:25:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612385862946816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:25:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612385862946816 [0;39m ==> Parameters: 
2022-08-18 22:25:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612385862946816 [0;39m <==    Updates: 0
2022-08-18 22:25:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612385862946816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:25:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612406847049728 [0;39m 生成今日电子书快照开始
2022-08-18 22:25:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612406847049728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:25:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612406847049728 [0;39m ==> Parameters: 
2022-08-18 22:25:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612406847049728 [0;39m <==    Updates: 0
2022-08-18 22:25:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612406847049728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:25:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612427818569728 [0;39m 生成今日电子书快照开始
2022-08-18 22:25:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612427818569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:25:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612427818569728 [0;39m ==> Parameters: 
2022-08-18 22:25:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612427818569728 [0;39m <==    Updates: 0
2022-08-18 22:25:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612427818569728 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:25:35.000 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17612448727175168 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:25:35.000 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612448727175168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:25:35.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612448727175168 [0;39m ==> Parameters: 
2022-08-18 22:25:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612448727175168 [0;39m <==    Updates: 7
2022-08-18 22:25:35.002 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17612448727175168 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:25:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612448735563776 [0;39m 生成今日电子书快照开始
2022-08-18 22:25:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612448735563776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:25:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612448735563776 [0;39m ==> Parameters: 
2022-08-18 22:25:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612448735563776 [0;39m <==    Updates: 0
2022-08-18 22:25:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612448735563776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:25:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612469723860992 [0;39m 生成今日电子书快照开始
2022-08-18 22:25:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612469723860992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:25:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612469723860992 [0;39m ==> Parameters: 
2022-08-18 22:25:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612469723860992 [0;39m <==    Updates: 0
2022-08-18 22:25:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612469723860992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:25:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612490686992384 [0;39m 生成今日电子书快照开始
2022-08-18 22:25:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612490686992384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:25:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612490686992384 [0;39m ==> Parameters: 
2022-08-18 22:25:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612490686992384 [0;39m <==    Updates: 0
2022-08-18 22:25:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612490686992384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:25:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612511666900992 [0;39m 生成今日电子书快照开始
2022-08-18 22:25:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612511666900992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:25:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612511666900992 [0;39m ==> Parameters: 
2022-08-18 22:25:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612511666900992 [0;39m <==    Updates: 0
2022-08-18 22:25:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612511666900992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:25:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612532638420992 [0;39m 生成今日电子书快照开始
2022-08-18 22:25:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612532638420992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:25:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612532638420992 [0;39m ==> Parameters: 
2022-08-18 22:25:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612532638420992 [0;39m <==    Updates: 0
2022-08-18 22:25:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612532638420992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:26:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612553609940992 [0;39m 生成今日电子书快照开始
2022-08-18 22:26:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612553609940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:26:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612553609940992 [0;39m ==> Parameters: 
2022-08-18 22:26:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612553609940992 [0;39m <==    Updates: 0
2022-08-18 22:26:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612553609940992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:26:05.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612574556295168 [0;39m 生成今日电子书快照开始
2022-08-18 22:26:05.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612574556295168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:26:05.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612574556295168 [0;39m ==> Parameters: 
2022-08-18 22:26:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612574556295168 [0;39m <==    Updates: 0
2022-08-18 22:26:05.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612574556295168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:26:05.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17612574564683776 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:26:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612574564683776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:26:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612574564683776 [0;39m ==> Parameters: 
2022-08-18 22:26:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612574564683776 [0;39m <==    Updates: 7
2022-08-18 22:26:05.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17612574564683776 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:26:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612595548786688 [0;39m 生成今日电子书快照开始
2022-08-18 22:26:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612595548786688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:26:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612595548786688 [0;39m ==> Parameters: 
2022-08-18 22:26:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612595548786688 [0;39m <==    Updates: 0
2022-08-18 22:26:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612595548786688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:26:10.361 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m17611467050323968 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-18 22:26:10.361 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m17611467050323968 [0;39m ------------- LoginInterceptor 结束 耗时：0 ms -------------
2022-08-18 22:26:10.363 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-18 22:26:10.364 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-18 22:26:10.364 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m                  [0;39m 登录校验开始，token：17610697500397568
2022-08-18 22:26:10.399 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m                  [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"17610697500397568"}
2022-08-18 22:26:10.418 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17612597281034240 [0;39m ------------- 开始 -------------
2022-08-18 22:26:10.419 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17612597281034240 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-18 22:26:10.419 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17612597281034240 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-18 22:26:10.419 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17612597281034240 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:26:10.421 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17612597281034240 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div></blockquote>","ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1}]
2022-08-18 22:26:10.437 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17612597281034240 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-18 22:26:10.438 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17612597281034240 [0;39m ==> Parameters: 202714600712572928(Long), 0(Long), 用户管理功能开发(String), 9(Integer), 9(Integer), 1(Integer), 202715583089872896(Long)
2022-08-18 22:26:10.439 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17612597281034240 [0;39m <==    Updates: 1
2022-08-18 22:26:10.439 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17612597281034240 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-18 22:26:10.440 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17612597281034240 [0;39m ==> Parameters: <blockquote><h2 id="fii37">密码加密存储和传输（MDS）<br><font face="宋体"><font size="3">&nbsp;</font><b style=""><font size="4">传输加密： </font></b><font size="3">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size="3" face="Times New Roman"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）
</b></font>&nbsp;&nbsp;<font face="宋体" style=""><b style="font-size: large;">存储加密：</b><font size="3">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size="3"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id="90d5d">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id="9l5yg">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face="Times New Roman" size="3"><font color="#c24f4a">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id="rckur">单点登录token与JWT介绍</h2><h3 id="o9527"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size="3">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div></blockquote>(String), 202715583089872896(Long)
2022-08-18 22:26:10.441 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17612597281034240 [0;39m <==    Updates: 1
2022-08-18 22:26:10.473 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17612597281034240 [0;39m 返回结果: {"success":true}
2022-08-18 22:26:10.473 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17612597281034240 [0;39m ------------- 结束 耗时：55 ms -------------
2022-08-18 22:26:10.474 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m17612597281034240 [0;39m ------------- LoginInterceptor 结束 耗时：111 ms -------------
2022-08-18 22:26:10.486 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17612597566246912 [0;39m ------------- 开始 -------------
2022-08-18 22:26:10.486 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17612597566246912 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-18 22:26:10.486 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17612597566246912 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-18 22:26:10.487 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17612597566246912 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:26:10.487 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17612597566246912 [0;39m 请求参数: [202714600712572928]
2022-08-18 22:26:10.487 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17612597566246912 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-18 22:26:10.488 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17612597566246912 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-18 22:26:10.489 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17612597566246912 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-18 22:26:10.489 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17612597566246912 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 47, 5
2022-08-18 22:26:10.489 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17612597566246912 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 39, 4
2022-08-18 22:26:10.490 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17612597566246912 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-18 22:26:10.490 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17612597566246912 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 21, 3
2022-08-18 22:26:10.492 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17612597566246912 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 25, 5
2022-08-18 22:26:10.493 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17612597566246912 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 23, 2
2022-08-18 22:26:10.493 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17612597566246912 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 9, 2
2022-08-18 22:26:10.493 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17612597566246912 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 9, 3
2022-08-18 22:26:10.493 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17612597566246912 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 9, 1
2022-08-18 22:26:10.494 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17612597566246912 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 7, 1
2022-08-18 22:26:10.494 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17612597566246912 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 4, 1
2022-08-18 22:26:10.494 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17612597566246912 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 3, 2
2022-08-18 22:26:10.494 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17612597566246912 [0;39m <==      Total: 12
2022-08-18 22:26:10.497 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17612597566246912 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":47,"voteCount":5},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":39,"voteCount":4},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":21,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":25,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":23,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":9,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":9,"voteCount":3},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":7,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":4,"voteCount":1},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":3,"voteCount":2}],"success":true}
2022-08-18 22:26:10.497 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17612597566246912 [0;39m ------------- 结束 耗时：11 ms -------------
2022-08-18 22:26:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612616537083904 [0;39m 生成今日电子书快照开始
2022-08-18 22:26:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612616537083904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:26:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612616537083904 [0;39m ==> Parameters: 
2022-08-18 22:26:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612616537083904 [0;39m <==    Updates: 0
2022-08-18 22:26:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612616537083904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:26:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612637512798208 [0;39m 生成今日电子书快照开始
2022-08-18 22:26:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612637512798208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:26:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612637512798208 [0;39m ==> Parameters: 
2022-08-18 22:26:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612637512798208 [0;39m <==    Updates: 0
2022-08-18 22:26:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612637512798208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:26:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612658475929600 [0;39m 生成今日电子书快照开始
2022-08-18 22:26:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612658475929600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:26:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612658475929600 [0;39m ==> Parameters: 
2022-08-18 22:26:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612658475929600 [0;39m <==    Updates: 0
2022-08-18 22:26:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612658475929600 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:26:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612679434866688 [0;39m 生成今日电子书快照开始
2022-08-18 22:26:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612679434866688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:26:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612679434866688 [0;39m ==> Parameters: 
2022-08-18 22:26:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612679434866688 [0;39m <==    Updates: 0
2022-08-18 22:26:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612679434866688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:26:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17612700406386688 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:26:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612700406386688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:26:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612700406386688 [0;39m ==> Parameters: 
2022-08-18 22:26:35.071 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612700406386688 [0;39m <==    Updates: 7
2022-08-18 22:26:35.071 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17612700406386688 [0;39m 更新电子书下的文档数据结束，耗时：66 毫秒
2022-08-18 22:26:35.072 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612700687405056 [0;39m 生成今日电子书快照开始
2022-08-18 22:26:35.072 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612700687405056 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:26:35.072 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612700687405056 [0;39m ==> Parameters: 
2022-08-18 22:26:35.102 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612700687405056 [0;39m <==    Updates: 0
2022-08-18 22:26:35.102 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612700687405056 [0;39m 生成今日电子书快照结束，耗时：30 毫秒
2022-08-18 22:26:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612721398878208 [0;39m 生成今日电子书快照开始
2022-08-18 22:26:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612721398878208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:26:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612721398878208 [0;39m ==> Parameters: 
2022-08-18 22:26:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612721398878208 [0;39m <==    Updates: 0
2022-08-18 22:26:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612721398878208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:26:45.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612742328455168 [0;39m 生成今日电子书快照开始
2022-08-18 22:26:45.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612742328455168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:26:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612742328455168 [0;39m ==> Parameters: 
2022-08-18 22:26:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612742328455168 [0;39m <==    Updates: 0
2022-08-18 22:26:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612742328455168 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:26:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612763341918208 [0;39m 生成今日电子书快照开始
2022-08-18 22:26:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612763341918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:26:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612763341918208 [0;39m ==> Parameters: 
2022-08-18 22:26:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612763341918208 [0;39m <==    Updates: 0
2022-08-18 22:26:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612763341918208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:26:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612784309243904 [0;39m 生成今日电子书快照开始
2022-08-18 22:26:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612784309243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:26:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612784309243904 [0;39m ==> Parameters: 
2022-08-18 22:26:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612784309243904 [0;39m <==    Updates: 0
2022-08-18 22:26:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612784309243904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:27:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612805255598080 [0;39m 生成今日电子书快照开始
2022-08-18 22:27:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612805255598080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:27:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612805255598080 [0;39m ==> Parameters: 
2022-08-18 22:27:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612805255598080 [0;39m <==    Updates: 0
2022-08-18 22:27:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612805255598080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:27:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17612826260672512 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:27:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612826260672512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:27:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612826260672512 [0;39m ==> Parameters: 
2022-08-18 22:27:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612826260672512 [0;39m <==    Updates: 7
2022-08-18 22:27:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17612826260672512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:27:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612826269061120 [0;39m 生成今日电子书快照开始
2022-08-18 22:27:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612826269061120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:27:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612826269061120 [0;39m ==> Parameters: 
2022-08-18 22:27:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612826269061120 [0;39m <==    Updates: 0
2022-08-18 22:27:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612826269061120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:27:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612847190249472 [0;39m 生成今日电子书快照开始
2022-08-18 22:27:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612847190249472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:27:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612847190249472 [0;39m ==> Parameters: 
2022-08-18 22:27:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612847190249472 [0;39m <==    Updates: 0
2022-08-18 22:27:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612847190249472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:27:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612868203712512 [0;39m 生成今日电子书快照开始
2022-08-18 22:27:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612868203712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:27:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612868203712512 [0;39m ==> Parameters: 
2022-08-18 22:27:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612868203712512 [0;39m <==    Updates: 0
2022-08-18 22:27:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612868203712512 [0;39m 生成今日电子书快照结束，耗时：0 毫秒
2022-08-18 22:27:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612889192009728 [0;39m 生成今日电子书快照开始
2022-08-18 22:27:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612889192009728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:27:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612889192009728 [0;39m ==> Parameters: 
2022-08-18 22:27:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612889192009728 [0;39m <==    Updates: 0
2022-08-18 22:27:20.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612889192009728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:27:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612910146752512 [0;39m 生成今日电子书快照开始
2022-08-18 22:27:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612910146752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:27:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612910146752512 [0;39m ==> Parameters: 
2022-08-18 22:27:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612910146752512 [0;39m <==    Updates: 0
2022-08-18 22:27:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612910146752512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:27:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612931105689600 [0;39m 生成今日电子书快照开始
2022-08-18 22:27:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612931105689600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:27:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612931105689600 [0;39m ==> Parameters: 
2022-08-18 22:27:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612931105689600 [0;39m <==    Updates: 0
2022-08-18 22:27:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612931105689600 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:27:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17612952060432384 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:27:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612952060432384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:27:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612952060432384 [0;39m ==> Parameters: 
2022-08-18 22:27:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17612952060432384 [0;39m <==    Updates: 7
2022-08-18 22:27:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17612952060432384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:27:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612952068820992 [0;39m 生成今日电子书快照开始
2022-08-18 22:27:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612952068820992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:27:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612952068820992 [0;39m ==> Parameters: 
2022-08-18 22:27:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612952068820992 [0;39m <==    Updates: 0
2022-08-18 22:27:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612952068820992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:27:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612973044535296 [0;39m 生成今日电子书快照开始
2022-08-18 22:27:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612973044535296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:27:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612973044535296 [0;39m ==> Parameters: 
2022-08-18 22:27:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612973044535296 [0;39m <==    Updates: 0
2022-08-18 22:27:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612973044535296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:27:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17612994016055296 [0;39m 生成今日电子书快照开始
2022-08-18 22:27:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612994016055296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:27:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612994016055296 [0;39m ==> Parameters: 
2022-08-18 22:27:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17612994016055296 [0;39m <==    Updates: 0
2022-08-18 22:27:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17612994016055296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:27:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613015012741120 [0;39m 生成今日电子书快照开始
2022-08-18 22:27:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613015012741120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:27:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613015012741120 [0;39m ==> Parameters: 
2022-08-18 22:27:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613015012741120 [0;39m <==    Updates: 0
2022-08-18 22:27:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613015012741120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:27:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613035946512384 [0;39m 生成今日电子书快照开始
2022-08-18 22:27:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613035946512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:27:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613035946512384 [0;39m ==> Parameters: 
2022-08-18 22:27:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613035946512384 [0;39m <==    Updates: 0
2022-08-18 22:27:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613035946512384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:28:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613056943198208 [0;39m 生成今日电子书快照开始
2022-08-18 22:28:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613056943198208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:28:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613056943198208 [0;39m ==> Parameters: 
2022-08-18 22:28:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613056943198208 [0;39m <==    Updates: 0
2022-08-18 22:28:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613056943198208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:28:05.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17613077881163776 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:28:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613077881163776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:28:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613077881163776 [0;39m ==> Parameters: 
2022-08-18 22:28:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613077881163776 [0;39m <==    Updates: 7
2022-08-18 22:28:05.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17613077881163776 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:28:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613077889552384 [0;39m 生成今日电子书快照开始
2022-08-18 22:28:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613077889552384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:28:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613077889552384 [0;39m ==> Parameters: 
2022-08-18 22:28:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613077889552384 [0;39m <==    Updates: 0
2022-08-18 22:28:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613077889552384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:28:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613098894626816 [0;39m 生成今日电子书快照开始
2022-08-18 22:28:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613098894626816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:28:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613098894626816 [0;39m ==> Parameters: 
2022-08-18 22:28:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613098894626816 [0;39m <==    Updates: 0
2022-08-18 22:28:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613098894626816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:28:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613119832592384 [0;39m 生成今日电子书快照开始
2022-08-18 22:28:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613119832592384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:28:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613119832592384 [0;39m ==> Parameters: 
2022-08-18 22:28:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613119832592384 [0;39m <==    Updates: 0
2022-08-18 22:28:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613119832592384 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-18 22:28:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613140837666816 [0;39m 生成今日电子书快照开始
2022-08-18 22:28:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613140837666816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:28:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613140837666816 [0;39m ==> Parameters: 
2022-08-18 22:28:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613140837666816 [0;39m <==    Updates: 0
2022-08-18 22:28:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613140837666816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:28:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613161821769728 [0;39m 生成今日电子书快照开始
2022-08-18 22:28:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613161821769728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:28:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613161821769728 [0;39m ==> Parameters: 
2022-08-18 22:28:25.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613161821769728 [0;39m <==    Updates: 0
2022-08-18 22:28:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613161821769728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:28:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613182768123904 [0;39m 生成今日电子书快照开始
2022-08-18 22:28:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613182768123904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:28:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613182768123904 [0;39m ==> Parameters: 
2022-08-18 22:28:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613182768123904 [0;39m <==    Updates: 0
2022-08-18 22:28:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613182768123904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:28:33.295 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m17611475027890176 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-18 22:28:33.295 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m17611475027890176 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-18 22:28:33.295 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m17611475027890176 [0;39m 登录校验开始，token：17610697500397568
2022-08-18 22:28:33.334 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m17611475027890176 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"17610697500397568"}
2022-08-18 22:28:33.335 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613196718379008 [0;39m ------------- 开始 -------------
2022-08-18 22:28:33.335 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613196718379008 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-18 22:28:33.335 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613196718379008 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-18 22:28:33.336 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613196718379008 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:28:33.336 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613196718379008 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\">4. 前、后端保存token</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验）</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4. 前、后端保存token</font></p></div></blockquote>","ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1}]
2022-08-18 22:28:33.337 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17613196718379008 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-18 22:28:33.337 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17613196718379008 [0;39m ==> Parameters: 202714600712572928(Long), 0(Long), 用户管理功能开发(String), 9(Integer), 9(Integer), 1(Integer), 202715583089872896(Long)
2022-08-18 22:28:33.338 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17613196718379008 [0;39m <==    Updates: 1
2022-08-18 22:28:33.339 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17613196718379008 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-18 22:28:33.339 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17613196718379008 [0;39m ==> Parameters: <blockquote><h2 id="fii37">密码加密存储和传输（MDS）<br><font face="宋体"><font size="3">&nbsp;</font><b style=""><font size="4">传输加密： </font></b><font size="3">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size="3" face="Times New Roman"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）
</b></font>&nbsp;&nbsp;<font face="宋体" style=""><b style="font-size: large;">存储加密：</b><font size="3">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size="3"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id="90d5d">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id="9l5yg">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face="Times New Roman" size="3"><font color="#c24f4a">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id="rckur">单点登录token与JWT介绍</h2><h3 id="o9527"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size="3">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3">4. 前、后端保存token</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验）</font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4. 前、后端保存token</font></p></div></blockquote>(String), 202715583089872896(Long)
2022-08-18 22:28:33.340 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17613196718379008 [0;39m <==    Updates: 1
2022-08-18 22:28:33.360 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613196718379008 [0;39m 返回结果: {"success":true}
2022-08-18 22:28:33.360 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613196718379008 [0;39m ------------- 结束 耗时：25 ms -------------
2022-08-18 22:28:33.361 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m17613196718379008 [0;39m ------------- LoginInterceptor 结束 耗时：66 ms -------------
2022-08-18 22:28:33.372 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613196873568256 [0;39m ------------- 开始 -------------
2022-08-18 22:28:33.373 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613196873568256 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-18 22:28:33.373 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613196873568256 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-18 22:28:33.373 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613196873568256 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:28:33.373 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613196873568256 [0;39m 请求参数: [202714600712572928]
2022-08-18 22:28:33.374 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17613196873568256 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-18 22:28:33.374 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17613196873568256 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-18 22:28:33.375 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613196873568256 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-18 22:28:33.375 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613196873568256 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 47, 5
2022-08-18 22:28:33.375 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613196873568256 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 39, 4
2022-08-18 22:28:33.376 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613196873568256 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-18 22:28:33.376 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613196873568256 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 21, 3
2022-08-18 22:28:33.376 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613196873568256 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 25, 5
2022-08-18 22:28:33.376 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613196873568256 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 23, 2
2022-08-18 22:28:33.376 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613196873568256 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 9, 2
2022-08-18 22:28:33.377 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613196873568256 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 9, 3
2022-08-18 22:28:33.377 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613196873568256 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 9, 1
2022-08-18 22:28:33.377 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613196873568256 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 7, 1
2022-08-18 22:28:33.378 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613196873568256 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 4, 1
2022-08-18 22:28:33.378 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613196873568256 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 3, 2
2022-08-18 22:28:33.378 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17613196873568256 [0;39m <==      Total: 12
2022-08-18 22:28:33.380 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613196873568256 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":47,"voteCount":5},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":39,"voteCount":4},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":21,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":25,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":23,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":9,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":9,"voteCount":3},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":7,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":4,"voteCount":1},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":3,"voteCount":2}],"success":true}
2022-08-18 22:28:33.381 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613196873568256 [0;39m ------------- 结束 耗时：9 ms -------------
2022-08-18 22:28:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17613203727060992 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:28:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613203727060992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:28:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613203727060992 [0;39m ==> Parameters: 
2022-08-18 22:28:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613203727060992 [0;39m <==    Updates: 7
2022-08-18 22:28:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17613203727060992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:28:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613203735449600 [0;39m 生成今日电子书快照开始
2022-08-18 22:28:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613203735449600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:28:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613203735449600 [0;39m ==> Parameters: 
2022-08-18 22:28:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613203735449600 [0;39m <==    Updates: 0
2022-08-18 22:28:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613203735449600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:28:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613224690192384 [0;39m 生成今日电子书快照开始
2022-08-18 22:28:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613224690192384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:28:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613224690192384 [0;39m ==> Parameters: 
2022-08-18 22:28:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613224690192384 [0;39m <==    Updates: 0
2022-08-18 22:28:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613224690192384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:28:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613245657518080 [0;39m 生成今日电子书快照开始
2022-08-18 22:28:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613245657518080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:28:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613245657518080 [0;39m ==> Parameters: 
2022-08-18 22:28:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613245657518080 [0;39m <==    Updates: 0
2022-08-18 22:28:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613245657518080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:28:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613266633232384 [0;39m 生成今日电子书快照开始
2022-08-18 22:28:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613266633232384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:28:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613266633232384 [0;39m ==> Parameters: 
2022-08-18 22:28:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613266633232384 [0;39m <==    Updates: 0
2022-08-18 22:28:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613266633232384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:28:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613287642501120 [0;39m 生成今日电子书快照开始
2022-08-18 22:28:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613287642501120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:28:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613287642501120 [0;39m ==> Parameters: 
2022-08-18 22:28:55.023 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613287642501120 [0;39m <==    Updates: 0
2022-08-18 22:28:55.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613287642501120 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-18 22:29:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613308601438208 [0;39m 生成今日电子书快照开始
2022-08-18 22:29:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613308601438208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:29:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613308601438208 [0;39m ==> Parameters: 
2022-08-18 22:29:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613308601438208 [0;39m <==    Updates: 0
2022-08-18 22:29:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613308601438208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:29:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17613329581346816 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:29:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613329581346816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:29:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613329581346816 [0;39m ==> Parameters: 
2022-08-18 22:29:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613329581346816 [0;39m <==    Updates: 7
2022-08-18 22:29:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17613329581346816 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:29:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613329585541120 [0;39m 生成今日电子书快照开始
2022-08-18 22:29:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613329585541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:29:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613329585541120 [0;39m ==> Parameters: 
2022-08-18 22:29:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613329585541120 [0;39m <==    Updates: 0
2022-08-18 22:29:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613329585541120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:29:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613350557061120 [0;39m 生成今日电子书快照开始
2022-08-18 22:29:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613350557061120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:29:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613350557061120 [0;39m ==> Parameters: 
2022-08-18 22:29:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613350557061120 [0;39m <==    Updates: 0
2022-08-18 22:29:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613350557061120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:29:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613371507609600 [0;39m 生成今日电子书快照开始
2022-08-18 22:29:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613371507609600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:29:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613371507609600 [0;39m ==> Parameters: 
2022-08-18 22:29:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613371507609600 [0;39m <==    Updates: 0
2022-08-18 22:29:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613371507609600 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:29:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613392483323904 [0;39m 生成今日电子书快照开始
2022-08-18 22:29:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613392483323904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:29:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613392483323904 [0;39m ==> Parameters: 
2022-08-18 22:29:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613392483323904 [0;39m <==    Updates: 0
2022-08-18 22:29:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613392483323904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:29:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613413438066688 [0;39m 生成今日电子书快照开始
2022-08-18 22:29:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613413438066688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:29:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613413438066688 [0;39m ==> Parameters: 
2022-08-18 22:29:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613413438066688 [0;39m <==    Updates: 0
2022-08-18 22:29:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613413438066688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:29:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613434430558208 [0;39m 生成今日电子书快照开始
2022-08-18 22:29:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613434430558208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:29:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613434430558208 [0;39m ==> Parameters: 
2022-08-18 22:29:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613434430558208 [0;39m <==    Updates: 0
2022-08-18 22:29:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613434430558208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:29:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613455372718080 [0;39m 生成今日电子书快照开始
2022-08-18 22:29:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613455372718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:29:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613455372718080 [0;39m ==> Parameters: 
2022-08-18 22:29:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613455372718080 [0;39m <==    Updates: 0
2022-08-18 22:29:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613455372718080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:29:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17613455381106688 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:29:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613455381106688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:29:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613455381106688 [0;39m ==> Parameters: 
2022-08-18 22:29:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613455381106688 [0;39m <==    Updates: 7
2022-08-18 22:29:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17613455381106688 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:29:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613476394569728 [0;39m 生成今日电子书快照开始
2022-08-18 22:29:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613476394569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:29:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613476394569728 [0;39m ==> Parameters: 
2022-08-18 22:29:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613476394569728 [0;39m <==    Updates: 0
2022-08-18 22:29:40.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613476394569728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:29:44.389 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-18 22:29:44.389 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-18 22:29:44.389 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m                  [0;39m 登录校验开始，token：17610697500397568
2022-08-18 22:29:44.424 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m                  [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"17610697500397568"}
2022-08-18 22:29:44.426 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613494895644672 [0;39m ------------- 开始 -------------
2022-08-18 22:29:44.426 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613494895644672 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-18 22:29:44.426 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613494895644672 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-18 22:29:44.426 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613494895644672 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:29:44.426 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613494895644672 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\">4. 前、后端保存token</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4. 前、后端保存token</font></p></div></blockquote>","ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1}]
2022-08-18 22:29:44.428 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17613494895644672 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-18 22:29:44.429 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17613494895644672 [0;39m ==> Parameters: 202714600712572928(Long), 0(Long), 用户管理功能开发(String), 9(Integer), 9(Integer), 1(Integer), 202715583089872896(Long)
2022-08-18 22:29:44.430 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17613494895644672 [0;39m <==    Updates: 1
2022-08-18 22:29:44.431 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17613494895644672 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-18 22:29:44.432 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17613494895644672 [0;39m ==> Parameters: <blockquote><h2 id="fii37">密码加密存储和传输（MDS）<br><font face="宋体"><font size="3">&nbsp;</font><b style=""><font size="4">传输加密： </font></b><font size="3">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size="3" face="Times New Roman"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）
</b></font>&nbsp;&nbsp;<font face="宋体" style=""><b style="font-size: large;">存储加密：</b><font size="3">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size="3"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id="90d5d">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id="9l5yg">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face="Times New Roman" size="3"><font color="#c24f4a">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id="rckur">单点登录token与JWT介绍</h2><h3 id="o9527"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size="3">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3">4. 前、后端保存token</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4. 前、后端保存token</font></p></div></blockquote>(String), 202715583089872896(Long)
2022-08-18 22:29:44.439 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17613494895644672 [0;39m <==    Updates: 1
2022-08-18 22:29:44.468 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613494895644672 [0;39m 返回结果: {"success":true}
2022-08-18 22:29:44.468 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613494895644672 [0;39m ------------- 结束 耗时：42 ms -------------
2022-08-18 22:29:44.469 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m17613494895644672 [0;39m ------------- LoginInterceptor 结束 耗时：80 ms -------------
2022-08-18 22:29:44.479 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613495117942784 [0;39m ------------- 开始 -------------
2022-08-18 22:29:44.479 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613495117942784 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-18 22:29:44.479 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613495117942784 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-18 22:29:44.479 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613495117942784 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:29:44.480 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613495117942784 [0;39m 请求参数: [202714600712572928]
2022-08-18 22:29:44.481 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17613495117942784 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-18 22:29:44.481 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17613495117942784 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-18 22:29:44.483 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613495117942784 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-18 22:29:44.484 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613495117942784 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 47, 5
2022-08-18 22:29:44.484 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613495117942784 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 39, 4
2022-08-18 22:29:44.484 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613495117942784 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-18 22:29:44.484 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613495117942784 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 21, 3
2022-08-18 22:29:44.485 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613495117942784 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 25, 5
2022-08-18 22:29:44.485 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613495117942784 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 23, 2
2022-08-18 22:29:44.485 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613495117942784 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 9, 2
2022-08-18 22:29:44.485 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613495117942784 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 9, 3
2022-08-18 22:29:44.485 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613495117942784 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 9, 1
2022-08-18 22:29:44.486 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613495117942784 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 7, 1
2022-08-18 22:29:44.486 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613495117942784 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 4, 1
2022-08-18 22:29:44.486 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613495117942784 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 3, 2
2022-08-18 22:29:44.486 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17613495117942784 [0;39m <==      Total: 12
2022-08-18 22:29:44.487 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613495117942784 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":47,"voteCount":5},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":39,"voteCount":4},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":21,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":25,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":23,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":9,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":9,"voteCount":3},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":7,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":4,"voteCount":1},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":3,"voteCount":2}],"success":true}
2022-08-18 22:29:44.487 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613495117942784 [0;39m ------------- 结束 耗时：9 ms -------------
2022-08-18 22:29:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613497336729600 [0;39m 生成今日电子书快照开始
2022-08-18 22:29:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613497336729600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:29:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613497336729600 [0;39m ==> Parameters: 
2022-08-18 22:29:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613497336729600 [0;39m <==    Updates: 0
2022-08-18 22:29:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613497336729600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:29:46.492 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613503561076736 [0;39m ------------- 开始 -------------
2022-08-18 22:29:46.492 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613503561076736 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202715069841281024 GET
2022-08-18 22:29:46.492 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613503561076736 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-18 22:29:46.492 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613503561076736 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:29:46.493 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613503561076736 [0;39m 请求参数: [202715069841281024]
2022-08-18 22:29:46.493 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613503561076736 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-18 22:29:46.493 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613503561076736 [0;39m ==> Parameters: 202715069841281024(Long)
2022-08-18 22:29:46.495 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613503561076736 [0;39m <==    Columns: id, content
2022-08-18 22:29:46.495 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613503561076736 [0;39m <==        Row: 202715069841281024, <<BLOB>>
2022-08-18 22:29:46.496 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613503561076736 [0;39m <==      Total: 1
2022-08-18 22:29:46.497 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613503561076736 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-18 22:29:46.498 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613503561076736 [0;39m ==> Parameters: 202715069841281024(Long)
2022-08-18 22:29:46.520 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613503561076736 [0;39m <==    Updates: 1
2022-08-18 22:29:46.521 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613503561076736 [0;39m 返回结果: {"content":"<blockquote><h2 id=\"343h7\">1. 在远程仓库上创建一个新项目，将本地项目关联到远程仓库</h2></blockquote><p style=\"text-align:center;\"><span style=\"background-color: rgb(77, 128, 191);\"><font face=\"华文楷体\" size=\"3\">自定义启动端开始的文案网址：patorjk.com</font></span><br></p><blockquote><h2 id=\"lbj1m\"></h2><h2 id=\"y1h2i\"></h2><h3 id=\"g91hj\"></h3><h1 id=\"vfo4x\"></h1><h4 id=\"t6wlk\"><h2 id=\"y3p29\"><xmp>2.  Restful风格：GET（查找） ,POST(新增),PUT（修改）,DELETE（删除）</font></xmp><xmp> 正常情况：user？id=1</xmp><xmp> Restful：/user/1</xmp></h2></h4></blockquote><p><br></p><blockquote><p><font size=\"4\" face=\"Times New Roman\">3. @RestController和@Controller区别：<br></font>&nbsp; &nbsp;&nbsp;<font size=\"4\" face=\"Times New Roman\">@GetMapping(\"/hello\")<br>    public String hello(){<br>        return \"hello\";<br>    }</font></p></blockquote><div><div><p><font size=\"3\" face=\"黑体\">&nbsp;</font><font size=\"3\" face=\"楷体\"> &nbsp;<span style=\"background-color: rgb(255, 255, 255); color: rgba(0, 0, 0, 0.85); font-variant-ligatures: normal; font-variant-caps: normal; float: none; display: inline !important;\">&nbsp;&nbsp;&nbsp;</span><span style=\"background-color: rgb(255, 255, 255); color: rgba(0, 0, 0, 0.85); font-variant-ligatures: normal; font-variant-caps: normal; float: none; display: inline !important;\">@RestController一般用来返回字符串即返回“hello”，@Controller用来返回一个页面hello.html</span></font></p><p><font face=\"楷体\"><font size=\"3\">&nbsp; &nbsp;</font>&nbsp; &nbsp;&nbsp;<span style=\"font-size: medium;\">@RestController=@Controller+@ResponseBody(返回字符串或JSON对象)</span></font></p><p><br></p><blockquote><p><font face=\"黑体\" size=\"4\">4. resources文件夹下的application.properties/yml能够被识别，将其放入子文件夹中也一样可以，同样也可以识别bootstrap.properties/yml</font></p><p><b>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style=\"background-color: rgb(139, 170, 74);\">&nbsp;properties-&gt;yml格式网站：<span style=\"font-size: 1em;\">toyaml.com/index.html&nbsp; &nbsp;</span></span></b><font face=\"黑体\" size=\"4\"><br></font></p><p><i><font size=\"3\"><u><font color=\"#c24f4a\">bootstrap:</font></u>一般用于动态配置，线上实时修改，实时生效的配置，一般可配合nacos使用</font></i><font face=\"黑体\" size=\"4\"><br></font></p><span style=\"background-color: rgb(139, 170, 74);\"></span></blockquote><blockquote><p><font face=\"仿宋\" size=\"4\">5.配置集成热部署：代码及时生效</font></p></blockquote><ul><li style=\"\"><font size=\"3\" face=\"仿宋\">&nbsp;</font><font size=\"3\" face=\"黑体\">添加依赖：</font></li></ul><blockquote><div><pre><font size=\"3\" face=\"Times New Roman\">&lt;!--热部署--&gt;<br>&lt;dependency&gt;<br>    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br>    &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;<br>&lt;/dependency&gt;</font></pre></div></blockquote><p><br></p><ul><li><hr></li><li><font size=\"4\">勾选Build project automatically</font></li></ul><p><img src=\"https://i.postimg.cc/G3qNkhrF/83cd2913ee9d7d81366087dab707da3.jpg\" style=\"max-width:100%;\" width=\"100%\"><br></p><hr><ul><li><font size=\"4\" face=\"仿宋\">按两次shift键</font></li><li><img src=\"https://i.postimg.cc/DzxY3n6Q/0bd555589af48fa57b01b9230dbb31f.jpg\" style=\"max-width:100%;\"><br></li></ul><p><br></p><ul><li><img src=\"https://i.postimg.cc/W4xgky1L/78bd304480a2a1eb6a1f90cd955e9ce.jpg\" style=\"max-width:100%;\"><br></li></ul><hr><ul><li style=\"text-align:center;\"><span style=\"background-color: rgb(194, 79, 74);\"><font size=\"5\">2021版本的IDEA将上面这个勾选项移动到了别的地方，下面是2021版本的修改</font></span></li></ul><div style=\"text-align: center;\"><font size=\"3\"><br></font></div><ul><li><br></li><li><img src=\"https://i.postimg.cc/sxjXQP7C/71d856aaae65177b7e791458f6c8d27.jpg\"></li></ul></div><p><br></p></div>","success":true}
2022-08-18 22:29:46.521 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613503561076736 [0;39m ------------- 结束 耗时：29 ms -------------
2022-08-18 22:29:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613518291472384 [0;39m 生成今日电子书快照开始
2022-08-18 22:29:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613518291472384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:29:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613518291472384 [0;39m ==> Parameters: 
2022-08-18 22:29:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613518291472384 [0;39m <==    Updates: 0
2022-08-18 22:29:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613518291472384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:29:55.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613539250409472 [0;39m 生成今日电子书快照开始
2022-08-18 22:29:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613539250409472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:29:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613539250409472 [0;39m ==> Parameters: 
2022-08-18 22:29:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613539250409472 [0;39m <==    Updates: 0
2022-08-18 22:29:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613539250409472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:29:56.035 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613543587319808 [0;39m ------------- 开始 -------------
2022-08-18 22:29:56.035 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613543587319808 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202715279778779136 GET
2022-08-18 22:29:56.036 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613543587319808 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-18 22:29:56.036 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613543587319808 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:29:56.036 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613543587319808 [0;39m 请求参数: [202715279778779136]
2022-08-18 22:29:56.037 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613543587319808 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-18 22:29:56.037 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613543587319808 [0;39m ==> Parameters: 202715279778779136(Long)
2022-08-18 22:29:56.038 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613543587319808 [0;39m <==    Columns: id, content
2022-08-18 22:29:56.039 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613543587319808 [0;39m <==        Row: 202715279778779136, <<BLOB>>
2022-08-18 22:29:56.039 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613543587319808 [0;39m <==      Total: 1
2022-08-18 22:29:56.039 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613543587319808 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-18 22:29:56.040 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613543587319808 [0;39m ==> Parameters: 202715279778779136(Long)
2022-08-18 22:29:56.060 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613543587319808 [0;39m <==    Updates: 1
2022-08-18 22:29:56.061 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613543587319808 [0;39m 返回结果: {"content":"<blockquote><ul><li><p><font size=\"4\" style=\"font-weight: bold;\">介绍一下Vue和Vue CLI</font><br><font size=\"3\" style=\"\" face=\"宋体\">Vue CLI（需要安装Node.js）是一个基于Vue.js进行快速开发的完整系统，即</font><font size=\"3\" face=\"宋体\">Vue CLI=Vue.js+一堆组件</font><br></p></li><li><p><b style=\"font-size: large;\">安装Vue CLI，并创建Vue CLI项目</b><br><font size=\"3\" face=\"Times New Roman\">1. npm install -g @vue/cli@4.5.9<br>2. vue create web<br>3. 新建运行窗口：右击web项目中的package.json 找到 “show npm scripts”</font></p></li><li><font style=\"\"><b style=\"font-size: 1em;\">集成Ant Design Vue（前端框架中的Element UI不支持vue3）</b><br><br><font size=\"3\" face=\"Times New Roman\">1. 在IDEA的cmd中首先<span style=\"background-color: rgb(139, 170, 74);\">cd 前端项目名——npm install ant-design-vue --save<br></span></font></font>2. 在main.ts（集成第三方库）中导入</li></ul></blockquote><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p>","success":true}
2022-08-18 22:29:56.061 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613543587319808 [0;39m ------------- 结束 耗时：26 ms -------------
2022-08-18 22:29:59.681 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613558879752192 [0;39m ------------- 开始 -------------
2022-08-18 22:29:59.682 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613558879752192 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202715322204164096 GET
2022-08-18 22:29:59.682 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613558879752192 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-18 22:29:59.682 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613558879752192 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:29:59.682 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613558879752192 [0;39m 请求参数: [202715322204164096]
2022-08-18 22:29:59.683 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613558879752192 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-18 22:29:59.683 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613558879752192 [0;39m ==> Parameters: 202715322204164096(Long)
2022-08-18 22:29:59.692 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613558879752192 [0;39m <==    Columns: id, content
2022-08-18 22:29:59.692 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613558879752192 [0;39m <==        Row: 202715322204164096, <<BLOB>>
2022-08-18 22:29:59.693 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613558879752192 [0;39m <==      Total: 1
2022-08-18 22:29:59.694 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613558879752192 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-18 22:29:59.694 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613558879752192 [0;39m ==> Parameters: 202715322204164096(Long)
2022-08-18 22:29:59.723 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613558879752192 [0;39m <==    Updates: 1
2022-08-18 22:29:59.723 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613558879752192 [0;39m 返回结果: {"content":"<blockquote><ul><li><font size=\"4\">集成HTTP库axios<br>npm install axios --save&nbsp;</font></li><li><font size=\"4\">前后端分离的项目的跨域问题？<br>CorsConfig类</font></li><li><font size=\"4\">Vue3数据绑定显示列表数据（双向数据绑定）<br><font face=\"仿宋\">实时将后端的值刷新到前端页面上，html代码要拿到响应式变量，需要在setup最后return出去，大体流程如下：<br>前端页面写上{{ebooks}}<br>eg：const=ebooks ref():<br>axios.get(\"路径\").then((resonse)=&gt;{<br>const data=response.data;<br>ebooks.value=data.content（后端电子书的内容）<br>})<br>return {ebooks</font></font><font face=\"仿宋\">}</font></li><li><font face=\"黑体\" style=\"font-size: large;\">Vue CLI多环境配置</font><br><font size=\"3\"><font face=\"宋体\" style=\"\">配置之前的话——</font><font face=\"宋体\">axios.get(\"路径\")只能是本地地址！！！<br>1. 在web项目根目录下新建“.env.dev.txt（开发环境）”以及“.env.prod.txt（生产环境）”<br>2. </font><font face=\"Times New Roman\">在package.json文件</font><br></font>&nbsp; &nbsp; &nbsp; <font face=\"Times New Roman\" size=\"3\">&nbsp;\"scripts\": {<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; \"serve-dev\": \"vue-cli-service serve<span style=\"background-color: rgb(194, 79, 74);\"> --mode dev --port 8080</span>（可以改变端口号）\",<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; \"serve-prod\": \"vue-cli-service serve<span style=\"background-color: rgb(194, 79, 74);\"> --mode prod</span>\",<br>&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;\"&nbsp;build-dev\": \"vue-cli-service build --mode dev\",<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;\"build-prod\": \"vue-cli-service build --mode prod\",<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;\"lint\": \"vue-cli-service lint\"<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;},<br>3. 在main.ts中添加一个全局配置，可以使axios获取路径的时候不用每次写上开发环境的本地端口号<br><pre>&nbsp;&nbsp;&nbsp;&nbsp;<font color=\"#f9963b\">import axios from \"axios\";<br>&nbsp;&nbsp;&nbsp;&nbsp;axios.defaults.baseURL=process.env.VUE_APP_SERVER;</font></pre></font><pre type=\"Java\"><code><xmp><br></xmp></code></pre></li><li><pre><font color=\"#000000\" face=\"黑体\" size=\"4\">axios自带拦截器（</font><font color=\"#000000\" size=\"4\" face=\"Times New Roman\">main.ts，Intercepter/LoginIntercepter.java,定义一个全局配置类config/SpringMvcConfig.java</font><font color=\"#000000\" face=\"黑体\" size=\"4\">）</font></pre></li><li><pre><font color=\"#000000\" face=\"黑体\" size=\"4\">SpringBoot过滤器记录耗时（</font><font color=\"#000000\" size=\"4\" face=\"Times New Roman\">filter/LogFilter.java</font><font color=\"#000000\" face=\"黑体\" size=\"4\">）</font></pre></li><li><pre><font color=\"#000000\"><font size=\"4\" style=\"font-family: 黑体;\">过滤器和拦截器的区别？\n</font><font size=\"3\" style=\"\" face=\"宋体\">拦截器的前后面是分开的，调用业务方法不需要自己去写。而过滤器是一起的，利用过滤链来调用业务方法。</font></font></pre></li><li><pre><font style=\"color: rgb(0, 0, 0);\" size=\"4\" face=\"黑体\">SpringBoot AOP的使用（</font><font style=\"color: rgb(0, 0, 0);\" size=\"4\" face=\"Times New Roman\">aspect/LogAspect.java</font><font size=\"4\" style=\"color: rgb(0, 0, 0); font-family: 黑体;\">）前置、后置、环绕通知\n</font><font size=\"3\" style=\"\" face=\"Times New Roman\"><font color=\"#c24f4a\">需要在pom文件中增加依赖：</font><font color=\"#000000\">\n</font></font><pre style=\"color: rgb(0, 0, 0);\"><font size=\"3\" style=\"\" face=\"Times New Roman\">&lt;dependency&gt;<br>    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br>    &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;<br>&lt;/dependency&gt;</font></pre><br></pre></li><li><pre style=\"color: rgb(0, 0, 0);\"><font size=\"3\" style=\"\" face=\"Times New Roman\">通过执行日志的执行顺序可以看出过滤器——拦截器——AOP（需加注解@Aspect）,@Component注解是SpringBoot最基本的注解，表示将这个类交给Spring来管理</font></pre></li></ul></blockquote>","success":true}
2022-08-18 22:29:59.724 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613558879752192 [0;39m ------------- 结束 耗时：43 ms -------------
2022-08-18 22:30:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613560234512384 [0;39m 生成今日电子书快照开始
2022-08-18 22:30:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613560234512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:30:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613560234512384 [0;39m ==> Parameters: 
2022-08-18 22:30:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613560234512384 [0;39m <==    Updates: 0
2022-08-18 22:30:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613560234512384 [0;39m 生成今日电子书快照结束，耗时：12 毫秒
2022-08-18 22:30:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17613581247975424 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:30:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613581247975424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:30:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613581247975424 [0;39m ==> Parameters: 
2022-08-18 22:30:05.050 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613581247975424 [0;39m <==    Updates: 7
2022-08-18 22:30:05.050 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17613581247975424 [0;39m 更新电子书下的文档数据结束，耗时：36 毫秒
2022-08-18 22:30:05.050 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613581398970368 [0;39m 生成今日电子书快照开始
2022-08-18 22:30:05.050 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613581398970368 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:30:05.051 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613581398970368 [0;39m ==> Parameters: 
2022-08-18 22:30:05.083 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613581398970368 [0;39m <==    Updates: 0
2022-08-18 22:30:05.083 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613581398970368 [0;39m 生成今日电子书快照结束，耗时：33 毫秒
2022-08-18 22:30:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613602219495424 [0;39m 生成今日电子书快照开始
2022-08-18 22:30:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613602219495424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:30:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613602219495424 [0;39m ==> Parameters: 
2022-08-18 22:30:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613602219495424 [0;39m <==    Updates: 0
2022-08-18 22:30:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613602219495424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:30:10.053 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613602383073280 [0;39m ------------- 开始 -------------
2022-08-18 22:30:10.054 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613602383073280 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202715412436226048 GET
2022-08-18 22:30:10.054 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613602383073280 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-18 22:30:10.054 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613602383073280 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:30:10.054 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613602383073280 [0;39m 请求参数: [202715412436226048]
2022-08-18 22:30:10.054 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613602383073280 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-18 22:30:10.054 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613602383073280 [0;39m ==> Parameters: 202715412436226048(Long)
2022-08-18 22:30:10.060 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613602383073280 [0;39m <==    Columns: id, content
2022-08-18 22:30:10.061 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613602383073280 [0;39m <==        Row: 202715412436226048, <<BLOB>>
2022-08-18 22:30:10.061 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613602383073280 [0;39m <==      Total: 1
2022-08-18 22:30:10.062 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613602383073280 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-18 22:30:10.063 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613602383073280 [0;39m ==> Parameters: 202715412436226048(Long)
2022-08-18 22:30:10.096 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613602383073280 [0;39m <==    Updates: 1
2022-08-18 22:30:10.096 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613602383073280 [0;39m 返回结果: {"content":"<blockquote><ul><li><font size=\"4\">集成PageHelper分页插件</font><br><font size=\"3\" face=\"宋体\">首先在pom文件中导入相应的依赖<br><br></font></li><li><font size=\"4\" face=\"黑体\">请求参数封装：PageReq</font></li><li><font size=\"4\"><font face=\"黑体\">返回结果封装：PageResp</font><br></font></li><li><p><font size=\"4\" face=\"黑体\">POST请求，如果是以json方式提交，后端参数需要增加@RequestBody，如果是以form方式提交，则不需要加任何注解&nbsp;</font></p></li><li><font size=\"4\" style=\"font-family: 黑体;\">集成Validation做参数校验</font><br><font size=\"3\" style=\"\" face=\"宋体\">1. 首先在pom文件中导入相应依赖<br>2. 在控制层的函数中比如list函数加入@Valid注解，开启校验</font></li><li><font style=\"\" size=\"4\" face=\"黑体\"><p style=\"\">使用@PathVariable获取url上的参数&nbsp;</p></font></li><li><font size=\"4\" style=\"\" face=\"黑体\">util/tool.ts的作用：(js对象复制：将json对象转为json字符串，再转回json对象)<br></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=\"宋体\" style=\"font-size: medium;\">因为在前端页面中比如电子书管理任一电子书点击编辑的时候，在编辑过程中未保存的时候页面的电子书内容已经修改，即使点击取消也已经修改了。所以说需要将页面中各个电子书的内容保存到一个变量中，然后从这个变量中编辑修改</font><br><font face=\"Times New Roman\" style=\"\"><font size=\"3\">&nbsp; &nbsp;</font><font size=\"4\" color=\"#c24f4a\"> ebook.value=record--&gt;&nbsp;ebook.value=Tool.copy(record)</font></font><br></li></ul></blockquote><hr><h1 id=\"ewi1n\" style=\"text-align:center;\"><span style=\"background-color: rgb(70, 172, 200);\">面试题</span></h1><blockquote><ul><li><font face=\"黑体\" size=\"5\">雪花算法的组成部分：时间戳、数据中心、机器中心、序列号</font></li><li><font style=\"font-family: 黑体;\"><font size=\"5\">什么是物理分页，什么是逻辑分页？</font><br></font><br><font size=\"3\" style=\"\"><font face=\"宋体\">&nbsp; &nbsp;<b><u>物理分页：</u></b>依赖的是某一物理实体，这个物理实体就是数据库，比如MySQL数据库提供了limit关键字，只需要编写带有limit关键字的SQL语句，数据库返回的就是分页结果。</font><br><p style=\"\"><font face=\"Times New Roman\"><span style=\"font-size: medium; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, &quot;Helvetica Neue&quot;, Arial, &quot;Noto Sans&quot;, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;;\">&nbsp; &nbsp;&nbsp;</span></font><span style=\"font-size: 14px;\">&nbsp;</span><span style=\"font-family: &quot;Times New Roman&quot;; font-size: 1em;\">SELECT * FROM `shop` LIMIT (currentPage-1)*pageSize, pageSize;<br></span><br><font size=\"3\" style=\"\" face=\"宋体\"><u><b>&nbsp; 逻辑分页（内存分页）：</b></u></font><font face=\"宋体\" style=\"\" size=\"3\">逻辑分页依赖的是算法。数据库返回的是全部数据，然后通过算法获取分页数据，常用的操作是一次性从数据库中查询出全部数据并存储到List集合中，因为List集合有序，再根据索引获取指定范围的数据。<br></font></p><p><font face=\"Times New Roman\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT * FROM 'shop';<br></font></p><h3><font face=\"Times New Roman\" id=\"wef4y\"><font color=\"#c24f4a\">分页对比：</font><br><font color=\"#000000\">1. 数据库负担：</font></font><font size=\"3\" face=\"宋体\">物理分页每次都访问数据库，逻辑分页只访问一次数据库，物理分页对数据库造成的负担大。<br></font></h3><h2></h2><h3>2. 服务器负担：<font size=\"3\" face=\"宋体\">逻辑分页一次性将数据读取到内存，占用了较大的内存空间，物理分页每次只读取一部分数据，占用内存空间较小。</font><br></h3><h3>3. 实时性：<font size=\"3\" face=\"宋体\">逻辑分页一次性将数据读取到内存，数据发生改变，数据库的最新状态不能实时反映到操作中，实时性差。物理分页每次需要数据时都访问数据库，能够获取数据库的最新状态，实时性强。</font><br>4.适用场合：<font size=\"3\" face=\"宋体\">逻辑分页主要用于数据量不大、数据稳定的场合，物理分页主要用于数据量较大、更新频繁的场合。</font></h3></font></li><li><font size=\"5\" style=\"font-family: 黑体;\">数据库ID有哪些设计方法，都有什么优缺点？</font><br><font color=\"#8baa4a\" style=\"font-family: 宋体; font-size: large; font-weight: bold;\">1. 数据库自增生成的id：</font><br><font color=\"#000000\" style=\"\"><b style=\"font-family: 宋体; font-size: large;\">&nbsp; &nbsp;</b><span style=\"font-size: large; font-weight: bold;\"><font face=\"黑体\" style=\"\"> 优点：&nbsp;</font></span><font size=\"3\" style=\"font-family: 宋体;\">简单，成本小。<br></font></font><font face=\"宋体\">&nbsp; </font><b style=\"font-family: 黑体; font-size: large;\">&nbsp; &nbsp;&nbsp;</b><b style=\"font-family: 黑体; font-size: large;\">缺点:</b><b style=\"font-family: 黑体; font-size: large;\">&nbsp;&nbsp;</b><font size=\"3\" style=\"\" face=\"宋体\">强依赖DB，单点故障（在</font><font face=\"宋体\" size=\"3\">单个数据库或读写分离或一主多从的情况下，只有一个主库可以生成。有单点故障的风险。）、数据一致性问题、当性能达不到要求时难于扩展。<br></font><font color=\"#8baa4a\" style=\"font-family: 宋体; font-size: large; font-weight: bold;\">2. UUID：<br></font>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style=\"font-family: 黑体; font-size: large; font-weight: bold;\"> 优点：</span><span style=\"font-family: 黑体; font-size: large;\"> 1.</span><font size=\"3\" style=\"\"><font face=\"黑体\">非</font><font face=\"宋体\">常简单、本地生成，代码方便，API调用方便。<br></font></font>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2. <font face=\"宋体\" size=\"3\">性能高。生成的id性能非常好，没有网络消耗，基本不会有性能问题。<br></font>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3. <font face=\"宋体\" size=\"3\">全球唯一。在数据库迁移、系统数据合并、或者数据库变更的情况下，可以从容应对。<br></font>&nbsp; &nbsp; &nbsp; &nbsp; <span style=\"font-size: large; font-family: 黑体;\">&nbsp; </span><span style=\"font-size: large; font-weight: bold; font-family: 黑体;\">缺点：</span><font face=\"黑体\" style=\"font-size: large; font-weight: bold;\">&nbsp; </font><font face=\"宋体\" style=\"\" size=\"3\">存储成本高、信息不安全、不适用作为主键、UUID是无序的、传输数据量大、不可读。<br></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=\"#c24f4a\">&nbsp;&nbsp;<font face=\"宋体\" size=\"3\">在Java中我们可以直接使用下面的API生成UUID：<br></font></font>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style=\"background-color: rgb(249, 150, 59);\">&nbsp; <font face=\"Times New Roman\">UUID uuid = UUID.randomUUID();<br></font></span><p><font face=\"Times New Roman\" style=\"background-color: rgb(249, 150, 59);\"><span style=\"font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, &quot;Helvetica Neue&quot;, Arial, &quot;Noto Sans&quot;, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span>String s = UUID.randomUUID().toString()</font></p><font color=\"#8baa4a\" style=\"font-family: 宋体; font-size: large; font-weight: bold;\">3. 雪花算法：<br>&nbsp; &nbsp;</font><font style=\"font-weight: bold;\"><font color=\"#000000\" style=\"\" size=\"4\" face=\"黑体\"> 优点：<br></font></font>&nbsp; &nbsp; &nbsp;<font face=\"宋体\" size=\"3\"> &nbsp; &nbsp; &nbsp; 1. 高并发分布式环境下生成不重复 id，每秒可生成百万个不重复 id。<br>&nbsp; &nbsp; &nbsp; &nbsp; 2. 基于时间戳，以及同一时间戳下序列号自增，基本保证 id 有序递增。<br>&nbsp; &nbsp; &nbsp; &nbsp; 3. 不依赖第三方库或者中间件。<br>&nbsp; &nbsp; &nbsp; &nbsp; 4. 算法简单，在内存中进行，效率高。</font>&nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font size=\"4\" face=\"黑体\"><b>&nbsp; 缺点：</b></font><font size=\"3\" face=\"宋体\">依赖服务器时间，服务器时钟回拨时可能会生成重复 id。算法中可通过记录最后一个生成 id 时的时间戳来解决，每次生成 id 之前比较当前服务器时钟是否被回拨，避免生成重复 id。</font></li><li><font size=\"5\" face=\"黑体\"><p style=\"\">什么是前端校验？什么是后端校验？<span style=\"font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, &quot;Helvetica Neue&quot;, Arial, &quot;Noto Sans&quot;, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p></font></li></ul><p><b>&nbsp; &nbsp;</b><font face=\"宋体\" size=\"3\" style=\"font-weight: bold;\"> &nbsp;</font><font face=\"宋体\" size=\"4\" style=\"\"><b><i>前端校验：</i></b></font><font face=\"宋体\" size=\"3\" style=\"font-weight: bold;\">主要是针对用户输入时，一些基础的错误进行提示，提升用户体验</font><font face=\"宋体\" size=\"3\">。比如：参数为空，密码邮箱的组合规则等。归根到底是对所有请求的一种过滤操作，如果前端都校验不通过当然就没必要请求后端了，这样可以减轻服务器负担。</font></p><p style=\"text-align:center;\"><font face=\"宋体\" size=\"3\" color=\"#c24f4a\"><b>但是：对于某些不走寻常路的用户，前端校验其实形同虚设。<br></b></font></p><h3 style=\"text-align:center;\">&nbsp; &nbsp; &nbsp; <font face=\"宋体\"><b style=\"\"><font size=\"4\"><i>后端校验：</i></font></b><font size=\"3\">是针对整个系统的业务逻辑进行校验，比如用户权限，token验证等。校验范围比前端更大</font></font>。<br><strong style=\"background-color: rgb(194, 79, 74);\">前端校验是辅助，后端校验是核心。后端校验必不可少。</strong><br></h3></blockquote>","success":true}
2022-08-18 22:30:10.097 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613602383073280 [0;39m ------------- 结束 耗时：44 ms -------------
2022-08-18 22:30:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613623195209728 [0;39m 生成今日电子书快照开始
2022-08-18 22:30:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613623195209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:30:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613623195209728 [0;39m ==> Parameters: 
2022-08-18 22:30:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613623195209728 [0;39m <==    Updates: 0
2022-08-18 22:30:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613623195209728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:30:20.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613644103815168 [0;39m 生成今日电子书快照开始
2022-08-18 22:30:20.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613644103815168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:30:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613644103815168 [0;39m ==> Parameters: 
2022-08-18 22:30:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613644103815168 [0;39m <==    Updates: 0
2022-08-18 22:30:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613644103815168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:30:21.188 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613649086648320 [0;39m ------------- 开始 -------------
2022-08-18 22:30:21.188 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613649086648320 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202715412436226048 GET
2022-08-18 22:30:21.189 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613649086648320 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-18 22:30:21.189 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613649086648320 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:30:21.189 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613649086648320 [0;39m 请求参数: [202715412436226048]
2022-08-18 22:30:21.190 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613649086648320 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-18 22:30:21.191 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613649086648320 [0;39m ==> Parameters: 202715412436226048(Long)
2022-08-18 22:30:21.192 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613649086648320 [0;39m <==    Columns: id, content
2022-08-18 22:30:21.193 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613649086648320 [0;39m <==        Row: 202715412436226048, <<BLOB>>
2022-08-18 22:30:21.193 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613649086648320 [0;39m <==      Total: 1
2022-08-18 22:30:21.193 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613649086648320 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-18 22:30:21.194 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613649086648320 [0;39m ==> Parameters: 202715412436226048(Long)
2022-08-18 22:30:21.259 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613649086648320 [0;39m <==    Updates: 1
2022-08-18 22:30:21.259 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613649086648320 [0;39m 返回结果: {"content":"<blockquote><ul><li><font size=\"4\">集成PageHelper分页插件</font><br><font size=\"3\" face=\"宋体\">首先在pom文件中导入相应的依赖<br><br></font></li><li><font size=\"4\" face=\"黑体\">请求参数封装：PageReq</font></li><li><font size=\"4\"><font face=\"黑体\">返回结果封装：PageResp</font><br></font></li><li><p><font size=\"4\" face=\"黑体\">POST请求，如果是以json方式提交，后端参数需要增加@RequestBody，如果是以form方式提交，则不需要加任何注解&nbsp;</font></p></li><li><font size=\"4\" style=\"font-family: 黑体;\">集成Validation做参数校验</font><br><font size=\"3\" style=\"\" face=\"宋体\">1. 首先在pom文件中导入相应依赖<br>2. 在控制层的函数中比如list函数加入@Valid注解，开启校验</font></li><li><font style=\"\" size=\"4\" face=\"黑体\"><p style=\"\">使用@PathVariable获取url上的参数&nbsp;</p></font></li><li><font size=\"4\" style=\"\" face=\"黑体\">util/tool.ts的作用：(js对象复制：将json对象转为json字符串，再转回json对象)<br></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=\"宋体\" style=\"font-size: medium;\">因为在前端页面中比如电子书管理任一电子书点击编辑的时候，在编辑过程中未保存的时候页面的电子书内容已经修改，即使点击取消也已经修改了。所以说需要将页面中各个电子书的内容保存到一个变量中，然后从这个变量中编辑修改</font><br><font face=\"Times New Roman\" style=\"\"><font size=\"3\">&nbsp; &nbsp;</font><font size=\"4\" color=\"#c24f4a\"> ebook.value=record--&gt;&nbsp;ebook.value=Tool.copy(record)</font></font><br></li></ul></blockquote><hr><h1 id=\"ewi1n\" style=\"text-align:center;\"><span style=\"background-color: rgb(70, 172, 200);\">面试题</span></h1><blockquote><ul><li><font face=\"黑体\" size=\"5\">雪花算法的组成部分：时间戳、数据中心、机器中心、序列号</font></li><li><font style=\"font-family: 黑体;\"><font size=\"5\">什么是物理分页，什么是逻辑分页？</font><br></font><br><font size=\"3\" style=\"\"><font face=\"宋体\">&nbsp; &nbsp;<b><u>物理分页：</u></b>依赖的是某一物理实体，这个物理实体就是数据库，比如MySQL数据库提供了limit关键字，只需要编写带有limit关键字的SQL语句，数据库返回的就是分页结果。</font><br><p style=\"\"><font face=\"Times New Roman\"><span style=\"font-size: medium; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, &quot;Helvetica Neue&quot;, Arial, &quot;Noto Sans&quot;, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;;\">&nbsp; &nbsp;&nbsp;</span></font><span style=\"font-size: 14px;\">&nbsp;</span><span style=\"font-family: &quot;Times New Roman&quot;; font-size: 1em;\">SELECT * FROM `shop` LIMIT (currentPage-1)*pageSize, pageSize;<br></span><br><font size=\"3\" style=\"\" face=\"宋体\"><u><b>&nbsp; 逻辑分页（内存分页）：</b></u></font><font face=\"宋体\" style=\"\" size=\"3\">逻辑分页依赖的是算法。数据库返回的是全部数据，然后通过算法获取分页数据，常用的操作是一次性从数据库中查询出全部数据并存储到List集合中，因为List集合有序，再根据索引获取指定范围的数据。<br></font></p><p><font face=\"Times New Roman\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT * FROM 'shop';<br></font></p><h3><font face=\"Times New Roman\" id=\"wef4y\"><font color=\"#c24f4a\">分页对比：</font><br><font color=\"#000000\">1. 数据库负担：</font></font><font size=\"3\" face=\"宋体\">物理分页每次都访问数据库，逻辑分页只访问一次数据库，物理分页对数据库造成的负担大。<br></font></h3><h2></h2><h3>2. 服务器负担：<font size=\"3\" face=\"宋体\">逻辑分页一次性将数据读取到内存，占用了较大的内存空间，物理分页每次只读取一部分数据，占用内存空间较小。</font><br></h3><h3>3. 实时性：<font size=\"3\" face=\"宋体\">逻辑分页一次性将数据读取到内存，数据发生改变，数据库的最新状态不能实时反映到操作中，实时性差。物理分页每次需要数据时都访问数据库，能够获取数据库的最新状态，实时性强。</font><br>4.适用场合：<font size=\"3\" face=\"宋体\">逻辑分页主要用于数据量不大、数据稳定的场合，物理分页主要用于数据量较大、更新频繁的场合。</font></h3></font></li><li><font size=\"5\" style=\"font-family: 黑体;\">数据库ID有哪些设计方法，都有什么优缺点？</font><br><font color=\"#8baa4a\" style=\"font-family: 宋体; font-size: large; font-weight: bold;\">1. 数据库自增生成的id：</font><br><font color=\"#000000\" style=\"\"><b style=\"font-family: 宋体; font-size: large;\">&nbsp; &nbsp;</b><span style=\"font-size: large; font-weight: bold;\"><font face=\"黑体\" style=\"\"> 优点：&nbsp;</font></span><font size=\"3\" style=\"font-family: 宋体;\">简单，成本小。<br></font></font><font face=\"宋体\">&nbsp; </font><b style=\"font-family: 黑体; font-size: large;\">&nbsp; &nbsp;&nbsp;</b><b style=\"font-family: 黑体; font-size: large;\">缺点:</b><b style=\"font-family: 黑体; font-size: large;\">&nbsp;&nbsp;</b><font size=\"3\" style=\"\" face=\"宋体\">强依赖DB，单点故障（在</font><font face=\"宋体\" size=\"3\">单个数据库或读写分离或一主多从的情况下，只有一个主库可以生成。有单点故障的风险。）、数据一致性问题、当性能达不到要求时难于扩展。<br></font><font color=\"#8baa4a\" style=\"font-family: 宋体; font-size: large; font-weight: bold;\">2. UUID：<br></font>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style=\"font-family: 黑体; font-size: large; font-weight: bold;\"> 优点：</span><span style=\"font-family: 黑体; font-size: large;\"> 1.</span><font size=\"3\" style=\"\"><font face=\"黑体\">非</font><font face=\"宋体\">常简单、本地生成，代码方便，API调用方便。<br></font></font>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2. <font face=\"宋体\" size=\"3\">性能高。生成的id性能非常好，没有网络消耗，基本不会有性能问题。<br></font>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3. <font face=\"宋体\" size=\"3\">全球唯一。在数据库迁移、系统数据合并、或者数据库变更的情况下，可以从容应对。<br></font>&nbsp; &nbsp; &nbsp; &nbsp; <span style=\"font-size: large; font-family: 黑体;\">&nbsp; </span><span style=\"font-size: large; font-weight: bold; font-family: 黑体;\">缺点：</span><font face=\"黑体\" style=\"font-size: large; font-weight: bold;\">&nbsp; </font><font face=\"宋体\" style=\"\" size=\"3\">存储成本高、信息不安全、不适用作为主键、UUID是无序的、传输数据量大、不可读。<br></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=\"#c24f4a\">&nbsp;&nbsp;<font face=\"宋体\" size=\"3\">在Java中我们可以直接使用下面的API生成UUID：<br></font></font>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style=\"background-color: rgb(249, 150, 59);\">&nbsp; <font face=\"Times New Roman\">UUID uuid = UUID.randomUUID();<br></font></span><p><font face=\"Times New Roman\" style=\"background-color: rgb(249, 150, 59);\"><span style=\"font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, &quot;Helvetica Neue&quot;, Arial, &quot;Noto Sans&quot;, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span>String s = UUID.randomUUID().toString()</font></p><font color=\"#8baa4a\" style=\"font-family: 宋体; font-size: large; font-weight: bold;\">3. 雪花算法：<br>&nbsp; &nbsp;</font><font style=\"font-weight: bold;\"><font color=\"#000000\" style=\"\" size=\"4\" face=\"黑体\"> 优点：<br></font></font>&nbsp; &nbsp; &nbsp;<font face=\"宋体\" size=\"3\"> &nbsp; &nbsp; &nbsp; 1. 高并发分布式环境下生成不重复 id，每秒可生成百万个不重复 id。<br>&nbsp; &nbsp; &nbsp; &nbsp; 2. 基于时间戳，以及同一时间戳下序列号自增，基本保证 id 有序递增。<br>&nbsp; &nbsp; &nbsp; &nbsp; 3. 不依赖第三方库或者中间件。<br>&nbsp; &nbsp; &nbsp; &nbsp; 4. 算法简单，在内存中进行，效率高。</font>&nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font size=\"4\" face=\"黑体\"><b>&nbsp; 缺点：</b></font><font size=\"3\" face=\"宋体\">依赖服务器时间，服务器时钟回拨时可能会生成重复 id。算法中可通过记录最后一个生成 id 时的时间戳来解决，每次生成 id 之前比较当前服务器时钟是否被回拨，避免生成重复 id。</font></li><li><font size=\"5\" face=\"黑体\"><p style=\"\">什么是前端校验？什么是后端校验？<span style=\"font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, &quot;Helvetica Neue&quot;, Arial, &quot;Noto Sans&quot;, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p></font></li></ul><p><b>&nbsp; &nbsp;</b><font face=\"宋体\" size=\"3\" style=\"font-weight: bold;\"> &nbsp;</font><font face=\"宋体\" size=\"4\" style=\"\"><b><i>前端校验：</i></b></font><font face=\"宋体\" size=\"3\" style=\"font-weight: bold;\">主要是针对用户输入时，一些基础的错误进行提示，提升用户体验</font><font face=\"宋体\" size=\"3\">。比如：参数为空，密码邮箱的组合规则等。归根到底是对所有请求的一种过滤操作，如果前端都校验不通过当然就没必要请求后端了，这样可以减轻服务器负担。</font></p><p style=\"text-align:center;\"><font face=\"宋体\" size=\"3\" color=\"#c24f4a\"><b>但是：对于某些不走寻常路的用户，前端校验其实形同虚设。<br></b></font></p><h3 style=\"text-align:center;\">&nbsp; &nbsp; &nbsp; <font face=\"宋体\"><b style=\"\"><font size=\"4\"><i>后端校验：</i></font></b><font size=\"3\">是针对整个系统的业务逻辑进行校验，比如用户权限，token验证等。校验范围比前端更大</font></font>。<br><strong style=\"background-color: rgb(194, 79, 74);\">前端校验是辅助，后端校验是核心。后端校验必不可少。</strong><br></h3></blockquote>","success":true}
2022-08-18 22:30:21.259 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613649086648320 [0;39m ------------- 结束 耗时：71 ms -------------
2022-08-18 22:30:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613665079529472 [0;39m 生成今日电子书快照开始
2022-08-18 22:30:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613665079529472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:30:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613665079529472 [0;39m ==> Parameters: 
2022-08-18 22:30:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613665079529472 [0;39m <==    Updates: 0
2022-08-18 22:30:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613665079529472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:30:25.658 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613667835187200 [0;39m ------------- 开始 -------------
2022-08-18 22:30:25.658 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613667835187200 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202715466249146368 GET
2022-08-18 22:30:25.659 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613667835187200 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-18 22:30:25.659 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613667835187200 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:30:25.659 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613667835187200 [0;39m 请求参数: [202715466249146368]
2022-08-18 22:30:25.659 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613667835187200 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-18 22:30:25.660 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613667835187200 [0;39m ==> Parameters: 202715466249146368(Long)
2022-08-18 22:30:25.661 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613667835187200 [0;39m <==    Columns: id, content
2022-08-18 22:30:25.661 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613667835187200 [0;39m <==        Row: 202715466249146368, <<BLOB>>
2022-08-18 22:30:25.662 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613667835187200 [0;39m <==      Total: 1
2022-08-18 22:30:25.662 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613667835187200 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-18 22:30:25.663 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613667835187200 [0;39m ==> Parameters: 202715466249146368(Long)
2022-08-18 22:30:25.690 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613667835187200 [0;39m <==    Updates: 1
2022-08-18 22:30:25.691 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613667835187200 [0;39m 返回结果: {"content":"<blockquote><h2 id=\"1ke3d\">如何将数组转换成一个树形JSON结构？<br>&nbsp; &nbsp; &nbsp; &nbsp; Tool.ts<br></h2></blockquote>","success":true}
2022-08-18 22:30:25.691 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613667835187200 [0;39m ------------- 结束 耗时：33 ms -------------
2022-08-18 22:30:27.504 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613675573678080 [0;39m ------------- 开始 -------------
2022-08-18 22:30:27.504 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613675573678080 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202715537334210560 GET
2022-08-18 22:30:27.504 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613675573678080 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-18 22:30:27.504 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613675573678080 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:30:27.505 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613675573678080 [0;39m 请求参数: [202715537334210560]
2022-08-18 22:30:27.505 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613675573678080 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-18 22:30:27.506 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613675573678080 [0;39m ==> Parameters: 202715537334210560(Long)
2022-08-18 22:30:27.507 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613675573678080 [0;39m <==    Columns: id, content
2022-08-18 22:30:27.507 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613675573678080 [0;39m <==        Row: 202715537334210560, <<BLOB>>
2022-08-18 22:30:27.508 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613675573678080 [0;39m <==      Total: 1
2022-08-18 22:30:27.508 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613675573678080 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-18 22:30:27.509 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613675573678080 [0;39m ==> Parameters: 202715537334210560(Long)
2022-08-18 22:30:27.536 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613675573678080 [0;39m <==    Updates: 1
2022-08-18 22:30:27.536 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613675573678080 [0;39m 返回结果: {"content":"<blockquote><h2 id=\"1ovx1\">利用userRoute()函数中的route.query.ebookId获取点击哪一个电子书的id获取ebookId</h2></blockquote>","success":true}
2022-08-18 22:30:27.537 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613675573678080 [0;39m ------------- 结束 耗时：34 ms -------------
2022-08-18 22:30:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613686097186816 [0;39m 生成今日电子书快照开始
2022-08-18 22:30:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613686097186816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:30:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613686097186816 [0;39m ==> Parameters: 
2022-08-18 22:30:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613686097186816 [0;39m <==    Updates: 0
2022-08-18 22:30:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613686097186816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:30:34.904 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613706615721984 [0;39m ------------- 开始 -------------
2022-08-18 22:30:34.905 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613706615721984 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202715537334210560 GET
2022-08-18 22:30:34.905 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613706615721984 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-18 22:30:34.905 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613706615721984 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:30:34.905 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613706615721984 [0;39m 请求参数: [202715537334210560]
2022-08-18 22:30:34.906 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613706615721984 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-18 22:30:34.907 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613706615721984 [0;39m ==> Parameters: 202715537334210560(Long)
2022-08-18 22:30:34.908 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613706615721984 [0;39m <==    Columns: id, content
2022-08-18 22:30:34.909 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613706615721984 [0;39m <==        Row: 202715537334210560, <<BLOB>>
2022-08-18 22:30:34.909 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613706615721984 [0;39m <==      Total: 1
2022-08-18 22:30:34.910 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613706615721984 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-18 22:30:34.911 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613706615721984 [0;39m ==> Parameters: 202715537334210560(Long)
2022-08-18 22:30:34.947 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613706615721984 [0;39m <==    Updates: 1
2022-08-18 22:30:34.947 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613706615721984 [0;39m 返回结果: {"content":"<blockquote><h2 id=\"1ovx1\">利用userRoute()函数中的route.query.ebookId获取点击哪一个电子书的id获取ebookId</h2></blockquote>","success":true}
2022-08-18 22:30:34.947 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613706615721984 [0;39m ------------- 结束 耗时：43 ms -------------
2022-08-18 22:30:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613707077095424 [0;39m 生成今日电子书快照开始
2022-08-18 22:30:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613707077095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:30:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613707077095424 [0;39m ==> Parameters: 
2022-08-18 22:30:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613707077095424 [0;39m <==    Updates: 0
2022-08-18 22:30:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613707077095424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:30:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17613707085484032 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:30:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613707085484032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:30:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613707085484032 [0;39m ==> Parameters: 
2022-08-18 22:30:35.036 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613707085484032 [0;39m <==    Updates: 7
2022-08-18 22:30:35.036 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17613707085484032 [0;39m 更新电子书下的文档数据结束，耗时：20 毫秒
2022-08-18 22:30:36.268 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613712336752640 [0;39m ------------- 开始 -------------
2022-08-18 22:30:36.269 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613712336752640 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202715583089872896 GET
2022-08-18 22:30:36.269 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613712336752640 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-18 22:30:36.269 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613712336752640 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:30:36.270 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613712336752640 [0;39m 请求参数: [202715583089872896]
2022-08-18 22:30:36.271 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613712336752640 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-18 22:30:36.271 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613712336752640 [0;39m ==> Parameters: 202715583089872896(Long)
2022-08-18 22:30:36.272 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613712336752640 [0;39m <==    Columns: id, content
2022-08-18 22:30:36.273 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613712336752640 [0;39m <==        Row: 202715583089872896, <<BLOB>>
2022-08-18 22:30:36.274 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613712336752640 [0;39m <==      Total: 1
2022-08-18 22:30:36.274 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613712336752640 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-18 22:30:36.275 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613712336752640 [0;39m ==> Parameters: 202715583089872896(Long)
2022-08-18 22:30:36.295 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613712336752640 [0;39m <==    Updates: 1
2022-08-18 22:30:36.295 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613712336752640 [0;39m 返回结果: {"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\">4. 前、后端保存token</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4. 前、后端保存token</font></p></div></blockquote>","success":true}
2022-08-18 22:30:36.295 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613712336752640 [0;39m ------------- 结束 耗时：27 ms -------------
2022-08-18 22:30:39.871 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613727448829952 [0;39m ------------- 开始 -------------
2022-08-18 22:30:39.871 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613727448829952 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202714909656616960 GET
2022-08-18 22:30:39.871 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613727448829952 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-18 22:30:39.872 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613727448829952 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:30:39.872 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613727448829952 [0;39m 请求参数: [202714909656616960]
2022-08-18 22:30:39.873 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613727448829952 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-18 22:30:39.873 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613727448829952 [0;39m ==> Parameters: 202714909656616960(Long)
2022-08-18 22:30:39.874 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613727448829952 [0;39m <==    Columns: id, content
2022-08-18 22:30:39.875 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613727448829952 [0;39m <==        Row: 202714909656616960, <<BLOB>>
2022-08-18 22:30:39.875 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613727448829952 [0;39m <==      Total: 1
2022-08-18 22:30:39.876 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613727448829952 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-18 22:30:39.876 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613727448829952 [0;39m ==> Parameters: 202714909656616960(Long)
2022-08-18 22:30:39.897 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613727448829952 [0;39m <==    Updates: 1
2022-08-18 22:30:39.897 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613727448829952 [0;39m 返回结果: {"content":"<blockquote><h2><b>前端：</b>Vue CLI(生成一个前端框架)、Vue3、Ant Design Vue(UI组件)、router、vuex、axios</h2><p><br></p><h2><b>后端：</b>SpringBoot核心知识体系AOP、拦截器、过滤器、异步化、定时任务、websocket、多环境、缓存、消息队列...</h2></blockquote><p><img src=\"https://obohe.com/i/2022/07/29/m04bxh.png\" style=\"max-width:100%;\"><br></p>","success":true}
2022-08-18 22:30:39.897 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613727448829952 [0;39m ------------- 结束 耗时：26 ms -------------
2022-08-18 22:30:40.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613727989895168 [0;39m 生成今日电子书快照开始
2022-08-18 22:30:40.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613727989895168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:30:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613727989895168 [0;39m ==> Parameters: 
2022-08-18 22:30:40.035 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613727989895168 [0;39m <==    Updates: 0
2022-08-18 22:30:40.035 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613727989895168 [0;39m 生成今日电子书快照结束，耗时：35 毫秒
2022-08-18 22:30:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613749020135424 [0;39m 生成今日电子书快照开始
2022-08-18 22:30:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613749020135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:30:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613749020135424 [0;39m ==> Parameters: 
2022-08-18 22:30:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613749020135424 [0;39m <==    Updates: 0
2022-08-18 22:30:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613749020135424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:30:47.779 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613760617385984 [0;39m ------------- 开始 -------------
2022-08-18 22:30:47.780 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613760617385984 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202715069841281024 GET
2022-08-18 22:30:47.780 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613760617385984 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-18 22:30:47.780 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613760617385984 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:30:47.780 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613760617385984 [0;39m 请求参数: [202715069841281024]
2022-08-18 22:30:47.781 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613760617385984 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-18 22:30:47.781 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613760617385984 [0;39m ==> Parameters: 202715069841281024(Long)
2022-08-18 22:30:47.782 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613760617385984 [0;39m <==    Columns: id, content
2022-08-18 22:30:47.783 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613760617385984 [0;39m <==        Row: 202715069841281024, <<BLOB>>
2022-08-18 22:30:47.783 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613760617385984 [0;39m <==      Total: 1
2022-08-18 22:30:47.784 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613760617385984 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-18 22:30:47.784 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613760617385984 [0;39m ==> Parameters: 202715069841281024(Long)
2022-08-18 22:30:47.815 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613760617385984 [0;39m <==    Updates: 1
2022-08-18 22:30:47.816 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613760617385984 [0;39m 返回结果: {"content":"<blockquote><h2 id=\"343h7\">1. 在远程仓库上创建一个新项目，将本地项目关联到远程仓库</h2></blockquote><p style=\"text-align:center;\"><span style=\"background-color: rgb(77, 128, 191);\"><font face=\"华文楷体\" size=\"3\">自定义启动端开始的文案网址：patorjk.com</font></span><br></p><blockquote><h2 id=\"lbj1m\"></h2><h2 id=\"y1h2i\"></h2><h3 id=\"g91hj\"></h3><h1 id=\"vfo4x\"></h1><h4 id=\"t6wlk\"><h2 id=\"y3p29\"><xmp>2.  Restful风格：GET（查找） ,POST(新增),PUT（修改）,DELETE（删除）</font></xmp><xmp> 正常情况：user？id=1</xmp><xmp> Restful：/user/1</xmp></h2></h4></blockquote><p><br></p><blockquote><p><font size=\"4\" face=\"Times New Roman\">3. @RestController和@Controller区别：<br></font>&nbsp; &nbsp;&nbsp;<font size=\"4\" face=\"Times New Roman\">@GetMapping(\"/hello\")<br>    public String hello(){<br>        return \"hello\";<br>    }</font></p></blockquote><div><div><p><font size=\"3\" face=\"黑体\">&nbsp;</font><font size=\"3\" face=\"楷体\"> &nbsp;<span style=\"background-color: rgb(255, 255, 255); color: rgba(0, 0, 0, 0.85); font-variant-ligatures: normal; font-variant-caps: normal; float: none; display: inline !important;\">&nbsp;&nbsp;&nbsp;</span><span style=\"background-color: rgb(255, 255, 255); color: rgba(0, 0, 0, 0.85); font-variant-ligatures: normal; font-variant-caps: normal; float: none; display: inline !important;\">@RestController一般用来返回字符串即返回“hello”，@Controller用来返回一个页面hello.html</span></font></p><p><font face=\"楷体\"><font size=\"3\">&nbsp; &nbsp;</font>&nbsp; &nbsp;&nbsp;<span style=\"font-size: medium;\">@RestController=@Controller+@ResponseBody(返回字符串或JSON对象)</span></font></p><p><br></p><blockquote><p><font face=\"黑体\" size=\"4\">4. resources文件夹下的application.properties/yml能够被识别，将其放入子文件夹中也一样可以，同样也可以识别bootstrap.properties/yml</font></p><p><b>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style=\"background-color: rgb(139, 170, 74);\">&nbsp;properties-&gt;yml格式网站：<span style=\"font-size: 1em;\">toyaml.com/index.html&nbsp; &nbsp;</span></span></b><font face=\"黑体\" size=\"4\"><br></font></p><p><i><font size=\"3\"><u><font color=\"#c24f4a\">bootstrap:</font></u>一般用于动态配置，线上实时修改，实时生效的配置，一般可配合nacos使用</font></i><font face=\"黑体\" size=\"4\"><br></font></p><span style=\"background-color: rgb(139, 170, 74);\"></span></blockquote><blockquote><p><font face=\"仿宋\" size=\"4\">5.配置集成热部署：代码及时生效</font></p></blockquote><ul><li style=\"\"><font size=\"3\" face=\"仿宋\">&nbsp;</font><font size=\"3\" face=\"黑体\">添加依赖：</font></li></ul><blockquote><div><pre><font size=\"3\" face=\"Times New Roman\">&lt;!--热部署--&gt;<br>&lt;dependency&gt;<br>    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br>    &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;<br>&lt;/dependency&gt;</font></pre></div></blockquote><p><br></p><ul><li><hr></li><li><font size=\"4\">勾选Build project automatically</font></li></ul><p><img src=\"https://i.postimg.cc/G3qNkhrF/83cd2913ee9d7d81366087dab707da3.jpg\" style=\"max-width:100%;\" width=\"100%\"><br></p><hr><ul><li><font size=\"4\" face=\"仿宋\">按两次shift键</font></li><li><img src=\"https://i.postimg.cc/DzxY3n6Q/0bd555589af48fa57b01b9230dbb31f.jpg\" style=\"max-width:100%;\"><br></li></ul><p><br></p><ul><li><img src=\"https://i.postimg.cc/W4xgky1L/78bd304480a2a1eb6a1f90cd955e9ce.jpg\" style=\"max-width:100%;\"><br></li></ul><hr><ul><li style=\"text-align:center;\"><span style=\"background-color: rgb(194, 79, 74);\"><font size=\"5\">2021版本的IDEA将上面这个勾选项移动到了别的地方，下面是2021版本的修改</font></span></li></ul><div style=\"text-align: center;\"><font size=\"3\"><br></font></div><ul><li><br></li><li><img src=\"https://i.postimg.cc/sxjXQP7C/71d856aaae65177b7e791458f6c8d27.jpg\"></li></ul></div><p><br></p></div>","success":true}
2022-08-18 22:30:47.816 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613760617385984 [0;39m ------------- 结束 耗时：37 ms -------------
2022-08-18 22:30:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613769979072512 [0;39m 生成今日电子书快照开始
2022-08-18 22:30:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613769979072512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:30:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613769979072512 [0;39m ==> Parameters: 
2022-08-18 22:30:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613769979072512 [0;39m <==    Updates: 0
2022-08-18 22:30:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613769979072512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:30:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613790946398208 [0;39m 生成今日电子书快照开始
2022-08-18 22:30:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613790946398208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:30:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613790946398208 [0;39m ==> Parameters: 
2022-08-18 22:30:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613790946398208 [0;39m <==    Updates: 0
2022-08-18 22:30:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613790946398208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:30:57.749 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613802434596864 [0;39m ------------- 开始 -------------
2022-08-18 22:30:57.749 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613802434596864 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202715583089872896 GET
2022-08-18 22:30:57.750 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613802434596864 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-18 22:30:57.750 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613802434596864 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:30:57.750 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613802434596864 [0;39m 请求参数: [202715583089872896]
2022-08-18 22:30:57.751 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613802434596864 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-18 22:30:57.752 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613802434596864 [0;39m ==> Parameters: 202715583089872896(Long)
2022-08-18 22:30:57.753 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613802434596864 [0;39m <==    Columns: id, content
2022-08-18 22:30:57.754 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17613802434596864 [0;39m <==        Row: 202715583089872896, <<BLOB>>
2022-08-18 22:30:57.754 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17613802434596864 [0;39m <==      Total: 1
2022-08-18 22:30:57.755 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613802434596864 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-18 22:30:57.755 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613802434596864 [0;39m ==> Parameters: 202715583089872896(Long)
2022-08-18 22:30:57.848 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17613802434596864 [0;39m <==    Updates: 1
2022-08-18 22:30:57.849 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613802434596864 [0;39m 返回结果: {"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\">4. 前、后端保存token</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4. 前、后端保存token</font></p></div></blockquote>","success":true}
2022-08-18 22:30:57.849 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613802434596864 [0;39m ------------- 结束 耗时：100 ms -------------
2022-08-18 22:31:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613811926306816 [0;39m 生成今日电子书快照开始
2022-08-18 22:31:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613811926306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:31:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613811926306816 [0;39m ==> Parameters: 
2022-08-18 22:31:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613811926306816 [0;39m <==    Updates: 0
2022-08-18 22:31:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613811926306816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:31:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17613832893632512 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:31:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613832893632512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:31:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613832893632512 [0;39m ==> Parameters: 
2022-08-18 22:31:05.063 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613832893632512 [0;39m <==    Updates: 7
2022-08-18 22:31:05.064 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17613832893632512 [0;39m 更新电子书下的文档数据结束，耗时：53 毫秒
2022-08-18 22:31:05.064 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613833115930624 [0;39m 生成今日电子书快照开始
2022-08-18 22:31:05.064 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613833115930624 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:31:05.064 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613833115930624 [0;39m ==> Parameters: 
2022-08-18 22:31:05.096 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613833115930624 [0;39m <==    Updates: 0
2022-08-18 22:31:05.096 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613833115930624 [0;39m 生成今日电子书快照结束，耗时：32 毫秒
2022-08-18 22:31:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613853873541120 [0;39m 生成今日电子书快照开始
2022-08-18 22:31:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613853873541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:31:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613853873541120 [0;39m ==> Parameters: 
2022-08-18 22:31:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613853873541120 [0;39m <==    Updates: 0
2022-08-18 22:31:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613853873541120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:31:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613874798923776 [0;39m 生成今日电子书快照开始
2022-08-18 22:31:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613874798923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:31:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613874798923776 [0;39m ==> Parameters: 
2022-08-18 22:31:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613874798923776 [0;39m <==    Updates: 0
2022-08-18 22:31:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613874798923776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:31:16.228 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m17613495117942784 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-18 22:31:16.229 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m17613495117942784 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-18 22:31:16.229 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m17613495117942784 [0;39m 登录校验开始，token：17610697500397568
2022-08-18 22:31:16.264 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m17613495117942784 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"17610697500397568"}
2022-08-18 22:31:16.265 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613880096329728 [0;39m ------------- 开始 -------------
2022-08-18 22:31:16.265 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613880096329728 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-18 22:31:16.266 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613880096329728 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-18 22:31:16.266 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613880096329728 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:31:16.266 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613880096329728 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4. 前、后端保存token</font></p></div></blockquote>","ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1}]
2022-08-18 22:31:16.267 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17613880096329728 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-18 22:31:16.267 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17613880096329728 [0;39m ==> Parameters: 202714600712572928(Long), 0(Long), 用户管理功能开发(String), 9(Integer), 9(Integer), 1(Integer), 202715583089872896(Long)
2022-08-18 22:31:16.271 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17613880096329728 [0;39m <==    Updates: 1
2022-08-18 22:31:16.272 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17613880096329728 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-18 22:31:16.272 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17613880096329728 [0;39m ==> Parameters: <blockquote><h2 id="fii37">密码加密存储和传输（MDS）<br><font face="宋体"><font size="3">&nbsp;</font><b style=""><font size="4">传输加密： </font></b><font size="3">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size="3" face="Times New Roman"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）
</b></font>&nbsp;&nbsp;<font face="宋体" style=""><b style="font-size: large;">存储加密：</b><font size="3">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size="3"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id="90d5d">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id="9l5yg">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face="Times New Roman" size="3"><font color="#c24f4a">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id="rckur">单点登录token与JWT介绍</h2><h3 id="o9527"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size="3">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4. 前、后端保存token</font></p></div></blockquote>(String), 202715583089872896(Long)
2022-08-18 22:31:16.274 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17613880096329728 [0;39m <==    Updates: 1
2022-08-18 22:31:16.338 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613880096329728 [0;39m 返回结果: {"success":true}
2022-08-18 22:31:16.338 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613880096329728 [0;39m ------------- 结束 耗时：73 ms -------------
2022-08-18 22:31:16.339 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m17613880096329728 [0;39m ------------- LoginInterceptor 结束 耗时：110 ms -------------
2022-08-18 22:31:16.351 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17613880457039872 [0;39m ------------- 开始 -------------
2022-08-18 22:31:16.351 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17613880457039872 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-18 22:31:16.351 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17613880457039872 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-18 22:31:16.351 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17613880457039872 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:31:16.351 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17613880457039872 [0;39m 请求参数: [202714600712572928]
2022-08-18 22:31:16.352 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17613880457039872 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-18 22:31:16.352 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17613880457039872 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-18 22:31:16.353 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613880457039872 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-18 22:31:16.353 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613880457039872 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 48, 5
2022-08-18 22:31:16.353 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613880457039872 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 41, 4
2022-08-18 22:31:16.354 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613880457039872 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-18 22:31:16.354 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613880457039872 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 22, 3
2022-08-18 22:31:16.354 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613880457039872 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 26, 5
2022-08-18 22:31:16.354 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613880457039872 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 25, 2
2022-08-18 22:31:16.354 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613880457039872 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 10, 2
2022-08-18 22:31:16.355 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613880457039872 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 11, 3
2022-08-18 22:31:16.355 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613880457039872 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 9, 1
2022-08-18 22:31:16.355 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613880457039872 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 7, 1
2022-08-18 22:31:16.356 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613880457039872 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 4, 1
2022-08-18 22:31:16.356 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17613880457039872 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 3, 2
2022-08-18 22:31:16.356 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17613880457039872 [0;39m <==      Total: 12
2022-08-18 22:31:16.358 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17613880457039872 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":48,"voteCount":5},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":41,"voteCount":4},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":22,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":26,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":25,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":10,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":11,"voteCount":3},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":7,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":4,"voteCount":1},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":3,"voteCount":2}],"success":true}
2022-08-18 22:31:16.358 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17613880457039872 [0;39m ------------- 结束 耗时：7 ms -------------
2022-08-18 22:31:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613895795609600 [0;39m 生成今日电子书快照开始
2022-08-18 22:31:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613895795609600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:31:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613895795609600 [0;39m ==> Parameters: 
2022-08-18 22:31:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613895795609600 [0;39m <==    Updates: 0
2022-08-18 22:31:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613895795609600 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:31:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613916775518208 [0;39m 生成今日电子书快照开始
2022-08-18 22:31:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613916775518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:31:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613916775518208 [0;39m ==> Parameters: 
2022-08-18 22:31:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613916775518208 [0;39m <==    Updates: 0
2022-08-18 22:31:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613916775518208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:31:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613937759621120 [0;39m 生成今日电子书快照开始
2022-08-18 22:31:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613937759621120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:31:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613937759621120 [0;39m ==> Parameters: 
2022-08-18 22:31:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613937759621120 [0;39m <==    Updates: 0
2022-08-18 22:31:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613937759621120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:31:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17613958697586688 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:31:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613958697586688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:31:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613958697586688 [0;39m ==> Parameters: 
2022-08-18 22:31:35.040 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17613958697586688 [0;39m <==    Updates: 7
2022-08-18 22:31:35.041 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17613958697586688 [0;39m 更新电子书下的文档数据结束，耗时：36 毫秒
2022-08-18 22:31:35.041 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613958848581632 [0;39m 生成今日电子书快照开始
2022-08-18 22:31:35.041 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613958848581632 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:31:35.041 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613958848581632 [0;39m ==> Parameters: 
2022-08-18 22:31:35.067 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613958848581632 [0;39m <==    Updates: 0
2022-08-18 22:31:35.067 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613958848581632 [0;39m 生成今日电子书快照结束，耗时：26 毫秒
2022-08-18 22:31:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17613979706855424 [0;39m 生成今日电子书快照开始
2022-08-18 22:31:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613979706855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:31:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613979706855424 [0;39m ==> Parameters: 
2022-08-18 22:31:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17613979706855424 [0;39m <==    Updates: 0
2022-08-18 22:31:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17613979706855424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:31:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614000657403904 [0;39m 生成今日电子书快照开始
2022-08-18 22:31:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614000657403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:31:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614000657403904 [0;39m ==> Parameters: 
2022-08-18 22:31:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614000657403904 [0;39m <==    Updates: 0
2022-08-18 22:31:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614000657403904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:31:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614021633118208 [0;39m 生成今日电子书快照开始
2022-08-18 22:31:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614021633118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:31:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614021633118208 [0;39m ==> Parameters: 
2022-08-18 22:31:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614021633118208 [0;39m <==    Updates: 0
2022-08-18 22:31:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614021633118208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:31:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614042617221120 [0;39m 生成今日电子书快照开始
2022-08-18 22:31:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614042617221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:31:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614042617221120 [0;39m ==> Parameters: 
2022-08-18 22:31:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614042617221120 [0;39m <==    Updates: 0
2022-08-18 22:31:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614042617221120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:32:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614063559380992 [0;39m 生成今日电子书快照开始
2022-08-18 22:32:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614063559380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:32:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614063559380992 [0;39m ==> Parameters: 
2022-08-18 22:32:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614063559380992 [0;39m <==    Updates: 0
2022-08-18 22:32:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614063559380992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:32:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17614084551872512 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:32:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614084551872512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:32:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614084551872512 [0;39m ==> Parameters: 
2022-08-18 22:32:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614084551872512 [0;39m <==    Updates: 7
2022-08-18 22:32:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17614084551872512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:32:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614084560261120 [0;39m 生成今日电子书快照开始
2022-08-18 22:32:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614084560261120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:32:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614084560261120 [0;39m ==> Parameters: 
2022-08-18 22:32:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614084560261120 [0;39m <==    Updates: 0
2022-08-18 22:32:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614084560261120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:32:09.914 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m17613503561076736 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-18 22:32:09.915 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m17613503561076736 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-18 22:32:09.915 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m17613503561076736 [0;39m 登录校验开始，token：17610697500397568
2022-08-18 22:32:09.952 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m17613503561076736 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"17610697500397568"}
2022-08-18 22:32:09.953 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17614105280122880 [0;39m ------------- 开始 -------------
2022-08-18 22:32:09.953 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17614105280122880 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-18 22:32:09.953 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17614105280122880 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-18 22:32:09.953 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17614105280122880 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:32:09.953 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17614105280122880 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p></div></blockquote>","ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1}]
2022-08-18 22:32:09.954 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17614105280122880 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-18 22:32:09.955 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17614105280122880 [0;39m ==> Parameters: 202714600712572928(Long), 0(Long), 用户管理功能开发(String), 9(Integer), 9(Integer), 1(Integer), 202715583089872896(Long)
2022-08-18 22:32:09.955 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17614105280122880 [0;39m <==    Updates: 1
2022-08-18 22:32:09.956 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17614105280122880 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-18 22:32:09.956 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17614105280122880 [0;39m ==> Parameters: <blockquote><h2 id="fii37">密码加密存储和传输（MDS）<br><font face="宋体"><font size="3">&nbsp;</font><b style=""><font size="4">传输加密： </font></b><font size="3">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size="3" face="Times New Roman"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）
</b></font>&nbsp;&nbsp;<font face="宋体" style=""><b style="font-size: large;">存储加密：</b><font size="3">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size="3"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id="90d5d">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id="9l5yg">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face="Times New Roman" size="3"><font color="#c24f4a">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id="rckur">单点登录token与JWT介绍</h2><h3 id="o9527"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size="3">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p></div></blockquote>(String), 202715583089872896(Long)
2022-08-18 22:32:09.962 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17614105280122880 [0;39m <==    Updates: 1
2022-08-18 22:32:09.992 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17614105280122880 [0;39m 返回结果: {"success":true}
2022-08-18 22:32:09.992 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17614105280122880 [0;39m ------------- 结束 耗时：39 ms -------------
2022-08-18 22:32:09.993 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m17614105280122880 [0;39m ------------- LoginInterceptor 结束 耗时：78 ms -------------
2022-08-18 22:32:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614105485643776 [0;39m 生成今日电子书快照开始
2022-08-18 22:32:10.002 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17614105485643777 [0;39m ------------- 开始 -------------
2022-08-18 22:32:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614105485643776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:32:10.003 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17614105485643777 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-18 22:32:10.003 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17614105485643777 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-18 22:32:10.003 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17614105485643777 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:32:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614105485643776 [0;39m ==> Parameters: 
2022-08-18 22:32:10.003 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17614105485643777 [0;39m 请求参数: [202714600712572928]
2022-08-18 22:32:10.005 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17614105485643777 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-18 22:32:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614105485643776 [0;39m <==    Updates: 0
2022-08-18 22:32:10.005 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17614105485643777 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-18 22:32:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614105485643776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:32:10.006 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614105485643777 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-18 22:32:10.006 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614105485643777 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 48, 5
2022-08-18 22:32:10.007 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614105485643777 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 41, 4
2022-08-18 22:32:10.007 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614105485643777 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-18 22:32:10.007 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614105485643777 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 22, 3
2022-08-18 22:32:10.008 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614105485643777 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 26, 5
2022-08-18 22:32:10.008 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614105485643777 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 25, 2
2022-08-18 22:32:10.008 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614105485643777 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 10, 2
2022-08-18 22:32:10.009 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614105485643777 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 11, 3
2022-08-18 22:32:10.009 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614105485643777 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 9, 1
2022-08-18 22:32:10.009 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614105485643777 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 7, 1
2022-08-18 22:32:10.009 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614105485643777 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 4, 1
2022-08-18 22:32:10.010 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614105485643777 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 3, 2
2022-08-18 22:32:10.010 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17614105485643777 [0;39m <==      Total: 12
2022-08-18 22:32:10.011 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17614105485643777 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":48,"voteCount":5},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":41,"voteCount":4},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":22,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":26,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":25,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":10,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":11,"voteCount":3},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":7,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":4,"voteCount":1},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":3,"voteCount":2}],"success":true}
2022-08-18 22:32:10.011 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17614105485643777 [0;39m ------------- 结束 耗时：9 ms -------------
2022-08-18 22:32:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614126499106816 [0;39m 生成今日电子书快照开始
2022-08-18 22:32:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614126499106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:32:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614126499106816 [0;39m ==> Parameters: 
2022-08-18 22:32:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614126499106816 [0;39m <==    Updates: 0
2022-08-18 22:32:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614126499106816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:32:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614147466432512 [0;39m 生成今日电子书快照开始
2022-08-18 22:32:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614147466432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:32:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614147466432512 [0;39m ==> Parameters: 
2022-08-18 22:32:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614147466432512 [0;39m <==    Updates: 0
2022-08-18 22:32:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614147466432512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:32:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614168400203776 [0;39m 生成今日电子书快照开始
2022-08-18 22:32:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614168400203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:32:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614168400203776 [0;39m ==> Parameters: 
2022-08-18 22:32:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614168400203776 [0;39m <==    Updates: 0
2022-08-18 22:32:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614168400203776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:32:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614189396889600 [0;39m 生成今日电子书快照开始
2022-08-18 22:32:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614189396889600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:32:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614189396889600 [0;39m ==> Parameters: 
2022-08-18 22:32:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614189396889600 [0;39m <==    Updates: 0
2022-08-18 22:32:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614189396889600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:32:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614210360020992 [0;39m 生成今日电子书快照开始
2022-08-18 22:32:35.109 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614210360020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:32:35.110 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614210360020992 [0;39m ==> Parameters: 
2022-08-18 22:32:35.111 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614210360020992 [0;39m <==    Updates: 0
2022-08-18 22:32:35.111 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614210360020992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:32:35.112 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17614210804617216 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:32:35.112 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614210804617216 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:32:35.112 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614210804617216 [0;39m ==> Parameters: 
2022-08-18 22:32:35.113 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614210804617216 [0;39m <==    Updates: 7
2022-08-18 22:32:35.113 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17614210804617216 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:32:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614231352512512 [0;39m 生成今日电子书快照开始
2022-08-18 22:32:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614231352512512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:32:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614231352512512 [0;39m ==> Parameters: 
2022-08-18 22:32:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614231352512512 [0;39m <==    Updates: 0
2022-08-18 22:32:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614231352512512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:32:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614252332421120 [0;39m 生成今日电子书快照开始
2022-08-18 22:32:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614252332421120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:32:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614252332421120 [0;39m ==> Parameters: 
2022-08-18 22:32:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614252332421120 [0;39m <==    Updates: 0
2022-08-18 22:32:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614252332421120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:32:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614273282969600 [0;39m 生成今日电子书快照开始
2022-08-18 22:32:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614273282969600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:32:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614273282969600 [0;39m ==> Parameters: 
2022-08-18 22:32:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614273282969600 [0;39m <==    Updates: 0
2022-08-18 22:32:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614273282969600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:32:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614294283849728 [0;39m 生成今日电子书快照开始
2022-08-18 22:32:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614294283849728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:32:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614294283849728 [0;39m ==> Parameters: 
2022-08-18 22:32:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614294283849728 [0;39m <==    Updates: 0
2022-08-18 22:32:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614294283849728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:33:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614315200843776 [0;39m 生成今日电子书快照开始
2022-08-18 22:33:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614315200843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:33:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614315200843776 [0;39m ==> Parameters: 
2022-08-18 22:33:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614315200843776 [0;39m <==    Updates: 0
2022-08-18 22:33:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614315200843776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:33:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17614336226889728 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:33:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614336226889728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:33:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614336226889728 [0;39m ==> Parameters: 
2022-08-18 22:33:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614336226889728 [0;39m <==    Updates: 7
2022-08-18 22:33:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17614336226889728 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:33:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614336235278336 [0;39m 生成今日电子书快照开始
2022-08-18 22:33:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614336235278336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:33:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614336235278336 [0;39m ==> Parameters: 
2022-08-18 22:33:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614336235278336 [0;39m <==    Updates: 0
2022-08-18 22:33:05.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614336235278336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:33:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614357198409728 [0;39m 生成今日电子书快照开始
2022-08-18 22:33:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614357198409728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:33:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614357198409728 [0;39m ==> Parameters: 
2022-08-18 22:33:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614357198409728 [0;39m <==    Updates: 0
2022-08-18 22:33:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614357198409728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:33:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614378157346816 [0;39m 生成今日电子书快照开始
2022-08-18 22:33:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614378157346816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:33:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614378157346816 [0;39m ==> Parameters: 
2022-08-18 22:33:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614378157346816 [0;39m <==    Updates: 0
2022-08-18 22:33:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614378157346816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:33:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614399128866816 [0;39m 生成今日电子书快照开始
2022-08-18 22:33:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614399128866816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:33:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614399128866816 [0;39m ==> Parameters: 
2022-08-18 22:33:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614399128866816 [0;39m <==    Updates: 0
2022-08-18 22:33:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614399128866816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:33:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614420054249472 [0;39m 生成今日电子书快照开始
2022-08-18 22:33:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614420054249472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:33:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614420054249472 [0;39m ==> Parameters: 
2022-08-18 22:33:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614420054249472 [0;39m <==    Updates: 0
2022-08-18 22:33:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614420054249472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:33:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614441025769472 [0;39m 生成今日电子书快照开始
2022-08-18 22:33:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614441025769472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:33:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614441025769472 [0;39m ==> Parameters: 
2022-08-18 22:33:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614441025769472 [0;39m <==    Updates: 0
2022-08-18 22:33:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614441025769472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:33:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614462060204032 [0;39m 生成今日电子书快照开始
2022-08-18 22:33:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614462060204032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:33:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614462060204032 [0;39m ==> Parameters: 
2022-08-18 22:33:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614462060204032 [0;39m <==    Updates: 0
2022-08-18 22:33:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614462060204032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:33:35.019 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17614462072786944 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:33:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614462072786944 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:33:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614462072786944 [0;39m ==> Parameters: 
2022-08-18 22:33:35.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614462072786944 [0;39m <==    Updates: 7
2022-08-18 22:33:35.021 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17614462072786944 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:33:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614483006558208 [0;39m 生成今日电子书快照开始
2022-08-18 22:33:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614483006558208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:33:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614483006558208 [0;39m ==> Parameters: 
2022-08-18 22:33:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614483006558208 [0;39m <==    Updates: 0
2022-08-18 22:33:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614483006558208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:33:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614503978078208 [0;39m 生成今日电子书快照开始
2022-08-18 22:33:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614503978078208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:33:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614503978078208 [0;39m ==> Parameters: 
2022-08-18 22:33:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614503978078208 [0;39m <==    Updates: 0
2022-08-18 22:33:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614503978078208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:33:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614524966375424 [0;39m 生成今日电子书快照开始
2022-08-18 22:33:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614524966375424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:33:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614524966375424 [0;39m ==> Parameters: 
2022-08-18 22:33:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614524966375424 [0;39m <==    Updates: 0
2022-08-18 22:33:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614524966375424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:33:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614545933701120 [0;39m 生成今日电子书快照开始
2022-08-18 22:33:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614545933701120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:33:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614545933701120 [0;39m ==> Parameters: 
2022-08-18 22:33:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614545933701120 [0;39m <==    Updates: 0
2022-08-18 22:33:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614545933701120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:34:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614566892638208 [0;39m 生成今日电子书快照开始
2022-08-18 22:34:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614566892638208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:34:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614566892638208 [0;39m ==> Parameters: 
2022-08-18 22:34:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614566892638208 [0;39m <==    Updates: 0
2022-08-18 22:34:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614566892638208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:34:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614587889324032 [0;39m 生成今日电子书快照开始
2022-08-18 22:34:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614587889324032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:34:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614587889324032 [0;39m ==> Parameters: 
2022-08-18 22:34:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614587889324032 [0;39m <==    Updates: 0
2022-08-18 22:34:05.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614587889324032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:34:05.019 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17614587901906944 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:34:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614587901906944 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:34:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614587901906944 [0;39m ==> Parameters: 
2022-08-18 22:34:05.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614587901906944 [0;39m <==    Updates: 7
2022-08-18 22:34:05.021 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17614587901906944 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:34:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614608823095296 [0;39m 生成今日电子书快照开始
2022-08-18 22:34:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614608823095296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:34:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614608823095296 [0;39m ==> Parameters: 
2022-08-18 22:34:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614608823095296 [0;39m <==    Updates: 0
2022-08-18 22:34:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614608823095296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:34:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614629773643776 [0;39m 生成今日电子书快照开始
2022-08-18 22:34:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614629773643776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:34:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614629773643776 [0;39m ==> Parameters: 
2022-08-18 22:34:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614629773643776 [0;39m <==    Updates: 0
2022-08-18 22:34:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614629773643776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:34:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614650761940992 [0;39m 生成今日电子书快照开始
2022-08-18 22:34:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614650761940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:34:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614650761940992 [0;39m ==> Parameters: 
2022-08-18 22:34:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614650761940992 [0;39m <==    Updates: 0
2022-08-18 22:34:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614650761940992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:34:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614671762821120 [0;39m 生成今日电子书快照开始
2022-08-18 22:34:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614671762821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:34:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614671762821120 [0;39m ==> Parameters: 
2022-08-18 22:34:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614671762821120 [0;39m <==    Updates: 0
2022-08-18 22:34:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614671762821120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:34:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614692684009472 [0;39m 生成今日电子书快照开始
2022-08-18 22:34:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614692684009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:34:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614692684009472 [0;39m ==> Parameters: 
2022-08-18 22:34:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614692684009472 [0;39m <==    Updates: 0
2022-08-18 22:34:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614692684009472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:34:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17614713697472512 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:34:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614713697472512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:34:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614713697472512 [0;39m ==> Parameters: 
2022-08-18 22:34:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614713697472512 [0;39m <==    Updates: 7
2022-08-18 22:34:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17614713697472512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:34:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614713705861120 [0;39m 生成今日电子书快照开始
2022-08-18 22:34:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614713705861120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:34:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614713705861120 [0;39m ==> Parameters: 
2022-08-18 22:34:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614713705861120 [0;39m <==    Updates: 0
2022-08-18 22:34:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614713705861120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:34:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614734664798208 [0;39m 生成今日电子书快照开始
2022-08-18 22:34:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614734664798208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:34:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614734664798208 [0;39m ==> Parameters: 
2022-08-18 22:34:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614734664798208 [0;39m <==    Updates: 0
2022-08-18 22:34:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614734664798208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:34:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614755627929600 [0;39m 生成今日电子书快照开始
2022-08-18 22:34:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614755627929600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:34:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614755627929600 [0;39m ==> Parameters: 
2022-08-18 22:34:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614755627929600 [0;39m <==    Updates: 0
2022-08-18 22:34:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614755627929600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:34:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614776624615424 [0;39m 生成今日电子书快照开始
2022-08-18 22:34:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614776624615424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:34:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614776624615424 [0;39m ==> Parameters: 
2022-08-18 22:34:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614776624615424 [0;39m <==    Updates: 0
2022-08-18 22:34:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614776624615424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:34:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614797583552512 [0;39m 生成今日电子书快照开始
2022-08-18 22:34:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614797583552512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:34:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614797583552512 [0;39m ==> Parameters: 
2022-08-18 22:34:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614797583552512 [0;39m <==    Updates: 0
2022-08-18 22:34:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614797583552512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:35:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614818513129472 [0;39m 生成今日电子书快照开始
2022-08-18 22:35:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614818513129472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:35:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614818513129472 [0;39m ==> Parameters: 
2022-08-18 22:35:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614818513129472 [0;39m <==    Updates: 0
2022-08-18 22:35:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614818513129472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:35:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17614839543369728 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:35:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614839543369728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:35:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614839543369728 [0;39m ==> Parameters: 
2022-08-18 22:35:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614839543369728 [0;39m <==    Updates: 7
2022-08-18 22:35:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17614839543369728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:35:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614839547564032 [0;39m 生成今日电子书快照开始
2022-08-18 22:35:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614839547564032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:35:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614839547564032 [0;39m ==> Parameters: 
2022-08-18 22:35:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614839547564032 [0;39m <==    Updates: 0
2022-08-18 22:35:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614839547564032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:35:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614860506501120 [0;39m 生成今日电子书快照开始
2022-08-18 22:35:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614860506501120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:35:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614860506501120 [0;39m ==> Parameters: 
2022-08-18 22:35:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614860506501120 [0;39m <==    Updates: 0
2022-08-18 22:35:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614860506501120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:35:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614881482215424 [0;39m 生成今日电子书快照开始
2022-08-18 22:35:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614881482215424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:35:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614881482215424 [0;39m ==> Parameters: 
2022-08-18 22:35:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614881482215424 [0;39m <==    Updates: 0
2022-08-18 22:35:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614881482215424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:35:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614902420180992 [0;39m 生成今日电子书快照开始
2022-08-18 22:35:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614902420180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:35:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614902420180992 [0;39m ==> Parameters: 
2022-08-18 22:35:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614902420180992 [0;39m <==    Updates: 0
2022-08-18 22:35:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614902420180992 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 22:35:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614923429449728 [0;39m 生成今日电子书快照开始
2022-08-18 22:35:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614923429449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:35:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614923429449728 [0;39m ==> Parameters: 
2022-08-18 22:35:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614923429449728 [0;39m <==    Updates: 0
2022-08-18 22:35:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614923429449728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:35:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614944384192512 [0;39m 生成今日电子书快照开始
2022-08-18 22:35:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614944384192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:35:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614944384192512 [0;39m ==> Parameters: 
2022-08-18 22:35:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614944384192512 [0;39m <==    Updates: 0
2022-08-18 22:35:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614944384192512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:35:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614965330546688 [0;39m 生成今日电子书快照开始
2022-08-18 22:35:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614965330546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:35:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614965330546688 [0;39m ==> Parameters: 
2022-08-18 22:35:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614965330546688 [0;39m <==    Updates: 0
2022-08-18 22:35:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614965330546688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:35:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17614965343129600 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:35:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614965343129600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:35:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614965343129600 [0;39m ==> Parameters: 
2022-08-18 22:35:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17614965343129600 [0;39m <==    Updates: 7
2022-08-18 22:35:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17614965343129600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:35:37.830 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m17613712336752640 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-18 22:35:37.830 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m17613712336752640 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-18 22:35:37.830 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m17613712336752640 [0;39m 登录校验开始，token：17610697500397568
2022-08-18 22:35:37.867 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m17613712336752640 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"17610697500397568"}
2022-08-18 22:35:37.868 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17614977338839040 [0;39m ------------- 开始 -------------
2022-08-18 22:35:37.869 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17614977338839040 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-18 22:35:37.869 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17614977338839040 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-18 22:35:37.869 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17614977338839040 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:35:37.870 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17614977338839040 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size=\"3\">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录</font><b><br></b></div></blockquote>","ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1}]
2022-08-18 22:35:37.871 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17614977338839040 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-18 22:35:37.871 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17614977338839040 [0;39m ==> Parameters: 202714600712572928(Long), 0(Long), 用户管理功能开发(String), 9(Integer), 9(Integer), 1(Integer), 202715583089872896(Long)
2022-08-18 22:35:37.872 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17614977338839040 [0;39m <==    Updates: 1
2022-08-18 22:35:37.872 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17614977338839040 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-18 22:35:37.872 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17614977338839040 [0;39m ==> Parameters: <blockquote><h2 id="fii37">密码加密存储和传输（MDS）<br><font face="宋体"><font size="3">&nbsp;</font><b style=""><font size="4">传输加密： </font></b><font size="3">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size="3" face="Times New Roman"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）
</b></font>&nbsp;&nbsp;<font face="宋体" style=""><b style="font-size: large;">存储加密：</b><font size="3">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size="3"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id="90d5d">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id="9l5yg">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face="Times New Roman" size="3"><font color="#c24f4a">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id="rckur">单点登录token与JWT介绍</h2><h3 id="o9527"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size="3">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size="3">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录</font><b><br></b></div></blockquote>(String), 202715583089872896(Long)
2022-08-18 22:35:37.878 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17614977338839040 [0;39m <==    Updates: 1
2022-08-18 22:35:37.916 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17614977338839040 [0;39m 返回结果: {"success":true}
2022-08-18 22:35:37.916 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17614977338839040 [0;39m ------------- 结束 耗时：48 ms -------------
2022-08-18 22:35:37.918 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m17614977338839040 [0;39m ------------- LoginInterceptor 结束 耗时：88 ms -------------
2022-08-18 22:35:37.935 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17614977619857408 [0;39m ------------- 开始 -------------
2022-08-18 22:35:37.936 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17614977619857408 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-18 22:35:37.936 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17614977619857408 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-18 22:35:37.937 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17614977619857408 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:35:37.937 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17614977619857408 [0;39m 请求参数: [202714600712572928]
2022-08-18 22:35:37.938 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17614977619857408 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-18 22:35:37.938 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17614977619857408 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-18 22:35:37.940 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614977619857408 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-18 22:35:37.940 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614977619857408 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 48, 5
2022-08-18 22:35:37.941 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614977619857408 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 41, 4
2022-08-18 22:35:37.941 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614977619857408 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-18 22:35:37.941 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614977619857408 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 22, 3
2022-08-18 22:35:37.941 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614977619857408 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 26, 5
2022-08-18 22:35:37.942 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614977619857408 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 25, 2
2022-08-18 22:35:37.942 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614977619857408 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 10, 2
2022-08-18 22:35:37.942 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614977619857408 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 11, 3
2022-08-18 22:35:37.942 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614977619857408 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 9, 1
2022-08-18 22:35:37.942 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614977619857408 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 7, 1
2022-08-18 22:35:37.943 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614977619857408 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 4, 1
2022-08-18 22:35:37.943 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17614977619857408 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 3, 2
2022-08-18 22:35:37.943 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17614977619857408 [0;39m <==      Total: 12
2022-08-18 22:35:37.944 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17614977619857408 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":48,"voteCount":5},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":41,"voteCount":4},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":22,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":26,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":25,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":10,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":11,"voteCount":3},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":7,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":4,"voteCount":1},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":3,"voteCount":2}],"success":true}
2022-08-18 22:35:37.944 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17614977619857408 [0;39m ------------- 结束 耗时：9 ms -------------
2022-08-18 22:35:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17614986335621120 [0;39m 生成今日电子书快照开始
2022-08-18 22:35:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614986335621120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:35:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614986335621120 [0;39m ==> Parameters: 
2022-08-18 22:35:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17614986335621120 [0;39m <==    Updates: 0
2022-08-18 22:35:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17614986335621120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:35:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615007256809472 [0;39m 生成今日电子书快照开始
2022-08-18 22:35:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615007256809472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:35:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615007256809472 [0;39m ==> Parameters: 
2022-08-18 22:35:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615007256809472 [0;39m <==    Updates: 0
2022-08-18 22:35:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615007256809472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:35:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615028266078208 [0;39m 生成今日电子书快照开始
2022-08-18 22:35:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615028266078208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:35:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615028266078208 [0;39m ==> Parameters: 
2022-08-18 22:35:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615028266078208 [0;39m <==    Updates: 0
2022-08-18 22:35:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615028266078208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:35:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615049245986816 [0;39m 生成今日电子书快照开始
2022-08-18 22:35:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615049245986816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:35:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615049245986816 [0;39m ==> Parameters: 
2022-08-18 22:35:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615049245986816 [0;39m <==    Updates: 0
2022-08-18 22:35:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615049245986816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:36:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615070200729600 [0;39m 生成今日电子书快照开始
2022-08-18 22:36:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615070200729600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:36:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615070200729600 [0;39m ==> Parameters: 
2022-08-18 22:36:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615070200729600 [0;39m <==    Updates: 0
2022-08-18 22:36:00.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615070200729600 [0;39m 生成今日电子书快照结束，耗时：11 毫秒
2022-08-18 22:36:05.000 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17615091138695168 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:36:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615091138695168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:36:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615091138695168 [0;39m ==> Parameters: 
2022-08-18 22:36:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615091138695168 [0;39m <==    Updates: 7
2022-08-18 22:36:05.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17615091138695168 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-18 22:36:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615091151278080 [0;39m 生成今日电子书快照开始
2022-08-18 22:36:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615091151278080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:36:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615091151278080 [0;39m ==> Parameters: 
2022-08-18 22:36:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615091151278080 [0;39m <==    Updates: 0
2022-08-18 22:36:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615091151278080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:36:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615112177324032 [0;39m 生成今日电子书快照开始
2022-08-18 22:36:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615112177324032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:36:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615112177324032 [0;39m ==> Parameters: 
2022-08-18 22:36:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615112177324032 [0;39m <==    Updates: 0
2022-08-18 22:36:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615112177324032 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:36:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615133148844032 [0;39m 生成今日电子书快照开始
2022-08-18 22:36:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615133148844032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:36:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615133148844032 [0;39m ==> Parameters: 
2022-08-18 22:36:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615133148844032 [0;39m <==    Updates: 0
2022-08-18 22:36:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615133148844032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:36:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615154078420992 [0;39m 生成今日电子书快照开始
2022-08-18 22:36:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615154078420992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:36:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615154078420992 [0;39m ==> Parameters: 
2022-08-18 22:36:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615154078420992 [0;39m <==    Updates: 0
2022-08-18 22:36:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615154078420992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:36:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615175054135296 [0;39m 生成今日电子书快照开始
2022-08-18 22:36:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615175054135296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:36:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615175054135296 [0;39m ==> Parameters: 
2022-08-18 22:36:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615175054135296 [0;39m <==    Updates: 0
2022-08-18 22:36:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615175054135296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:36:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615196017266688 [0;39m 生成今日电子书快照开始
2022-08-18 22:36:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615196017266688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:36:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615196017266688 [0;39m ==> Parameters: 
2022-08-18 22:36:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615196017266688 [0;39m <==    Updates: 0
2022-08-18 22:36:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615196017266688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:36:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17615216997175296 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:36:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615216997175296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:36:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615216997175296 [0;39m ==> Parameters: 
2022-08-18 22:36:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615216997175296 [0;39m <==    Updates: 7
2022-08-18 22:36:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17615216997175296 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:36:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615217001369600 [0;39m 生成今日电子书快照开始
2022-08-18 22:36:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615217001369600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:36:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615217001369600 [0;39m ==> Parameters: 
2022-08-18 22:36:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615217001369600 [0;39m <==    Updates: 0
2022-08-18 22:36:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615217001369600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:36:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615237993861120 [0;39m 生成今日电子书快照开始
2022-08-18 22:36:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615237993861120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:36:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615237993861120 [0;39m ==> Parameters: 
2022-08-18 22:36:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615237993861120 [0;39m <==    Updates: 0
2022-08-18 22:36:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615237993861120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:36:42.455 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m17613760617385984 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-18 22:36:42.455 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m17613760617385984 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-18 22:36:42.455 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m17613760617385984 [0;39m 登录校验开始，token：17610697500397568
2022-08-18 22:36:42.491 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m17613760617385984 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"17610697500397568"}
2022-08-18 22:36:42.492 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17615248391540736 [0;39m ------------- 开始 -------------
2022-08-18 22:36:42.492 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17615248391540736 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-18 22:36:42.492 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17615248391540736 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-18 22:36:42.492 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17615248391540736 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:36:42.493 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17615248391540736 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size=\"3\">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录。</font><b><br></b></div><div>&nbsp; &nbsp;<font size=\"3\"> X：用户管理、登录、登录校验、退出登录（X有可能只是接口也可以是页面）<br></font></div></blockquote>","ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1}]
2022-08-18 22:36:42.494 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17615248391540736 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-18 22:36:42.494 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17615248391540736 [0;39m ==> Parameters: 202714600712572928(Long), 0(Long), 用户管理功能开发(String), 9(Integer), 9(Integer), 1(Integer), 202715583089872896(Long)
2022-08-18 22:36:42.496 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17615248391540736 [0;39m <==    Updates: 1
2022-08-18 22:36:42.497 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17615248391540736 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-18 22:36:42.498 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17615248391540736 [0;39m ==> Parameters: <blockquote><h2 id="fii37">密码加密存储和传输（MDS）<br><font face="宋体"><font size="3">&nbsp;</font><b style=""><font size="4">传输加密： </font></b><font size="3">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size="3" face="Times New Roman"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）
</b></font>&nbsp;&nbsp;<font face="宋体" style=""><b style="font-size: large;">存储加密：</b><font size="3">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size="3"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id="90d5d">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id="9l5yg">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face="Times New Roman" size="3"><font color="#c24f4a">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id="rckur">单点登录token与JWT介绍</h2><h3 id="o9527"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size="3">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size="3">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录。</font><b><br></b></div><div>&nbsp; &nbsp;<font size="3"> X：用户管理、登录、登录校验、退出登录（X有可能只是接口也可以是页面）<br></font></div></blockquote>(String), 202715583089872896(Long)
2022-08-18 22:36:42.504 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17615248391540736 [0;39m <==    Updates: 1
2022-08-18 22:36:42.548 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17615248391540736 [0;39m 返回结果: {"success":true}
2022-08-18 22:36:42.548 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17615248391540736 [0;39m ------------- 结束 耗时：56 ms -------------
2022-08-18 22:36:42.549 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m17615248391540736 [0;39m ------------- LoginInterceptor 结束 耗时：94 ms -------------
2022-08-18 22:36:42.557 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17615248664170496 [0;39m ------------- 开始 -------------
2022-08-18 22:36:42.557 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17615248664170496 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-18 22:36:42.558 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17615248664170496 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-18 22:36:42.558 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17615248664170496 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:36:42.558 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17615248664170496 [0;39m 请求参数: [202714600712572928]
2022-08-18 22:36:42.559 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17615248664170496 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-18 22:36:42.560 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17615248664170496 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-18 22:36:42.560 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615248664170496 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-18 22:36:42.561 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615248664170496 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 48, 5
2022-08-18 22:36:42.561 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615248664170496 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 41, 4
2022-08-18 22:36:42.562 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615248664170496 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-18 22:36:42.562 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615248664170496 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 22, 3
2022-08-18 22:36:42.563 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615248664170496 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 26, 5
2022-08-18 22:36:42.564 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615248664170496 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 25, 2
2022-08-18 22:36:42.564 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615248664170496 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 10, 2
2022-08-18 22:36:42.564 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615248664170496 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 11, 3
2022-08-18 22:36:42.565 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615248664170496 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 9, 1
2022-08-18 22:36:42.565 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615248664170496 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 7, 1
2022-08-18 22:36:42.565 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615248664170496 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 4, 1
2022-08-18 22:36:42.566 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615248664170496 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 3, 2
2022-08-18 22:36:42.566 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17615248664170496 [0;39m <==      Total: 12
2022-08-18 22:36:42.567 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17615248664170496 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":48,"voteCount":5},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":41,"voteCount":4},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":22,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":26,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":25,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":10,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":11,"voteCount":3},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":7,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":4,"voteCount":1},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":3,"voteCount":2}],"success":true}
2022-08-18 22:36:42.567 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17615248664170496 [0;39m ------------- 结束 耗时：10 ms -------------
2022-08-18 22:36:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615258965381120 [0;39m 生成今日电子书快照开始
2022-08-18 22:36:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615258965381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:36:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615258965381120 [0;39m ==> Parameters: 
2022-08-18 22:36:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615258965381120 [0;39m <==    Updates: 0
2022-08-18 22:36:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615258965381120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:36:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615279903346688 [0;39m 生成今日电子书快照开始
2022-08-18 22:36:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615279903346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:36:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615279903346688 [0;39m ==> Parameters: 
2022-08-18 22:36:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615279903346688 [0;39m <==    Updates: 0
2022-08-18 22:36:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615279903346688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:36:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615300895838208 [0;39m 生成今日电子书快照开始
2022-08-18 22:36:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615300895838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:36:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615300895838208 [0;39m ==> Parameters: 
2022-08-18 22:36:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615300895838208 [0;39m <==    Updates: 0
2022-08-18 22:36:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615300895838208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:37:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615321829609472 [0;39m 生成今日电子书快照开始
2022-08-18 22:37:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615321829609472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:37:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615321829609472 [0;39m ==> Parameters: 
2022-08-18 22:37:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615321829609472 [0;39m <==    Updates: 0
2022-08-18 22:37:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615321829609472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:37:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615342864044032 [0;39m 生成今日电子书快照开始
2022-08-18 22:37:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615342864044032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:37:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615342864044032 [0;39m ==> Parameters: 
2022-08-18 22:37:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615342864044032 [0;39m <==    Updates: 0
2022-08-18 22:37:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615342864044032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:37:05.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17615342872432640 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:37:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615342872432640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:37:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615342872432640 [0;39m ==> Parameters: 
2022-08-18 22:37:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615342872432640 [0;39m <==    Updates: 7
2022-08-18 22:37:05.020 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17615342872432640 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:37:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615363785232384 [0;39m 生成今日电子书快照开始
2022-08-18 22:37:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615363785232384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:37:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615363785232384 [0;39m ==> Parameters: 
2022-08-18 22:37:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615363785232384 [0;39m <==    Updates: 0
2022-08-18 22:37:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615363785232384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:37:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615384765140992 [0;39m 生成今日电子书快照开始
2022-08-18 22:37:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615384765140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:37:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615384765140992 [0;39m ==> Parameters: 
2022-08-18 22:37:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615384765140992 [0;39m <==    Updates: 0
2022-08-18 22:37:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615384765140992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:37:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615405766021120 [0;39m 生成今日电子书快照开始
2022-08-18 22:37:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615405766021120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:37:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615405766021120 [0;39m ==> Parameters: 
2022-08-18 22:37:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615405766021120 [0;39m <==    Updates: 0
2022-08-18 22:37:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615405766021120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:37:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615426712375296 [0;39m 生成今日电子书快照开始
2022-08-18 22:37:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615426712375296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:37:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615426712375296 [0;39m ==> Parameters: 
2022-08-18 22:37:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615426712375296 [0;39m <==    Updates: 0
2022-08-18 22:37:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615426712375296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:37:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615447713255424 [0;39m 生成今日电子书快照开始
2022-08-18 22:37:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615447713255424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:37:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615447713255424 [0;39m ==> Parameters: 
2022-08-18 22:37:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615447713255424 [0;39m <==    Updates: 0
2022-08-18 22:37:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615447713255424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:37:35.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17615468676386816 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:37:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615468676386816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:37:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615468676386816 [0;39m ==> Parameters: 
2022-08-18 22:37:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615468676386816 [0;39m <==    Updates: 7
2022-08-18 22:37:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17615468676386816 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:37:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615468684775424 [0;39m 生成今日电子书快照开始
2022-08-18 22:37:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615468684775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:37:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615468684775424 [0;39m ==> Parameters: 
2022-08-18 22:37:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615468684775424 [0;39m <==    Updates: 0
2022-08-18 22:37:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615468684775424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:37:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615489610158080 [0;39m 生成今日电子书快照开始
2022-08-18 22:37:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615489610158080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:37:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615489610158080 [0;39m ==> Parameters: 
2022-08-18 22:37:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615489610158080 [0;39m <==    Updates: 0
2022-08-18 22:37:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615489610158080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:37:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615510581678080 [0;39m 生成今日电子书快照开始
2022-08-18 22:37:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615510581678080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:37:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615510581678080 [0;39m ==> Parameters: 
2022-08-18 22:37:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615510581678080 [0;39m <==    Updates: 0
2022-08-18 22:37:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615510581678080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:37:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615531549003776 [0;39m 生成今日电子书快照开始
2022-08-18 22:37:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615531549003776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:37:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615531549003776 [0;39m ==> Parameters: 
2022-08-18 22:37:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615531549003776 [0;39m <==    Updates: 0
2022-08-18 22:37:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615531549003776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:37:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615552520523776 [0;39m 生成今日电子书快照开始
2022-08-18 22:37:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615552520523776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:37:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615552520523776 [0;39m ==> Parameters: 
2022-08-18 22:37:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615552520523776 [0;39m <==    Updates: 0
2022-08-18 22:37:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615552520523776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:38:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615573496238080 [0;39m 生成今日电子书快照开始
2022-08-18 22:38:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615573496238080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:38:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615573496238080 [0;39m ==> Parameters: 
2022-08-18 22:38:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615573496238080 [0;39m <==    Updates: 0
2022-08-18 22:38:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615573496238080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:38:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17615594497118208 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:38:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615594497118208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:38:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615594497118208 [0;39m ==> Parameters: 
2022-08-18 22:38:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615594497118208 [0;39m <==    Updates: 7
2022-08-18 22:38:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17615594497118208 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:38:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615594505506816 [0;39m 生成今日电子书快照开始
2022-08-18 22:38:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615594505506816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:38:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615594505506816 [0;39m ==> Parameters: 
2022-08-18 22:38:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615594505506816 [0;39m <==    Updates: 0
2022-08-18 22:38:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615594505506816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:38:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615615493804032 [0;39m 生成今日电子书快照开始
2022-08-18 22:38:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615615493804032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:38:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615615493804032 [0;39m ==> Parameters: 
2022-08-18 22:38:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615615493804032 [0;39m <==    Updates: 0
2022-08-18 22:38:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615615493804032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:38:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615636440158208 [0;39m 生成今日电子书快照开始
2022-08-18 22:38:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615636440158208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:38:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615636440158208 [0;39m ==> Parameters: 
2022-08-18 22:38:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615636440158208 [0;39m <==    Updates: 0
2022-08-18 22:38:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615636440158208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:38:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615657399095296 [0;39m 生成今日电子书快照开始
2022-08-18 22:38:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615657399095296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:38:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615657399095296 [0;39m ==> Parameters: 
2022-08-18 22:38:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615657399095296 [0;39m <==    Updates: 0
2022-08-18 22:38:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615657399095296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:38:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615678349643776 [0;39m 生成今日电子书快照开始
2022-08-18 22:38:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615678349643776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:38:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615678349643776 [0;39m ==> Parameters: 
2022-08-18 22:38:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615678349643776 [0;39m <==    Updates: 0
2022-08-18 22:38:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615678349643776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:38:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615699325358080 [0;39m 生成今日电子书快照开始
2022-08-18 22:38:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615699325358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:38:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615699325358080 [0;39m ==> Parameters: 
2022-08-18 22:38:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615699325358080 [0;39m <==    Updates: 0
2022-08-18 22:38:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615699325358080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:38:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615720292683776 [0;39m 生成今日电子书快照开始
2022-08-18 22:38:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615720292683776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:38:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615720292683776 [0;39m ==> Parameters: 
2022-08-18 22:38:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615720292683776 [0;39m <==    Updates: 0
2022-08-18 22:38:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615720292683776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:38:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17615720309460992 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:38:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615720309460992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:38:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615720309460992 [0;39m ==> Parameters: 
2022-08-18 22:38:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615720309460992 [0;39m <==    Updates: 7
2022-08-18 22:38:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17615720309460992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:38:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615741310341120 [0;39m 生成今日电子书快照开始
2022-08-18 22:38:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615741310341120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:38:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615741310341120 [0;39m ==> Parameters: 
2022-08-18 22:38:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615741310341120 [0;39m <==    Updates: 0
2022-08-18 22:38:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615741310341120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:38:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615762239918080 [0;39m 生成今日电子书快照开始
2022-08-18 22:38:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615762239918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:38:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615762239918080 [0;39m ==> Parameters: 
2022-08-18 22:38:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615762239918080 [0;39m <==    Updates: 0
2022-08-18 22:38:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615762239918080 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-18 22:38:46.913 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m17613880457039872 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-18 22:38:46.913 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m17613880457039872 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-18 22:38:46.913 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m17613880457039872 [0;39m 登录校验开始，token：17610697500397568
2022-08-18 22:38:46.949 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m17613880457039872 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"17610697500397568"}
2022-08-18 22:38:46.950 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17615770406227968 [0;39m ------------- 开始 -------------
2022-08-18 22:38:46.951 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17615770406227968 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-18 22:38:46.951 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17615770406227968 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-18 22:38:46.951 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17615770406227968 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:38:46.952 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17615770406227968 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size=\"3\">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录。</font><b><br></b></div><div>&nbsp; &nbsp;<font size=\"3\"> X：用户管理、登录、登录校验、退出登录（X有可能只是接口也可以是页面）。<br></font></div><div><h2><b>token与JWT：</b></h2></div><h3><font size=\"3\">&nbsp; &nbsp;<b id=\"8bsf3\"> </b>token+redis：</font><b style=\"font-size: 1.17em;\">token是无意义的</b></h3><h3 id=\"cmxl6\">&nbsp; &nbsp; <b>JWT:token是有意义的，加密的，包含业务信息</b></h3></blockquote>","ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1}]
2022-08-18 22:38:46.953 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17615770406227968 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-18 22:38:46.954 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17615770406227968 [0;39m ==> Parameters: 202714600712572928(Long), 0(Long), 用户管理功能开发(String), 9(Integer), 9(Integer), 1(Integer), 202715583089872896(Long)
2022-08-18 22:38:46.955 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17615770406227968 [0;39m <==    Updates: 1
2022-08-18 22:38:46.955 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17615770406227968 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-18 22:38:46.956 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17615770406227968 [0;39m ==> Parameters: <blockquote><h2 id="fii37">密码加密存储和传输（MDS）<br><font face="宋体"><font size="3">&nbsp;</font><b style=""><font size="4">传输加密： </font></b><font size="3">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size="3" face="Times New Roman"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）
</b></font>&nbsp;&nbsp;<font face="宋体" style=""><b style="font-size: large;">存储加密：</b><font size="3">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size="3"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id="90d5d">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id="9l5yg">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face="Times New Roman" size="3"><font color="#c24f4a">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id="rckur">单点登录token与JWT介绍</h2><h3 id="o9527"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size="3">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size="3">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录。</font><b><br></b></div><div>&nbsp; &nbsp;<font size="3"> X：用户管理、登录、登录校验、退出登录（X有可能只是接口也可以是页面）。<br></font></div><div><h2><b>token与JWT：</b></h2></div><h3><font size="3">&nbsp; &nbsp;<b id="8bsf3"> </b>token+redis：</font><b style="font-size: 1.17em;">token是无意义的</b></h3><h3 id="cmxl6">&nbsp; &nbsp; <b>JWT:token是有意义的，加密的，包含业务信息</b></h3></blockquote>(String), 202715583089872896(Long)
2022-08-18 22:38:46.962 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17615770406227968 [0;39m <==    Updates: 1
2022-08-18 22:38:46.994 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17615770406227968 [0;39m 返回结果: {"success":true}
2022-08-18 22:38:46.994 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17615770406227968 [0;39m ------------- 结束 耗时：44 ms -------------
2022-08-18 22:38:46.995 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m17615770406227968 [0;39m ------------- LoginInterceptor 结束 耗时：82 ms -------------
2022-08-18 22:38:47.005 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17615770636914688 [0;39m ------------- 开始 -------------
2022-08-18 22:38:47.006 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17615770636914688 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-18 22:38:47.006 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17615770636914688 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-18 22:38:47.006 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17615770636914688 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:38:47.007 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17615770636914688 [0;39m 请求参数: [202714600712572928]
2022-08-18 22:38:47.008 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17615770636914688 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-18 22:38:47.009 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17615770636914688 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-18 22:38:47.010 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615770636914688 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-18 22:38:47.010 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615770636914688 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 48, 5
2022-08-18 22:38:47.010 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615770636914688 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 41, 4
2022-08-18 22:38:47.011 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615770636914688 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-18 22:38:47.011 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615770636914688 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 22, 3
2022-08-18 22:38:47.011 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615770636914688 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 26, 5
2022-08-18 22:38:47.011 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615770636914688 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 25, 2
2022-08-18 22:38:47.012 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615770636914688 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 10, 2
2022-08-18 22:38:47.012 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615770636914688 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 11, 3
2022-08-18 22:38:47.012 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615770636914688 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 9, 1
2022-08-18 22:38:47.013 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615770636914688 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 7, 1
2022-08-18 22:38:47.013 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615770636914688 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 4, 1
2022-08-18 22:38:47.013 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615770636914688 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 3, 2
2022-08-18 22:38:47.013 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17615770636914688 [0;39m <==      Total: 12
2022-08-18 22:38:47.014 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17615770636914688 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":48,"voteCount":5},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":41,"voteCount":4},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":22,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":26,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":25,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":10,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":11,"voteCount":3},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":7,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":4,"voteCount":1},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":3,"voteCount":2}],"success":true}
2022-08-18 22:38:47.014 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17615770636914688 [0;39m ------------- 结束 耗时：9 ms -------------
2022-08-18 22:38:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615783257575424 [0;39m 生成今日电子书快照开始
2022-08-18 22:38:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615783257575424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:38:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615783257575424 [0;39m ==> Parameters: 
2022-08-18 22:38:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615783257575424 [0;39m <==    Updates: 0
2022-08-18 22:38:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615783257575424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:38:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615804191346688 [0;39m 生成今日电子书快照开始
2022-08-18 22:38:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615804191346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:38:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615804191346688 [0;39m ==> Parameters: 
2022-08-18 22:38:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615804191346688 [0;39m <==    Updates: 0
2022-08-18 22:38:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615804191346688 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 22:38:56.594 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m17614105485643777 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-18 22:38:56.594 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m17614105485643777 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-18 22:38:56.594 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m17614105485643777 [0;39m 登录校验开始，token：17610697500397568
2022-08-18 22:38:56.633 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m17614105485643777 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"17610697500397568"}
2022-08-18 22:38:56.634 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17615811023867904 [0;39m ------------- 开始 -------------
2022-08-18 22:38:56.634 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17615811023867904 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-18 22:38:56.634 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17615811023867904 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-18 22:38:56.634 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17615811023867904 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:38:56.635 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17615811023867904 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size=\"3\">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录。</font><b><br></b></div><div>&nbsp; &nbsp;<font size=\"3\"> X：用户管理、登录、登录校验、退出登录（X有可能只是接口也可以是页面）。<br></font></div><div><h2><b>token与JWT：</b></h2></div><h3><font size=\"3\">&nbsp; &nbsp;<b id=\"8bsf3\"> </b>token+redis：</font><b style=\"font-size: 1.17em;\">token是无意义的</b></h3><h3 id=\"cmxl6\">&nbsp; &nbsp; <b>JWT:token是有意义的，加密的，包含业务信息，一般是用户信息</b></h3></blockquote>","ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1}]
2022-08-18 22:38:56.637 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17615811023867904 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-18 22:38:56.637 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17615811023867904 [0;39m ==> Parameters: 202714600712572928(Long), 0(Long), 用户管理功能开发(String), 9(Integer), 9(Integer), 1(Integer), 202715583089872896(Long)
2022-08-18 22:38:56.638 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17615811023867904 [0;39m <==    Updates: 1
2022-08-18 22:38:56.639 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17615811023867904 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-18 22:38:56.639 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17615811023867904 [0;39m ==> Parameters: <blockquote><h2 id="fii37">密码加密存储和传输（MDS）<br><font face="宋体"><font size="3">&nbsp;</font><b style=""><font size="4">传输加密： </font></b><font size="3">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size="3" face="Times New Roman"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）
</b></font>&nbsp;&nbsp;<font face="宋体" style=""><b style="font-size: large;">存储加密：</b><font size="3">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size="3"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id="90d5d">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id="9l5yg">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face="Times New Roman" size="3"><font color="#c24f4a">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id="rckur">单点登录token与JWT介绍</h2><h3 id="o9527"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size="3">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size="3">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录。</font><b><br></b></div><div>&nbsp; &nbsp;<font size="3"> X：用户管理、登录、登录校验、退出登录（X有可能只是接口也可以是页面）。<br></font></div><div><h2><b>token与JWT：</b></h2></div><h3><font size="3">&nbsp; &nbsp;<b id="8bsf3"> </b>token+redis：</font><b style="font-size: 1.17em;">token是无意义的</b></h3><h3 id="cmxl6">&nbsp; &nbsp; <b>JWT:token是有意义的，加密的，包含业务信息，一般是用户信息</b></h3></blockquote>(String), 202715583089872896(Long)
2022-08-18 22:38:56.644 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17615811023867904 [0;39m <==    Updates: 1
2022-08-18 22:38:56.746 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17615811023867904 [0;39m 返回结果: {"success":true}
2022-08-18 22:38:56.746 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17615811023867904 [0;39m ------------- 结束 耗时：112 ms -------------
2022-08-18 22:38:56.747 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m17615811023867904 [0;39m ------------- LoginInterceptor 结束 耗时：153 ms -------------
2022-08-18 22:38:56.755 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17615811531378688 [0;39m ------------- 开始 -------------
2022-08-18 22:38:56.755 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17615811531378688 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-18 22:38:56.756 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17615811531378688 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-18 22:38:56.756 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17615811531378688 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:38:56.756 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17615811531378688 [0;39m 请求参数: [202714600712572928]
2022-08-18 22:38:56.757 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17615811531378688 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-18 22:38:56.758 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17615811531378688 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-18 22:38:56.759 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615811531378688 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-18 22:38:56.759 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615811531378688 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 48, 5
2022-08-18 22:38:56.759 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615811531378688 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 41, 4
2022-08-18 22:38:56.760 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615811531378688 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-18 22:38:56.760 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615811531378688 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 22, 3
2022-08-18 22:38:56.760 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615811531378688 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 26, 5
2022-08-18 22:38:56.761 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615811531378688 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 25, 2
2022-08-18 22:38:56.761 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615811531378688 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 10, 2
2022-08-18 22:38:56.761 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615811531378688 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 11, 3
2022-08-18 22:38:56.761 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615811531378688 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 9, 1
2022-08-18 22:38:56.761 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615811531378688 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 7, 1
2022-08-18 22:38:56.762 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615811531378688 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 4, 1
2022-08-18 22:38:56.762 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17615811531378688 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 3, 2
2022-08-18 22:38:56.762 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17615811531378688 [0;39m <==      Total: 12
2022-08-18 22:38:56.763 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17615811531378688 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":48,"voteCount":5},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":41,"voteCount":4},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":22,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":26,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":25,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":10,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":11,"voteCount":3},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":7,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":4,"voteCount":1},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":3,"voteCount":2}],"success":true}
2022-08-18 22:38:56.763 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17615811531378688 [0;39m ------------- 结束 耗时：8 ms -------------
2022-08-18 22:39:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615825146089472 [0;39m 生成今日电子书快照开始
2022-08-18 22:39:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615825146089472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:39:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615825146089472 [0;39m ==> Parameters: 
2022-08-18 22:39:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615825146089472 [0;39m <==    Updates: 0
2022-08-18 22:39:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615825146089472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:39:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615846138580992 [0;39m 生成今日电子书快照开始
2022-08-18 22:39:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615846138580992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:39:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615846138580992 [0;39m ==> Parameters: 
2022-08-18 22:39:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615846138580992 [0;39m <==    Updates: 0
2022-08-18 22:39:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615846138580992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:39:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17615846142775296 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:39:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615846142775296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:39:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615846142775296 [0;39m ==> Parameters: 
2022-08-18 22:39:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615846142775296 [0;39m <==    Updates: 7
2022-08-18 22:39:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17615846142775296 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:39:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615867122683904 [0;39m 生成今日电子书快照开始
2022-08-18 22:39:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615867122683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:39:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615867122683904 [0;39m ==> Parameters: 
2022-08-18 22:39:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615867122683904 [0;39m <==    Updates: 0
2022-08-18 22:39:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615867122683904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:39:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615888119369728 [0;39m 生成今日电子书快照开始
2022-08-18 22:39:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615888119369728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:39:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615888119369728 [0;39m ==> Parameters: 
2022-08-18 22:39:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615888119369728 [0;39m <==    Updates: 0
2022-08-18 22:39:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615888119369728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:39:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615909065723904 [0;39m 生成今日电子书快照开始
2022-08-18 22:39:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615909065723904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:39:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615909065723904 [0;39m ==> Parameters: 
2022-08-18 22:39:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615909065723904 [0;39m <==    Updates: 0
2022-08-18 22:39:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615909065723904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:39:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615930003689472 [0;39m 生成今日电子书快照开始
2022-08-18 22:39:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615930003689472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:39:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615930003689472 [0;39m ==> Parameters: 
2022-08-18 22:39:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615930003689472 [0;39m <==    Updates: 0
2022-08-18 22:39:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615930003689472 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:39:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615951012958208 [0;39m 生成今日电子书快照开始
2022-08-18 22:39:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615951012958208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:39:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615951012958208 [0;39m ==> Parameters: 
2022-08-18 22:39:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615951012958208 [0;39m <==    Updates: 0
2022-08-18 22:39:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615951012958208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:39:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17615971988672512 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:39:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615971988672512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:39:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615971988672512 [0;39m ==> Parameters: 
2022-08-18 22:39:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17615971988672512 [0;39m <==    Updates: 7
2022-08-18 22:39:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17615971988672512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:39:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615971992866816 [0;39m 生成今日电子书快照开始
2022-08-18 22:39:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615971992866816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:39:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615971992866816 [0;39m ==> Parameters: 
2022-08-18 22:39:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615971992866816 [0;39m <==    Updates: 0
2022-08-18 22:39:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615971992866816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:39:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17615992943415296 [0;39m 生成今日电子书快照开始
2022-08-18 22:39:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615992943415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:39:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615992943415296 [0;39m ==> Parameters: 
2022-08-18 22:39:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17615992943415296 [0;39m <==    Updates: 0
2022-08-18 22:39:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17615992943415296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:39:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616013893963776 [0;39m 生成今日电子书快照开始
2022-08-18 22:39:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616013893963776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:39:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616013893963776 [0;39m ==> Parameters: 
2022-08-18 22:39:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616013893963776 [0;39m <==    Updates: 0
2022-08-18 22:39:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616013893963776 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:39:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616034878066688 [0;39m 生成今日电子书快照开始
2022-08-18 22:39:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616034878066688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:39:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616034878066688 [0;39m ==> Parameters: 
2022-08-18 22:39:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616034878066688 [0;39m <==    Updates: 0
2022-08-18 22:39:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616034878066688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:39:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616055887335424 [0;39m 生成今日电子书快照开始
2022-08-18 22:39:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616055887335424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:39:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616055887335424 [0;39m ==> Parameters: 
2022-08-18 22:39:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616055887335424 [0;39m <==    Updates: 0
2022-08-18 22:39:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616055887335424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:40:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616076808523776 [0;39m 生成今日电子书快照开始
2022-08-18 22:40:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616076808523776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:40:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616076808523776 [0;39m ==> Parameters: 
2022-08-18 22:40:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616076808523776 [0;39m <==    Updates: 0
2022-08-18 22:40:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616076808523776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:40:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616097838764032 [0;39m 生成今日电子书快照开始
2022-08-18 22:40:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616097838764032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:40:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616097838764032 [0;39m ==> Parameters: 
2022-08-18 22:40:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616097838764032 [0;39m <==    Updates: 0
2022-08-18 22:40:05.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616097838764032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:40:05.019 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17616097851346944 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:40:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616097851346944 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:40:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616097851346944 [0;39m ==> Parameters: 
2022-08-18 22:40:05.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616097851346944 [0;39m <==    Updates: 7
2022-08-18 22:40:05.021 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17616097851346944 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:40:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616118793506816 [0;39m 生成今日电子书快照开始
2022-08-18 22:40:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616118793506816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:40:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616118793506816 [0;39m ==> Parameters: 
2022-08-18 22:40:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616118793506816 [0;39m <==    Updates: 0
2022-08-18 22:40:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616118793506816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:40:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616139748249600 [0;39m 生成今日电子书快照开始
2022-08-18 22:40:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616139748249600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:40:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616139748249600 [0;39m ==> Parameters: 
2022-08-18 22:40:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616139748249600 [0;39m <==    Updates: 0
2022-08-18 22:40:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616139748249600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:40:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616160740741120 [0;39m 生成今日电子书快照开始
2022-08-18 22:40:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616160740741120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:40:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616160740741120 [0;39m ==> Parameters: 
2022-08-18 22:40:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616160740741120 [0;39m <==    Updates: 0
2022-08-18 22:40:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616160740741120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:40:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616181703872512 [0;39m 生成今日电子书快照开始
2022-08-18 22:40:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616181703872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:40:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616181703872512 [0;39m ==> Parameters: 
2022-08-18 22:40:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616181703872512 [0;39m <==    Updates: 0
2022-08-18 22:40:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616181703872512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:40:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616202662809600 [0;39m 生成今日电子书快照开始
2022-08-18 22:40:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616202662809600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:40:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616202662809600 [0;39m ==> Parameters: 
2022-08-18 22:40:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616202662809600 [0;39m <==    Updates: 0
2022-08-18 22:40:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616202662809600 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:40:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17616223613358080 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:40:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616223613358080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:40:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616223613358080 [0;39m ==> Parameters: 
2022-08-18 22:40:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616223613358080 [0;39m <==    Updates: 7
2022-08-18 22:40:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17616223613358080 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:40:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616223621746688 [0;39m 生成今日电子书快照开始
2022-08-18 22:40:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616223621746688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:40:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616223621746688 [0;39m ==> Parameters: 
2022-08-18 22:40:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616223621746688 [0;39m <==    Updates: 0
2022-08-18 22:40:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616223621746688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:40:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616244584878080 [0;39m 生成今日电子书快照开始
2022-08-18 22:40:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616244584878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:40:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616244584878080 [0;39m ==> Parameters: 
2022-08-18 22:40:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616244584878080 [0;39m <==    Updates: 0
2022-08-18 22:40:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616244584878080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:40:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616265589952512 [0;39m 生成今日电子书快照开始
2022-08-18 22:40:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616265589952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:40:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616265589952512 [0;39m ==> Parameters: 
2022-08-18 22:40:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616265589952512 [0;39m <==    Updates: 0
2022-08-18 22:40:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616265589952512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:40:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616286548889600 [0;39m 生成今日电子书快照开始
2022-08-18 22:40:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616286548889600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:40:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616286548889600 [0;39m ==> Parameters: 
2022-08-18 22:40:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616286548889600 [0;39m <==    Updates: 0
2022-08-18 22:40:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616286548889600 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 22:40:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616307541381120 [0;39m 生成今日电子书快照开始
2022-08-18 22:40:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616307541381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:40:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616307541381120 [0;39m ==> Parameters: 
2022-08-18 22:40:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616307541381120 [0;39m <==    Updates: 0
2022-08-18 22:40:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616307541381120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:41:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616328470958080 [0;39m 生成今日电子书快照开始
2022-08-18 22:41:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616328470958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:41:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616328470958080 [0;39m ==> Parameters: 
2022-08-18 22:41:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616328470958080 [0;39m <==    Updates: 0
2022-08-18 22:41:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616328470958080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:41:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17616349471838208 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:41:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616349471838208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:41:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616349471838208 [0;39m ==> Parameters: 
2022-08-18 22:41:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616349471838208 [0;39m <==    Updates: 7
2022-08-18 22:41:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17616349471838208 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:41:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616349476032512 [0;39m 生成今日电子书快照开始
2022-08-18 22:41:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616349476032512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:41:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616349476032512 [0;39m ==> Parameters: 
2022-08-18 22:41:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616349476032512 [0;39m <==    Updates: 0
2022-08-18 22:41:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616349476032512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:41:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616370413998080 [0;39m 生成今日电子书快照开始
2022-08-18 22:41:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616370413998080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:41:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616370413998080 [0;39m ==> Parameters: 
2022-08-18 22:41:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616370413998080 [0;39m <==    Updates: 0
2022-08-18 22:41:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616370413998080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:41:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616391440044032 [0;39m 生成今日电子书快照开始
2022-08-18 22:41:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616391440044032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:41:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616391440044032 [0;39m ==> Parameters: 
2022-08-18 22:41:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616391440044032 [0;39m <==    Updates: 0
2022-08-18 22:41:15.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616391440044032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:41:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616412357038080 [0;39m 生成今日电子书快照开始
2022-08-18 22:41:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616412357038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:41:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616412357038080 [0;39m ==> Parameters: 
2022-08-18 22:41:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616412357038080 [0;39m <==    Updates: 0
2022-08-18 22:41:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616412357038080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:41:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616433328558080 [0;39m 生成今日电子书快照开始
2022-08-18 22:41:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616433328558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:41:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616433328558080 [0;39m ==> Parameters: 
2022-08-18 22:41:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616433328558080 [0;39m <==    Updates: 0
2022-08-18 22:41:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616433328558080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:41:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616454300078080 [0;39m 生成今日电子书快照开始
2022-08-18 22:41:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616454300078080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:41:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616454300078080 [0;39m ==> Parameters: 
2022-08-18 22:41:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616454300078080 [0;39m <==    Updates: 0
2022-08-18 22:41:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616454300078080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:41:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616475267403776 [0;39m 生成今日电子书快照开始
2022-08-18 22:41:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616475267403776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:41:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616475267403776 [0;39m ==> Parameters: 
2022-08-18 22:41:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616475267403776 [0;39m <==    Updates: 0
2022-08-18 22:41:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616475267403776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:41:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17616475279986688 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:41:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616475279986688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:41:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616475279986688 [0;39m ==> Parameters: 
2022-08-18 22:41:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616475279986688 [0;39m <==    Updates: 7
2022-08-18 22:41:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17616475279986688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:41:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616496289255424 [0;39m 生成今日电子书快照开始
2022-08-18 22:41:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616496289255424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:41:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616496289255424 [0;39m ==> Parameters: 
2022-08-18 22:41:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616496289255424 [0;39m <==    Updates: 0
2022-08-18 22:41:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616496289255424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:41:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616517214638080 [0;39m 生成今日电子书快照开始
2022-08-18 22:41:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616517214638080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:41:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616517214638080 [0;39m ==> Parameters: 
2022-08-18 22:41:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616517214638080 [0;39m <==    Updates: 0
2022-08-18 22:41:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616517214638080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:41:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616538232295424 [0;39m 生成今日电子书快照开始
2022-08-18 22:41:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616538232295424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:41:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616538232295424 [0;39m ==> Parameters: 
2022-08-18 22:41:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616538232295424 [0;39m <==    Updates: 0
2022-08-18 22:41:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616538232295424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:41:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616559178649600 [0;39m 生成今日电子书快照开始
2022-08-18 22:41:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616559178649600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:41:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616559178649600 [0;39m ==> Parameters: 
2022-08-18 22:41:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616559178649600 [0;39m <==    Updates: 0
2022-08-18 22:41:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616559178649600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:42:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616580133392384 [0;39m 生成今日电子书快照开始
2022-08-18 22:42:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616580133392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:42:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616580133392384 [0;39m ==> Parameters: 
2022-08-18 22:42:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616580133392384 [0;39m <==    Updates: 0
2022-08-18 22:42:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616580133392384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:42:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17616601104912384 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:42:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616601104912384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:42:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616601104912384 [0;39m ==> Parameters: 
2022-08-18 22:42:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616601104912384 [0;39m <==    Updates: 7
2022-08-18 22:42:05.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17616601104912384 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-18 22:42:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616601130078208 [0;39m 生成今日电子书快照开始
2022-08-18 22:42:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616601130078208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:42:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616601130078208 [0;39m ==> Parameters: 
2022-08-18 22:42:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616601130078208 [0;39m <==    Updates: 0
2022-08-18 22:42:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616601130078208 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 22:42:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616622126764032 [0;39m 生成今日电子书快照开始
2022-08-18 22:42:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616622126764032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:42:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616622126764032 [0;39m ==> Parameters: 
2022-08-18 22:42:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616622126764032 [0;39m <==    Updates: 0
2022-08-18 22:42:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616622126764032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:42:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616643064729600 [0;39m 生成今日电子书快照开始
2022-08-18 22:42:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616643064729600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:42:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616643064729600 [0;39m ==> Parameters: 
2022-08-18 22:42:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616643064729600 [0;39m <==    Updates: 0
2022-08-18 22:42:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616643064729600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:42:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616664057221120 [0;39m 生成今日电子书快照开始
2022-08-18 22:42:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616664057221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:42:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616664057221120 [0;39m ==> Parameters: 
2022-08-18 22:42:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616664057221120 [0;39m <==    Updates: 0
2022-08-18 22:42:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616664057221120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:42:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616684995186688 [0;39m 生成今日电子书快照开始
2022-08-18 22:42:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616684995186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:42:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616684995186688 [0;39m ==> Parameters: 
2022-08-18 22:42:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616684995186688 [0;39m <==    Updates: 0
2022-08-18 22:42:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616684995186688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:42:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616705954123776 [0;39m 生成今日电子书快照开始
2022-08-18 22:42:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616705954123776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:42:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616705954123776 [0;39m ==> Parameters: 
2022-08-18 22:42:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616705954123776 [0;39m <==    Updates: 0
2022-08-18 22:42:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616705954123776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:42:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616726980169728 [0;39m 生成今日电子书快照开始
2022-08-18 22:42:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616726980169728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:42:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616726980169728 [0;39m ==> Parameters: 
2022-08-18 22:42:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616726980169728 [0;39m <==    Updates: 0
2022-08-18 22:42:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616726980169728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:42:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17616726992752640 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:42:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616726992752640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:42:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616726992752640 [0;39m ==> Parameters: 
2022-08-18 22:42:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616726992752640 [0;39m <==    Updates: 7
2022-08-18 22:42:35.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17616726992752640 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:42:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616747943301120 [0;39m 生成今日电子书快照开始
2022-08-18 22:42:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616747943301120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:42:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616747943301120 [0;39m ==> Parameters: 
2022-08-18 22:42:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616747943301120 [0;39m <==    Updates: 0
2022-08-18 22:42:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616747943301120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:42:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616768919015424 [0;39m 生成今日电子书快照开始
2022-08-18 22:42:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616768919015424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:42:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616768919015424 [0;39m ==> Parameters: 
2022-08-18 22:42:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616768919015424 [0;39m <==    Updates: 0
2022-08-18 22:42:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616768919015424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:42:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616789848592384 [0;39m 生成今日电子书快照开始
2022-08-18 22:42:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616789848592384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:42:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616789848592384 [0;39m ==> Parameters: 
2022-08-18 22:42:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616789848592384 [0;39m <==    Updates: 0
2022-08-18 22:42:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616789848592384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:42:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616810820112384 [0;39m 生成今日电子书快照开始
2022-08-18 22:42:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616810820112384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:42:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616810820112384 [0;39m ==> Parameters: 
2022-08-18 22:42:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616810820112384 [0;39m <==    Updates: 0
2022-08-18 22:42:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616810820112384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:43:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616831825186816 [0;39m 生成今日电子书快照开始
2022-08-18 22:43:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616831825186816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:43:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616831825186816 [0;39m ==> Parameters: 
2022-08-18 22:43:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616831825186816 [0;39m <==    Updates: 0
2022-08-18 22:43:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616831825186816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:43:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17616852788318208 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:43:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616852788318208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:43:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616852788318208 [0;39m ==> Parameters: 
2022-08-18 22:43:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616852788318208 [0;39m <==    Updates: 7
2022-08-18 22:43:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17616852788318208 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:43:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616852792512512 [0;39m 生成今日电子书快照开始
2022-08-18 22:43:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616852792512512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:43:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616852792512512 [0;39m ==> Parameters: 
2022-08-18 22:43:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616852792512512 [0;39m <==    Updates: 0
2022-08-18 22:43:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616852792512512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:43:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616873755643904 [0;39m 生成今日电子书快照开始
2022-08-18 22:43:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616873755643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:43:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616873755643904 [0;39m ==> Parameters: 
2022-08-18 22:43:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616873755643904 [0;39m <==    Updates: 0
2022-08-18 22:43:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616873755643904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:43:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616894710386688 [0;39m 生成今日电子书快照开始
2022-08-18 22:43:15.872 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616894710386688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:43:15.872 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616894710386688 [0;39m ==> Parameters: 
2022-08-18 22:43:15.874 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616894710386688 [0;39m <==    Updates: 0
2022-08-18 22:43:15.874 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616894710386688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:43:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616915698683904 [0;39m 生成今日电子书快照开始
2022-08-18 22:43:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616915698683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:43:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616915698683904 [0;39m ==> Parameters: 
2022-08-18 22:43:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616915698683904 [0;39m <==    Updates: 0
2022-08-18 22:43:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616915698683904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:43:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616936682786816 [0;39m 生成今日电子书快照开始
2022-08-18 22:43:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616936682786816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:43:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616936682786816 [0;39m ==> Parameters: 
2022-08-18 22:43:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616936682786816 [0;39m <==    Updates: 0
2022-08-18 22:43:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616936682786816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:43:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616957633335296 [0;39m 生成今日电子书快照开始
2022-08-18 22:43:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616957633335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:43:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616957633335296 [0;39m ==> Parameters: 
2022-08-18 22:43:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616957633335296 [0;39m <==    Updates: 0
2022-08-18 22:43:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616957633335296 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:43:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17616978592272384 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:43:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616978592272384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:43:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616978592272384 [0;39m ==> Parameters: 
2022-08-18 22:43:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17616978592272384 [0;39m <==    Updates: 7
2022-08-18 22:43:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17616978592272384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:43:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616978600660992 [0;39m 生成今日电子书快照开始
2022-08-18 22:43:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616978600660992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:43:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616978600660992 [0;39m ==> Parameters: 
2022-08-18 22:43:35.061 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616978600660992 [0;39m <==    Updates: 0
2022-08-18 22:43:35.061 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616978600660992 [0;39m 生成今日电子书快照结束，耗时：55 毫秒
2022-08-18 22:43:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17616999601541120 [0;39m 生成今日电子书快照开始
2022-08-18 22:43:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616999601541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:43:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616999601541120 [0;39m ==> Parameters: 
2022-08-18 22:43:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17616999601541120 [0;39m <==    Updates: 0
2022-08-18 22:43:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17616999601541120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:43:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617020560478208 [0;39m 生成今日电子书快照开始
2022-08-18 22:43:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617020560478208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:43:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617020560478208 [0;39m ==> Parameters: 
2022-08-18 22:43:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617020560478208 [0;39m <==    Updates: 0
2022-08-18 22:43:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617020560478208 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:43:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617041552969728 [0;39m 生成今日电子书快照开始
2022-08-18 22:43:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617041552969728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:43:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617041552969728 [0;39m ==> Parameters: 
2022-08-18 22:43:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617041552969728 [0;39m <==    Updates: 0
2022-08-18 22:43:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617041552969728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:43:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617062516101120 [0;39m 生成今日电子书快照开始
2022-08-18 22:43:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617062516101120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:43:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617062516101120 [0;39m ==> Parameters: 
2022-08-18 22:43:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617062516101120 [0;39m <==    Updates: 0
2022-08-18 22:43:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617062516101120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:44:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617083466649600 [0;39m 生成今日电子书快照开始
2022-08-18 22:44:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617083466649600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:44:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617083466649600 [0;39m ==> Parameters: 
2022-08-18 22:44:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617083466649600 [0;39m <==    Updates: 0
2022-08-18 22:44:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617083466649600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:44:05.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17617104417198080 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:44:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617104417198080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:44:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617104417198080 [0;39m ==> Parameters: 
2022-08-18 22:44:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617104417198080 [0;39m <==    Updates: 7
2022-08-18 22:44:05.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17617104417198080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:44:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617104425586688 [0;39m 生成今日电子书快照开始
2022-08-18 22:44:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617104425586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:44:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617104425586688 [0;39m ==> Parameters: 
2022-08-18 22:44:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617104425586688 [0;39m <==    Updates: 0
2022-08-18 22:44:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617104425586688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:44:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617125422272512 [0;39m 生成今日电子书快照开始
2022-08-18 22:44:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617125422272512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:44:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617125422272512 [0;39m ==> Parameters: 
2022-08-18 22:44:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617125422272512 [0;39m <==    Updates: 0
2022-08-18 22:44:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617125422272512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:44:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617146360238080 [0;39m 生成今日电子书快照开始
2022-08-18 22:44:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617146360238080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:44:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617146360238080 [0;39m ==> Parameters: 
2022-08-18 22:44:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617146360238080 [0;39m <==    Updates: 0
2022-08-18 22:44:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617146360238080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:44:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617167331758080 [0;39m 生成今日电子书快照开始
2022-08-18 22:44:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617167331758080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:44:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617167331758080 [0;39m ==> Parameters: 
2022-08-18 22:44:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617167331758080 [0;39m <==    Updates: 0
2022-08-18 22:44:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617167331758080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:44:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617188336832512 [0;39m 生成今日电子书快照开始
2022-08-18 22:44:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617188336832512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:44:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617188336832512 [0;39m ==> Parameters: 
2022-08-18 22:44:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617188336832512 [0;39m <==    Updates: 0
2022-08-18 22:44:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617188336832512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:44:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617209295769600 [0;39m 生成今日电子书快照开始
2022-08-18 22:44:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617209295769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:44:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617209295769600 [0;39m ==> Parameters: 
2022-08-18 22:44:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617209295769600 [0;39m <==    Updates: 0
2022-08-18 22:44:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617209295769600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:44:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17617230279872512 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:44:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617230279872512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:44:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617230279872512 [0;39m ==> Parameters: 
2022-08-18 22:44:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617230279872512 [0;39m <==    Updates: 7
2022-08-18 22:44:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17617230279872512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:44:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617230288261120 [0;39m 生成今日电子书快照开始
2022-08-18 22:44:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617230288261120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:44:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617230288261120 [0;39m ==> Parameters: 
2022-08-18 22:44:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617230288261120 [0;39m <==    Updates: 0
2022-08-18 22:44:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617230288261120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:44:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617251230420992 [0;39m 生成今日电子书快照开始
2022-08-18 22:44:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617251230420992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:44:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617251230420992 [0;39m ==> Parameters: 
2022-08-18 22:44:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617251230420992 [0;39m <==    Updates: 0
2022-08-18 22:44:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617251230420992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:44:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617272193552384 [0;39m 生成今日电子书快照开始
2022-08-18 22:44:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617272193552384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:44:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617272193552384 [0;39m ==> Parameters: 
2022-08-18 22:44:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617272193552384 [0;39m <==    Updates: 0
2022-08-18 22:44:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617272193552384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:44:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617293160878080 [0;39m 生成今日电子书快照开始
2022-08-18 22:44:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617293160878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:44:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617293160878080 [0;39m ==> Parameters: 
2022-08-18 22:44:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617293160878080 [0;39m <==    Updates: 0
2022-08-18 22:44:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617293160878080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:44:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617314136592384 [0;39m 生成今日电子书快照开始
2022-08-18 22:44:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617314136592384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:44:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617314136592384 [0;39m ==> Parameters: 
2022-08-18 22:44:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617314136592384 [0;39m <==    Updates: 0
2022-08-18 22:44:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617314136592384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:45:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617335154249728 [0;39m 生成今日电子书快照开始
2022-08-18 22:45:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617335154249728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:45:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617335154249728 [0;39m ==> Parameters: 
2022-08-18 22:45:00.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617335154249728 [0;39m <==    Updates: 0
2022-08-18 22:45:00.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617335154249728 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-18 22:45:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17617356092215296 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:45:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617356092215296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:45:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617356092215296 [0;39m ==> Parameters: 
2022-08-18 22:45:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617356092215296 [0;39m <==    Updates: 7
2022-08-18 22:45:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17617356092215296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:45:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617356100603904 [0;39m 生成今日电子书快照开始
2022-08-18 22:45:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617356100603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:45:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617356100603904 [0;39m ==> Parameters: 
2022-08-18 22:45:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617356100603904 [0;39m <==    Updates: 0
2022-08-18 22:45:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617356100603904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:45:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617377097289728 [0;39m 生成今日电子书快照开始
2022-08-18 22:45:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617377097289728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:45:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617377097289728 [0;39m ==> Parameters: 
2022-08-18 22:45:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617377097289728 [0;39m <==    Updates: 0
2022-08-18 22:45:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617377097289728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:45:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617398043643904 [0;39m 生成今日电子书快照开始
2022-08-18 22:45:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617398043643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:45:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617398043643904 [0;39m ==> Parameters: 
2022-08-18 22:45:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617398043643904 [0;39m <==    Updates: 0
2022-08-18 22:45:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617398043643904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:45:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617419031941120 [0;39m 生成今日电子书快照开始
2022-08-18 22:45:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617419031941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:45:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617419031941120 [0;39m ==> Parameters: 
2022-08-18 22:45:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617419031941120 [0;39m <==    Updates: 0
2022-08-18 22:45:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617419031941120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:45:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617440007655424 [0;39m 生成今日电子书快照开始
2022-08-18 22:45:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617440007655424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:45:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617440007655424 [0;39m ==> Parameters: 
2022-08-18 22:45:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617440007655424 [0;39m <==    Updates: 0
2022-08-18 22:45:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617440007655424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:45:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617460924649472 [0;39m 生成今日电子书快照开始
2022-08-18 22:45:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617460924649472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:45:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617460924649472 [0;39m ==> Parameters: 
2022-08-18 22:45:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617460924649472 [0;39m <==    Updates: 0
2022-08-18 22:45:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617460924649472 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:45:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17617481933918208 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:45:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617481933918208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:45:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617481933918208 [0;39m ==> Parameters: 
2022-08-18 22:45:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617481933918208 [0;39m <==    Updates: 7
2022-08-18 22:45:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17617481933918208 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:45:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617481942306816 [0;39m 生成今日电子书快照开始
2022-08-18 22:45:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617481942306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:45:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617481942306816 [0;39m ==> Parameters: 
2022-08-18 22:45:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617481942306816 [0;39m <==    Updates: 0
2022-08-18 22:45:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617481942306816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:45:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617502867689472 [0;39m 生成今日电子书快照开始
2022-08-18 22:45:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617502867689472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:45:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617502867689472 [0;39m ==> Parameters: 
2022-08-18 22:45:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617502867689472 [0;39m <==    Updates: 0
2022-08-18 22:45:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617502867689472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:45:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617523847598080 [0;39m 生成今日电子书快照开始
2022-08-18 22:45:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617523847598080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:45:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617523847598080 [0;39m ==> Parameters: 
2022-08-18 22:45:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617523847598080 [0;39m <==    Updates: 0
2022-08-18 22:45:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617523847598080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:45:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617544869449728 [0;39m 生成今日电子书快照开始
2022-08-18 22:45:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617544869449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:45:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617544869449728 [0;39m ==> Parameters: 
2022-08-18 22:45:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617544869449728 [0;39m <==    Updates: 0
2022-08-18 22:45:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617544869449728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:45:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617565794832384 [0;39m 生成今日电子书快照开始
2022-08-18 22:45:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617565794832384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:45:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617565794832384 [0;39m ==> Parameters: 
2022-08-18 22:45:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617565794832384 [0;39m <==    Updates: 0
2022-08-18 22:45:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617565794832384 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:46:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617586799906816 [0;39m 生成今日电子书快照开始
2022-08-18 22:46:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617586799906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:46:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617586799906816 [0;39m ==> Parameters: 
2022-08-18 22:46:00.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617586799906816 [0;39m <==    Updates: 0
2022-08-18 22:46:00.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617586799906816 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-18 22:46:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17617607784009728 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:46:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617607784009728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:46:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617607784009728 [0;39m ==> Parameters: 
2022-08-18 22:46:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617607784009728 [0;39m <==    Updates: 7
2022-08-18 22:46:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17617607784009728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:46:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617607788204032 [0;39m 生成今日电子书快照开始
2022-08-18 22:46:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617607788204032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:46:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617607788204032 [0;39m ==> Parameters: 
2022-08-18 22:46:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617607788204032 [0;39m <==    Updates: 0
2022-08-18 22:46:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617607788204032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:46:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617628721975296 [0;39m 生成今日电子书快照开始
2022-08-18 22:46:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617628721975296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:46:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617628721975296 [0;39m ==> Parameters: 
2022-08-18 22:46:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617628721975296 [0;39m <==    Updates: 0
2022-08-18 22:46:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617628721975296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:46:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617649706078208 [0;39m 生成今日电子书快照开始
2022-08-18 22:46:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617649706078208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:46:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617649706078208 [0;39m ==> Parameters: 
2022-08-18 22:46:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617649706078208 [0;39m <==    Updates: 0
2022-08-18 22:46:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617649706078208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:46:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617670669209600 [0;39m 生成今日电子书快照开始
2022-08-18 22:46:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617670669209600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:46:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617670669209600 [0;39m ==> Parameters: 
2022-08-18 22:46:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617670669209600 [0;39m <==    Updates: 0
2022-08-18 22:46:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617670669209600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:46:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617691649118208 [0;39m 生成今日电子书快照开始
2022-08-18 22:46:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617691649118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:46:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617691649118208 [0;39m ==> Parameters: 
2022-08-18 22:46:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617691649118208 [0;39m <==    Updates: 0
2022-08-18 22:46:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617691649118208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:46:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617712582889472 [0;39m 生成今日电子书快照开始
2022-08-18 22:46:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617712582889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:46:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617712582889472 [0;39m ==> Parameters: 
2022-08-18 22:46:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617712582889472 [0;39m <==    Updates: 0
2022-08-18 22:46:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617712582889472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:46:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617733617324032 [0;39m 生成今日电子书快照开始
2022-08-18 22:46:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617733617324032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:46:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617733617324032 [0;39m ==> Parameters: 
2022-08-18 22:46:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617733617324032 [0;39m <==    Updates: 0
2022-08-18 22:46:35.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617733617324032 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:46:35.020 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17617733634101248 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:46:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617733634101248 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:46:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617733634101248 [0;39m ==> Parameters: 
2022-08-18 22:46:35.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617733634101248 [0;39m <==    Updates: 7
2022-08-18 22:46:35.021 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17617733634101248 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:46:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617754530123776 [0;39m 生成今日电子书快照开始
2022-08-18 22:46:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617754530123776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:46:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617754530123776 [0;39m ==> Parameters: 
2022-08-18 22:46:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617754530123776 [0;39m <==    Updates: 0
2022-08-18 22:46:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617754530123776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:46:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617775497449472 [0;39m 生成今日电子书快照开始
2022-08-18 22:46:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617775497449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:46:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617775497449472 [0;39m ==> Parameters: 
2022-08-18 22:46:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617775497449472 [0;39m <==    Updates: 0
2022-08-18 22:46:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617775497449472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:46:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617796473163776 [0;39m 生成今日电子书快照开始
2022-08-18 22:46:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617796473163776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:46:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617796473163776 [0;39m ==> Parameters: 
2022-08-18 22:46:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617796473163776 [0;39m <==    Updates: 0
2022-08-18 22:46:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617796473163776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:46:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617817490821120 [0;39m 生成今日电子书快照开始
2022-08-18 22:46:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617817490821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:46:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617817490821120 [0;39m ==> Parameters: 
2022-08-18 22:46:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617817490821120 [0;39m <==    Updates: 0
2022-08-18 22:46:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617817490821120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:46:59.465 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m17614977619857408 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-18 22:46:59.465 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m17614977619857408 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-18 22:46:59.465 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m17614977619857408 [0;39m 登录校验开始，token：17610697500397568
2022-08-18 22:46:59.503 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m17614977619857408 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"17610697500397568"}
2022-08-18 22:46:59.504 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17617836327440384 [0;39m ------------- 开始 -------------
2022-08-18 22:46:59.505 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17617836327440384 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-18 22:46:59.506 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17617836327440384 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-18 22:46:59.506 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17617836327440384 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:46:59.506 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17617836327440384 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size=\"3\">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录。</font><b><br></b></div><div>&nbsp; &nbsp;<font size=\"3\"> X：用户管理、登录、登录校验、退出登录（X有可能只是接口也可以是页面）。<br></font></div><div><h2><b>token与JWT：</b></h2></div><h3><font size=\"3\">&nbsp; &nbsp;<b id=\"8bsf3\"> </b>token+redis：</font><b style=\"font-size: 1.17em;\">token是无意义的</b></h3><h3 id=\"cmxl6\">&nbsp; &nbsp; <b>JWT:token是有意义的，加密的，包含业务信息，一般是用户信息，无需存放在redis中可查看<font color=\"#000000\">&nbsp;</font></b><font face=\"仿宋\" style=\"\"><i style=\"background-color: rgb(249, 150, 59);\"><font color=\"#000000\">jwt.io</font></i><font color=\"#1c487f\">&nbsp;</font></font></h3></blockquote>","ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1}]
2022-08-18 22:46:59.507 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17617836327440384 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-18 22:46:59.508 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17617836327440384 [0;39m ==> Parameters: 202714600712572928(Long), 0(Long), 用户管理功能开发(String), 9(Integer), 9(Integer), 1(Integer), 202715583089872896(Long)
2022-08-18 22:46:59.509 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17617836327440384 [0;39m <==    Updates: 1
2022-08-18 22:46:59.509 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17617836327440384 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-18 22:46:59.509 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17617836327440384 [0;39m ==> Parameters: <blockquote><h2 id="fii37">密码加密存储和传输（MDS）<br><font face="宋体"><font size="3">&nbsp;</font><b style=""><font size="4">传输加密： </font></b><font size="3">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size="3" face="Times New Roman"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）
</b></font>&nbsp;&nbsp;<font face="宋体" style=""><b style="font-size: large;">存储加密：</b><font size="3">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size="3"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id="90d5d">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id="9l5yg">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face="Times New Roman" size="3"><font color="#c24f4a">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id="rckur">单点登录token与JWT介绍</h2><h3 id="o9527"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size="3">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size="3">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录。</font><b><br></b></div><div>&nbsp; &nbsp;<font size="3"> X：用户管理、登录、登录校验、退出登录（X有可能只是接口也可以是页面）。<br></font></div><div><h2><b>token与JWT：</b></h2></div><h3><font size="3">&nbsp; &nbsp;<b id="8bsf3"> </b>token+redis：</font><b style="font-size: 1.17em;">token是无意义的</b></h3><h3 id="cmxl6">&nbsp; &nbsp; <b>JWT:token是有意义的，加密的，包含业务信息，一般是用户信息，无需存放在redis中可查看<font color="#000000">&nbsp;</font></b><font face="仿宋" style=""><i style="background-color: rgb(249, 150, 59);"><font color="#000000">jwt.io</font></i><font color="#1c487f">&nbsp;</font></font></h3></blockquote>(String), 202715583089872896(Long)
2022-08-18 22:46:59.515 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17617836327440384 [0;39m <==    Updates: 1
2022-08-18 22:46:59.557 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17617836327440384 [0;39m 返回结果: {"success":true}
2022-08-18 22:46:59.557 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17617836327440384 [0;39m ------------- 结束 耗时：53 ms -------------
2022-08-18 22:46:59.558 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m17617836327440384 [0;39m ------------- LoginInterceptor 结束 耗时：93 ms -------------
2022-08-18 22:46:59.568 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17617836595875840 [0;39m ------------- 开始 -------------
2022-08-18 22:46:59.569 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17617836595875840 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-18 22:46:59.569 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17617836595875840 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-18 22:46:59.569 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17617836595875840 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:46:59.569 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17617836595875840 [0;39m 请求参数: [202714600712572928]
2022-08-18 22:46:59.569 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17617836595875840 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-18 22:46:59.570 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17617836595875840 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-18 22:46:59.571 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17617836595875840 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-18 22:46:59.571 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17617836595875840 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 48, 5
2022-08-18 22:46:59.571 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17617836595875840 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 41, 4
2022-08-18 22:46:59.572 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17617836595875840 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-18 22:46:59.572 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17617836595875840 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 22, 3
2022-08-18 22:46:59.573 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17617836595875840 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 26, 5
2022-08-18 22:46:59.573 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17617836595875840 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 25, 2
2022-08-18 22:46:59.573 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17617836595875840 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 10, 2
2022-08-18 22:46:59.573 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17617836595875840 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 11, 3
2022-08-18 22:46:59.574 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17617836595875840 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 9, 1
2022-08-18 22:46:59.574 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17617836595875840 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 7, 1
2022-08-18 22:46:59.574 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17617836595875840 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 4, 1
2022-08-18 22:46:59.574 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17617836595875840 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 3, 2
2022-08-18 22:46:59.574 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17617836595875840 [0;39m <==      Total: 12
2022-08-18 22:46:59.575 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17617836595875840 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":48,"voteCount":5},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":41,"voteCount":4},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":22,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":26,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":25,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":10,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":11,"voteCount":3},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":7,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":4,"voteCount":1},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":3,"voteCount":2}],"success":true}
2022-08-18 22:46:59.575 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17617836595875840 [0;39m ------------- 结束 耗时：7 ms -------------
2022-08-18 22:47:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617838474924032 [0;39m 生成今日电子书快照开始
2022-08-18 22:47:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617838474924032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:47:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617838474924032 [0;39m ==> Parameters: 
2022-08-18 22:47:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617838474924032 [0;39m <==    Updates: 0
2022-08-18 22:47:00.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617838474924032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:47:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17617859421278208 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:47:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617859421278208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:47:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617859421278208 [0;39m ==> Parameters: 
2022-08-18 22:47:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617859421278208 [0;39m <==    Updates: 7
2022-08-18 22:47:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17617859421278208 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:47:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617859429666816 [0;39m 生成今日电子书快照开始
2022-08-18 22:47:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617859429666816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:47:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617859429666816 [0;39m ==> Parameters: 
2022-08-18 22:47:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617859429666816 [0;39m <==    Updates: 0
2022-08-18 22:47:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617859429666816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:47:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617880359243776 [0;39m 生成今日电子书快照开始
2022-08-18 22:47:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617880359243776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:47:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617880359243776 [0;39m ==> Parameters: 
2022-08-18 22:47:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617880359243776 [0;39m <==    Updates: 0
2022-08-18 22:47:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617880359243776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:47:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617901343346688 [0;39m 生成今日电子书快照开始
2022-08-18 22:47:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617901343346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:47:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617901343346688 [0;39m ==> Parameters: 
2022-08-18 22:47:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617901343346688 [0;39m <==    Updates: 0
2022-08-18 22:47:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617901343346688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:47:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617922340032512 [0;39m 生成今日电子书快照开始
2022-08-18 22:47:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617922340032512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:47:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617922340032512 [0;39m ==> Parameters: 
2022-08-18 22:47:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617922340032512 [0;39m <==    Updates: 0
2022-08-18 22:47:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617922340032512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:47:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617943332524032 [0;39m 生成今日电子书快照开始
2022-08-18 22:47:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617943332524032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:47:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617943332524032 [0;39m ==> Parameters: 
2022-08-18 22:47:25.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617943332524032 [0;39m <==    Updates: 0
2022-08-18 22:47:25.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617943332524032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:47:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617964283072512 [0;39m 生成今日电子书快照开始
2022-08-18 22:47:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617964283072512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:47:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617964283072512 [0;39m ==> Parameters: 
2022-08-18 22:47:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617964283072512 [0;39m <==    Updates: 0
2022-08-18 22:47:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617964283072512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:47:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17617985221038080 [0;39m 生成今日电子书快照开始
2022-08-18 22:47:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617985221038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:47:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617985221038080 [0;39m ==> Parameters: 
2022-08-18 22:47:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17617985221038080 [0;39m <==    Updates: 0
2022-08-18 22:47:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17617985221038080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:47:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17617985233620992 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:47:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617985233620992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:47:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617985233620992 [0;39m ==> Parameters: 
2022-08-18 22:47:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17617985233620992 [0;39m <==    Updates: 7
2022-08-18 22:47:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17617985233620992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:47:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618006200946688 [0;39m 生成今日电子书快照开始
2022-08-18 22:47:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618006200946688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:47:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618006200946688 [0;39m ==> Parameters: 
2022-08-18 22:47:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618006200946688 [0;39m <==    Updates: 0
2022-08-18 22:47:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618006200946688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:47:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618027185049600 [0;39m 生成今日电子书快照开始
2022-08-18 22:47:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618027185049600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:47:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618027185049600 [0;39m ==> Parameters: 
2022-08-18 22:47:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618027185049600 [0;39m <==    Updates: 0
2022-08-18 22:47:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618027185049600 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-18 22:47:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618048164958208 [0;39m 生成今日电子书快照开始
2022-08-18 22:47:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618048164958208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:47:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618048164958208 [0;39m ==> Parameters: 
2022-08-18 22:47:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618048164958208 [0;39m <==    Updates: 0
2022-08-18 22:47:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618048164958208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:47:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618069115506688 [0;39m 生成今日电子书快照开始
2022-08-18 22:47:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618069115506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:47:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618069115506688 [0;39m ==> Parameters: 
2022-08-18 22:47:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618069115506688 [0;39m <==    Updates: 0
2022-08-18 22:47:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618069115506688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:48:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618090107998208 [0;39m 生成今日电子书快照开始
2022-08-18 22:48:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618090107998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:48:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618090107998208 [0;39m ==> Parameters: 
2022-08-18 22:48:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618090107998208 [0;39m <==    Updates: 0
2022-08-18 22:48:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618090107998208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:48:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618111096295424 [0;39m 生成今日电子书快照开始
2022-08-18 22:48:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618111096295424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:48:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618111096295424 [0;39m ==> Parameters: 
2022-08-18 22:48:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618111096295424 [0;39m <==    Updates: 0
2022-08-18 22:48:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618111096295424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:48:05.017 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17618111108878336 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:48:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618111108878336 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:48:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618111108878336 [0;39m ==> Parameters: 
2022-08-18 22:48:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618111108878336 [0;39m <==    Updates: 7
2022-08-18 22:48:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17618111108878336 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:48:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618132072009728 [0;39m 生成今日电子书快照开始
2022-08-18 22:48:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618132072009728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:48:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618132072009728 [0;39m ==> Parameters: 
2022-08-18 22:48:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618132072009728 [0;39m <==    Updates: 0
2022-08-18 22:48:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618132072009728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:48:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618153005780992 [0;39m 生成今日电子书快照开始
2022-08-18 22:48:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618153005780992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:48:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618153005780992 [0;39m ==> Parameters: 
2022-08-18 22:48:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618153005780992 [0;39m <==    Updates: 0
2022-08-18 22:48:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618153005780992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:48:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618174002466816 [0;39m 生成今日电子书快照开始
2022-08-18 22:48:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618174002466816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:48:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618174002466816 [0;39m ==> Parameters: 
2022-08-18 22:48:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618174002466816 [0;39m <==    Updates: 0
2022-08-18 22:48:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618174002466816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:48:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618194944626688 [0;39m 生成今日电子书快照开始
2022-08-18 22:48:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618194944626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:48:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618194944626688 [0;39m ==> Parameters: 
2022-08-18 22:48:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618194944626688 [0;39m <==    Updates: 0
2022-08-18 22:48:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618194944626688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:48:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618215932923904 [0;39m 生成今日电子书快照开始
2022-08-18 22:48:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618215932923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:48:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618215932923904 [0;39m ==> Parameters: 
2022-08-18 22:48:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618215932923904 [0;39m <==    Updates: 0
2022-08-18 22:48:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618215932923904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:48:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618236879278080 [0;39m 生成今日电子书快照开始
2022-08-18 22:48:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618236879278080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:48:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618236879278080 [0;39m ==> Parameters: 
2022-08-18 22:48:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618236879278080 [0;39m <==    Updates: 0
2022-08-18 22:48:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618236879278080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:48:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17618236891860992 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:48:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618236891860992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:48:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618236891860992 [0;39m ==> Parameters: 
2022-08-18 22:48:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618236891860992 [0;39m <==    Updates: 7
2022-08-18 22:48:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17618236891860992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:48:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618257884352512 [0;39m 生成今日电子书快照开始
2022-08-18 22:48:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618257884352512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:48:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618257884352512 [0;39m ==> Parameters: 
2022-08-18 22:48:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618257884352512 [0;39m <==    Updates: 0
2022-08-18 22:48:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618257884352512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:48:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618278813929472 [0;39m 生成今日电子书快照开始
2022-08-18 22:48:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618278813929472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:48:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618278813929472 [0;39m ==> Parameters: 
2022-08-18 22:48:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618278813929472 [0;39m <==    Updates: 0
2022-08-18 22:48:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618278813929472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:48:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618299789643776 [0;39m 生成今日电子书快照开始
2022-08-18 22:48:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618299789643776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:48:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618299789643776 [0;39m ==> Parameters: 
2022-08-18 22:48:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618299789643776 [0;39m <==    Updates: 0
2022-08-18 22:48:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618299789643776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:48:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618320769552384 [0;39m 生成今日电子书快照开始
2022-08-18 22:48:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618320769552384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:48:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618320769552384 [0;39m ==> Parameters: 
2022-08-18 22:48:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618320769552384 [0;39m <==    Updates: 0
2022-08-18 22:48:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618320769552384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:49:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618341778821120 [0;39m 生成今日电子书快照开始
2022-08-18 22:49:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618341778821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:49:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618341778821120 [0;39m ==> Parameters: 
2022-08-18 22:49:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618341778821120 [0;39m <==    Updates: 0
2022-08-18 22:49:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618341778821120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:49:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17618362737758208 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:49:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618362737758208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:49:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618362737758208 [0;39m ==> Parameters: 
2022-08-18 22:49:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618362737758208 [0;39m <==    Updates: 7
2022-08-18 22:49:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17618362737758208 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:49:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618362741952512 [0;39m 生成今日电子书快照开始
2022-08-18 22:49:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618362741952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:49:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618362741952512 [0;39m ==> Parameters: 
2022-08-18 22:49:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618362741952512 [0;39m <==    Updates: 0
2022-08-18 22:49:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618362741952512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:49:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618383675723776 [0;39m 生成今日电子书快照开始
2022-08-18 22:49:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618383675723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:49:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618383675723776 [0;39m ==> Parameters: 
2022-08-18 22:49:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618383675723776 [0;39m <==    Updates: 0
2022-08-18 22:49:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618383675723776 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:49:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618404684992512 [0;39m 生成今日电子书快照开始
2022-08-18 22:49:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618404684992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:49:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618404684992512 [0;39m ==> Parameters: 
2022-08-18 22:49:15.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618404684992512 [0;39m <==    Updates: 0
2022-08-18 22:49:15.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618404684992512 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-18 22:49:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618425639735296 [0;39m 生成今日电子书快照开始
2022-08-18 22:49:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618425639735296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:49:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618425639735296 [0;39m ==> Parameters: 
2022-08-18 22:49:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618425639735296 [0;39m <==    Updates: 0
2022-08-18 22:49:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618425639735296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:49:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618446619643904 [0;39m 生成今日电子书快照开始
2022-08-18 22:49:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618446619643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:49:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618446619643904 [0;39m ==> Parameters: 
2022-08-18 22:49:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618446619643904 [0;39m <==    Updates: 0
2022-08-18 22:49:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618446619643904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:49:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618467612135424 [0;39m 生成今日电子书快照开始
2022-08-18 22:49:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618467612135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:49:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618467612135424 [0;39m ==> Parameters: 
2022-08-18 22:49:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618467612135424 [0;39m <==    Updates: 0
2022-08-18 22:49:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618467612135424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:49:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618488566878208 [0;39m 生成今日电子书快照开始
2022-08-18 22:49:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618488566878208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:49:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618488566878208 [0;39m ==> Parameters: 
2022-08-18 22:49:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618488566878208 [0;39m <==    Updates: 0
2022-08-18 22:49:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618488566878208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:49:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17618488579461120 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:49:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618488579461120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:49:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618488579461120 [0;39m ==> Parameters: 
2022-08-18 22:49:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618488579461120 [0;39m <==    Updates: 7
2022-08-18 22:49:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17618488579461120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:49:40.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618509496455168 [0;39m 生成今日电子书快照开始
2022-08-18 22:49:40.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618509496455168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:49:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618509496455168 [0;39m ==> Parameters: 
2022-08-18 22:49:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618509496455168 [0;39m <==    Updates: 0
2022-08-18 22:49:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618509496455168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:49:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618530480558080 [0;39m 生成今日电子书快照开始
2022-08-18 22:49:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618530480558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:49:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618530480558080 [0;39m ==> Parameters: 
2022-08-18 22:49:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618530480558080 [0;39m <==    Updates: 0
2022-08-18 22:49:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618530480558080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:49:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618551473049600 [0;39m 生成今日电子书快照开始
2022-08-18 22:49:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618551473049600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:49:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618551473049600 [0;39m ==> Parameters: 
2022-08-18 22:49:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618551473049600 [0;39m <==    Updates: 0
2022-08-18 22:49:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618551473049600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:49:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618572469735424 [0;39m 生成今日电子书快照开始
2022-08-18 22:49:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618572469735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:49:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618572469735424 [0;39m ==> Parameters: 
2022-08-18 22:49:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618572469735424 [0;39m <==    Updates: 0
2022-08-18 22:49:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618572469735424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:50:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618593424478208 [0;39m 生成今日电子书快照开始
2022-08-18 22:50:00.031 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618593424478208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:50:00.031 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618593424478208 [0;39m ==> Parameters: 
2022-08-18 22:50:00.048 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618593424478208 [0;39m <==    Updates: 0
2022-08-18 22:50:00.048 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618593424478208 [0;39m 生成今日电子书快照结束，耗时：38 毫秒
2022-08-18 22:50:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17618614383415296 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:50:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618614383415296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:50:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618614383415296 [0;39m ==> Parameters: 
2022-08-18 22:50:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618614383415296 [0;39m <==    Updates: 7
2022-08-18 22:50:05.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17618614383415296 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-18 22:50:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618614395998208 [0;39m 生成今日电子书快照开始
2022-08-18 22:50:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618614395998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:50:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618614395998208 [0;39m ==> Parameters: 
2022-08-18 22:50:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618614395998208 [0;39m <==    Updates: 0
2022-08-18 22:50:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618614395998208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:50:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618635346546688 [0;39m 生成今日电子书快照开始
2022-08-18 22:50:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618635346546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:50:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618635346546688 [0;39m ==> Parameters: 
2022-08-18 22:50:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618635346546688 [0;39m <==    Updates: 0
2022-08-18 22:50:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618635346546688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:50:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618656309678080 [0;39m 生成今日电子书快照开始
2022-08-18 22:50:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618656309678080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:50:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618656309678080 [0;39m ==> Parameters: 
2022-08-18 22:50:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618656309678080 [0;39m <==    Updates: 0
2022-08-18 22:50:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618656309678080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:50:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618677302169600 [0;39m 生成今日电子书快照开始
2022-08-18 22:50:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618677302169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:50:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618677302169600 [0;39m ==> Parameters: 
2022-08-18 22:50:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618677302169600 [0;39m <==    Updates: 0
2022-08-18 22:50:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618677302169600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:50:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618698269495296 [0;39m 生成今日电子书快照开始
2022-08-18 22:50:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618698269495296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:50:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618698269495296 [0;39m ==> Parameters: 
2022-08-18 22:50:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618698269495296 [0;39m <==    Updates: 0
2022-08-18 22:50:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618698269495296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:50:30.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618719303929856 [0;39m 生成今日电子书快照开始
2022-08-18 22:50:30.024 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618719303929856 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:50:30.025 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618719303929856 [0;39m ==> Parameters: 
2022-08-18 22:50:30.028 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618719303929856 [0;39m <==    Updates: 0
2022-08-18 22:50:30.028 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618719303929856 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 22:50:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618740229312512 [0;39m 生成今日电子书快照开始
2022-08-18 22:50:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618740229312512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:50:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618740229312512 [0;39m ==> Parameters: 
2022-08-18 22:50:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618740229312512 [0;39m <==    Updates: 0
2022-08-18 22:50:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618740229312512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:50:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17618740237701120 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:50:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618740237701120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:50:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618740237701120 [0;39m ==> Parameters: 
2022-08-18 22:50:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618740237701120 [0;39m <==    Updates: 7
2022-08-18 22:50:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17618740237701120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:50:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618761163083776 [0;39m 生成今日电子书快照开始
2022-08-18 22:50:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618761163083776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:50:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618761163083776 [0;39m ==> Parameters: 
2022-08-18 22:50:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618761163083776 [0;39m <==    Updates: 0
2022-08-18 22:50:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618761163083776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:50:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618782155575296 [0;39m 生成今日电子书快照开始
2022-08-18 22:50:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618782155575296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:50:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618782155575296 [0;39m ==> Parameters: 
2022-08-18 22:50:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618782155575296 [0;39m <==    Updates: 0
2022-08-18 22:50:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618782155575296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:50:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618803118706688 [0;39m 生成今日电子书快照开始
2022-08-18 22:50:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618803118706688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:50:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618803118706688 [0;39m ==> Parameters: 
2022-08-18 22:50:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618803118706688 [0;39m <==    Updates: 0
2022-08-18 22:50:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618803118706688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:50:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618824098615296 [0;39m 生成今日电子书快照开始
2022-08-18 22:50:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618824098615296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:50:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618824098615296 [0;39m ==> Parameters: 
2022-08-18 22:50:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618824098615296 [0;39m <==    Updates: 0
2022-08-18 22:50:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618824098615296 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:51:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618845070135296 [0;39m 生成今日电子书快照开始
2022-08-18 22:51:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618845070135296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:51:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618845070135296 [0;39m ==> Parameters: 
2022-08-18 22:51:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618845070135296 [0;39m <==    Updates: 0
2022-08-18 22:51:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618845070135296 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-18 22:51:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17618866054238208 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:51:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618866054238208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:51:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618866054238208 [0;39m ==> Parameters: 
2022-08-18 22:51:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618866054238208 [0;39m <==    Updates: 7
2022-08-18 22:51:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17618866054238208 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:51:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618866058432512 [0;39m 生成今日电子书快照开始
2022-08-18 22:51:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618866058432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:51:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618866058432512 [0;39m ==> Parameters: 
2022-08-18 22:51:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618866058432512 [0;39m <==    Updates: 0
2022-08-18 22:51:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618866058432512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:51:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618887008980992 [0;39m 生成今日电子书快照开始
2022-08-18 22:51:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618887008980992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:51:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618887008980992 [0;39m ==> Parameters: 
2022-08-18 22:51:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618887008980992 [0;39m <==    Updates: 0
2022-08-18 22:51:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618887008980992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:51:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618907988889600 [0;39m 生成今日电子书快照开始
2022-08-18 22:51:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618907988889600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:51:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618907988889600 [0;39m ==> Parameters: 
2022-08-18 22:51:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618907988889600 [0;39m <==    Updates: 0
2022-08-18 22:51:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618907988889600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:51:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618928981381120 [0;39m 生成今日电子书快照开始
2022-08-18 22:51:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618928981381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:51:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618928981381120 [0;39m ==> Parameters: 
2022-08-18 22:51:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618928981381120 [0;39m <==    Updates: 0
2022-08-18 22:51:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618928981381120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:51:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618949952901120 [0;39m 生成今日电子书快照开始
2022-08-18 22:51:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618949952901120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:51:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618949952901120 [0;39m ==> Parameters: 
2022-08-18 22:51:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618949952901120 [0;39m <==    Updates: 0
2022-08-18 22:51:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618949952901120 [0;39m 生成今日电子书快照结束，耗时：0 毫秒
2022-08-18 22:51:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618970907643904 [0;39m 生成今日电子书快照开始
2022-08-18 22:51:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618970907643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:51:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618970907643904 [0;39m ==> Parameters: 
2022-08-18 22:51:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618970907643904 [0;39m <==    Updates: 0
2022-08-18 22:51:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618970907643904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:51:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17618991904329728 [0;39m 生成今日电子书快照开始
2022-08-18 22:51:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618991904329728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:51:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618991904329728 [0;39m ==> Parameters: 
2022-08-18 22:51:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17618991904329728 [0;39m <==    Updates: 0
2022-08-18 22:51:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17618991904329728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:51:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17618991916912640 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:51:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618991916912640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:51:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618991916912640 [0;39m ==> Parameters: 
2022-08-18 22:51:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17618991916912640 [0;39m <==    Updates: 7
2022-08-18 22:51:35.020 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17618991916912640 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:51:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619012875849728 [0;39m 生成今日电子书快照开始
2022-08-18 22:51:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619012875849728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:51:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619012875849728 [0;39m ==> Parameters: 
2022-08-18 22:51:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619012875849728 [0;39m <==    Updates: 0
2022-08-18 22:51:40.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619012875849728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:51:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619033822203904 [0;39m 生成今日电子书快照开始
2022-08-18 22:51:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619033822203904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:51:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619033822203904 [0;39m ==> Parameters: 
2022-08-18 22:51:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619033822203904 [0;39m <==    Updates: 0
2022-08-18 22:51:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619033822203904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:51:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619054785335296 [0;39m 生成今日电子书快照开始
2022-08-18 22:51:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619054785335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:51:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619054785335296 [0;39m ==> Parameters: 
2022-08-18 22:51:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619054785335296 [0;39m <==    Updates: 0
2022-08-18 22:51:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619054785335296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:51:52.620 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m17615248664170496 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-18 22:51:52.620 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m17615248664170496 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-18 22:51:52.620 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m17615248664170496 [0;39m 登录校验开始，token：17610697500397568
2022-08-18 22:51:52.657 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m17615248664170496 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"17610697500397568"}
2022-08-18 22:51:52.657 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17619065900240896 [0;39m ------------- 开始 -------------
2022-08-18 22:51:52.658 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17619065900240896 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-18 22:51:52.658 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17619065900240896 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-18 22:51:52.658 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17619065900240896 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:51:52.659 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17619065900240896 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size=\"3\">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录。</font><b><br></b></div><div>&nbsp; &nbsp;<font size=\"3\"> X：用户管理、登录、登录校验、退出登录（X有可能只是接口也可以是页面）。<br></font></div><div><h2><b>token与JWT：</b></h2></div><h3><font size=\"3\">&nbsp; &nbsp;<b id=\"8bsf3\"> </b>token+redis：</font><b style=\"font-size: 1.17em;\">token是无意义的</b></h3><h3 id=\"cmxl6\">&nbsp; &nbsp; <b>JWT:token是有意义的，加密的，包含业务信息，一般是用户信息，无需存放在redis中可查看<font color=\"#000000\">&nbsp;</font></b><font face=\"仿宋\" style=\"\"><i style=\"background-color: rgb(249, 150, 59);\"><font color=\"#000000\">jwt.io</font></i><font color=\"#1c487f\">&nbsp;</font></font></h3><div><pre> <font size=\"3\">  &lt;dependency&gt;<br>      &lt;groupId&gt;com.auth0&lt;/groupId&gt;<br>      &lt;artifactId&gt;java-jwt&lt;/artifactId&gt;<br>      &lt;version&gt;3.5.0&lt;/version&gt;<br>  &lt;/dependency&gt;  </font></pre><pre><font size=\"3\">  <i>JwtUtil.sign 加密\n  JwtUtil.verity 校验</i></font></pre></div></blockquote>","ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1}]
2022-08-18 22:51:52.660 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17619065900240896 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-18 22:51:52.661 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17619065900240896 [0;39m ==> Parameters: 202714600712572928(Long), 0(Long), 用户管理功能开发(String), 9(Integer), 9(Integer), 1(Integer), 202715583089872896(Long)
2022-08-18 22:51:52.662 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17619065900240896 [0;39m <==    Updates: 1
2022-08-18 22:51:52.662 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17619065900240896 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-18 22:51:52.662 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17619065900240896 [0;39m ==> Parameters: <blockquote><h2 id="fii37">密码加密存储和传输（MDS）<br><font face="宋体"><font size="3">&nbsp;</font><b style=""><font size="4">传输加密： </font></b><font size="3">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size="3" face="Times New Roman"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）
</b></font>&nbsp;&nbsp;<font face="宋体" style=""><b style="font-size: large;">存储加密：</b><font size="3">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size="3"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id="90d5d">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id="9l5yg">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face="Times New Roman" size="3"><font color="#c24f4a">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id="rckur">单点登录token与JWT介绍</h2><h3 id="o9527"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size="3">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size="3">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录。</font><b><br></b></div><div>&nbsp; &nbsp;<font size="3"> X：用户管理、登录、登录校验、退出登录（X有可能只是接口也可以是页面）。<br></font></div><div><h2><b>token与JWT：</b></h2></div><h3><font size="3">&nbsp; &nbsp;<b id="8bsf3"> </b>token+redis：</font><b style="font-size: 1.17em;">token是无意义的</b></h3><h3 id="cmxl6">&nbsp; &nbsp; <b>JWT:token是有意义的，加密的，包含业务信息，一般是用户信息，无需存放在redis中可查看<font color="#000000">&nbsp;</font></b><font face="仿宋" style=""><i style="background-color: rgb(249, 150, 59);"><font color="#000000">jwt.io</font></i><font color="#1c487f">&nbsp;</font></font></h3><div><pre> <font size="3">  &lt;dependency&gt;<br>      &lt;groupId&gt;com.auth0&lt;/groupId&gt;<br>      &lt;artifactId&gt;java-jwt&lt;/artifactId&gt;<br>      &lt;version&gt;3.5.0&lt;/version&gt;<br>  &lt;/dependency&gt;  </font></pre><pre><font size="3">  <i>JwtUtil.sign 加密
  JwtUtil.verity 校验</i></font></pre></div></blockquote>(String), 202715583089872896(Long)
2022-08-18 22:51:52.669 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17619065900240896 [0;39m <==    Updates: 1
2022-08-18 22:51:52.739 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17619065900240896 [0;39m 返回结果: {"success":true}
2022-08-18 22:51:52.739 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17619065900240896 [0;39m ------------- 结束 耗时：82 ms -------------
2022-08-18 22:51:52.740 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m17619065900240896 [0;39m ------------- LoginInterceptor 结束 耗时：120 ms -------------
2022-08-18 22:51:52.750 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17619066290311168 [0;39m ------------- 开始 -------------
2022-08-18 22:51:52.751 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17619066290311168 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-18 22:51:52.751 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17619066290311168 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-18 22:51:52.751 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17619066290311168 [0;39m 远程地址: 127.0.0.1
2022-08-18 22:51:52.751 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17619066290311168 [0;39m 请求参数: [202714600712572928]
2022-08-18 22:51:52.752 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17619066290311168 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-18 22:51:52.752 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17619066290311168 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-18 22:51:52.753 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17619066290311168 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-18 22:51:52.754 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17619066290311168 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 48, 5
2022-08-18 22:51:52.754 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17619066290311168 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 41, 4
2022-08-18 22:51:52.754 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17619066290311168 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-18 22:51:52.754 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17619066290311168 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 22, 3
2022-08-18 22:51:52.755 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17619066290311168 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 26, 5
2022-08-18 22:51:52.755 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17619066290311168 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 25, 2
2022-08-18 22:51:52.755 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17619066290311168 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 10, 2
2022-08-18 22:51:52.755 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17619066290311168 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 11, 3
2022-08-18 22:51:52.756 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17619066290311168 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 9, 1
2022-08-18 22:51:52.756 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17619066290311168 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 7, 1
2022-08-18 22:51:52.756 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17619066290311168 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 4, 1
2022-08-18 22:51:52.756 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17619066290311168 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 3, 2
2022-08-18 22:51:52.756 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17619066290311168 [0;39m <==      Total: 12
2022-08-18 22:51:52.757 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17619066290311168 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":48,"voteCount":5},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":41,"voteCount":4},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":22,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":26,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":25,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":10,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":11,"voteCount":3},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":7,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":4,"voteCount":1},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":3,"voteCount":2}],"success":true}
2022-08-18 22:51:52.757 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17619066290311168 [0;39m ------------- 结束 耗时：7 ms -------------
2022-08-18 22:51:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619075786215424 [0;39m 生成今日电子书快照开始
2022-08-18 22:51:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619075786215424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:51:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619075786215424 [0;39m ==> Parameters: 
2022-08-18 22:51:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619075786215424 [0;39m <==    Updates: 0
2022-08-18 22:51:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619075786215424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:52:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619096719986688 [0;39m 生成今日电子书快照开始
2022-08-18 22:52:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619096719986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:52:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619096719986688 [0;39m ==> Parameters: 
2022-08-18 22:52:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619096719986688 [0;39m <==    Updates: 0
2022-08-18 22:52:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619096719986688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:52:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619117729255424 [0;39m 生成今日电子书快照开始
2022-08-18 22:52:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619117729255424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:52:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619117729255424 [0;39m ==> Parameters: 
2022-08-18 22:52:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619117729255424 [0;39m <==    Updates: 0
2022-08-18 22:52:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619117729255424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:52:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17619117737644032 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:52:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619117737644032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:52:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619117737644032 [0;39m ==> Parameters: 
2022-08-18 22:52:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619117737644032 [0;39m <==    Updates: 7
2022-08-18 22:52:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17619117737644032 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:52:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619138671415296 [0;39m 生成今日电子书快照开始
2022-08-18 22:52:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619138671415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:52:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619138671415296 [0;39m ==> Parameters: 
2022-08-18 22:52:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619138671415296 [0;39m <==    Updates: 0
2022-08-18 22:52:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619138671415296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:52:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619159663906816 [0;39m 生成今日电子书快照开始
2022-08-18 22:52:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619159663906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:52:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619159663906816 [0;39m ==> Parameters: 
2022-08-18 22:52:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619159663906816 [0;39m <==    Updates: 0
2022-08-18 22:52:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619159663906816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:52:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619180643815424 [0;39m 生成今日电子书快照开始
2022-08-18 22:52:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619180643815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:52:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619180643815424 [0;39m ==> Parameters: 
2022-08-18 22:52:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619180643815424 [0;39m <==    Updates: 0
2022-08-18 22:52:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619180643815424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:52:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619201602752512 [0;39m 生成今日电子书快照开始
2022-08-18 22:52:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619201602752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:52:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619201602752512 [0;39m ==> Parameters: 
2022-08-18 22:52:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619201602752512 [0;39m <==    Updates: 0
2022-08-18 22:52:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619201602752512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:52:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619222574272512 [0;39m 生成今日电子书快照开始
2022-08-18 22:52:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619222574272512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:52:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619222574272512 [0;39m ==> Parameters: 
2022-08-18 22:52:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619222574272512 [0;39m <==    Updates: 0
2022-08-18 22:52:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619222574272512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:52:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17619243558375424 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:52:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619243558375424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:52:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619243558375424 [0;39m ==> Parameters: 
2022-08-18 22:52:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619243558375424 [0;39m <==    Updates: 7
2022-08-18 22:52:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17619243558375424 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:52:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619243566764032 [0;39m 生成今日电子书快照开始
2022-08-18 22:52:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619243566764032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:52:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619243566764032 [0;39m ==> Parameters: 
2022-08-18 22:52:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619243566764032 [0;39m <==    Updates: 0
2022-08-18 22:52:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619243566764032 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:52:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619264517312512 [0;39m 生成今日电子书快照开始
2022-08-18 22:52:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619264517312512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:52:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619264517312512 [0;39m ==> Parameters: 
2022-08-18 22:52:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619264517312512 [0;39m <==    Updates: 0
2022-08-18 22:52:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619264517312512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:52:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619285480443904 [0;39m 生成今日电子书快照开始
2022-08-18 22:52:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619285480443904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:52:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619285480443904 [0;39m ==> Parameters: 
2022-08-18 22:52:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619285480443904 [0;39m <==    Updates: 0
2022-08-18 22:52:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619285480443904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:52:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619306456158208 [0;39m 生成今日电子书快照开始
2022-08-18 22:52:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619306456158208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:52:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619306456158208 [0;39m ==> Parameters: 
2022-08-18 22:52:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619306456158208 [0;39m <==    Updates: 0
2022-08-18 22:52:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619306456158208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:52:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619327452844032 [0;39m 生成今日电子书快照开始
2022-08-18 22:52:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619327452844032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:52:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619327452844032 [0;39m ==> Parameters: 
2022-08-18 22:52:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619327452844032 [0;39m <==    Updates: 0
2022-08-18 22:52:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619327452844032 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:53:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619348369838080 [0;39m 生成今日电子书快照开始
2022-08-18 22:53:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619348369838080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:53:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619348369838080 [0;39m ==> Parameters: 
2022-08-18 22:53:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619348369838080 [0;39m <==    Updates: 0
2022-08-18 22:53:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619348369838080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:53:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17619369370718208 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:53:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619369370718208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:53:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619369370718208 [0;39m ==> Parameters: 
2022-08-18 22:53:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619369370718208 [0;39m <==    Updates: 7
2022-08-18 22:53:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17619369370718208 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:53:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619369374912512 [0;39m 生成今日电子书快照开始
2022-08-18 22:53:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619369374912512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:53:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619369374912512 [0;39m ==> Parameters: 
2022-08-18 22:53:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619369374912512 [0;39m <==    Updates: 0
2022-08-18 22:53:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619369374912512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:53:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619390359015424 [0;39m 生成今日电子书快照开始
2022-08-18 22:53:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619390359015424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:53:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619390359015424 [0;39m ==> Parameters: 
2022-08-18 22:53:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619390359015424 [0;39m <==    Updates: 0
2022-08-18 22:53:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619390359015424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:53:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619411317952512 [0;39m 生成今日电子书快照开始
2022-08-18 22:53:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619411317952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:53:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619411317952512 [0;39m ==> Parameters: 
2022-08-18 22:53:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619411317952512 [0;39m <==    Updates: 0
2022-08-18 22:53:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619411317952512 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 22:53:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619432293666816 [0;39m 生成今日电子书快照开始
2022-08-18 22:53:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619432293666816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:53:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619432293666816 [0;39m ==> Parameters: 
2022-08-18 22:53:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619432293666816 [0;39m <==    Updates: 0
2022-08-18 22:53:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619432293666816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:53:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619453260992512 [0;39m 生成今日电子书快照开始
2022-08-18 22:53:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619453260992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:53:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619453260992512 [0;39m ==> Parameters: 
2022-08-18 22:53:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619453260992512 [0;39m <==    Updates: 0
2022-08-18 22:53:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619453260992512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:53:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619474198958080 [0;39m 生成今日电子书快照开始
2022-08-18 22:53:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619474198958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:53:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619474198958080 [0;39m ==> Parameters: 
2022-08-18 22:53:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619474198958080 [0;39m <==    Updates: 0
2022-08-18 22:53:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619474198958080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:53:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17619495170478080 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:53:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619495170478080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:53:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619495170478080 [0;39m ==> Parameters: 
2022-08-18 22:53:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619495170478080 [0;39m <==    Updates: 7
2022-08-18 22:53:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17619495170478080 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:53:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619495178866688 [0;39m 生成今日电子书快照开始
2022-08-18 22:53:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619495178866688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:53:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619495178866688 [0;39m ==> Parameters: 
2022-08-18 22:53:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619495178866688 [0;39m <==    Updates: 0
2022-08-18 22:53:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619495178866688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:53:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619516133609472 [0;39m 生成今日电子书快照开始
2022-08-18 22:53:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619516133609472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:53:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619516133609472 [0;39m ==> Parameters: 
2022-08-18 22:53:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619516133609472 [0;39m <==    Updates: 0
2022-08-18 22:53:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619516133609472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:53:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619537126100992 [0;39m 生成今日电子书快照开始
2022-08-18 22:53:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619537126100992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:53:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619537126100992 [0;39m ==> Parameters: 
2022-08-18 22:53:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619537126100992 [0;39m <==    Updates: 0
2022-08-18 22:53:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619537126100992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:53:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619558101815296 [0;39m 生成今日电子书快照开始
2022-08-18 22:53:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619558101815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:53:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619558101815296 [0;39m ==> Parameters: 
2022-08-18 22:53:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619558101815296 [0;39m <==    Updates: 0
2022-08-18 22:53:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619558101815296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:53:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619579056558080 [0;39m 生成今日电子书快照开始
2022-08-18 22:53:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619579056558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:53:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619579056558080 [0;39m ==> Parameters: 
2022-08-18 22:53:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619579056558080 [0;39m <==    Updates: 0
2022-08-18 22:53:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619579056558080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:54:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619600078409728 [0;39m 生成今日电子书快照开始
2022-08-18 22:54:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619600078409728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:54:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619600078409728 [0;39m ==> Parameters: 
2022-08-18 22:54:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619600078409728 [0;39m <==    Updates: 0
2022-08-18 22:54:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619600078409728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:54:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17619621012180992 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:54:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619621012180992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:54:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619621012180992 [0;39m ==> Parameters: 
2022-08-18 22:54:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619621012180992 [0;39m <==    Updates: 7
2022-08-18 22:54:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17619621012180992 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-18 22:54:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619621037346816 [0;39m 生成今日电子书快照开始
2022-08-18 22:54:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619621037346816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:54:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619621037346816 [0;39m ==> Parameters: 
2022-08-18 22:54:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619621037346816 [0;39m <==    Updates: 0
2022-08-18 22:54:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619621037346816 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 22:54:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619641979506688 [0;39m 生成今日电子书快照开始
2022-08-18 22:54:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619641979506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:54:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619641979506688 [0;39m ==> Parameters: 
2022-08-18 22:54:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619641979506688 [0;39m <==    Updates: 0
2022-08-18 22:54:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619641979506688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:54:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619662980386816 [0;39m 生成今日电子书快照开始
2022-08-18 22:54:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619662980386816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:54:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619662980386816 [0;39m ==> Parameters: 
2022-08-18 22:54:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619662980386816 [0;39m <==    Updates: 0
2022-08-18 22:54:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619662980386816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:54:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619683918352384 [0;39m 生成今日电子书快照开始
2022-08-18 22:54:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619683918352384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:54:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619683918352384 [0;39m ==> Parameters: 
2022-08-18 22:54:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619683918352384 [0;39m <==    Updates: 0
2022-08-18 22:54:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619683918352384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:54:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619704940204032 [0;39m 生成今日电子书快照开始
2022-08-18 22:54:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619704940204032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:54:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619704940204032 [0;39m ==> Parameters: 
2022-08-18 22:54:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619704940204032 [0;39m <==    Updates: 0
2022-08-18 22:54:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619704940204032 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:54:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619725882363904 [0;39m 生成今日电子书快照开始
2022-08-18 22:54:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619725882363904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:54:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619725882363904 [0;39m ==> Parameters: 
2022-08-18 22:54:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619725882363904 [0;39m <==    Updates: 0
2022-08-18 22:54:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619725882363904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:54:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619746858078208 [0;39m 生成今日电子书快照开始
2022-08-18 22:54:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619746858078208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:54:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619746858078208 [0;39m ==> Parameters: 
2022-08-18 22:54:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619746858078208 [0;39m <==    Updates: 0
2022-08-18 22:54:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619746858078208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:54:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17619746870661120 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:54:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619746870661120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:54:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619746870661120 [0;39m ==> Parameters: 
2022-08-18 22:54:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619746870661120 [0;39m <==    Updates: 7
2022-08-18 22:54:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17619746870661120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:54:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619767800238080 [0;39m 生成今日电子书快照开始
2022-08-18 22:54:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619767800238080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:54:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619767800238080 [0;39m ==> Parameters: 
2022-08-18 22:54:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619767800238080 [0;39m <==    Updates: 0
2022-08-18 22:54:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619767800238080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:54:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619788809506816 [0;39m 生成今日电子书快照开始
2022-08-18 22:54:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619788809506816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:54:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619788809506816 [0;39m ==> Parameters: 
2022-08-18 22:54:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619788809506816 [0;39m <==    Updates: 0
2022-08-18 22:54:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619788809506816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:54:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619809760055296 [0;39m 生成今日电子书快照开始
2022-08-18 22:54:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619809760055296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:54:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619809760055296 [0;39m ==> Parameters: 
2022-08-18 22:54:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619809760055296 [0;39m <==    Updates: 0
2022-08-18 22:54:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619809760055296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:54:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619830714798080 [0;39m 生成今日电子书快照开始
2022-08-18 22:54:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619830714798080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:54:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619830714798080 [0;39m ==> Parameters: 
2022-08-18 22:54:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619830714798080 [0;39m <==    Updates: 0
2022-08-18 22:54:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619830714798080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:55:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619851703095296 [0;39m 生成今日电子书快照开始
2022-08-18 22:55:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619851703095296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:55:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619851703095296 [0;39m ==> Parameters: 
2022-08-18 22:55:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619851703095296 [0;39m <==    Updates: 0
2022-08-18 22:55:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619851703095296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:55:05.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17619872653643776 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:55:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619872653643776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:55:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619872653643776 [0;39m ==> Parameters: 
2022-08-18 22:55:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619872653643776 [0;39m <==    Updates: 7
2022-08-18 22:55:05.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17619872653643776 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:55:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619872657838080 [0;39m 生成今日电子书快照开始
2022-08-18 22:55:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619872657838080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:55:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619872657838080 [0;39m ==> Parameters: 
2022-08-18 22:55:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619872657838080 [0;39m <==    Updates: 0
2022-08-18 22:55:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619872657838080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:55:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619893629358080 [0;39m 生成今日电子书快照开始
2022-08-18 22:55:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619893629358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:55:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619893629358080 [0;39m ==> Parameters: 
2022-08-18 22:55:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619893629358080 [0;39m <==    Updates: 0
2022-08-18 22:55:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619893629358080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:55:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619914651209728 [0;39m 生成今日电子书快照开始
2022-08-18 22:55:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619914651209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:55:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619914651209728 [0;39m ==> Parameters: 
2022-08-18 22:55:15.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619914651209728 [0;39m <==    Updates: 0
2022-08-18 22:55:15.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619914651209728 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-18 22:55:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619935576592384 [0;39m 生成今日电子书快照开始
2022-08-18 22:55:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619935576592384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:55:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619935576592384 [0;39m ==> Parameters: 
2022-08-18 22:55:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619935576592384 [0;39m <==    Updates: 0
2022-08-18 22:55:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619935576592384 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:55:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619956569083904 [0;39m 生成今日电子书快照开始
2022-08-18 22:55:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619956569083904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:55:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619956569083904 [0;39m ==> Parameters: 
2022-08-18 22:55:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619956569083904 [0;39m <==    Updates: 0
2022-08-18 22:55:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619956569083904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:55:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619977553186816 [0;39m 生成今日电子书快照开始
2022-08-18 22:55:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619977553186816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:55:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619977553186816 [0;39m ==> Parameters: 
2022-08-18 22:55:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619977553186816 [0;39m <==    Updates: 0
2022-08-18 22:55:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619977553186816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:55:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17619998486958080 [0;39m 生成今日电子书快照开始
2022-08-18 22:55:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619998486958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:55:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619998486958080 [0;39m ==> Parameters: 
2022-08-18 22:55:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17619998486958080 [0;39m <==    Updates: 0
2022-08-18 22:55:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17619998486958080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:55:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17619998495346688 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:55:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619998495346688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:55:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619998495346688 [0;39m ==> Parameters: 
2022-08-18 22:55:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17619998495346688 [0;39m <==    Updates: 7
2022-08-18 22:55:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17619998495346688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:55:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620019483643904 [0;39m 生成今日电子书快照开始
2022-08-18 22:55:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620019483643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:55:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620019483643904 [0;39m ==> Parameters: 
2022-08-18 22:55:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620019483643904 [0;39m <==    Updates: 0
2022-08-18 22:55:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620019483643904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:55:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620040463552512 [0;39m 生成今日电子书快照开始
2022-08-18 22:55:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620040463552512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:55:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620040463552512 [0;39m ==> Parameters: 
2022-08-18 22:55:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620040463552512 [0;39m <==    Updates: 0
2022-08-18 22:55:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620040463552512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:55:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620061397323776 [0;39m 生成今日电子书快照开始
2022-08-18 22:55:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620061397323776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:55:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620061397323776 [0;39m ==> Parameters: 
2022-08-18 22:55:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620061397323776 [0;39m <==    Updates: 0
2022-08-18 22:55:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620061397323776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:55:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620082414981120 [0;39m 生成今日电子书快照开始
2022-08-18 22:55:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620082414981120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:55:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620082414981120 [0;39m ==> Parameters: 
2022-08-18 22:55:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620082414981120 [0;39m <==    Updates: 0
2022-08-18 22:55:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620082414981120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:56:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620103361335296 [0;39m 生成今日电子书快照开始
2022-08-18 22:56:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620103361335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:56:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620103361335296 [0;39m ==> Parameters: 
2022-08-18 22:56:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620103361335296 [0;39m <==    Updates: 0
2022-08-18 22:56:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620103361335296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 22:56:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17620124341243904 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:56:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620124341243904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:56:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620124341243904 [0;39m ==> Parameters: 
2022-08-18 22:56:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620124341243904 [0;39m <==    Updates: 7
2022-08-18 22:56:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17620124341243904 [0;39m 更新电子书下的文档数据结束，耗时：5 毫秒
2022-08-18 22:56:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620124366409728 [0;39m 生成今日电子书快照开始
2022-08-18 22:56:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620124366409728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:56:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620124366409728 [0;39m ==> Parameters: 
2022-08-18 22:56:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620124366409728 [0;39m <==    Updates: 0
2022-08-18 22:56:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620124366409728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:56:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620145329541120 [0;39m 生成今日电子书快照开始
2022-08-18 22:56:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620145329541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:56:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620145329541120 [0;39m ==> Parameters: 
2022-08-18 22:56:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620145329541120 [0;39m <==    Updates: 0
2022-08-18 22:56:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620145329541120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:56:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620166309449728 [0;39m 生成今日电子书快照开始
2022-08-18 22:56:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620166309449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:56:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620166309449728 [0;39m ==> Parameters: 
2022-08-18 22:56:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620166309449728 [0;39m <==    Updates: 0
2022-08-18 22:56:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620166309449728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:56:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620187272581120 [0;39m 生成今日电子书快照开始
2022-08-18 22:56:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620187272581120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:56:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620187272581120 [0;39m ==> Parameters: 
2022-08-18 22:56:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620187272581120 [0;39m <==    Updates: 0
2022-08-18 22:56:20.031 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620187272581120 [0;39m 生成今日电子书快照结束，耗时：18 毫秒
2022-08-18 22:56:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620208218935296 [0;39m 生成今日电子书快照开始
2022-08-18 22:56:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620208218935296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:56:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620208218935296 [0;39m ==> Parameters: 
2022-08-18 22:56:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620208218935296 [0;39m <==    Updates: 0
2022-08-18 22:56:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620208218935296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:56:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620229169483776 [0;39m 生成今日电子书快照开始
2022-08-18 22:56:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620229169483776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:56:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620229169483776 [0;39m ==> Parameters: 
2022-08-18 22:56:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620229169483776 [0;39m <==    Updates: 0
2022-08-18 22:56:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620229169483776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:56:35.000 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17620250132615168 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:56:35.000 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620250132615168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:56:35.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620250132615168 [0;39m ==> Parameters: 
2022-08-18 22:56:35.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620250132615168 [0;39m <==    Updates: 7
2022-08-18 22:56:35.002 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17620250132615168 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:56:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620250141003776 [0;39m 生成今日电子书快照开始
2022-08-18 22:56:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620250141003776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:56:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620250141003776 [0;39m ==> Parameters: 
2022-08-18 22:56:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620250141003776 [0;39m <==    Updates: 0
2022-08-18 22:56:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620250141003776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:56:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620271167049728 [0;39m 生成今日电子书快照开始
2022-08-18 22:56:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620271167049728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:56:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620271167049728 [0;39m ==> Parameters: 
2022-08-18 22:56:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620271167049728 [0;39m <==    Updates: 0
2022-08-18 22:56:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620271167049728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:56:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620292109209600 [0;39m 生成今日电子书快照开始
2022-08-18 22:56:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620292109209600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:56:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620292109209600 [0;39m ==> Parameters: 
2022-08-18 22:56:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620292109209600 [0;39m <==    Updates: 0
2022-08-18 22:56:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620292109209600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:56:50.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620313051369472 [0;39m 生成今日电子书快照开始
2022-08-18 22:56:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620313051369472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:56:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620313051369472 [0;39m ==> Parameters: 
2022-08-18 22:56:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620313051369472 [0;39m <==    Updates: 0
2022-08-18 22:56:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620313051369472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:56:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620334085804032 [0;39m 生成今日电子书快照开始
2022-08-18 22:56:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620334085804032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:56:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620334085804032 [0;39m ==> Parameters: 
2022-08-18 22:56:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620334085804032 [0;39m <==    Updates: 0
2022-08-18 22:56:55.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620334085804032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:57:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620355015380992 [0;39m 生成今日电子书快照开始
2022-08-18 22:57:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620355015380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:57:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620355015380992 [0;39m ==> Parameters: 
2022-08-18 22:57:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620355015380992 [0;39m <==    Updates: 0
2022-08-18 22:57:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620355015380992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:57:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17620376028844032 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:57:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620376028844032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:57:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620376028844032 [0;39m ==> Parameters: 
2022-08-18 22:57:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620376028844032 [0;39m <==    Updates: 7
2022-08-18 22:57:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17620376028844032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:57:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620376037232640 [0;39m 生成今日电子书快照开始
2022-08-18 22:57:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620376037232640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:57:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620376037232640 [0;39m ==> Parameters: 
2022-08-18 22:57:05.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620376037232640 [0;39m <==    Updates: 0
2022-08-18 22:57:05.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620376037232640 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:57:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620396975198208 [0;39m 生成今日电子书快照开始
2022-08-18 22:57:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620396975198208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:57:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620396975198208 [0;39m ==> Parameters: 
2022-08-18 22:57:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620396975198208 [0;39m <==    Updates: 0
2022-08-18 22:57:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620396975198208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:57:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620417925746688 [0;39m 生成今日电子书快照开始
2022-08-18 22:57:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620417925746688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:57:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620417925746688 [0;39m ==> Parameters: 
2022-08-18 22:57:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620417925746688 [0;39m <==    Updates: 0
2022-08-18 22:57:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620417925746688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:57:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620438884683776 [0;39m 生成今日电子书快照开始
2022-08-18 22:57:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620438884683776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:57:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620438884683776 [0;39m ==> Parameters: 
2022-08-18 22:57:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620438884683776 [0;39m <==    Updates: 0
2022-08-18 22:57:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620438884683776 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:57:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620459889758208 [0;39m 生成今日电子书快照开始
2022-08-18 22:57:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620459889758208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:57:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620459889758208 [0;39m ==> Parameters: 
2022-08-18 22:57:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620459889758208 [0;39m <==    Updates: 0
2022-08-18 22:57:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620459889758208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:57:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620480865472512 [0;39m 生成今日电子书快照开始
2022-08-18 22:57:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620480865472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:57:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620480865472512 [0;39m ==> Parameters: 
2022-08-18 22:57:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620480865472512 [0;39m <==    Updates: 0
2022-08-18 22:57:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620480865472512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:57:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17620501857964032 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:57:35.130 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620501857964032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:57:35.130 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620501857964032 [0;39m ==> Parameters: 
2022-08-18 22:57:35.130 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620501857964032 [0;39m <==    Updates: 7
2022-08-18 22:57:35.131 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17620501857964032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:57:35.131 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620502340308992 [0;39m 生成今日电子书快照开始
2022-08-18 22:57:35.131 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620502340308992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:57:35.131 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620502340308992 [0;39m ==> Parameters: 
2022-08-18 22:57:35.132 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620502340308992 [0;39m <==    Updates: 0
2022-08-18 22:57:35.132 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620502340308992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:57:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620522770763776 [0;39m 生成今日电子书快照开始
2022-08-18 22:57:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620522770763776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:57:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620522770763776 [0;39m ==> Parameters: 
2022-08-18 22:57:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620522770763776 [0;39m <==    Updates: 0
2022-08-18 22:57:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620522770763776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:57:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620543771643904 [0;39m 生成今日电子书快照开始
2022-08-18 22:57:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620543771643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:57:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620543771643904 [0;39m ==> Parameters: 
2022-08-18 22:57:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620543771643904 [0;39m <==    Updates: 0
2022-08-18 22:57:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620543771643904 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 22:57:50.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620564709609472 [0;39m 生成今日电子书快照开始
2022-08-18 22:57:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620564709609472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:57:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620564709609472 [0;39m ==> Parameters: 
2022-08-18 22:57:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620564709609472 [0;39m <==    Updates: 0
2022-08-18 22:57:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620564709609472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:57:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620585693712384 [0;39m 生成今日电子书快照开始
2022-08-18 22:57:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620585693712384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:57:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620585693712384 [0;39m ==> Parameters: 
2022-08-18 22:57:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620585693712384 [0;39m <==    Updates: 0
2022-08-18 22:57:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620585693712384 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-18 22:58:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620606698786816 [0;39m 生成今日电子书快照开始
2022-08-18 22:58:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620606698786816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:58:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620606698786816 [0;39m ==> Parameters: 
2022-08-18 22:58:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620606698786816 [0;39m <==    Updates: 0
2022-08-18 22:58:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620606698786816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:58:05.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17620627632558080 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:58:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620627632558080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:58:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620627632558080 [0;39m ==> Parameters: 
2022-08-18 22:58:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620627632558080 [0;39m <==    Updates: 7
2022-08-18 22:58:05.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17620627632558080 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 22:58:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620627640946688 [0;39m 生成今日电子书快照开始
2022-08-18 22:58:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620627640946688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:58:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620627640946688 [0;39m ==> Parameters: 
2022-08-18 22:58:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620627640946688 [0;39m <==    Updates: 0
2022-08-18 22:58:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620627640946688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:58:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620648604078080 [0;39m 生成今日电子书快照开始
2022-08-18 22:58:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620648604078080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:58:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620648604078080 [0;39m ==> Parameters: 
2022-08-18 22:58:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620648604078080 [0;39m <==    Updates: 0
2022-08-18 22:58:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620648604078080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:58:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620669583986688 [0;39m 生成今日电子书快照开始
2022-08-18 22:58:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620669583986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:58:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620669583986688 [0;39m ==> Parameters: 
2022-08-18 22:58:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620669583986688 [0;39m <==    Updates: 0
2022-08-18 22:58:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620669583986688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:58:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620690576478208 [0;39m 生成今日电子书快照开始
2022-08-18 22:58:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620690576478208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:58:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620690576478208 [0;39m ==> Parameters: 
2022-08-18 22:58:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620690576478208 [0;39m <==    Updates: 0
2022-08-18 22:58:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620690576478208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:58:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620711543803904 [0;39m 生成今日电子书快照开始
2022-08-18 22:58:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620711543803904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:58:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620711543803904 [0;39m ==> Parameters: 
2022-08-18 22:58:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620711543803904 [0;39m <==    Updates: 0
2022-08-18 22:58:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620711543803904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:58:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620732511129600 [0;39m 生成今日电子书快照开始
2022-08-18 22:58:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620732511129600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:58:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620732511129600 [0;39m ==> Parameters: 
2022-08-18 22:58:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620732511129600 [0;39m <==    Updates: 0
2022-08-18 22:58:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620732511129600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:58:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620753470066688 [0;39m 生成今日电子书快照开始
2022-08-18 22:58:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620753470066688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:58:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620753470066688 [0;39m ==> Parameters: 
2022-08-18 22:58:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620753470066688 [0;39m <==    Updates: 0
2022-08-18 22:58:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620753470066688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:58:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17620753478455296 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:58:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620753478455296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:58:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620753478455296 [0;39m ==> Parameters: 
2022-08-18 22:58:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620753478455296 [0;39m <==    Updates: 7
2022-08-18 22:58:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17620753478455296 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:58:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620774466752512 [0;39m 生成今日电子书快照开始
2022-08-18 22:58:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620774466752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:58:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620774466752512 [0;39m ==> Parameters: 
2022-08-18 22:58:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620774466752512 [0;39m <==    Updates: 0
2022-08-18 22:58:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620774466752512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:58:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620795446661120 [0;39m 生成今日电子书快照开始
2022-08-18 22:58:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620795446661120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:58:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620795446661120 [0;39m ==> Parameters: 
2022-08-18 22:58:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620795446661120 [0;39m <==    Updates: 0
2022-08-18 22:58:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620795446661120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:58:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620816376238080 [0;39m 生成今日电子书快照开始
2022-08-18 22:58:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620816376238080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:58:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620816376238080 [0;39m ==> Parameters: 
2022-08-18 22:58:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620816376238080 [0;39m <==    Updates: 0
2022-08-18 22:58:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620816376238080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:58:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620837389701120 [0;39m 生成今日电子书快照开始
2022-08-18 22:58:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620837389701120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:58:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620837389701120 [0;39m ==> Parameters: 
2022-08-18 22:58:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620837389701120 [0;39m <==    Updates: 0
2022-08-18 22:58:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620837389701120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:59:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620858357026816 [0;39m 生成今日电子书快照开始
2022-08-18 22:59:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620858357026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:59:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620858357026816 [0;39m ==> Parameters: 
2022-08-18 22:59:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620858357026816 [0;39m <==    Updates: 0
2022-08-18 22:59:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620858357026816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:59:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620879324352512 [0;39m 生成今日电子书快照开始
2022-08-18 22:59:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620879324352512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:59:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620879324352512 [0;39m ==> Parameters: 
2022-08-18 22:59:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620879324352512 [0;39m <==    Updates: 0
2022-08-18 22:59:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620879324352512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:59:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17620879332741120 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:59:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620879332741120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:59:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620879332741120 [0;39m ==> Parameters: 
2022-08-18 22:59:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17620879332741120 [0;39m <==    Updates: 7
2022-08-18 22:59:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17620879332741120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:59:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620900304261120 [0;39m 生成今日电子书快照开始
2022-08-18 22:59:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620900304261120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:59:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620900304261120 [0;39m ==> Parameters: 
2022-08-18 22:59:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620900304261120 [0;39m <==    Updates: 0
2022-08-18 22:59:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620900304261120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:59:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620921279975424 [0;39m 生成今日电子书快照开始
2022-08-18 22:59:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620921279975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:59:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620921279975424 [0;39m ==> Parameters: 
2022-08-18 22:59:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620921279975424 [0;39m <==    Updates: 0
2022-08-18 22:59:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620921279975424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:59:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620942230523904 [0;39m 生成今日电子书快照开始
2022-08-18 22:59:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620942230523904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:59:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620942230523904 [0;39m ==> Parameters: 
2022-08-18 22:59:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620942230523904 [0;39m <==    Updates: 0
2022-08-18 22:59:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620942230523904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:59:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620963176878080 [0;39m 生成今日电子书快照开始
2022-08-18 22:59:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620963176878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:59:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620963176878080 [0;39m ==> Parameters: 
2022-08-18 22:59:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620963176878080 [0;39m <==    Updates: 0
2022-08-18 22:59:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620963176878080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 22:59:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17620984177758208 [0;39m 生成今日电子书快照开始
2022-08-18 22:59:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620984177758208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:59:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620984177758208 [0;39m ==> Parameters: 
2022-08-18 22:59:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17620984177758208 [0;39m <==    Updates: 0
2022-08-18 22:59:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17620984177758208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 22:59:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17621005174444032 [0;39m 更新电子书下的文档数据开始
2022-08-18 22:59:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621005174444032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 22:59:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621005174444032 [0;39m ==> Parameters: 
2022-08-18 22:59:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621005174444032 [0;39m <==    Updates: 7
2022-08-18 22:59:35.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17621005174444032 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 22:59:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621005178638336 [0;39m 生成今日电子书快照开始
2022-08-18 22:59:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621005178638336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:59:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621005178638336 [0;39m ==> Parameters: 
2022-08-18 22:59:35.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621005178638336 [0;39m <==    Updates: 0
2022-08-18 22:59:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621005178638336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:59:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621026095632384 [0;39m 生成今日电子书快照开始
2022-08-18 22:59:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621026095632384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:59:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621026095632384 [0;39m ==> Parameters: 
2022-08-18 22:59:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621026095632384 [0;39m <==    Updates: 0
2022-08-18 22:59:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621026095632384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:59:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621047062958080 [0;39m 生成今日电子书快照开始
2022-08-18 22:59:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621047062958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:59:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621047062958080 [0;39m ==> Parameters: 
2022-08-18 22:59:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621047062958080 [0;39m <==    Updates: 0
2022-08-18 22:59:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621047062958080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:59:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621068080615424 [0;39m 生成今日电子书快照开始
2022-08-18 22:59:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621068080615424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:59:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621068080615424 [0;39m ==> Parameters: 
2022-08-18 22:59:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621068080615424 [0;39m <==    Updates: 0
2022-08-18 22:59:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621068080615424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 22:59:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621089047941120 [0;39m 生成今日电子书快照开始
2022-08-18 22:59:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621089047941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 22:59:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621089047941120 [0;39m ==> Parameters: 
2022-08-18 22:59:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621089047941120 [0;39m <==    Updates: 0
2022-08-18 22:59:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621089047941120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:00:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621110006878208 [0;39m 生成今日电子书快照开始
2022-08-18 23:00:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621110006878208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:00:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621110006878208 [0;39m ==> Parameters: 
2022-08-18 23:00:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621110006878208 [0;39m <==    Updates: 0
2022-08-18 23:00:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621110006878208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:00:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17621130953232384 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:00:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621130953232384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:00:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621130953232384 [0;39m ==> Parameters: 
2022-08-18 23:00:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621130953232384 [0;39m <==    Updates: 7
2022-08-18 23:00:05.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17621130953232384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:00:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621130957426688 [0;39m 生成今日电子书快照开始
2022-08-18 23:00:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621130957426688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:00:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621130957426688 [0;39m ==> Parameters: 
2022-08-18 23:00:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621130957426688 [0;39m <==    Updates: 0
2022-08-18 23:00:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621130957426688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:00:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621151920558080 [0;39m 生成今日电子书快照开始
2022-08-18 23:00:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621151920558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:00:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621151920558080 [0;39m ==> Parameters: 
2022-08-18 23:00:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621151920558080 [0;39m <==    Updates: 0
2022-08-18 23:00:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621151920558080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:00:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621172892078080 [0;39m 生成今日电子书快照开始
2022-08-18 23:00:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621172892078080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:00:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621172892078080 [0;39m ==> Parameters: 
2022-08-18 23:00:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621172892078080 [0;39m <==    Updates: 0
2022-08-18 23:00:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621172892078080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:00:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621193867792384 [0;39m 生成今日电子书快照开始
2022-08-18 23:00:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621193867792384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:00:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621193867792384 [0;39m ==> Parameters: 
2022-08-18 23:00:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621193867792384 [0;39m <==    Updates: 0
2022-08-18 23:00:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621193867792384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:00:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621214889644032 [0;39m 生成今日电子书快照开始
2022-08-18 23:00:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621214889644032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:00:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621214889644032 [0;39m ==> Parameters: 
2022-08-18 23:00:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621214889644032 [0;39m <==    Updates: 0
2022-08-18 23:00:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621214889644032 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:00:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621235856969728 [0;39m 生成今日电子书快照开始
2022-08-18 23:00:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621235856969728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:00:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621235856969728 [0;39m ==> Parameters: 
2022-08-18 23:00:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621235856969728 [0;39m <==    Updates: 0
2022-08-18 23:00:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621235856969728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:00:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621256807518208 [0;39m 生成今日电子书快照开始
2022-08-18 23:00:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621256807518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:00:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621256807518208 [0;39m ==> Parameters: 
2022-08-18 23:00:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621256807518208 [0;39m <==    Updates: 0
2022-08-18 23:00:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621256807518208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:00:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17621256824295424 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:00:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621256824295424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:00:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621256824295424 [0;39m ==> Parameters: 
2022-08-18 23:00:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621256824295424 [0;39m <==    Updates: 7
2022-08-18 23:00:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17621256824295424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:00:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621277745483776 [0;39m 生成今日电子书快照开始
2022-08-18 23:00:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621277745483776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:00:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621277745483776 [0;39m ==> Parameters: 
2022-08-18 23:00:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621277745483776 [0;39m <==    Updates: 0
2022-08-18 23:00:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621277745483776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:00:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621298725392384 [0;39m 生成今日电子书快照开始
2022-08-18 23:00:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621298725392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:00:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621298725392384 [0;39m ==> Parameters: 
2022-08-18 23:00:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621298725392384 [0;39m <==    Updates: 0
2022-08-18 23:00:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621298725392384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:00:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621319709495296 [0;39m 生成今日电子书快照开始
2022-08-18 23:00:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621319709495296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:00:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621319709495296 [0;39m ==> Parameters: 
2022-08-18 23:00:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621319709495296 [0;39m <==    Updates: 0
2022-08-18 23:00:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621319709495296 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:00:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621340681015296 [0;39m 生成今日电子书快照开始
2022-08-18 23:00:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621340681015296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:00:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621340681015296 [0;39m ==> Parameters: 
2022-08-18 23:00:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621340681015296 [0;39m <==    Updates: 0
2022-08-18 23:00:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621340681015296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:01:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621361648340992 [0;39m 生成今日电子书快照开始
2022-08-18 23:01:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621361648340992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:01:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621361648340992 [0;39m ==> Parameters: 
2022-08-18 23:01:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621361648340992 [0;39m <==    Updates: 0
2022-08-18 23:01:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621361648340992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:01:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621382645026816 [0;39m 生成今日电子书快照开始
2022-08-18 23:01:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621382645026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:01:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621382645026816 [0;39m ==> Parameters: 
2022-08-18 23:01:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621382645026816 [0;39m <==    Updates: 0
2022-08-18 23:01:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621382645026816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:01:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17621382657609728 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:01:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621382657609728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:01:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621382657609728 [0;39m ==> Parameters: 
2022-08-18 23:01:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621382657609728 [0;39m <==    Updates: 7
2022-08-18 23:01:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17621382657609728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:01:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621403599769600 [0;39m 生成今日电子书快照开始
2022-08-18 23:01:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621403599769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:01:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621403599769600 [0;39m ==> Parameters: 
2022-08-18 23:01:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621403599769600 [0;39m <==    Updates: 0
2022-08-18 23:01:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621403599769600 [0;39m 生成今日电子书快照结束，耗时：0 毫秒
2022-08-18 23:01:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621424571289600 [0;39m 生成今日电子书快照开始
2022-08-18 23:01:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621424571289600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:01:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621424571289600 [0;39m ==> Parameters: 
2022-08-18 23:01:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621424571289600 [0;39m <==    Updates: 0
2022-08-18 23:01:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621424571289600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:01:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621445517643776 [0;39m 生成今日电子书快照开始
2022-08-18 23:01:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621445517643776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:01:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621445517643776 [0;39m ==> Parameters: 
2022-08-18 23:01:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621445517643776 [0;39m <==    Updates: 0
2022-08-18 23:01:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621445517643776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:01:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621466484969472 [0;39m 生成今日电子书快照开始
2022-08-18 23:01:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621466484969472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:01:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621466484969472 [0;39m ==> Parameters: 
2022-08-18 23:01:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621466484969472 [0;39m <==    Updates: 0
2022-08-18 23:01:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621466484969472 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-18 23:01:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621487498432512 [0;39m 生成今日电子书快照开始
2022-08-18 23:01:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621487498432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:01:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621487498432512 [0;39m ==> Parameters: 
2022-08-18 23:01:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621487498432512 [0;39m <==    Updates: 0
2022-08-18 23:01:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621487498432512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:01:35.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17621508474146816 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:01:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621508474146816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:01:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621508474146816 [0;39m ==> Parameters: 
2022-08-18 23:01:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621508474146816 [0;39m <==    Updates: 7
2022-08-18 23:01:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17621508474146816 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:01:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621508482535424 [0;39m 生成今日电子书快照开始
2022-08-18 23:01:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621508482535424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:01:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621508482535424 [0;39m ==> Parameters: 
2022-08-18 23:01:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621508482535424 [0;39m <==    Updates: 0
2022-08-18 23:01:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621508482535424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:01:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621529437278208 [0;39m 生成今日电子书快照开始
2022-08-18 23:01:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621529437278208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:01:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621529437278208 [0;39m ==> Parameters: 
2022-08-18 23:01:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621529437278208 [0;39m <==    Updates: 0
2022-08-18 23:01:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621529437278208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:01:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621550383632384 [0;39m 生成今日电子书快照开始
2022-08-18 23:01:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621550383632384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:01:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621550383632384 [0;39m ==> Parameters: 
2022-08-18 23:01:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621550383632384 [0;39m <==    Updates: 0
2022-08-18 23:01:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621550383632384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:01:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621571388706816 [0;39m 生成今日电子书快照开始
2022-08-18 23:01:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621571388706816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:01:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621571388706816 [0;39m ==> Parameters: 
2022-08-18 23:01:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621571388706816 [0;39m <==    Updates: 0
2022-08-18 23:01:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621571388706816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:01:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621592343449600 [0;39m 生成今日电子书快照开始
2022-08-18 23:01:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621592343449600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:01:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621592343449600 [0;39m ==> Parameters: 
2022-08-18 23:01:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621592343449600 [0;39m <==    Updates: 0
2022-08-18 23:01:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621592343449600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:02:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621613344329728 [0;39m 生成今日电子书快照开始
2022-08-18 23:02:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621613344329728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:02:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621613344329728 [0;39m ==> Parameters: 
2022-08-18 23:02:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621613344329728 [0;39m <==    Updates: 0
2022-08-18 23:02:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621613344329728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:02:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621634303266816 [0;39m 生成今日电子书快照开始
2022-08-18 23:02:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621634303266816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:02:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621634303266816 [0;39m ==> Parameters: 
2022-08-18 23:02:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621634303266816 [0;39m <==    Updates: 0
2022-08-18 23:02:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621634303266816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:02:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17621634307461120 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:02:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621634307461120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:02:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621634307461120 [0;39m ==> Parameters: 
2022-08-18 23:02:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621634307461120 [0;39m <==    Updates: 7
2022-08-18 23:02:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17621634307461120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:02:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621655237038080 [0;39m 生成今日电子书快照开始
2022-08-18 23:02:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621655237038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:02:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621655237038080 [0;39m ==> Parameters: 
2022-08-18 23:02:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621655237038080 [0;39m <==    Updates: 0
2022-08-18 23:02:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621655237038080 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:02:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621676225335296 [0;39m 生成今日电子书快照开始
2022-08-18 23:02:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621676225335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:02:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621676225335296 [0;39m ==> Parameters: 
2022-08-18 23:02:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621676225335296 [0;39m <==    Updates: 0
2022-08-18 23:02:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621676225335296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:02:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621697205243904 [0;39m 生成今日电子书快照开始
2022-08-18 23:02:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621697205243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:02:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621697205243904 [0;39m ==> Parameters: 
2022-08-18 23:02:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621697205243904 [0;39m <==    Updates: 0
2022-08-18 23:02:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621697205243904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:02:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621718155792384 [0;39m 生成今日电子书快照开始
2022-08-18 23:02:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621718155792384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:02:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621718155792384 [0;39m ==> Parameters: 
2022-08-18 23:02:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621718155792384 [0;39m <==    Updates: 0
2022-08-18 23:02:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621718155792384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:02:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621739118923776 [0;39m 生成今日电子书快照开始
2022-08-18 23:02:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621739118923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:02:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621739118923776 [0;39m ==> Parameters: 
2022-08-18 23:02:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621739118923776 [0;39m <==    Updates: 0
2022-08-18 23:02:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621739118923776 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-18 23:02:35.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17621760086249472 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:02:35.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621760086249472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:02:35.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621760086249472 [0;39m ==> Parameters: 
2022-08-18 23:02:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621760086249472 [0;39m <==    Updates: 7
2022-08-18 23:02:35.002 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17621760086249472 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:02:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621760090443776 [0;39m 生成今日电子书快照开始
2022-08-18 23:02:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621760090443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:02:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621760090443776 [0;39m ==> Parameters: 
2022-08-18 23:02:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621760090443776 [0;39m <==    Updates: 0
2022-08-18 23:02:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621760090443776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:02:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621781061963776 [0;39m 生成今日电子书快照开始
2022-08-18 23:02:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621781061963776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:02:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621781061963776 [0;39m ==> Parameters: 
2022-08-18 23:02:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621781061963776 [0;39m <==    Updates: 0
2022-08-18 23:02:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621781061963776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:02:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621802067038208 [0;39m 生成今日电子书快照开始
2022-08-18 23:02:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621802067038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:02:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621802067038208 [0;39m ==> Parameters: 
2022-08-18 23:02:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621802067038208 [0;39m <==    Updates: 0
2022-08-18 23:02:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621802067038208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:02:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621823072112640 [0;39m 生成今日电子书快照开始
2022-08-18 23:02:50.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621823072112640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:02:50.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621823072112640 [0;39m ==> Parameters: 
2022-08-18 23:02:50.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621823072112640 [0;39m <==    Updates: 0
2022-08-18 23:02:50.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621823072112640 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:02:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621843989106688 [0;39m 生成今日电子书快照开始
2022-08-18 23:02:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621843989106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:02:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621843989106688 [0;39m ==> Parameters: 
2022-08-18 23:02:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621843989106688 [0;39m <==    Updates: 0
2022-08-18 23:02:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621843989106688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:03:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621865002569728 [0;39m 生成今日电子书快照开始
2022-08-18 23:03:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621865002569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:03:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621865002569728 [0;39m ==> Parameters: 
2022-08-18 23:03:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621865002569728 [0;39m <==    Updates: 0
2022-08-18 23:03:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621865002569728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:03:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17621885936340992 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:03:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621885936340992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:03:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621885936340992 [0;39m ==> Parameters: 
2022-08-18 23:03:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17621885936340992 [0;39m <==    Updates: 7
2022-08-18 23:03:05.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17621885936340992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:03:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621885944729600 [0;39m 生成今日电子书快照开始
2022-08-18 23:03:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621885944729600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:03:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621885944729600 [0;39m ==> Parameters: 
2022-08-18 23:03:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621885944729600 [0;39m <==    Updates: 0
2022-08-18 23:03:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621885944729600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:03:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621906899472384 [0;39m 生成今日电子书快照开始
2022-08-18 23:03:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621906899472384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:03:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621906899472384 [0;39m ==> Parameters: 
2022-08-18 23:03:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621906899472384 [0;39m <==    Updates: 0
2022-08-18 23:03:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621906899472384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:03:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621927908741120 [0;39m 生成今日电子书快照开始
2022-08-18 23:03:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621927908741120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:03:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621927908741120 [0;39m ==> Parameters: 
2022-08-18 23:03:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621927908741120 [0;39m <==    Updates: 0
2022-08-18 23:03:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621927908741120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:03:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621948892844032 [0;39m 生成今日电子书快照开始
2022-08-18 23:03:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621948892844032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:03:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621948892844032 [0;39m ==> Parameters: 
2022-08-18 23:03:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621948892844032 [0;39m <==    Updates: 0
2022-08-18 23:03:20.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621948892844032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:03:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621969801449472 [0;39m 生成今日电子书快照开始
2022-08-18 23:03:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621969801449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:03:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621969801449472 [0;39m ==> Parameters: 
2022-08-18 23:03:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621969801449472 [0;39m <==    Updates: 0
2022-08-18 23:03:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621969801449472 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:03:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17621990777163776 [0;39m 生成今日电子书快照开始
2022-08-18 23:03:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621990777163776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:03:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621990777163776 [0;39m ==> Parameters: 
2022-08-18 23:03:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17621990777163776 [0;39m <==    Updates: 0
2022-08-18 23:03:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17621990777163776 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:03:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17622011761266688 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:03:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622011761266688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:03:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622011761266688 [0;39m ==> Parameters: 
2022-08-18 23:03:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622011761266688 [0;39m <==    Updates: 7
2022-08-18 23:03:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17622011761266688 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:03:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622011769655296 [0;39m 生成今日电子书快照开始
2022-08-18 23:03:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622011769655296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:03:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622011769655296 [0;39m ==> Parameters: 
2022-08-18 23:03:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622011769655296 [0;39m <==    Updates: 0
2022-08-18 23:03:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622011769655296 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:03:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622032762146816 [0;39m 生成今日电子书快照开始
2022-08-18 23:03:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622032762146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:03:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622032762146816 [0;39m ==> Parameters: 
2022-08-18 23:03:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622032762146816 [0;39m <==    Updates: 0
2022-08-18 23:03:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622032762146816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:03:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622053725278208 [0;39m 生成今日电子书快照开始
2022-08-18 23:03:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622053725278208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:03:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622053725278208 [0;39m ==> Parameters: 
2022-08-18 23:03:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622053725278208 [0;39m <==    Updates: 0
2022-08-18 23:03:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622053725278208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:03:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622074680020992 [0;39m 生成今日电子书快照开始
2022-08-18 23:03:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622074680020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:03:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622074680020992 [0;39m ==> Parameters: 
2022-08-18 23:03:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622074680020992 [0;39m <==    Updates: 0
2022-08-18 23:03:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622074680020992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:03:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622095664123904 [0;39m 生成今日电子书快照开始
2022-08-18 23:03:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622095664123904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:03:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622095664123904 [0;39m ==> Parameters: 
2022-08-18 23:03:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622095664123904 [0;39m <==    Updates: 0
2022-08-18 23:03:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622095664123904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:04:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622116618866688 [0;39m 生成今日电子书快照开始
2022-08-18 23:04:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622116618866688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:04:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622116618866688 [0;39m ==> Parameters: 
2022-08-18 23:04:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622116618866688 [0;39m <==    Updates: 0
2022-08-18 23:04:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622116618866688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:04:05.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622137577803776 [0;39m 生成今日电子书快照开始
2022-08-18 23:04:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622137577803776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:04:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622137577803776 [0;39m ==> Parameters: 
2022-08-18 23:04:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622137577803776 [0;39m <==    Updates: 0
2022-08-18 23:04:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622137577803776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:04:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17622137594580992 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:04:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622137594580992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:04:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622137594580992 [0;39m ==> Parameters: 
2022-08-18 23:04:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622137594580992 [0;39m <==    Updates: 7
2022-08-18 23:04:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17622137594580992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:04:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622158595461120 [0;39m 生成今日电子书快照开始
2022-08-18 23:04:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622158595461120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:04:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622158595461120 [0;39m ==> Parameters: 
2022-08-18 23:04:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622158595461120 [0;39m <==    Updates: 0
2022-08-18 23:04:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622158595461120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:04:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622179533426688 [0;39m 生成今日电子书快照开始
2022-08-18 23:04:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622179533426688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:04:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622179533426688 [0;39m ==> Parameters: 
2022-08-18 23:04:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622179533426688 [0;39m <==    Updates: 0
2022-08-18 23:04:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622179533426688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:04:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622200534306816 [0;39m 生成今日电子书快照开始
2022-08-18 23:04:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622200534306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:04:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622200534306816 [0;39m ==> Parameters: 
2022-08-18 23:04:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622200534306816 [0;39m <==    Updates: 0
2022-08-18 23:04:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622200534306816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:04:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622221463883776 [0;39m 生成今日电子书快照开始
2022-08-18 23:04:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622221463883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:04:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622221463883776 [0;39m ==> Parameters: 
2022-08-18 23:04:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622221463883776 [0;39m <==    Updates: 0
2022-08-18 23:04:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622221463883776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:04:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622242447986688 [0;39m 生成今日电子书快照开始
2022-08-18 23:04:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622242447986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:04:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622242447986688 [0;39m ==> Parameters: 
2022-08-18 23:04:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622242447986688 [0;39m <==    Updates: 0
2022-08-18 23:04:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622242447986688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:04:35.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622263402729472 [0;39m 生成今日电子书快照开始
2022-08-18 23:04:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622263402729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:04:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622263402729472 [0;39m ==> Parameters: 
2022-08-18 23:04:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622263402729472 [0;39m <==    Updates: 0
2022-08-18 23:04:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622263402729472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:04:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17622263411118080 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:04:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622263411118080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:04:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622263411118080 [0;39m ==> Parameters: 
2022-08-18 23:04:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622263411118080 [0;39m <==    Updates: 7
2022-08-18 23:04:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17622263411118080 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:04:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622284386832384 [0;39m 生成今日电子书快照开始
2022-08-18 23:04:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622284386832384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:04:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622284386832384 [0;39m ==> Parameters: 
2022-08-18 23:04:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622284386832384 [0;39m <==    Updates: 0
2022-08-18 23:04:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622284386832384 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:04:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622305404489728 [0;39m 生成今日电子书快照开始
2022-08-18 23:04:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622305404489728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:04:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622305404489728 [0;39m ==> Parameters: 
2022-08-18 23:04:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622305404489728 [0;39m <==    Updates: 0
2022-08-18 23:04:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622305404489728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:04:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622326346649600 [0;39m 生成今日电子书快照开始
2022-08-18 23:04:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622326346649600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:04:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622326346649600 [0;39m ==> Parameters: 
2022-08-18 23:04:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622326346649600 [0;39m <==    Updates: 0
2022-08-18 23:04:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622326346649600 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:04:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622347339141120 [0;39m 生成今日电子书快照开始
2022-08-18 23:04:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622347339141120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:04:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622347339141120 [0;39m ==> Parameters: 
2022-08-18 23:04:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622347339141120 [0;39m <==    Updates: 0
2022-08-18 23:04:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622347339141120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:05:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622368293883904 [0;39m 生成今日电子书快照开始
2022-08-18 23:05:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622368293883904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:05:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622368293883904 [0;39m ==> Parameters: 
2022-08-18 23:05:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622368293883904 [0;39m <==    Updates: 0
2022-08-18 23:05:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622368293883904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:05:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17622389286375424 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:05:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622389286375424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:05:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622389286375424 [0;39m ==> Parameters: 
2022-08-18 23:05:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622389286375424 [0;39m <==    Updates: 7
2022-08-18 23:05:05.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17622389286375424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:05:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622389290569728 [0;39m 生成今日电子书快照开始
2022-08-18 23:05:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622389290569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:05:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622389290569728 [0;39m ==> Parameters: 
2022-08-18 23:05:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622389290569728 [0;39m <==    Updates: 0
2022-08-18 23:05:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622389290569728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:05:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622410228535296 [0;39m 生成今日电子书快照开始
2022-08-18 23:05:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622410228535296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:05:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622410228535296 [0;39m ==> Parameters: 
2022-08-18 23:05:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622410228535296 [0;39m <==    Updates: 0
2022-08-18 23:05:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622410228535296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:05:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622431187472384 [0;39m 生成今日电子书快照开始
2022-08-18 23:05:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622431187472384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:05:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622431187472384 [0;39m ==> Parameters: 
2022-08-18 23:05:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622431187472384 [0;39m <==    Updates: 0
2022-08-18 23:05:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622431187472384 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:05:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622452213518336 [0;39m 生成今日电子书快照开始
2022-08-18 23:05:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622452213518336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:05:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622452213518336 [0;39m ==> Parameters: 
2022-08-18 23:05:20.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622452213518336 [0;39m <==    Updates: 0
2022-08-18 23:05:20.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622452213518336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:05:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622473126318080 [0;39m 生成今日电子书快照开始
2022-08-18 23:05:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622473126318080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:05:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622473126318080 [0;39m ==> Parameters: 
2022-08-18 23:05:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622473126318080 [0;39m <==    Updates: 0
2022-08-18 23:05:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622473126318080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:05:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622494118809600 [0;39m 生成今日电子书快照开始
2022-08-18 23:05:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622494118809600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:05:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622494118809600 [0;39m ==> Parameters: 
2022-08-18 23:05:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622494118809600 [0;39m <==    Updates: 0
2022-08-18 23:05:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622494118809600 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:05:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17622515086135296 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:05:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622515086135296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:05:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622515086135296 [0;39m ==> Parameters: 
2022-08-18 23:05:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622515086135296 [0;39m <==    Updates: 7
2022-08-18 23:05:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17622515086135296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:05:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622515094523904 [0;39m 生成今日电子书快照开始
2022-08-18 23:05:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622515094523904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:05:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622515094523904 [0;39m ==> Parameters: 
2022-08-18 23:05:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622515094523904 [0;39m <==    Updates: 0
2022-08-18 23:05:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622515094523904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:05:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622536057655296 [0;39m 生成今日电子书快照开始
2022-08-18 23:05:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622536057655296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:05:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622536057655296 [0;39m ==> Parameters: 
2022-08-18 23:05:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622536057655296 [0;39m <==    Updates: 0
2022-08-18 23:05:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622536057655296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:05:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622557029175296 [0;39m 生成今日电子书快照开始
2022-08-18 23:05:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622557029175296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:05:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622557029175296 [0;39m ==> Parameters: 
2022-08-18 23:05:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622557029175296 [0;39m <==    Updates: 0
2022-08-18 23:05:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622557029175296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:05:50.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622577971335168 [0;39m 生成今日电子书快照开始
2022-08-18 23:05:50.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622577971335168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:05:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622577971335168 [0;39m ==> Parameters: 
2022-08-18 23:05:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622577971335168 [0;39m <==    Updates: 0
2022-08-18 23:05:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622577971335168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:05:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622598976409600 [0;39m 生成今日电子书快照开始
2022-08-18 23:05:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622598976409600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:05:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622598976409600 [0;39m ==> Parameters: 
2022-08-18 23:05:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622598976409600 [0;39m <==    Updates: 0
2022-08-18 23:05:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622598976409600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:06:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622619918569472 [0;39m 生成今日电子书快照开始
2022-08-18 23:06:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622619918569472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:06:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622619918569472 [0;39m ==> Parameters: 
2022-08-18 23:06:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622619918569472 [0;39m <==    Updates: 0
2022-08-18 23:06:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622619918569472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:06:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17622640944615424 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:06:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622640944615424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:06:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622640944615424 [0;39m ==> Parameters: 
2022-08-18 23:06:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622640944615424 [0;39m <==    Updates: 7
2022-08-18 23:06:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17622640944615424 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:06:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622640953004032 [0;39m 生成今日电子书快照开始
2022-08-18 23:06:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622640953004032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:06:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622640953004032 [0;39m ==> Parameters: 
2022-08-18 23:06:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622640953004032 [0;39m <==    Updates: 0
2022-08-18 23:06:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622640953004032 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:06:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622661882580992 [0;39m 生成今日电子书快照开始
2022-08-18 23:06:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622661882580992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:06:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622661882580992 [0;39m ==> Parameters: 
2022-08-18 23:06:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622661882580992 [0;39m <==    Updates: 0
2022-08-18 23:06:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622661882580992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:06:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622682854100992 [0;39m 生成今日电子书快照开始
2022-08-18 23:06:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622682854100992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:06:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622682854100992 [0;39m ==> Parameters: 
2022-08-18 23:06:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622682854100992 [0;39m <==    Updates: 0
2022-08-18 23:06:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622682854100992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:06:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622703808843776 [0;39m 生成今日电子书快照开始
2022-08-18 23:06:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622703808843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:06:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622703808843776 [0;39m ==> Parameters: 
2022-08-18 23:06:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622703808843776 [0;39m <==    Updates: 0
2022-08-18 23:06:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622703808843776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:06:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622724822306816 [0;39m 生成今日电子书快照开始
2022-08-18 23:06:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622724822306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:06:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622724822306816 [0;39m ==> Parameters: 
2022-08-18 23:06:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622724822306816 [0;39m <==    Updates: 0
2022-08-18 23:06:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622724822306816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:06:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622745789632512 [0;39m 生成今日电子书快照开始
2022-08-18 23:06:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622745789632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:06:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622745789632512 [0;39m ==> Parameters: 
2022-08-18 23:06:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622745789632512 [0;39m <==    Updates: 0
2022-08-18 23:06:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622745789632512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:06:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17622766748569600 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:06:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622766748569600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:06:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622766748569600 [0;39m ==> Parameters: 
2022-08-18 23:06:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622766748569600 [0;39m <==    Updates: 7
2022-08-18 23:06:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17622766748569600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:06:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622766756958208 [0;39m 生成今日电子书快照开始
2022-08-18 23:06:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622766756958208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:06:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622766756958208 [0;39m ==> Parameters: 
2022-08-18 23:06:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622766756958208 [0;39m <==    Updates: 0
2022-08-18 23:06:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622766756958208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:06:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622787707506688 [0;39m 生成今日电子书快照开始
2022-08-18 23:06:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622787707506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:06:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622787707506688 [0;39m ==> Parameters: 
2022-08-18 23:06:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622787707506688 [0;39m <==    Updates: 0
2022-08-18 23:06:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622787707506688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:06:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622808674832384 [0;39m 生成今日电子书快照开始
2022-08-18 23:06:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622808674832384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:06:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622808674832384 [0;39m ==> Parameters: 
2022-08-18 23:06:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622808674832384 [0;39m <==    Updates: 0
2022-08-18 23:06:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622808674832384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:06:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622829692489728 [0;39m 生成今日电子书快照开始
2022-08-18 23:06:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622829692489728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:06:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622829692489728 [0;39m ==> Parameters: 
2022-08-18 23:06:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622829692489728 [0;39m <==    Updates: 0
2022-08-18 23:06:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622829692489728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:06:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622850659815424 [0;39m 生成今日电子书快照开始
2022-08-18 23:06:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622850659815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:06:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622850659815424 [0;39m ==> Parameters: 
2022-08-18 23:06:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622850659815424 [0;39m <==    Updates: 0
2022-08-18 23:06:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622850659815424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:07:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622871597780992 [0;39m 生成今日电子书快照开始
2022-08-18 23:07:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622871597780992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:07:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622871597780992 [0;39m ==> Parameters: 
2022-08-18 23:07:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622871597780992 [0;39m <==    Updates: 0
2022-08-18 23:07:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622871597780992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:07:02.247 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m17615770636914688 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-18 23:07:02.248 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m17615770636914688 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-18 23:07:02.248 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m17615770636914688 [0;39m 登录校验开始，token：17610697500397568
2022-08-18 23:07:02.283 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m17615770636914688 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"17610697500397568"}
2022-08-18 23:07:02.284 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17622881152405504 [0;39m ------------- 开始 -------------
2022-08-18 23:07:02.284 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17622881152405504 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-18 23:07:02.284 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17622881152405504 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-18 23:07:02.284 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17622881152405504 [0;39m 远程地址: 127.0.0.1
2022-08-18 23:07:02.284 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17622881152405504 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size=\"3\">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录。</font><b><br></b></div><div>&nbsp; &nbsp;<font size=\"3\"> X：用户管理、登录、登录校验、退出登录（X有可能只是接口也可以是页面）。<br></font></div><div><h2><b>token与JWT：</b></h2></div><h3><font size=\"3\">&nbsp; &nbsp;<b id=\"8bsf3\"> </b>token+redis：</font><b style=\"font-size: 1.17em;\">token是无意义的</b></h3><h3 id=\"cmxl6\">&nbsp; &nbsp; <b>JWT:token是有意义的，加密的，包含业务信息，一般是用户信息，无需存放在redis中可查看<font color=\"#000000\">&nbsp;</font></b><font face=\"仿宋\" style=\"\"><i style=\"background-color: rgb(249, 150, 59);\"><font color=\"#000000\">jwt.io</font></i><font color=\"#1c487f\">&nbsp;</font></font></h3><div><pre> <font size=\"3\">  &lt;dependency&gt;<br>      &lt;groupId&gt;com.auth0&lt;/groupId&gt;<br>      &lt;artifactId&gt;java-jwt&lt;/artifactId&gt;<br>      &lt;version&gt;3.5.0&lt;/version&gt;<br>  &lt;/dependency&gt;  </font></pre><pre><font size=\"3\">  <i>JwtUtil.sign 加密\n  JwtUtil.verity 校验</i></font></pre></div></blockquote>","ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1}]
2022-08-18 23:07:02.285 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17622881152405504 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-18 23:07:02.286 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17622881152405504 [0;39m ==> Parameters: 202714600712572928(Long), 0(Long), 用户管理功能开发(String), 9(Integer), 9(Integer), 1(Integer), 202715583089872896(Long)
2022-08-18 23:07:02.287 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17622881152405504 [0;39m <==    Updates: 1
2022-08-18 23:07:02.287 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17622881152405504 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-18 23:07:02.287 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17622881152405504 [0;39m ==> Parameters: <blockquote><h2 id="fii37">密码加密存储和传输（MDS）<br><font face="宋体"><font size="3">&nbsp;</font><b style=""><font size="4">传输加密： </font></b><font size="3">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size="3" face="Times New Roman"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）
</b></font>&nbsp;&nbsp;<font face="宋体" style=""><b style="font-size: large;">存储加密：</b><font size="3">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size="3"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id="90d5d">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id="9l5yg">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face="Times New Roman" size="3"><font color="#c24f4a">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id="rckur">单点登录token与JWT介绍</h2><h3 id="o9527"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size="3">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size="3">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录。</font><b><br></b></div><div>&nbsp; &nbsp;<font size="3"> X：用户管理、登录、登录校验、退出登录（X有可能只是接口也可以是页面）。<br></font></div><div><h2><b>token与JWT：</b></h2></div><h3><font size="3">&nbsp; &nbsp;<b id="8bsf3"> </b>token+redis：</font><b style="font-size: 1.17em;">token是无意义的</b></h3><h3 id="cmxl6">&nbsp; &nbsp; <b>JWT:token是有意义的，加密的，包含业务信息，一般是用户信息，无需存放在redis中可查看<font color="#000000">&nbsp;</font></b><font face="仿宋" style=""><i style="background-color: rgb(249, 150, 59);"><font color="#000000">jwt.io</font></i><font color="#1c487f">&nbsp;</font></font></h3><div><pre> <font size="3">  &lt;dependency&gt;<br>      &lt;groupId&gt;com.auth0&lt;/groupId&gt;<br>      &lt;artifactId&gt;java-jwt&lt;/artifactId&gt;<br>      &lt;version&gt;3.5.0&lt;/version&gt;<br>  &lt;/dependency&gt;  </font></pre><pre><font size="3">  <i>JwtUtil.sign 加密
  JwtUtil.verity 校验</i></font></pre></div></blockquote>(String), 202715583089872896(Long)
2022-08-18 23:07:02.289 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17622881152405504 [0;39m <==    Updates: 1
2022-08-18 23:07:02.291 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17622881152405504 [0;39m 返回结果: {"success":true}
2022-08-18 23:07:02.292 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17622881152405504 [0;39m ------------- 结束 耗时：8 ms -------------
2022-08-18 23:07:02.293 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m17622881152405504 [0;39m ------------- LoginInterceptor 结束 耗时：45 ms -------------
2022-08-18 23:07:02.302 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17622881227902976 [0;39m ------------- 开始 -------------
2022-08-18 23:07:02.302 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17622881227902976 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-18 23:07:02.302 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17622881227902976 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-18 23:07:02.303 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17622881227902976 [0;39m 远程地址: 127.0.0.1
2022-08-18 23:07:02.303 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17622881227902976 [0;39m 请求参数: [202714600712572928]
2022-08-18 23:07:02.303 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17622881227902976 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-18 23:07:02.304 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17622881227902976 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-18 23:07:02.304 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17622881227902976 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-18 23:07:02.305 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17622881227902976 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 48, 5
2022-08-18 23:07:02.305 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17622881227902976 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 41, 4
2022-08-18 23:07:02.305 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17622881227902976 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-18 23:07:02.306 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17622881227902976 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 22, 3
2022-08-18 23:07:02.307 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17622881227902976 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 26, 5
2022-08-18 23:07:02.307 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17622881227902976 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 25, 2
2022-08-18 23:07:02.308 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17622881227902976 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 10, 2
2022-08-18 23:07:02.309 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17622881227902976 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 11, 3
2022-08-18 23:07:02.310 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17622881227902976 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 9, 1
2022-08-18 23:07:02.310 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17622881227902976 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 7, 1
2022-08-18 23:07:02.310 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17622881227902976 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 4, 1
2022-08-18 23:07:02.311 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17622881227902976 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 3, 2
2022-08-18 23:07:02.311 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17622881227902976 [0;39m <==      Total: 12
2022-08-18 23:07:02.312 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17622881227902976 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":48,"voteCount":5},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":41,"voteCount":4},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":22,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":26,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":25,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":10,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":11,"voteCount":3},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":7,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":4,"voteCount":1},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":3,"voteCount":2}],"success":true}
2022-08-18 23:07:02.312 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17622881227902976 [0;39m ------------- 结束 耗时：10 ms -------------
2022-08-18 23:07:03.312 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17622885464150016 [0;39m ------------- 开始 -------------
2022-08-18 23:07:03.313 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17622885464150016 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202715069841281024 GET
2022-08-18 23:07:03.313 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17622885464150016 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-18 23:07:03.313 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17622885464150016 [0;39m 远程地址: 127.0.0.1
2022-08-18 23:07:03.314 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17622885464150016 [0;39m 请求参数: [202715069841281024]
2022-08-18 23:07:03.314 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17622885464150016 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-18 23:07:03.315 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17622885464150016 [0;39m ==> Parameters: 202715069841281024(Long)
2022-08-18 23:07:03.316 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17622885464150016 [0;39m <==    Columns: id, content
2022-08-18 23:07:03.316 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17622885464150016 [0;39m <==        Row: 202715069841281024, <<BLOB>>
2022-08-18 23:07:03.317 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17622885464150016 [0;39m <==      Total: 1
2022-08-18 23:07:03.318 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17622885464150016 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-18 23:07:03.318 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17622885464150016 [0;39m ==> Parameters: 202715069841281024(Long)
2022-08-18 23:07:03.397 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17622885464150016 [0;39m <==    Updates: 1
2022-08-18 23:07:03.397 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17622885464150016 [0;39m 返回结果: {"content":"<blockquote><h2 id=\"343h7\">1. 在远程仓库上创建一个新项目，将本地项目关联到远程仓库</h2></blockquote><p style=\"text-align:center;\"><span style=\"background-color: rgb(77, 128, 191);\"><font face=\"华文楷体\" size=\"3\">自定义启动端开始的文案网址：patorjk.com</font></span><br></p><blockquote><h2 id=\"lbj1m\"></h2><h2 id=\"y1h2i\"></h2><h3 id=\"g91hj\"></h3><h1 id=\"vfo4x\"></h1><h4 id=\"t6wlk\"><h2 id=\"y3p29\"><xmp>2.  Restful风格：GET（查找） ,POST(新增),PUT（修改）,DELETE（删除）</font></xmp><xmp> 正常情况：user？id=1</xmp><xmp> Restful：/user/1</xmp></h2></h4></blockquote><p><br></p><blockquote><p><font size=\"4\" face=\"Times New Roman\">3. @RestController和@Controller区别：<br></font>&nbsp; &nbsp;&nbsp;<font size=\"4\" face=\"Times New Roman\">@GetMapping(\"/hello\")<br>    public String hello(){<br>        return \"hello\";<br>    }</font></p></blockquote><div><div><p><font size=\"3\" face=\"黑体\">&nbsp;</font><font size=\"3\" face=\"楷体\"> &nbsp;<span style=\"background-color: rgb(255, 255, 255); color: rgba(0, 0, 0, 0.85); font-variant-ligatures: normal; font-variant-caps: normal; float: none; display: inline !important;\">&nbsp;&nbsp;&nbsp;</span><span style=\"background-color: rgb(255, 255, 255); color: rgba(0, 0, 0, 0.85); font-variant-ligatures: normal; font-variant-caps: normal; float: none; display: inline !important;\">@RestController一般用来返回字符串即返回“hello”，@Controller用来返回一个页面hello.html</span></font></p><p><font face=\"楷体\"><font size=\"3\">&nbsp; &nbsp;</font>&nbsp; &nbsp;&nbsp;<span style=\"font-size: medium;\">@RestController=@Controller+@ResponseBody(返回字符串或JSON对象)</span></font></p><p><br></p><blockquote><p><font face=\"黑体\" size=\"4\">4. resources文件夹下的application.properties/yml能够被识别，将其放入子文件夹中也一样可以，同样也可以识别bootstrap.properties/yml</font></p><p><b>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style=\"background-color: rgb(139, 170, 74);\">&nbsp;properties-&gt;yml格式网站：<span style=\"font-size: 1em;\">toyaml.com/index.html&nbsp; &nbsp;</span></span></b><font face=\"黑体\" size=\"4\"><br></font></p><p><i><font size=\"3\"><u><font color=\"#c24f4a\">bootstrap:</font></u>一般用于动态配置，线上实时修改，实时生效的配置，一般可配合nacos使用</font></i><font face=\"黑体\" size=\"4\"><br></font></p><span style=\"background-color: rgb(139, 170, 74);\"></span></blockquote><blockquote><p><font face=\"仿宋\" size=\"4\">5.配置集成热部署：代码及时生效</font></p></blockquote><ul><li style=\"\"><font size=\"3\" face=\"仿宋\">&nbsp;</font><font size=\"3\" face=\"黑体\">添加依赖：</font></li></ul><blockquote><div><pre><font size=\"3\" face=\"Times New Roman\">&lt;!--热部署--&gt;<br>&lt;dependency&gt;<br>    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br>    &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;<br>&lt;/dependency&gt;</font></pre></div></blockquote><p><br></p><ul><li><hr></li><li><font size=\"4\">勾选Build project automatically</font></li></ul><p><img src=\"https://i.postimg.cc/G3qNkhrF/83cd2913ee9d7d81366087dab707da3.jpg\" style=\"max-width:100%;\" width=\"100%\"><br></p><hr><ul><li><font size=\"4\" face=\"仿宋\">按两次shift键</font></li><li><img src=\"https://i.postimg.cc/DzxY3n6Q/0bd555589af48fa57b01b9230dbb31f.jpg\" style=\"max-width:100%;\"><br></li></ul><p><br></p><ul><li><img src=\"https://i.postimg.cc/W4xgky1L/78bd304480a2a1eb6a1f90cd955e9ce.jpg\" style=\"max-width:100%;\"><br></li></ul><hr><ul><li style=\"text-align:center;\"><span style=\"background-color: rgb(194, 79, 74);\"><font size=\"5\">2021版本的IDEA将上面这个勾选项移动到了别的地方，下面是2021版本的修改</font></span></li></ul><div style=\"text-align: center;\"><font size=\"3\"><br></font></div><ul><li><br></li><li><img src=\"https://i.postimg.cc/sxjXQP7C/71d856aaae65177b7e791458f6c8d27.jpg\"></li></ul></div><p><br></p></div>","success":true}
2022-08-18 23:07:03.398 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17622885464150016 [0;39m ------------- 结束 耗时：86 ms -------------
2022-08-18 23:07:05.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622892548329472 [0;39m 生成今日电子书快照开始
2022-08-18 23:07:05.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622892548329472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:07:05.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622892548329472 [0;39m ==> Parameters: 
2022-08-18 23:07:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622892548329472 [0;39m <==    Updates: 0
2022-08-18 23:07:05.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622892548329472 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:07:05.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17622892552523776 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:07:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622892552523776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:07:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622892552523776 [0;39m ==> Parameters: 
2022-08-18 23:07:05.024 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17622892552523776 [0;39m <==    Updates: 7
2022-08-18 23:07:05.024 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17622892552523776 [0;39m 更新电子书下的文档数据结束，耗时：22 毫秒
2022-08-18 23:07:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622913536626688 [0;39m 生成今日电子书快照开始
2022-08-18 23:07:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622913536626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:07:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622913536626688 [0;39m ==> Parameters: 
2022-08-18 23:07:10.057 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622913536626688 [0;39m <==    Updates: 0
2022-08-18 23:07:10.057 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622913536626688 [0;39m 生成今日电子书快照结束，耗时：52 毫秒
2022-08-18 23:07:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622934545895424 [0;39m 生成今日电子书快照开始
2022-08-18 23:07:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622934545895424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:07:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622934545895424 [0;39m ==> Parameters: 
2022-08-18 23:07:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622934545895424 [0;39m <==    Updates: 0
2022-08-18 23:07:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622934545895424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:07:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622955525804032 [0;39m 生成今日电子书快照开始
2022-08-18 23:07:20.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622955525804032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:07:20.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622955525804032 [0;39m ==> Parameters: 
2022-08-18 23:07:20.025 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622955525804032 [0;39m <==    Updates: 0
2022-08-18 23:07:20.026 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622955525804032 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-18 23:07:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622976488935424 [0;39m 生成今日电子书快照开始
2022-08-18 23:07:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622976488935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:07:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622976488935424 [0;39m ==> Parameters: 
2022-08-18 23:07:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622976488935424 [0;39m <==    Updates: 0
2022-08-18 23:07:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622976488935424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:07:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17622997431095296 [0;39m 生成今日电子书快照开始
2022-08-18 23:07:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622997431095296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:07:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622997431095296 [0;39m ==> Parameters: 
2022-08-18 23:07:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17622997431095296 [0;39m <==    Updates: 0
2022-08-18 23:07:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17622997431095296 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:07:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17623018402615296 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:07:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623018402615296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:07:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623018402615296 [0;39m ==> Parameters: 
2022-08-18 23:07:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623018402615296 [0;39m <==    Updates: 7
2022-08-18 23:07:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17623018402615296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:07:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623018411003904 [0;39m 生成今日电子书快照开始
2022-08-18 23:07:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623018411003904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:07:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623018411003904 [0;39m ==> Parameters: 
2022-08-18 23:07:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623018411003904 [0;39m <==    Updates: 0
2022-08-18 23:07:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623018411003904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:07:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623039361552384 [0;39m 生成今日电子书快照开始
2022-08-18 23:07:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623039361552384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:07:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623039361552384 [0;39m ==> Parameters: 
2022-08-18 23:07:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623039361552384 [0;39m <==    Updates: 0
2022-08-18 23:07:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623039361552384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:07:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623060354043904 [0;39m 生成今日电子书快照开始
2022-08-18 23:07:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623060354043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:07:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623060354043904 [0;39m ==> Parameters: 
2022-08-18 23:07:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623060354043904 [0;39m <==    Updates: 0
2022-08-18 23:07:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623060354043904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:07:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623081304592384 [0;39m 生成今日电子书快照开始
2022-08-18 23:07:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623081304592384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:07:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623081304592384 [0;39m ==> Parameters: 
2022-08-18 23:07:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623081304592384 [0;39m <==    Updates: 0
2022-08-18 23:07:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623081304592384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:07:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623102280306688 [0;39m 生成今日电子书快照开始
2022-08-18 23:07:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623102280306688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:07:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623102280306688 [0;39m ==> Parameters: 
2022-08-18 23:07:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623102280306688 [0;39m <==    Updates: 0
2022-08-18 23:07:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623102280306688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:08:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623123289575424 [0;39m 生成今日电子书快照开始
2022-08-18 23:08:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623123289575424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:08:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623123289575424 [0;39m ==> Parameters: 
2022-08-18 23:08:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623123289575424 [0;39m <==    Updates: 0
2022-08-18 23:08:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623123289575424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:08:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623144256901120 [0;39m 生成今日电子书快照开始
2022-08-18 23:08:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623144256901120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:08:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623144256901120 [0;39m ==> Parameters: 
2022-08-18 23:08:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623144256901120 [0;39m <==    Updates: 0
2022-08-18 23:08:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623144256901120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:08:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17623144269484032 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:08:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623144269484032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:08:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623144269484032 [0;39m ==> Parameters: 
2022-08-18 23:08:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623144269484032 [0;39m <==    Updates: 7
2022-08-18 23:08:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17623144269484032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:08:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623165182283776 [0;39m 生成今日电子书快照开始
2022-08-18 23:08:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623165182283776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:08:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623165182283776 [0;39m ==> Parameters: 
2022-08-18 23:08:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623165182283776 [0;39m <==    Updates: 0
2022-08-18 23:08:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623165182283776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:08:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623186153803776 [0;39m 生成今日电子书快照开始
2022-08-18 23:08:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623186153803776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:08:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623186153803776 [0;39m ==> Parameters: 
2022-08-18 23:08:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623186153803776 [0;39m <==    Updates: 0
2022-08-18 23:08:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623186153803776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:08:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623207137906688 [0;39m 生成今日电子书快照开始
2022-08-18 23:08:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623207137906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:08:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623207137906688 [0;39m ==> Parameters: 
2022-08-18 23:08:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623207137906688 [0;39m <==    Updates: 0
2022-08-18 23:08:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623207137906688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:08:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623228096843776 [0;39m 生成今日电子书快照开始
2022-08-18 23:08:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623228096843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:08:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623228096843776 [0;39m ==> Parameters: 
2022-08-18 23:08:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623228096843776 [0;39m <==    Updates: 0
2022-08-18 23:08:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623228096843776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:08:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623249064169472 [0;39m 生成今日电子书快照开始
2022-08-18 23:08:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623249064169472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:08:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623249064169472 [0;39m ==> Parameters: 
2022-08-18 23:08:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623249064169472 [0;39m <==    Updates: 0
2022-08-18 23:08:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623249064169472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:08:35.000 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17623270031495168 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:08:35.000 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623270031495168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:08:35.000 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623270031495168 [0;39m ==> Parameters: 
2022-08-18 23:08:35.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623270031495168 [0;39m <==    Updates: 7
2022-08-18 23:08:35.002 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17623270031495168 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:08:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623270039883776 [0;39m 生成今日电子书快照开始
2022-08-18 23:08:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623270039883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:08:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623270039883776 [0;39m ==> Parameters: 
2022-08-18 23:08:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623270039883776 [0;39m <==    Updates: 0
2022-08-18 23:08:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623270039883776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:08:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623291061735424 [0;39m 生成今日电子书快照开始
2022-08-18 23:08:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623291061735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:08:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623291061735424 [0;39m ==> Parameters: 
2022-08-18 23:08:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623291061735424 [0;39m <==    Updates: 0
2022-08-18 23:08:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623291061735424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:08:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623312029061120 [0;39m 生成今日电子书快照开始
2022-08-18 23:08:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623312029061120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:08:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623312029061120 [0;39m ==> Parameters: 
2022-08-18 23:08:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623312029061120 [0;39m <==    Updates: 0
2022-08-18 23:08:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623312029061120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:08:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623332996386816 [0;39m 生成今日电子书快照开始
2022-08-18 23:08:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623332996386816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:08:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623332996386816 [0;39m ==> Parameters: 
2022-08-18 23:08:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623332996386816 [0;39m <==    Updates: 0
2022-08-18 23:08:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623332996386816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:08:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623353984684032 [0;39m 生成今日电子书快照开始
2022-08-18 23:08:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623353984684032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:08:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623353984684032 [0;39m ==> Parameters: 
2022-08-18 23:08:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623353984684032 [0;39m <==    Updates: 0
2022-08-18 23:08:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623353984684032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:09:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623374914260992 [0;39m 生成今日电子书快照开始
2022-08-18 23:09:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623374914260992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:09:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623374914260992 [0;39m ==> Parameters: 
2022-08-18 23:09:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623374914260992 [0;39m <==    Updates: 0
2022-08-18 23:09:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623374914260992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:09:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17623395898363904 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:09:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623395898363904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:09:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623395898363904 [0;39m ==> Parameters: 
2022-08-18 23:09:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623395898363904 [0;39m <==    Updates: 7
2022-08-18 23:09:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17623395898363904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:09:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623395906752512 [0;39m 生成今日电子书快照开始
2022-08-18 23:09:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623395906752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:09:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623395906752512 [0;39m ==> Parameters: 
2022-08-18 23:09:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623395906752512 [0;39m <==    Updates: 0
2022-08-18 23:09:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623395906752512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:09:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623416874078208 [0;39m 生成今日电子书快照开始
2022-08-18 23:09:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623416874078208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:09:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623416874078208 [0;39m ==> Parameters: 
2022-08-18 23:09:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623416874078208 [0;39m <==    Updates: 0
2022-08-18 23:09:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623416874078208 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:09:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623437845598208 [0;39m 生成今日电子书快照开始
2022-08-18 23:09:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623437845598208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:09:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623437845598208 [0;39m ==> Parameters: 
2022-08-18 23:09:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623437845598208 [0;39m <==    Updates: 0
2022-08-18 23:09:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623437845598208 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:09:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623458838089728 [0;39m 生成今日电子书快照开始
2022-08-18 23:09:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623458838089728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:09:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623458838089728 [0;39m ==> Parameters: 
2022-08-18 23:09:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623458838089728 [0;39m <==    Updates: 0
2022-08-18 23:09:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623458838089728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:09:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623479809609728 [0;39m 生成今日电子书快照开始
2022-08-18 23:09:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623479809609728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:09:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623479809609728 [0;39m ==> Parameters: 
2022-08-18 23:09:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623479809609728 [0;39m <==    Updates: 0
2022-08-18 23:09:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623479809609728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:09:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623500734992384 [0;39m 生成今日电子书快照开始
2022-08-18 23:09:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623500734992384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:09:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623500734992384 [0;39m ==> Parameters: 
2022-08-18 23:09:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623500734992384 [0;39m <==    Updates: 0
2022-08-18 23:09:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623500734992384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:09:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17623521702318080 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:09:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623521702318080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:09:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623521702318080 [0;39m ==> Parameters: 
2022-08-18 23:09:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623521702318080 [0;39m <==    Updates: 7
2022-08-18 23:09:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17623521702318080 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:09:35.100 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623522109165568 [0;39m 生成今日电子书快照开始
2022-08-18 23:09:35.101 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623522109165568 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:09:35.101 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623522109165568 [0;39m ==> Parameters: 
2022-08-18 23:09:35.102 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623522109165568 [0;39m <==    Updates: 0
2022-08-18 23:09:35.103 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623522109165568 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:09:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623542669643776 [0;39m 生成今日电子书快照开始
2022-08-18 23:09:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623542669643776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:09:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623542669643776 [0;39m ==> Parameters: 
2022-08-18 23:09:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623542669643776 [0;39m <==    Updates: 0
2022-08-18 23:09:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623542669643776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:09:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623563636969472 [0;39m 生成今日电子书快照开始
2022-08-18 23:09:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623563636969472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:09:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623563636969472 [0;39m ==> Parameters: 
2022-08-18 23:09:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623563636969472 [0;39m <==    Updates: 0
2022-08-18 23:09:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623563636969472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:09:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623584650432512 [0;39m 生成今日电子书快照开始
2022-08-18 23:09:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623584650432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:09:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623584650432512 [0;39m ==> Parameters: 
2022-08-18 23:09:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623584650432512 [0;39m <==    Updates: 0
2022-08-18 23:09:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623584650432512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:09:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623605626146816 [0;39m 生成今日电子书快照开始
2022-08-18 23:09:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623605626146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:09:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623605626146816 [0;39m ==> Parameters: 
2022-08-18 23:09:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623605626146816 [0;39m <==    Updates: 0
2022-08-18 23:09:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623605626146816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:10:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623626597666816 [0;39m 生成今日电子书快照开始
2022-08-18 23:10:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623626597666816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:10:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623626597666816 [0;39m ==> Parameters: 
2022-08-18 23:10:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623626597666816 [0;39m <==    Updates: 0
2022-08-18 23:10:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623626597666816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:10:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623647560798208 [0;39m 生成今日电子书快照开始
2022-08-18 23:10:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623647560798208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:10:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623647560798208 [0;39m ==> Parameters: 
2022-08-18 23:10:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623647560798208 [0;39m <==    Updates: 0
2022-08-18 23:10:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623647560798208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:10:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17623647573381120 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:10:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623647573381120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:10:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623647573381120 [0;39m ==> Parameters: 
2022-08-18 23:10:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623647573381120 [0;39m <==    Updates: 7
2022-08-18 23:10:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17623647573381120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:10:10.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623668490375168 [0;39m 生成今日电子书快照开始
2022-08-18 23:10:10.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623668490375168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:10:10.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623668490375168 [0;39m ==> Parameters: 
2022-08-18 23:10:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623668490375168 [0;39m <==    Updates: 0
2022-08-18 23:10:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623668490375168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:10:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623689478672384 [0;39m 生成今日电子书快照开始
2022-08-18 23:10:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623689478672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:10:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623689478672384 [0;39m ==> Parameters: 
2022-08-18 23:10:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623689478672384 [0;39m <==    Updates: 0
2022-08-18 23:10:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623689478672384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:10:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623710487941120 [0;39m 生成今日电子书快照开始
2022-08-18 23:10:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623710487941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:10:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623710487941120 [0;39m ==> Parameters: 
2022-08-18 23:10:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623710487941120 [0;39m <==    Updates: 0
2022-08-18 23:10:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623710487941120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:10:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623731467849728 [0;39m 生成今日电子书快照开始
2022-08-18 23:10:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623731467849728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:10:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623731467849728 [0;39m ==> Parameters: 
2022-08-18 23:10:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623731467849728 [0;39m <==    Updates: 0
2022-08-18 23:10:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623731467849728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:10:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623752384843776 [0;39m 生成今日电子书快照开始
2022-08-18 23:10:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623752384843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:10:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623752384843776 [0;39m ==> Parameters: 
2022-08-18 23:10:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623752384843776 [0;39m <==    Updates: 0
2022-08-18 23:10:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623752384843776 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:10:35.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17623773410889728 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:10:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623773410889728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:10:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623773410889728 [0;39m ==> Parameters: 
2022-08-18 23:10:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623773410889728 [0;39m <==    Updates: 7
2022-08-18 23:10:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17623773410889728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:10:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623773419278336 [0;39m 生成今日电子书快照开始
2022-08-18 23:10:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623773419278336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:10:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623773419278336 [0;39m ==> Parameters: 
2022-08-18 23:10:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623773419278336 [0;39m <==    Updates: 0
2022-08-18 23:10:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623773419278336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:10:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623794332078080 [0;39m 生成今日电子书快照开始
2022-08-18 23:10:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623794332078080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:10:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623794332078080 [0;39m ==> Parameters: 
2022-08-18 23:10:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623794332078080 [0;39m <==    Updates: 0
2022-08-18 23:10:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623794332078080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:10:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623815316180992 [0;39m 生成今日电子书快照开始
2022-08-18 23:10:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623815316180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:10:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623815316180992 [0;39m ==> Parameters: 
2022-08-18 23:10:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623815316180992 [0;39m <==    Updates: 0
2022-08-18 23:10:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623815316180992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:10:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623836296089600 [0;39m 生成今日电子书快照开始
2022-08-18 23:10:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623836296089600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:10:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623836296089600 [0;39m ==> Parameters: 
2022-08-18 23:10:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623836296089600 [0;39m <==    Updates: 0
2022-08-18 23:10:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623836296089600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:10:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623857284386816 [0;39m 生成今日电子书快照开始
2022-08-18 23:10:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623857284386816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:10:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623857284386816 [0;39m ==> Parameters: 
2022-08-18 23:10:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623857284386816 [0;39m <==    Updates: 0
2022-08-18 23:10:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623857284386816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:11:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623878243323904 [0;39m 生成今日电子书快照开始
2022-08-18 23:11:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623878243323904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:11:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623878243323904 [0;39m ==> Parameters: 
2022-08-18 23:11:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623878243323904 [0;39m <==    Updates: 0
2022-08-18 23:11:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623878243323904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:11:01.090 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17623882777366528 [0;39m ------------- 开始 -------------
2022-08-18 23:11:01.091 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17623882777366528 [0;39m 请求地址: http://127.0.0.1:8880/doc/find-content/202715583089872896 GET
2022-08-18 23:11:01.091 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17623882777366528 [0;39m 类名方法: com.zs.wikibb.controller.DocController.findContent
2022-08-18 23:11:01.091 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17623882777366528 [0;39m 远程地址: 127.0.0.1
2022-08-18 23:11:01.092 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17623882777366528 [0;39m 请求参数: [202715583089872896]
2022-08-18 23:11:01.092 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17623882777366528 [0;39m ==>  Preparing: select id , content from content where id = ?
2022-08-18 23:11:01.093 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17623882777366528 [0;39m ==> Parameters: 202715583089872896(Long)
2022-08-18 23:11:01.094 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17623882777366528 [0;39m <==    Columns: id, content
2022-08-18 23:11:01.094 TRACE c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:143 
                [32m17623882777366528 [0;39m <==        Row: 202715583089872896, <<BLOB>>
2022-08-18 23:11:01.095 DEBUG c.z.wikibb.mapper.ContentMapper.selectByPrimaryKey:137 
                [32m17623882777366528 [0;39m <==      Total: 1
2022-08-18 23:11:01.095 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17623882777366528 [0;39m ==>  Preparing: update doc set view_count=view_count+1 where id=?
2022-08-18 23:11:01.095 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17623882777366528 [0;39m ==> Parameters: 202715583089872896(Long)
2022-08-18 23:11:01.127 DEBUG c.zs.wikibb.mapper.DocMapperCust.increaseViewCount:137 
                [32m17623882777366528 [0;39m <==    Updates: 1
2022-08-18 23:11:01.127 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17623882777366528 [0;39m 返回结果: {"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size=\"3\">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录。</font><b><br></b></div><div>&nbsp; &nbsp;<font size=\"3\"> X：用户管理、登录、登录校验、退出登录（X有可能只是接口也可以是页面）。<br></font></div><div><h2><b>token与JWT：</b></h2></div><h3><font size=\"3\">&nbsp; &nbsp;<b id=\"8bsf3\"> </b>token+redis：</font><b style=\"font-size: 1.17em;\">token是无意义的</b></h3><h3 id=\"cmxl6\">&nbsp; &nbsp; <b>JWT:token是有意义的，加密的，包含业务信息，一般是用户信息，无需存放在redis中可查看<font color=\"#000000\">&nbsp;</font></b><font face=\"仿宋\" style=\"\"><i style=\"background-color: rgb(249, 150, 59);\"><font color=\"#000000\">jwt.io</font></i><font color=\"#1c487f\">&nbsp;</font></font></h3><div><pre> <font size=\"3\">  &lt;dependency&gt;<br>      &lt;groupId&gt;com.auth0&lt;/groupId&gt;<br>      &lt;artifactId&gt;java-jwt&lt;/artifactId&gt;<br>      &lt;version&gt;3.5.0&lt;/version&gt;<br>  &lt;/dependency&gt;  </font></pre><pre><font size=\"3\">  <i>JwtUtil.sign 加密\n  JwtUtil.verity 校验</i></font></pre></div></blockquote>","success":true}
2022-08-18 23:11:01.127 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17623882777366528 [0;39m ------------- 结束 耗时：37 ms -------------
2022-08-18 23:11:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17623899198066688 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:11:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623899198066688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:11:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623899198066688 [0;39m ==> Parameters: 
2022-08-18 23:11:05.026 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17623899198066688 [0;39m <==    Updates: 7
2022-08-18 23:11:05.026 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17623899198066688 [0;39m 更新电子书下的文档数据结束，耗时：21 毫秒
2022-08-18 23:11:05.027 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623899290341376 [0;39m 生成今日电子书快照开始
2022-08-18 23:11:05.027 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623899290341376 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:11:05.027 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623899290341376 [0;39m ==> Parameters: 
2022-08-18 23:11:05.056 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623899290341376 [0;39m <==    Updates: 0
2022-08-18 23:11:05.056 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623899290341376 [0;39m 生成今日电子书快照结束，耗时：29 毫秒
2022-08-18 23:11:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623920207335424 [0;39m 生成今日电子书快照开始
2022-08-18 23:11:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623920207335424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:11:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623920207335424 [0;39m ==> Parameters: 
2022-08-18 23:11:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623920207335424 [0;39m <==    Updates: 0
2022-08-18 23:11:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623920207335424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:11:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623941157883904 [0;39m 生成今日电子书快照开始
2022-08-18 23:11:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623941157883904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:11:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623941157883904 [0;39m ==> Parameters: 
2022-08-18 23:11:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623941157883904 [0;39m <==    Updates: 0
2022-08-18 23:11:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623941157883904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:11:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623962100043776 [0;39m 生成今日电子书快照开始
2022-08-18 23:11:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623962100043776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:11:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623962100043776 [0;39m ==> Parameters: 
2022-08-18 23:11:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623962100043776 [0;39m <==    Updates: 0
2022-08-18 23:11:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623962100043776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:11:25.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17623983063175168 [0;39m 生成今日电子书快照开始
2022-08-18 23:11:25.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623983063175168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:11:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623983063175168 [0;39m ==> Parameters: 
2022-08-18 23:11:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17623983063175168 [0;39m <==    Updates: 0
2022-08-18 23:11:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17623983063175168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:11:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624004080832512 [0;39m 生成今日电子书快照开始
2022-08-18 23:11:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624004080832512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:11:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624004080832512 [0;39m ==> Parameters: 
2022-08-18 23:11:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624004080832512 [0;39m <==    Updates: 0
2022-08-18 23:11:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624004080832512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:11:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17624025018798080 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:11:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624025018798080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:11:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624025018798080 [0;39m ==> Parameters: 
2022-08-18 23:11:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624025018798080 [0;39m <==    Updates: 7
2022-08-18 23:11:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17624025018798080 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-18 23:11:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624025035575296 [0;39m 生成今日电子书快照开始
2022-08-18 23:11:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624025035575296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:11:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624025035575296 [0;39m ==> Parameters: 
2022-08-18 23:11:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624025035575296 [0;39m <==    Updates: 0
2022-08-18 23:11:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624025035575296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:11:40.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624045986123776 [0;39m 生成今日电子书快照开始
2022-08-18 23:11:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624045986123776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:11:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624045986123776 [0;39m ==> Parameters: 
2022-08-18 23:11:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624045986123776 [0;39m <==    Updates: 0
2022-08-18 23:11:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624045986123776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:11:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624067016364032 [0;39m 生成今日电子书快照开始
2022-08-18 23:11:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624067016364032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:11:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624067016364032 [0;39m ==> Parameters: 
2022-08-18 23:11:45.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624067016364032 [0;39m <==    Updates: 0
2022-08-18 23:11:45.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624067016364032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:11:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624087962718208 [0;39m 生成今日电子书快照开始
2022-08-18 23:11:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624087962718208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:11:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624087962718208 [0;39m ==> Parameters: 
2022-08-18 23:11:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624087962718208 [0;39m <==    Updates: 0
2022-08-18 23:11:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624087962718208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:11:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624108917460992 [0;39m 生成今日电子书快照开始
2022-08-18 23:11:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624108917460992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:11:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624108917460992 [0;39m ==> Parameters: 
2022-08-18 23:11:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624108917460992 [0;39m <==    Updates: 0
2022-08-18 23:11:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624108917460992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:12:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624129893175296 [0;39m 生成今日电子书快照开始
2022-08-18 23:12:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624129893175296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:12:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624129893175296 [0;39m ==> Parameters: 
2022-08-18 23:12:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624129893175296 [0;39m <==    Updates: 0
2022-08-18 23:12:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624129893175296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:12:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624150877278208 [0;39m 生成今日电子书快照开始
2022-08-18 23:12:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624150877278208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:12:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624150877278208 [0;39m ==> Parameters: 
2022-08-18 23:12:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624150877278208 [0;39m <==    Updates: 0
2022-08-18 23:12:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624150877278208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:12:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17624150889861120 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:12:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624150889861120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:12:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624150889861120 [0;39m ==> Parameters: 
2022-08-18 23:12:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624150889861120 [0;39m <==    Updates: 7
2022-08-18 23:12:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17624150889861120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:12:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624171861381120 [0;39m 生成今日电子书快照开始
2022-08-18 23:12:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624171861381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:12:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624171861381120 [0;39m ==> Parameters: 
2022-08-18 23:12:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624171861381120 [0;39m <==    Updates: 0
2022-08-18 23:12:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624171861381120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:12:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624192803540992 [0;39m 生成今日电子书快照开始
2022-08-18 23:12:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624192803540992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:12:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624192803540992 [0;39m ==> Parameters: 
2022-08-18 23:12:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624192803540992 [0;39m <==    Updates: 0
2022-08-18 23:12:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624192803540992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:12:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624213775060992 [0;39m 生成今日电子书快照开始
2022-08-18 23:12:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624213775060992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:12:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624213775060992 [0;39m ==> Parameters: 
2022-08-18 23:12:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624213775060992 [0;39m <==    Updates: 0
2022-08-18 23:12:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624213775060992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:12:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624234767552512 [0;39m 生成今日电子书快照开始
2022-08-18 23:12:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624234767552512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:12:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624234767552512 [0;39m ==> Parameters: 
2022-08-18 23:12:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624234767552512 [0;39m <==    Updates: 0
2022-08-18 23:12:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624234767552512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:12:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624255718100992 [0;39m 生成今日电子书快照开始
2022-08-18 23:12:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624255718100992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:12:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624255718100992 [0;39m ==> Parameters: 
2022-08-18 23:12:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624255718100992 [0;39m <==    Updates: 0
2022-08-18 23:12:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624255718100992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:12:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624276677038080 [0;39m 生成今日电子书快照开始
2022-08-18 23:12:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624276677038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:12:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624276677038080 [0;39m ==> Parameters: 
2022-08-18 23:12:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624276677038080 [0;39m <==    Updates: 0
2022-08-18 23:12:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624276677038080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:12:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17624276689620992 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:12:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624276689620992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:12:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624276689620992 [0;39m ==> Parameters: 
2022-08-18 23:12:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624276689620992 [0;39m <==    Updates: 7
2022-08-18 23:12:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17624276689620992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:12:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624297652752384 [0;39m 生成今日电子书快照开始
2022-08-18 23:12:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624297652752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:12:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624297652752384 [0;39m ==> Parameters: 
2022-08-18 23:12:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624297652752384 [0;39m <==    Updates: 0
2022-08-18 23:12:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624297652752384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:12:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624318653632512 [0;39m 生成今日电子书快照开始
2022-08-18 23:12:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624318653632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:12:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624318653632512 [0;39m ==> Parameters: 
2022-08-18 23:12:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624318653632512 [0;39m <==    Updates: 0
2022-08-18 23:12:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624318653632512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:12:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624339641929728 [0;39m 生成今日电子书快照开始
2022-08-18 23:12:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624339641929728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:12:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624339641929728 [0;39m ==> Parameters: 
2022-08-18 23:12:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624339641929728 [0;39m <==    Updates: 0
2022-08-18 23:12:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624339641929728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:12:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624360563118080 [0;39m 生成今日电子书快照开始
2022-08-18 23:12:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624360563118080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:12:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624360563118080 [0;39m ==> Parameters: 
2022-08-18 23:12:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624360563118080 [0;39m <==    Updates: 0
2022-08-18 23:12:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624360563118080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:13:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624381555609600 [0;39m 生成今日电子书快照开始
2022-08-18 23:13:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624381555609600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:13:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624381555609600 [0;39m ==> Parameters: 
2022-08-18 23:13:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624381555609600 [0;39m <==    Updates: 0
2022-08-18 23:13:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624381555609600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:13:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624402552295424 [0;39m 生成今日电子书快照开始
2022-08-18 23:13:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624402552295424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:13:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624402552295424 [0;39m ==> Parameters: 
2022-08-18 23:13:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624402552295424 [0;39m <==    Updates: 0
2022-08-18 23:13:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624402552295424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:13:05.017 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17624402564878336 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:13:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624402564878336 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:13:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624402564878336 [0;39m ==> Parameters: 
2022-08-18 23:13:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624402564878336 [0;39m <==    Updates: 7
2022-08-18 23:13:05.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17624402564878336 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:13:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624423469289472 [0;39m 生成今日电子书快照开始
2022-08-18 23:13:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624423469289472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:13:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624423469289472 [0;39m ==> Parameters: 
2022-08-18 23:13:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624423469289472 [0;39m <==    Updates: 0
2022-08-18 23:13:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624423469289472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:13:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624444445003776 [0;39m 生成今日电子书快照开始
2022-08-18 23:13:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624444445003776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:13:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624444445003776 [0;39m ==> Parameters: 
2022-08-18 23:13:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624444445003776 [0;39m <==    Updates: 0
2022-08-18 23:13:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624444445003776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:13:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624465420718080 [0;39m 生成今日电子书快照开始
2022-08-18 23:13:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624465420718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:13:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624465420718080 [0;39m ==> Parameters: 
2022-08-18 23:13:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624465420718080 [0;39m <==    Updates: 0
2022-08-18 23:13:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624465420718080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:13:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624486442569728 [0;39m 生成今日电子书快照开始
2022-08-18 23:13:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624486442569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:13:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624486442569728 [0;39m ==> Parameters: 
2022-08-18 23:13:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624486442569728 [0;39m <==    Updates: 0
2022-08-18 23:13:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624486442569728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:13:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624507409895424 [0;39m 生成今日电子书快照开始
2022-08-18 23:13:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624507409895424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:13:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624507409895424 [0;39m ==> Parameters: 
2022-08-18 23:13:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624507409895424 [0;39m <==    Updates: 0
2022-08-18 23:13:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624507409895424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:13:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17624528343666688 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:13:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624528343666688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:13:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624528343666688 [0;39m ==> Parameters: 
2022-08-18 23:13:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624528343666688 [0;39m <==    Updates: 7
2022-08-18 23:13:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17624528343666688 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:13:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624528356249600 [0;39m 生成今日电子书快照开始
2022-08-18 23:13:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624528356249600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:13:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624528356249600 [0;39m ==> Parameters: 
2022-08-18 23:13:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624528356249600 [0;39m <==    Updates: 0
2022-08-18 23:13:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624528356249600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:13:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624549298409472 [0;39m 生成今日电子书快照开始
2022-08-18 23:13:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624549298409472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:13:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624549298409472 [0;39m ==> Parameters: 
2022-08-18 23:13:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624549298409472 [0;39m <==    Updates: 0
2022-08-18 23:13:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624549298409472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:13:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624570311872512 [0;39m 生成今日电子书快照开始
2022-08-18 23:13:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624570311872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:13:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624570311872512 [0;39m ==> Parameters: 
2022-08-18 23:13:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624570311872512 [0;39m <==    Updates: 0
2022-08-18 23:13:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624570311872512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:13:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624591258226688 [0;39m 生成今日电子书快照开始
2022-08-18 23:13:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624591258226688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:13:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624591258226688 [0;39m ==> Parameters: 
2022-08-18 23:13:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624591258226688 [0;39m <==    Updates: 0
2022-08-18 23:13:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624591258226688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:13:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624612221358080 [0;39m 生成今日电子书快照开始
2022-08-18 23:13:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624612221358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:13:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624612221358080 [0;39m ==> Parameters: 
2022-08-18 23:13:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624612221358080 [0;39m <==    Updates: 0
2022-08-18 23:13:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624612221358080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:14:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624633197072384 [0;39m 生成今日电子书快照开始
2022-08-18 23:14:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624633197072384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:14:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624633197072384 [0;39m ==> Parameters: 
2022-08-18 23:14:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624633197072384 [0;39m <==    Updates: 0
2022-08-18 23:14:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624633197072384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:14:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17624654168592384 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:14:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624654168592384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:14:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624654168592384 [0;39m ==> Parameters: 
2022-08-18 23:14:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624654168592384 [0;39m <==    Updates: 7
2022-08-18 23:14:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17624654168592384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:14:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624654176980992 [0;39m 生成今日电子书快照开始
2022-08-18 23:14:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624654176980992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:14:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624654176980992 [0;39m ==> Parameters: 
2022-08-18 23:14:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624654176980992 [0;39m <==    Updates: 0
2022-08-18 23:14:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624654176980992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:14:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624675161083904 [0;39m 生成今日电子书快照开始
2022-08-18 23:14:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624675161083904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:14:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624675161083904 [0;39m ==> Parameters: 
2022-08-18 23:14:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624675161083904 [0;39m <==    Updates: 0
2022-08-18 23:14:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624675161083904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:14:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624696149381120 [0;39m 生成今日电子书快照开始
2022-08-18 23:14:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624696149381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:14:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624696149381120 [0;39m ==> Parameters: 
2022-08-18 23:14:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624696149381120 [0;39m <==    Updates: 0
2022-08-18 23:14:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624696149381120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:14:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624717120901120 [0;39m 生成今日电子书快照开始
2022-08-18 23:14:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624717120901120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:14:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624717120901120 [0;39m ==> Parameters: 
2022-08-18 23:14:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624717120901120 [0;39m <==    Updates: 0
2022-08-18 23:14:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624717120901120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:14:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624738063060992 [0;39m 生成今日电子书快照开始
2022-08-18 23:14:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624738063060992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:14:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624738063060992 [0;39m ==> Parameters: 
2022-08-18 23:14:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624738063060992 [0;39m <==    Updates: 0
2022-08-18 23:14:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624738063060992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:14:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624759047163904 [0;39m 生成今日电子书快照开始
2022-08-18 23:14:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624759047163904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:14:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624759047163904 [0;39m ==> Parameters: 
2022-08-18 23:14:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624759047163904 [0;39m <==    Updates: 0
2022-08-18 23:14:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624759047163904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:14:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17624780010295296 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:14:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624780010295296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:14:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624780010295296 [0;39m ==> Parameters: 
2022-08-18 23:14:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624780010295296 [0;39m <==    Updates: 7
2022-08-18 23:14:35.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17624780010295296 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-18 23:14:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624780027072512 [0;39m 生成今日电子书快照开始
2022-08-18 23:14:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624780027072512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:14:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624780027072512 [0;39m ==> Parameters: 
2022-08-18 23:14:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624780027072512 [0;39m <==    Updates: 0
2022-08-18 23:14:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624780027072512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:14:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624800986009600 [0;39m 生成今日电子书快照开始
2022-08-18 23:14:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624800986009600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:14:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624800986009600 [0;39m ==> Parameters: 
2022-08-18 23:14:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624800986009600 [0;39m <==    Updates: 0
2022-08-18 23:14:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624800986009600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:14:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624821940752384 [0;39m 生成今日电子书快照开始
2022-08-18 23:14:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624821940752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:14:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624821940752384 [0;39m ==> Parameters: 
2022-08-18 23:14:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624821940752384 [0;39m <==    Updates: 0
2022-08-18 23:14:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624821940752384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:14:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624842958409728 [0;39m 生成今日电子书快照开始
2022-08-18 23:14:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624842958409728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:14:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624842958409728 [0;39m ==> Parameters: 
2022-08-18 23:14:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624842958409728 [0;39m <==    Updates: 0
2022-08-18 23:14:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624842958409728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:14:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624863879598080 [0;39m 生成今日电子书快照开始
2022-08-18 23:14:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624863879598080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:14:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624863879598080 [0;39m ==> Parameters: 
2022-08-18 23:14:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624863879598080 [0;39m <==    Updates: 0
2022-08-18 23:14:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624863879598080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:15:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624884888866816 [0;39m 生成今日电子书快照开始
2022-08-18 23:15:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624884888866816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:15:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624884888866816 [0;39m ==> Parameters: 
2022-08-18 23:15:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624884888866816 [0;39m <==    Updates: 0
2022-08-18 23:15:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624884888866816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:15:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17624905856192512 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:15:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624905856192512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:15:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624905856192512 [0;39m ==> Parameters: 
2022-08-18 23:15:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17624905856192512 [0;39m <==    Updates: 7
2022-08-18 23:15:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17624905856192512 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-18 23:15:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624905868775424 [0;39m 生成今日电子书快照开始
2022-08-18 23:15:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624905868775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:15:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624905868775424 [0;39m ==> Parameters: 
2022-08-18 23:15:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624905868775424 [0;39m <==    Updates: 0
2022-08-18 23:15:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624905868775424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:15:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624926819323904 [0;39m 生成今日电子书快照开始
2022-08-18 23:15:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624926819323904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:15:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624926819323904 [0;39m ==> Parameters: 
2022-08-18 23:15:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624926819323904 [0;39m <==    Updates: 0
2022-08-18 23:15:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624926819323904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:15:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624947782455296 [0;39m 生成今日电子书快照开始
2022-08-18 23:15:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624947782455296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:15:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624947782455296 [0;39m ==> Parameters: 
2022-08-18 23:15:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624947782455296 [0;39m <==    Updates: 0
2022-08-18 23:15:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624947782455296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:15:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624968741392384 [0;39m 生成今日电子书快照开始
2022-08-18 23:15:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624968741392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:15:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624968741392384 [0;39m ==> Parameters: 
2022-08-18 23:15:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624968741392384 [0;39m <==    Updates: 0
2022-08-18 23:15:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624968741392384 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:15:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17624989750661120 [0;39m 生成今日电子书快照开始
2022-08-18 23:15:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624989750661120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:15:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624989750661120 [0;39m ==> Parameters: 
2022-08-18 23:15:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17624989750661120 [0;39m <==    Updates: 0
2022-08-18 23:15:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17624989750661120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:15:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625010713792512 [0;39m 生成今日电子书快照开始
2022-08-18 23:15:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625010713792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:15:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625010713792512 [0;39m ==> Parameters: 
2022-08-18 23:15:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625010713792512 [0;39m <==    Updates: 0
2022-08-18 23:15:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625010713792512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:15:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625031685312512 [0;39m 生成今日电子书快照开始
2022-08-18 23:15:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625031685312512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:15:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625031685312512 [0;39m ==> Parameters: 
2022-08-18 23:15:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625031685312512 [0;39m <==    Updates: 0
2022-08-18 23:15:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625031685312512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:15:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17625031693701120 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:15:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625031693701120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:15:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625031693701120 [0;39m ==> Parameters: 
2022-08-18 23:15:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625031693701120 [0;39m <==    Updates: 7
2022-08-18 23:15:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17625031693701120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:15:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625052665221120 [0;39m 生成今日电子书快照开始
2022-08-18 23:15:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625052665221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:15:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625052665221120 [0;39m ==> Parameters: 
2022-08-18 23:15:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625052665221120 [0;39m <==    Updates: 0
2022-08-18 23:15:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625052665221120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:15:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625073603186688 [0;39m 生成今日电子书快照开始
2022-08-18 23:15:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625073603186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:15:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625073603186688 [0;39m ==> Parameters: 
2022-08-18 23:15:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625073603186688 [0;39m <==    Updates: 0
2022-08-18 23:15:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625073603186688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:15:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625094612455424 [0;39m 生成今日电子书快照开始
2022-08-18 23:15:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625094612455424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:15:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625094612455424 [0;39m ==> Parameters: 
2022-08-18 23:15:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625094612455424 [0;39m <==    Updates: 0
2022-08-18 23:15:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625094612455424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:15:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625115583975424 [0;39m 生成今日电子书快照开始
2022-08-18 23:15:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625115583975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:15:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625115583975424 [0;39m ==> Parameters: 
2022-08-18 23:15:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625115583975424 [0;39m <==    Updates: 0
2022-08-18 23:15:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625115583975424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:16:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625136559689728 [0;39m 生成今日电子书快照开始
2022-08-18 23:16:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625136559689728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:16:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625136559689728 [0;39m ==> Parameters: 
2022-08-18 23:16:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625136559689728 [0;39m <==    Updates: 0
2022-08-18 23:16:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625136559689728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:16:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625157501849600 [0;39m 生成今日电子书快照开始
2022-08-18 23:16:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625157501849600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:16:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625157501849600 [0;39m ==> Parameters: 
2022-08-18 23:16:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625157501849600 [0;39m <==    Updates: 0
2022-08-18 23:16:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625157501849600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:16:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17625157514432512 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:16:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625157514432512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:16:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625157514432512 [0;39m ==> Parameters: 
2022-08-18 23:16:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625157514432512 [0;39m <==    Updates: 7
2022-08-18 23:16:05.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17625157514432512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:16:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625178444009472 [0;39m 生成今日电子书快照开始
2022-08-18 23:16:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625178444009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:16:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625178444009472 [0;39m ==> Parameters: 
2022-08-18 23:16:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625178444009472 [0;39m <==    Updates: 0
2022-08-18 23:16:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625178444009472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:16:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625199419723776 [0;39m 生成今日电子书快照开始
2022-08-18 23:16:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625199419723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:16:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625199419723776 [0;39m ==> Parameters: 
2022-08-18 23:16:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625199419723776 [0;39m <==    Updates: 0
2022-08-18 23:16:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625199419723776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:16:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625220412215296 [0;39m 生成今日电子书快照开始
2022-08-18 23:16:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625220412215296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:16:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625220412215296 [0;39m ==> Parameters: 
2022-08-18 23:16:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625220412215296 [0;39m <==    Updates: 0
2022-08-18 23:16:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625220412215296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:16:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625241379540992 [0;39m 生成今日电子书快照开始
2022-08-18 23:16:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625241379540992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:16:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625241379540992 [0;39m ==> Parameters: 
2022-08-18 23:16:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625241379540992 [0;39m <==    Updates: 0
2022-08-18 23:16:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625241379540992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:16:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625262380421120 [0;39m 生成今日电子书快照开始
2022-08-18 23:16:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625262380421120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:16:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625262380421120 [0;39m ==> Parameters: 
2022-08-18 23:16:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625262380421120 [0;39m <==    Updates: 0
2022-08-18 23:16:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625262380421120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:16:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625283356135424 [0;39m 生成今日电子书快照开始
2022-08-18 23:16:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625283356135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:16:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625283356135424 [0;39m ==> Parameters: 
2022-08-18 23:16:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625283356135424 [0;39m <==    Updates: 0
2022-08-18 23:16:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625283356135424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:16:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17625283364524032 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:16:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625283364524032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:16:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625283364524032 [0;39m ==> Parameters: 
2022-08-18 23:16:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625283364524032 [0;39m <==    Updates: 7
2022-08-18 23:16:35.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17625283364524032 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:16:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625304336044032 [0;39m 生成今日电子书快照开始
2022-08-18 23:16:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625304336044032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:16:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625304336044032 [0;39m ==> Parameters: 
2022-08-18 23:16:40.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625304336044032 [0;39m <==    Updates: 0
2022-08-18 23:16:40.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625304336044032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:16:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625325248843776 [0;39m 生成今日电子书快照开始
2022-08-18 23:16:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625325248843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:16:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625325248843776 [0;39m ==> Parameters: 
2022-08-18 23:16:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625325248843776 [0;39m <==    Updates: 0
2022-08-18 23:16:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625325248843776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:16:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625346237140992 [0;39m 生成今日电子书快照开始
2022-08-18 23:16:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625346237140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:16:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625346237140992 [0;39m ==> Parameters: 
2022-08-18 23:16:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625346237140992 [0;39m <==    Updates: 0
2022-08-18 23:16:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625346237140992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:16:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625367217049600 [0;39m 生成今日电子书快照开始
2022-08-18 23:16:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625367217049600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:16:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625367217049600 [0;39m ==> Parameters: 
2022-08-18 23:16:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625367217049600 [0;39m <==    Updates: 0
2022-08-18 23:16:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625367217049600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:17:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625388171792384 [0;39m 生成今日电子书快照开始
2022-08-18 23:17:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625388171792384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:17:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625388171792384 [0;39m ==> Parameters: 
2022-08-18 23:17:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625388171792384 [0;39m <==    Updates: 0
2022-08-18 23:17:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625388171792384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:17:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17625409147506688 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:17:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625409147506688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:17:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625409147506688 [0;39m ==> Parameters: 
2022-08-18 23:17:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625409147506688 [0;39m <==    Updates: 7
2022-08-18 23:17:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17625409147506688 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:17:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625409155895296 [0;39m 生成今日电子书快照开始
2022-08-18 23:17:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625409155895296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:17:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625409155895296 [0;39m ==> Parameters: 
2022-08-18 23:17:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625409155895296 [0;39m <==    Updates: 0
2022-08-18 23:17:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625409155895296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:17:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625430156775424 [0;39m 生成今日电子书快照开始
2022-08-18 23:17:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625430156775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:17:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625430156775424 [0;39m ==> Parameters: 
2022-08-18 23:17:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625430156775424 [0;39m <==    Updates: 0
2022-08-18 23:17:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625430156775424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:17:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625451128295424 [0;39m 生成今日电子书快照开始
2022-08-18 23:17:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625451128295424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:17:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625451128295424 [0;39m ==> Parameters: 
2022-08-18 23:17:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625451128295424 [0;39m <==    Updates: 0
2022-08-18 23:17:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625451128295424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:17:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625472087232512 [0;39m 生成今日电子书快照开始
2022-08-18 23:17:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625472087232512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:17:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625472087232512 [0;39m ==> Parameters: 
2022-08-18 23:17:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625472087232512 [0;39m <==    Updates: 0
2022-08-18 23:17:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625472087232512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:17:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625493054558208 [0;39m 生成今日电子书快照开始
2022-08-18 23:17:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625493054558208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:17:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625493054558208 [0;39m ==> Parameters: 
2022-08-18 23:17:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625493054558208 [0;39m <==    Updates: 0
2022-08-18 23:17:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625493054558208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:17:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625514013495296 [0;39m 生成今日电子书快照开始
2022-08-18 23:17:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625514013495296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:17:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625514013495296 [0;39m ==> Parameters: 
2022-08-18 23:17:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625514013495296 [0;39m <==    Updates: 0
2022-08-18 23:17:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625514013495296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:17:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17625535010181120 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:17:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625535010181120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:17:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625535010181120 [0;39m ==> Parameters: 
2022-08-18 23:17:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625535010181120 [0;39m <==    Updates: 7
2022-08-18 23:17:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17625535010181120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:17:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625535018569728 [0;39m 生成今日电子书快照开始
2022-08-18 23:17:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625535018569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:17:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625535018569728 [0;39m ==> Parameters: 
2022-08-18 23:17:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625535018569728 [0;39m <==    Updates: 0
2022-08-18 23:17:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625535018569728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:17:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625555973312512 [0;39m 生成今日电子书快照开始
2022-08-18 23:17:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625555973312512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:17:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625555973312512 [0;39m ==> Parameters: 
2022-08-18 23:17:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625555973312512 [0;39m <==    Updates: 0
2022-08-18 23:17:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625555973312512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:17:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625576953221120 [0;39m 生成今日电子书快照开始
2022-08-18 23:17:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625576953221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:17:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625576953221120 [0;39m ==> Parameters: 
2022-08-18 23:17:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625576953221120 [0;39m <==    Updates: 0
2022-08-18 23:17:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625576953221120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:17:50.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625597870215168 [0;39m 生成今日电子书快照开始
2022-08-18 23:17:50.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625597870215168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:17:50.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625597870215168 [0;39m ==> Parameters: 
2022-08-18 23:17:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625597870215168 [0;39m <==    Updates: 0
2022-08-18 23:17:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625597870215168 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:17:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625618904649728 [0;39m 生成今日电子书快照开始
2022-08-18 23:17:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625618904649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:17:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625618904649728 [0;39m ==> Parameters: 
2022-08-18 23:17:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625618904649728 [0;39m <==    Updates: 0
2022-08-18 23:17:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625618904649728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:18:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625639830032384 [0;39m 生成今日电子书快照开始
2022-08-18 23:18:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625639830032384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:18:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625639830032384 [0;39m ==> Parameters: 
2022-08-18 23:18:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625639830032384 [0;39m <==    Updates: 0
2022-08-18 23:18:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625639830032384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:18:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625660847689728 [0;39m 生成今日电子书快照开始
2022-08-18 23:18:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625660847689728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:18:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625660847689728 [0;39m ==> Parameters: 
2022-08-18 23:18:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625660847689728 [0;39m <==    Updates: 0
2022-08-18 23:18:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625660847689728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:18:05.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17625660860272640 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:18:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625660860272640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:18:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625660860272640 [0;39m ==> Parameters: 
2022-08-18 23:18:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625660860272640 [0;39m <==    Updates: 7
2022-08-18 23:18:05.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17625660860272640 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:18:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625681777266688 [0;39m 生成今日电子书快照开始
2022-08-18 23:18:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625681777266688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:18:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625681777266688 [0;39m ==> Parameters: 
2022-08-18 23:18:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625681777266688 [0;39m <==    Updates: 0
2022-08-18 23:18:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625681777266688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:18:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625702782341120 [0;39m 生成今日电子书快照开始
2022-08-18 23:18:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625702782341120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:18:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625702782341120 [0;39m ==> Parameters: 
2022-08-18 23:18:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625702782341120 [0;39m <==    Updates: 0
2022-08-18 23:18:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625702782341120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:18:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625723711918080 [0;39m 生成今日电子书快照开始
2022-08-18 23:18:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625723711918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:18:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625723711918080 [0;39m ==> Parameters: 
2022-08-18 23:18:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625723711918080 [0;39m <==    Updates: 0
2022-08-18 23:18:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625723711918080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:18:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625744729575424 [0;39m 生成今日电子书快照开始
2022-08-18 23:18:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625744729575424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:18:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625744729575424 [0;39m ==> Parameters: 
2022-08-18 23:18:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625744729575424 [0;39m <==    Updates: 0
2022-08-18 23:18:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625744729575424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:18:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625765667540992 [0;39m 生成今日电子书快照开始
2022-08-18 23:18:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625765667540992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:18:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625765667540992 [0;39m ==> Parameters: 
2022-08-18 23:18:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625765667540992 [0;39m <==    Updates: 0
2022-08-18 23:18:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625765667540992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:18:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625786626478080 [0;39m 生成今日电子书快照开始
2022-08-18 23:18:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625786626478080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:18:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625786626478080 [0;39m ==> Parameters: 
2022-08-18 23:18:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625786626478080 [0;39m <==    Updates: 0
2022-08-18 23:18:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625786626478080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:18:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17625786639060992 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:18:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625786639060992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:18:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625786639060992 [0;39m ==> Parameters: 
2022-08-18 23:18:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625786639060992 [0;39m <==    Updates: 7
2022-08-18 23:18:35.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17625786639060992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:18:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625807623163904 [0;39m 生成今日电子书快照开始
2022-08-18 23:18:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625807623163904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:18:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625807623163904 [0;39m ==> Parameters: 
2022-08-18 23:18:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625807623163904 [0;39m <==    Updates: 0
2022-08-18 23:18:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625807623163904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:18:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625828582100992 [0;39m 生成今日电子书快照开始
2022-08-18 23:18:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625828582100992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:18:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625828582100992 [0;39m ==> Parameters: 
2022-08-18 23:18:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625828582100992 [0;39m <==    Updates: 0
2022-08-18 23:18:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625828582100992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:18:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625849574592512 [0;39m 生成今日电子书快照开始
2022-08-18 23:18:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625849574592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:18:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625849574592512 [0;39m ==> Parameters: 
2022-08-18 23:18:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625849574592512 [0;39m <==    Updates: 0
2022-08-18 23:18:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625849574592512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:18:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625870508363776 [0;39m 生成今日电子书快照开始
2022-08-18 23:18:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625870508363776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:18:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625870508363776 [0;39m ==> Parameters: 
2022-08-18 23:18:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625870508363776 [0;39m <==    Updates: 0
2022-08-18 23:18:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625870508363776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:19:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625891496660992 [0;39m 生成今日电子书快照开始
2022-08-18 23:19:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625891496660992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:19:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625891496660992 [0;39m ==> Parameters: 
2022-08-18 23:19:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625891496660992 [0;39m <==    Updates: 0
2022-08-18 23:19:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625891496660992 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:19:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625912484958208 [0;39m 生成今日电子书快照开始
2022-08-18 23:19:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625912484958208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:19:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625912484958208 [0;39m ==> Parameters: 
2022-08-18 23:19:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625912484958208 [0;39m <==    Updates: 0
2022-08-18 23:19:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625912484958208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:19:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17625912493346816 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:19:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625912493346816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:19:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625912493346816 [0;39m ==> Parameters: 
2022-08-18 23:19:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17625912493346816 [0;39m <==    Updates: 7
2022-08-18 23:19:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17625912493346816 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:19:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625933469061120 [0;39m 生成今日电子书快照开始
2022-08-18 23:19:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625933469061120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:19:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625933469061120 [0;39m ==> Parameters: 
2022-08-18 23:19:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625933469061120 [0;39m <==    Updates: 0
2022-08-18 23:19:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625933469061120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:19:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625954427998208 [0;39m 生成今日电子书快照开始
2022-08-18 23:19:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625954427998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:19:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625954427998208 [0;39m ==> Parameters: 
2022-08-18 23:19:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625954427998208 [0;39m <==    Updates: 0
2022-08-18 23:19:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625954427998208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:19:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625975420489728 [0;39m 生成今日电子书快照开始
2022-08-18 23:19:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625975420489728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:19:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625975420489728 [0;39m ==> Parameters: 
2022-08-18 23:19:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625975420489728 [0;39m <==    Updates: 0
2022-08-18 23:19:20.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625975420489728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:19:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17625996341678080 [0;39m 生成今日电子书快照开始
2022-08-18 23:19:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625996341678080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:19:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625996341678080 [0;39m ==> Parameters: 
2022-08-18 23:19:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17625996341678080 [0;39m <==    Updates: 0
2022-08-18 23:19:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17625996341678080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:19:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626017346752512 [0;39m 生成今日电子书快照开始
2022-08-18 23:19:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626017346752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:19:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626017346752512 [0;39m ==> Parameters: 
2022-08-18 23:19:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626017346752512 [0;39m <==    Updates: 0
2022-08-18 23:19:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626017346752512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:19:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17626038284718080 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:19:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626038284718080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:19:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626038284718080 [0;39m ==> Parameters: 
2022-08-18 23:19:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626038284718080 [0;39m <==    Updates: 7
2022-08-18 23:19:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17626038284718080 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:19:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626038293106688 [0;39m 生成今日电子书快照开始
2022-08-18 23:19:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626038293106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:19:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626038293106688 [0;39m ==> Parameters: 
2022-08-18 23:19:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626038293106688 [0;39m <==    Updates: 0
2022-08-18 23:19:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626038293106688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:19:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626059289792512 [0;39m 生成今日电子书快照开始
2022-08-18 23:19:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626059289792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:19:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626059289792512 [0;39m ==> Parameters: 
2022-08-18 23:19:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626059289792512 [0;39m <==    Updates: 0
2022-08-18 23:19:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626059289792512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:19:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626080257118208 [0;39m 生成今日电子书快照开始
2022-08-18 23:19:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626080257118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:19:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626080257118208 [0;39m ==> Parameters: 
2022-08-18 23:19:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626080257118208 [0;39m <==    Updates: 0
2022-08-18 23:19:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626080257118208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:19:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626101228638208 [0;39m 生成今日电子书快照开始
2022-08-18 23:19:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626101228638208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:19:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626101228638208 [0;39m ==> Parameters: 
2022-08-18 23:19:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626101228638208 [0;39m <==    Updates: 0
2022-08-18 23:19:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626101228638208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:19:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626122187575296 [0;39m 生成今日电子书快照开始
2022-08-18 23:19:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626122187575296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:19:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626122187575296 [0;39m ==> Parameters: 
2022-08-18 23:19:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626122187575296 [0;39m <==    Updates: 0
2022-08-18 23:19:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626122187575296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:20:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626143138123776 [0;39m 生成今日电子书快照开始
2022-08-18 23:20:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626143138123776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:20:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626143138123776 [0;39m ==> Parameters: 
2022-08-18 23:20:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626143138123776 [0;39m <==    Updates: 0
2022-08-18 23:20:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626143138123776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:20:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17626164168364032 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:20:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626164168364032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:20:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626164168364032 [0;39m ==> Parameters: 
2022-08-18 23:20:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626164168364032 [0;39m <==    Updates: 7
2022-08-18 23:20:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17626164168364032 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:20:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626164176752640 [0;39m 生成今日电子书快照开始
2022-08-18 23:20:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626164176752640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:20:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626164176752640 [0;39m ==> Parameters: 
2022-08-18 23:20:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626164176752640 [0;39m <==    Updates: 0
2022-08-18 23:20:05.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626164176752640 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:20:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626185110523904 [0;39m 生成今日电子书快照开始
2022-08-18 23:20:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626185110523904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:20:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626185110523904 [0;39m ==> Parameters: 
2022-08-18 23:20:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626185110523904 [0;39m <==    Updates: 0
2022-08-18 23:20:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626185110523904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:20:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626206065266688 [0;39m 生成今日电子书快照开始
2022-08-18 23:20:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626206065266688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:20:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626206065266688 [0;39m ==> Parameters: 
2022-08-18 23:20:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626206065266688 [0;39m <==    Updates: 0
2022-08-18 23:20:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626206065266688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:20:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626227057758208 [0;39m 生成今日电子书快照开始
2022-08-18 23:20:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626227057758208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:20:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626227057758208 [0;39m ==> Parameters: 
2022-08-18 23:20:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626227057758208 [0;39m <==    Updates: 0
2022-08-18 23:20:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626227057758208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:20:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626248004112384 [0;39m 生成今日电子书快照开始
2022-08-18 23:20:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626248004112384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:20:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626248004112384 [0;39m ==> Parameters: 
2022-08-18 23:20:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626248004112384 [0;39m <==    Updates: 0
2022-08-18 23:20:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626248004112384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:20:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626269000798208 [0;39m 生成今日电子书快照开始
2022-08-18 23:20:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626269000798208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:20:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626269000798208 [0;39m ==> Parameters: 
2022-08-18 23:20:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626269000798208 [0;39m <==    Updates: 0
2022-08-18 23:20:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626269000798208 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:20:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17626289963929600 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:20:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626289963929600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:20:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626289963929600 [0;39m ==> Parameters: 
2022-08-18 23:20:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626289963929600 [0;39m <==    Updates: 7
2022-08-18 23:20:35.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17626289963929600 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:20:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626289972318208 [0;39m 生成今日电子书快照开始
2022-08-18 23:20:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626289972318208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:20:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626289972318208 [0;39m ==> Parameters: 
2022-08-18 23:20:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626289972318208 [0;39m <==    Updates: 0
2022-08-18 23:20:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626289972318208 [0;39m 生成今日电子书快照结束，耗时：0 毫秒
2022-08-18 23:20:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626310918672384 [0;39m 生成今日电子书快照开始
2022-08-18 23:20:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626310918672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:20:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626310918672384 [0;39m ==> Parameters: 
2022-08-18 23:20:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626310918672384 [0;39m <==    Updates: 0
2022-08-18 23:20:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626310918672384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:20:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626331906969600 [0;39m 生成今日电子书快照开始
2022-08-18 23:20:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626331906969600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:20:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626331906969600 [0;39m ==> Parameters: 
2022-08-18 23:20:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626331906969600 [0;39m <==    Updates: 0
2022-08-18 23:20:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626331906969600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:20:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626352874295296 [0;39m 生成今日电子书快照开始
2022-08-18 23:20:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626352874295296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:20:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626352874295296 [0;39m ==> Parameters: 
2022-08-18 23:20:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626352874295296 [0;39m <==    Updates: 0
2022-08-18 23:20:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626352874295296 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:20:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626373854203904 [0;39m 生成今日电子书快照开始
2022-08-18 23:20:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626373854203904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:20:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626373854203904 [0;39m ==> Parameters: 
2022-08-18 23:20:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626373854203904 [0;39m <==    Updates: 0
2022-08-18 23:20:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626373854203904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:21:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626394846695424 [0;39m 生成今日电子书快照开始
2022-08-18 23:21:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626394846695424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:21:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626394846695424 [0;39m ==> Parameters: 
2022-08-18 23:21:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626394846695424 [0;39m <==    Updates: 0
2022-08-18 23:21:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626394846695424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:21:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17626415809826816 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:21:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626415809826816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:21:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626415809826816 [0;39m ==> Parameters: 
2022-08-18 23:21:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626415809826816 [0;39m <==    Updates: 7
2022-08-18 23:21:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17626415809826816 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:21:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626415818215424 [0;39m 生成今日电子书快照开始
2022-08-18 23:21:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626415818215424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:21:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626415818215424 [0;39m ==> Parameters: 
2022-08-18 23:21:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626415818215424 [0;39m <==    Updates: 0
2022-08-18 23:21:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626415818215424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:21:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626436781346816 [0;39m 生成今日电子书快照开始
2022-08-18 23:21:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626436781346816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:21:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626436781346816 [0;39m ==> Parameters: 
2022-08-18 23:21:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626436781346816 [0;39m <==    Updates: 0
2022-08-18 23:21:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626436781346816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:21:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626457757061120 [0;39m 生成今日电子书快照开始
2022-08-18 23:21:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626457757061120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:21:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626457757061120 [0;39m ==> Parameters: 
2022-08-18 23:21:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626457757061120 [0;39m <==    Updates: 0
2022-08-18 23:21:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626457757061120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:21:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626478699220992 [0;39m 生成今日电子书快照开始
2022-08-18 23:21:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626478699220992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:21:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626478699220992 [0;39m ==> Parameters: 
2022-08-18 23:21:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626478699220992 [0;39m <==    Updates: 0
2022-08-18 23:21:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626478699220992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:21:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626499666546688 [0;39m 生成今日电子书快照开始
2022-08-18 23:21:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626499666546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:21:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626499666546688 [0;39m ==> Parameters: 
2022-08-18 23:21:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626499666546688 [0;39m <==    Updates: 0
2022-08-18 23:21:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626499666546688 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:21:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626520659038208 [0;39m 生成今日电子书快照开始
2022-08-18 23:21:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626520659038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:21:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626520659038208 [0;39m ==> Parameters: 
2022-08-18 23:21:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626520659038208 [0;39m <==    Updates: 0
2022-08-18 23:21:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626520659038208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:21:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626541626363904 [0;39m 生成今日电子书快照开始
2022-08-18 23:21:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626541626363904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:21:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626541626363904 [0;39m ==> Parameters: 
2022-08-18 23:21:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626541626363904 [0;39m <==    Updates: 0
2022-08-18 23:21:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626541626363904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:21:35.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17626541638946816 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:21:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626541638946816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:21:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626541638946816 [0;39m ==> Parameters: 
2022-08-18 23:21:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626541638946816 [0;39m <==    Updates: 7
2022-08-18 23:21:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17626541638946816 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:21:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626562623049728 [0;39m 生成今日电子书快照开始
2022-08-18 23:21:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626562623049728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:21:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626562623049728 [0;39m ==> Parameters: 
2022-08-18 23:21:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626562623049728 [0;39m <==    Updates: 0
2022-08-18 23:21:40.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626562623049728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:21:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626583594569728 [0;39m 生成今日电子书快照开始
2022-08-18 23:21:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626583594569728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:21:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626583594569728 [0;39m ==> Parameters: 
2022-08-18 23:21:45.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626583594569728 [0;39m <==    Updates: 0
2022-08-18 23:21:45.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626583594569728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:21:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626604524146688 [0;39m 生成今日电子书快照开始
2022-08-18 23:21:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626604524146688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:21:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626604524146688 [0;39m ==> Parameters: 
2022-08-18 23:21:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626604524146688 [0;39m <==    Updates: 0
2022-08-18 23:21:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626604524146688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:21:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626625520832512 [0;39m 生成今日电子书快照开始
2022-08-18 23:21:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626625520832512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:21:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626625520832512 [0;39m ==> Parameters: 
2022-08-18 23:21:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626625520832512 [0;39m <==    Updates: 0
2022-08-18 23:21:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626625520832512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:22:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626646504935424 [0;39m 生成今日电子书快照开始
2022-08-18 23:22:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626646504935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:22:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626646504935424 [0;39m ==> Parameters: 
2022-08-18 23:22:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626646504935424 [0;39m <==    Updates: 0
2022-08-18 23:22:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626646504935424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:22:05.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17626667421929472 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:22:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626667421929472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:22:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626667421929472 [0;39m ==> Parameters: 
2022-08-18 23:22:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626667421929472 [0;39m <==    Updates: 7
2022-08-18 23:22:05.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17626667421929472 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:22:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626667430318080 [0;39m 生成今日电子书快照开始
2022-08-18 23:22:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626667430318080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:22:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626667430318080 [0;39m ==> Parameters: 
2022-08-18 23:22:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626667430318080 [0;39m <==    Updates: 0
2022-08-18 23:22:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626667430318080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:22:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626688435392512 [0;39m 生成今日电子书快照开始
2022-08-18 23:22:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626688435392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:22:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626688435392512 [0;39m ==> Parameters: 
2022-08-18 23:22:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626688435392512 [0;39m <==    Updates: 0
2022-08-18 23:22:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626688435392512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:22:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626709427884032 [0;39m 生成今日电子书快照开始
2022-08-18 23:22:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626709427884032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:22:15.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626709427884032 [0;39m ==> Parameters: 
2022-08-18 23:22:15.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626709427884032 [0;39m <==    Updates: 0
2022-08-18 23:22:15.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626709427884032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:22:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626730374238208 [0;39m 生成今日电子书快照开始
2022-08-18 23:22:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626730374238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:22:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626730374238208 [0;39m ==> Parameters: 
2022-08-18 23:22:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626730374238208 [0;39m <==    Updates: 0
2022-08-18 23:22:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626730374238208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:22:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626751316398080 [0;39m 生成今日电子书快照开始
2022-08-18 23:22:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626751316398080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:22:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626751316398080 [0;39m ==> Parameters: 
2022-08-18 23:22:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626751316398080 [0;39m <==    Updates: 0
2022-08-18 23:22:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626751316398080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:22:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626772317278208 [0;39m 生成今日电子书快照开始
2022-08-18 23:22:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626772317278208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:22:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626772317278208 [0;39m ==> Parameters: 
2022-08-18 23:22:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626772317278208 [0;39m <==    Updates: 0
2022-08-18 23:22:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626772317278208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:22:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17626793272020992 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:22:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626793272020992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:22:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626793272020992 [0;39m ==> Parameters: 
2022-08-18 23:22:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626793272020992 [0;39m <==    Updates: 7
2022-08-18 23:22:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17626793272020992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:22:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626793280409600 [0;39m 生成今日电子书快照开始
2022-08-18 23:22:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626793280409600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:22:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626793280409600 [0;39m ==> Parameters: 
2022-08-18 23:22:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626793280409600 [0;39m <==    Updates: 0
2022-08-18 23:22:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626793280409600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:22:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626814243540992 [0;39m 生成今日电子书快照开始
2022-08-18 23:22:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626814243540992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:22:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626814243540992 [0;39m ==> Parameters: 
2022-08-18 23:22:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626814243540992 [0;39m <==    Updates: 0
2022-08-18 23:22:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626814243540992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:22:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626835252809728 [0;39m 生成今日电子书快照开始
2022-08-18 23:22:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626835252809728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:22:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626835252809728 [0;39m ==> Parameters: 
2022-08-18 23:22:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626835252809728 [0;39m <==    Updates: 0
2022-08-18 23:22:45.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626835252809728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:22:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626856178192384 [0;39m 生成今日电子书快照开始
2022-08-18 23:22:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626856178192384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:22:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626856178192384 [0;39m ==> Parameters: 
2022-08-18 23:22:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626856178192384 [0;39m <==    Updates: 0
2022-08-18 23:22:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626856178192384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:22:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626877204238336 [0;39m 生成今日电子书快照开始
2022-08-18 23:22:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626877204238336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:22:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626877204238336 [0;39m ==> Parameters: 
2022-08-18 23:22:55.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626877204238336 [0;39m <==    Updates: 0
2022-08-18 23:22:55.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626877204238336 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-18 23:23:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626898129620992 [0;39m 生成今日电子书快照开始
2022-08-18 23:23:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626898129620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:23:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626898129620992 [0;39m ==> Parameters: 
2022-08-18 23:23:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626898129620992 [0;39m <==    Updates: 0
2022-08-18 23:23:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626898129620992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:23:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17626919122112512 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:23:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626919122112512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:23:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626919122112512 [0;39m ==> Parameters: 
2022-08-18 23:23:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17626919122112512 [0;39m <==    Updates: 7
2022-08-18 23:23:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17626919122112512 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-18 23:23:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626919134695424 [0;39m 生成今日电子书快照开始
2022-08-18 23:23:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626919134695424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:23:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626919134695424 [0;39m ==> Parameters: 
2022-08-18 23:23:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626919134695424 [0;39m <==    Updates: 0
2022-08-18 23:23:05.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626919134695424 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-18 23:23:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626940081049600 [0;39m 生成今日电子书快照开始
2022-08-18 23:23:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626940081049600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:23:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626940081049600 [0;39m ==> Parameters: 
2022-08-18 23:23:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626940081049600 [0;39m <==    Updates: 0
2022-08-18 23:23:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626940081049600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:23:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626961086124032 [0;39m 生成今日电子书快照开始
2022-08-18 23:23:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626961086124032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:23:15.031 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626961086124032 [0;39m ==> Parameters: 
2022-08-18 23:23:15.033 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626961086124032 [0;39m <==    Updates: 0
2022-08-18 23:23:15.034 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626961086124032 [0;39m 生成今日电子书快照结束，耗时：18 毫秒
2022-08-18 23:23:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17626982015700992 [0;39m 生成今日电子书快照开始
2022-08-18 23:23:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626982015700992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:23:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626982015700992 [0;39m ==> Parameters: 
2022-08-18 23:23:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17626982015700992 [0;39m <==    Updates: 0
2022-08-18 23:23:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17626982015700992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:23:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627003008192512 [0;39m 生成今日电子书快照开始
2022-08-18 23:23:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627003008192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:23:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627003008192512 [0;39m ==> Parameters: 
2022-08-18 23:23:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627003008192512 [0;39m <==    Updates: 0
2022-08-18 23:23:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627003008192512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:23:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627023946158080 [0;39m 生成今日电子书快照开始
2022-08-18 23:23:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627023946158080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:23:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627023946158080 [0;39m ==> Parameters: 
2022-08-18 23:23:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627023946158080 [0;39m <==    Updates: 0
2022-08-18 23:23:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627023946158080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:23:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17627044959621120 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:23:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627044959621120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:23:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627044959621120 [0;39m ==> Parameters: 
2022-08-18 23:23:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627044959621120 [0;39m <==    Updates: 7
2022-08-18 23:23:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17627044959621120 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-18 23:23:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627044972204032 [0;39m 生成今日电子书快照开始
2022-08-18 23:23:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627044972204032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:23:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627044972204032 [0;39m ==> Parameters: 
2022-08-18 23:23:35.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627044972204032 [0;39m <==    Updates: 0
2022-08-18 23:23:35.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627044972204032 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-18 23:23:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627065918558208 [0;39m 生成今日电子书快照开始
2022-08-18 23:23:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627065918558208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:23:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627065918558208 [0;39m ==> Parameters: 
2022-08-18 23:23:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627065918558208 [0;39m <==    Updates: 0
2022-08-18 23:23:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627065918558208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:23:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627086877495296 [0;39m 生成今日电子书快照开始
2022-08-18 23:23:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627086877495296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:23:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627086877495296 [0;39m ==> Parameters: 
2022-08-18 23:23:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627086877495296 [0;39m <==    Updates: 0
2022-08-18 23:23:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627086877495296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:23:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627107853209600 [0;39m 生成今日电子书快照开始
2022-08-18 23:23:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627107853209600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:23:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627107853209600 [0;39m ==> Parameters: 
2022-08-18 23:23:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627107853209600 [0;39m <==    Updates: 0
2022-08-18 23:23:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627107853209600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:23:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627128816340992 [0;39m 生成今日电子书快照开始
2022-08-18 23:23:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627128816340992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:23:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627128816340992 [0;39m ==> Parameters: 
2022-08-18 23:23:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627128816340992 [0;39m <==    Updates: 0
2022-08-18 23:23:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627128816340992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:24:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627149771083776 [0;39m 生成今日电子书快照开始
2022-08-18 23:24:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627149771083776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:24:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627149771083776 [0;39m ==> Parameters: 
2022-08-18 23:24:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627149771083776 [0;39m <==    Updates: 0
2022-08-18 23:24:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627149771083776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:24:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17627170750992384 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:24:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627170750992384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:24:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627170750992384 [0;39m ==> Parameters: 
2022-08-18 23:24:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627170750992384 [0;39m <==    Updates: 7
2022-08-18 23:24:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17627170750992384 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-18 23:24:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627170763575296 [0;39m 生成今日电子书快照开始
2022-08-18 23:24:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627170763575296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:24:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627170763575296 [0;39m ==> Parameters: 
2022-08-18 23:24:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627170763575296 [0;39m <==    Updates: 0
2022-08-18 23:24:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627170763575296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:24:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627191747678208 [0;39m 生成今日电子书快照开始
2022-08-18 23:24:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627191747678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:24:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627191747678208 [0;39m ==> Parameters: 
2022-08-18 23:24:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627191747678208 [0;39m <==    Updates: 0
2022-08-18 23:24:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627191747678208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:24:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627212723392512 [0;39m 生成今日电子书快照开始
2022-08-18 23:24:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627212723392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:24:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627212723392512 [0;39m ==> Parameters: 
2022-08-18 23:24:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627212723392512 [0;39m <==    Updates: 0
2022-08-18 23:24:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627212723392512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:24:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627233652969472 [0;39m 生成今日电子书快照开始
2022-08-18 23:24:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627233652969472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:24:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627233652969472 [0;39m ==> Parameters: 
2022-08-18 23:24:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627233652969472 [0;39m <==    Updates: 0
2022-08-18 23:24:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627233652969472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:24:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627254637072384 [0;39m 生成今日电子书快照开始
2022-08-18 23:24:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627254637072384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:24:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627254637072384 [0;39m ==> Parameters: 
2022-08-18 23:24:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627254637072384 [0;39m <==    Updates: 0
2022-08-18 23:24:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627254637072384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:24:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627275642146816 [0;39m 生成今日电子书快照开始
2022-08-18 23:24:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627275642146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:24:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627275642146816 [0;39m ==> Parameters: 
2022-08-18 23:24:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627275642146816 [0;39m <==    Updates: 0
2022-08-18 23:24:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627275642146816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:24:35.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627296609472512 [0;39m 生成今日电子书快照开始
2022-08-18 23:24:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627296609472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:24:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627296609472512 [0;39m ==> Parameters: 
2022-08-18 23:24:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627296609472512 [0;39m <==    Updates: 0
2022-08-18 23:24:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627296609472512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:24:35.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17627296626249728 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:24:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627296626249728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:24:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627296626249728 [0;39m ==> Parameters: 
2022-08-18 23:24:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627296626249728 [0;39m <==    Updates: 7
2022-08-18 23:24:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17627296626249728 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:24:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627317580992512 [0;39m 生成今日电子书快照开始
2022-08-18 23:24:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627317580992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:24:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627317580992512 [0;39m ==> Parameters: 
2022-08-18 23:24:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627317580992512 [0;39m <==    Updates: 0
2022-08-18 23:24:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627317580992512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:24:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627338548318208 [0;39m 生成今日电子书快照开始
2022-08-18 23:24:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627338548318208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:24:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627338548318208 [0;39m ==> Parameters: 
2022-08-18 23:24:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627338548318208 [0;39m <==    Updates: 0
2022-08-18 23:24:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627338548318208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:24:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627359540809728 [0;39m 生成今日电子书快照开始
2022-08-18 23:24:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627359540809728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:24:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627359540809728 [0;39m ==> Parameters: 
2022-08-18 23:24:50.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627359540809728 [0;39m <==    Updates: 0
2022-08-18 23:24:50.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627359540809728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:24:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627380457803776 [0;39m 生成今日电子书快照开始
2022-08-18 23:24:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627380457803776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:24:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627380457803776 [0;39m ==> Parameters: 
2022-08-18 23:24:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627380457803776 [0;39m <==    Updates: 0
2022-08-18 23:24:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627380457803776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:25:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627401467072512 [0;39m 生成今日电子书快照开始
2022-08-18 23:25:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627401467072512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:25:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627401467072512 [0;39m ==> Parameters: 
2022-08-18 23:25:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627401467072512 [0;39m <==    Updates: 0
2022-08-18 23:25:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627401467072512 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-18 23:25:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627422459564032 [0;39m 生成今日电子书快照开始
2022-08-18 23:25:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627422459564032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:25:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627422459564032 [0;39m ==> Parameters: 
2022-08-18 23:25:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627422459564032 [0;39m <==    Updates: 0
2022-08-18 23:25:05.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627422459564032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:25:05.020 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17627422476341248 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:25:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627422476341248 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:25:05.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627422476341248 [0;39m ==> Parameters: 
2022-08-18 23:25:05.021 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627422476341248 [0;39m <==    Updates: 7
2022-08-18 23:25:05.021 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17627422476341248 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:25:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627443368169472 [0;39m 生成今日电子书快照开始
2022-08-18 23:25:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627443368169472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:25:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627443368169472 [0;39m ==> Parameters: 
2022-08-18 23:25:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627443368169472 [0;39m <==    Updates: 0
2022-08-18 23:25:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627443368169472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:25:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627464390021120 [0;39m 生成今日电子书快照开始
2022-08-18 23:25:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627464390021120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:25:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627464390021120 [0;39m ==> Parameters: 
2022-08-18 23:25:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627464390021120 [0;39m <==    Updates: 0
2022-08-18 23:25:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627464390021120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:25:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627485332180992 [0;39m 生成今日电子书快照开始
2022-08-18 23:25:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627485332180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:25:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627485332180992 [0;39m ==> Parameters: 
2022-08-18 23:25:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627485332180992 [0;39m <==    Updates: 0
2022-08-18 23:25:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627485332180992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:25:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627506345644032 [0;39m 生成今日电子书快照开始
2022-08-18 23:25:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627506345644032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:25:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627506345644032 [0;39m ==> Parameters: 
2022-08-18 23:25:25.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627506345644032 [0;39m <==    Updates: 0
2022-08-18 23:25:25.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627506345644032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:25:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627527296192512 [0;39m 生成今日电子书快照开始
2022-08-18 23:25:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627527296192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:25:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627527296192512 [0;39m ==> Parameters: 
2022-08-18 23:25:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627527296192512 [0;39m <==    Updates: 0
2022-08-18 23:25:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627527296192512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:25:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17627548255129600 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:25:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627548255129600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:25:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627548255129600 [0;39m ==> Parameters: 
2022-08-18 23:25:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627548255129600 [0;39m <==    Updates: 7
2022-08-18 23:25:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17627548255129600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:25:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627548259323904 [0;39m 生成今日电子书快照开始
2022-08-18 23:25:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627548259323904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:25:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627548259323904 [0;39m ==> Parameters: 
2022-08-18 23:25:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627548259323904 [0;39m <==    Updates: 0
2022-08-18 23:25:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627548259323904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:25:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627569230843904 [0;39m 生成今日电子书快照开始
2022-08-18 23:25:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627569230843904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:25:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627569230843904 [0;39m ==> Parameters: 
2022-08-18 23:25:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627569230843904 [0;39m <==    Updates: 0
2022-08-18 23:25:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627569230843904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:25:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627590173003776 [0;39m 生成今日电子书快照开始
2022-08-18 23:25:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627590173003776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:25:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627590173003776 [0;39m ==> Parameters: 
2022-08-18 23:25:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627590173003776 [0;39m <==    Updates: 0
2022-08-18 23:25:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627590173003776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:25:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627611152912384 [0;39m 生成今日电子书快照开始
2022-08-18 23:25:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627611152912384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:25:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627611152912384 [0;39m ==> Parameters: 
2022-08-18 23:25:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627611152912384 [0;39m <==    Updates: 0
2022-08-18 23:25:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627611152912384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:25:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627632166375424 [0;39m 生成今日电子书快照开始
2022-08-18 23:25:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627632166375424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:25:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627632166375424 [0;39m ==> Parameters: 
2022-08-18 23:25:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627632166375424 [0;39m <==    Updates: 0
2022-08-18 23:25:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627632166375424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:26:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627653146284032 [0;39m 生成今日电子书快照开始
2022-08-18 23:26:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627653146284032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:26:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627653146284032 [0;39m ==> Parameters: 
2022-08-18 23:26:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627653146284032 [0;39m <==    Updates: 0
2022-08-18 23:26:00.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627653146284032 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:26:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627674105221120 [0;39m 生成今日电子书快照开始
2022-08-18 23:26:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627674105221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:26:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627674105221120 [0;39m ==> Parameters: 
2022-08-18 23:26:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627674105221120 [0;39m <==    Updates: 0
2022-08-18 23:26:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627674105221120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:26:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17627674117804032 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:26:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627674117804032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:26:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627674117804032 [0;39m ==> Parameters: 
2022-08-18 23:26:05.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627674117804032 [0;39m <==    Updates: 7
2022-08-18 23:26:05.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17627674117804032 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-18 23:26:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627695076741120 [0;39m 生成今日电子书快照开始
2022-08-18 23:26:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627695076741120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:26:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627695076741120 [0;39m ==> Parameters: 
2022-08-18 23:26:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627695076741120 [0;39m <==    Updates: 0
2022-08-18 23:26:10.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627695076741120 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-18 23:26:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627715997929472 [0;39m 生成今日电子书快照开始
2022-08-18 23:26:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627715997929472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:26:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627715997929472 [0;39m ==> Parameters: 
2022-08-18 23:26:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627715997929472 [0;39m <==    Updates: 0
2022-08-18 23:26:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627715997929472 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-18 23:26:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627736986226688 [0;39m 生成今日电子书快照开始
2022-08-18 23:26:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627736986226688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:26:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627736986226688 [0;39m ==> Parameters: 
2022-08-18 23:26:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627736986226688 [0;39m <==    Updates: 0
2022-08-18 23:26:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627736986226688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:26:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627757940969472 [0;39m 生成今日电子书快照开始
2022-08-18 23:26:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627757940969472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:26:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627757940969472 [0;39m ==> Parameters: 
2022-08-18 23:26:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627757940969472 [0;39m <==    Updates: 0
2022-08-18 23:26:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627757940969472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:26:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627778941849600 [0;39m 生成今日电子书快照开始
2022-08-18 23:26:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627778941849600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:26:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627778941849600 [0;39m ==> Parameters: 
2022-08-18 23:26:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627778941849600 [0;39m <==    Updates: 0
2022-08-18 23:26:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627778941849600 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-18 23:26:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627799900786688 [0;39m 生成今日电子书快照开始
2022-08-18 23:26:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627799900786688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:26:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627799900786688 [0;39m ==> Parameters: 
2022-08-18 23:26:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627799900786688 [0;39m <==    Updates: 0
2022-08-18 23:26:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627799900786688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:26:35.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17627799917563904 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:26:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627799917563904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:26:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627799917563904 [0;39m ==> Parameters: 
2022-08-18 23:26:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627799917563904 [0;39m <==    Updates: 7
2022-08-18 23:26:35.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17627799917563904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:26:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627820863918080 [0;39m 生成今日电子书快照开始
2022-08-18 23:26:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627820863918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:26:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627820863918080 [0;39m ==> Parameters: 
2022-08-18 23:26:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627820863918080 [0;39m <==    Updates: 0
2022-08-18 23:26:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627820863918080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:26:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627841848020992 [0;39m 生成今日电子书快照开始
2022-08-18 23:26:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627841848020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:26:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627841848020992 [0;39m ==> Parameters: 
2022-08-18 23:26:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627841848020992 [0;39m <==    Updates: 0
2022-08-18 23:26:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627841848020992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:26:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627862853095424 [0;39m 生成今日电子书快照开始
2022-08-18 23:26:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627862853095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:26:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627862853095424 [0;39m ==> Parameters: 
2022-08-18 23:26:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627862853095424 [0;39m <==    Updates: 0
2022-08-18 23:26:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627862853095424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:26:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627883816226816 [0;39m 生成今日电子书快照开始
2022-08-18 23:26:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627883816226816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:26:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627883816226816 [0;39m ==> Parameters: 
2022-08-18 23:26:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627883816226816 [0;39m <==    Updates: 0
2022-08-18 23:26:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627883816226816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:27:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627904766775296 [0;39m 生成今日电子书快照开始
2022-08-18 23:27:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627904766775296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:27:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627904766775296 [0;39m ==> Parameters: 
2022-08-18 23:27:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627904766775296 [0;39m <==    Updates: 0
2022-08-18 23:27:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627904766775296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:27:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627925746683904 [0;39m 生成今日电子书快照开始
2022-08-18 23:27:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627925746683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:27:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627925746683904 [0;39m ==> Parameters: 
2022-08-18 23:27:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627925746683904 [0;39m <==    Updates: 0
2022-08-18 23:27:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627925746683904 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:27:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17627925767655424 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:27:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627925767655424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:27:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627925767655424 [0;39m ==> Parameters: 
2022-08-18 23:27:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17627925767655424 [0;39m <==    Updates: 7
2022-08-18 23:27:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17627925767655424 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:27:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627946722398208 [0;39m 生成今日电子书快照开始
2022-08-18 23:27:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627946722398208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:27:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627946722398208 [0;39m ==> Parameters: 
2022-08-18 23:27:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627946722398208 [0;39m <==    Updates: 0
2022-08-18 23:27:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627946722398208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:27:15.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627967656169472 [0;39m 生成今日电子书快照开始
2022-08-18 23:27:15.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627967656169472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:27:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627967656169472 [0;39m ==> Parameters: 
2022-08-18 23:27:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627967656169472 [0;39m <==    Updates: 0
2022-08-18 23:27:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627967656169472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:27:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17627988631883776 [0;39m 生成今日电子书快照开始
2022-08-18 23:27:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627988631883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:27:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627988631883776 [0;39m ==> Parameters: 
2022-08-18 23:27:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17627988631883776 [0;39m <==    Updates: 0
2022-08-18 23:27:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17627988631883776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:27:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628009628569600 [0;39m 生成今日电子书快照开始
2022-08-18 23:27:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628009628569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:27:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628009628569600 [0;39m ==> Parameters: 
2022-08-18 23:27:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628009628569600 [0;39m <==    Updates: 0
2022-08-18 23:27:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628009628569600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:27:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628030570729472 [0;39m 生成今日电子书快照开始
2022-08-18 23:27:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628030570729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:27:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628030570729472 [0;39m ==> Parameters: 
2022-08-18 23:27:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628030570729472 [0;39m <==    Updates: 0
2022-08-18 23:27:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628030570729472 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:27:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17628051563220992 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:27:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628051563220992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:27:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628051563220992 [0;39m ==> Parameters: 
2022-08-18 23:27:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628051563220992 [0;39m <==    Updates: 7
2022-08-18 23:27:35.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17628051563220992 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:27:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628051571609600 [0;39m 生成今日电子书快照开始
2022-08-18 23:27:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628051571609600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:27:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628051571609600 [0;39m ==> Parameters: 
2022-08-18 23:27:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628051571609600 [0;39m <==    Updates: 0
2022-08-18 23:27:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628051571609600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:27:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628072568295424 [0;39m 生成今日电子书快照开始
2022-08-18 23:27:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628072568295424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:27:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628072568295424 [0;39m ==> Parameters: 
2022-08-18 23:27:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628072568295424 [0;39m <==    Updates: 0
2022-08-18 23:27:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628072568295424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:27:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628093523038208 [0;39m 生成今日电子书快照开始
2022-08-18 23:27:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628093523038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:27:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628093523038208 [0;39m ==> Parameters: 
2022-08-18 23:27:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628093523038208 [0;39m <==    Updates: 0
2022-08-18 23:27:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628093523038208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:27:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628114477780992 [0;39m 生成今日电子书快照开始
2022-08-18 23:27:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628114477780992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:27:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628114477780992 [0;39m ==> Parameters: 
2022-08-18 23:27:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628114477780992 [0;39m <==    Updates: 0
2022-08-18 23:27:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628114477780992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:27:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628135482855424 [0;39m 生成今日电子书快照开始
2022-08-18 23:27:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628135482855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:27:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628135482855424 [0;39m ==> Parameters: 
2022-08-18 23:27:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628135482855424 [0;39m <==    Updates: 0
2022-08-18 23:27:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628135482855424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:28:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628156441792512 [0;39m 生成今日电子书快照开始
2022-08-18 23:28:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628156441792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:28:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628156441792512 [0;39m ==> Parameters: 
2022-08-18 23:28:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628156441792512 [0;39m <==    Updates: 0
2022-08-18 23:28:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628156441792512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:28:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628177392340992 [0;39m 生成今日电子书快照开始
2022-08-18 23:28:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628177392340992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:28:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628177392340992 [0;39m ==> Parameters: 
2022-08-18 23:28:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628177392340992 [0;39m <==    Updates: 0
2022-08-18 23:28:05.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628177392340992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:28:05.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17628177400729600 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:28:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628177400729600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:28:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628177400729600 [0;39m ==> Parameters: 
2022-08-18 23:28:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628177400729600 [0;39m <==    Updates: 7
2022-08-18 23:28:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17628177400729600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:28:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628198393221120 [0;39m 生成今日电子书快照开始
2022-08-18 23:28:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628198393221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:28:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628198393221120 [0;39m ==> Parameters: 
2022-08-18 23:28:10.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628198393221120 [0;39m <==    Updates: 0
2022-08-18 23:28:10.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628198393221120 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-18 23:28:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628219331186688 [0;39m 生成今日电子书快照开始
2022-08-18 23:28:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628219331186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:28:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628219331186688 [0;39m ==> Parameters: 
2022-08-18 23:28:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628219331186688 [0;39m <==    Updates: 0
2022-08-18 23:28:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628219331186688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:28:20.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628240344649728 [0;39m 生成今日电子书快照开始
2022-08-18 23:28:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628240344649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:28:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628240344649728 [0;39m ==> Parameters: 
2022-08-18 23:28:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628240344649728 [0;39m <==    Updates: 0
2022-08-18 23:28:20.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628240344649728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:28:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628261299392512 [0;39m 生成今日电子书快照开始
2022-08-18 23:28:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628261299392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:28:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628261299392512 [0;39m ==> Parameters: 
2022-08-18 23:28:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628261299392512 [0;39m <==    Updates: 0
2022-08-18 23:28:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628261299392512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:28:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628282275106816 [0;39m 生成今日电子书快照开始
2022-08-18 23:28:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628282275106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:28:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628282275106816 [0;39m ==> Parameters: 
2022-08-18 23:28:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628282275106816 [0;39m <==    Updates: 0
2022-08-18 23:28:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628282275106816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:28:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628303213072384 [0;39m 生成今日电子书快照开始
2022-08-18 23:28:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628303213072384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:28:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628303213072384 [0;39m ==> Parameters: 
2022-08-18 23:28:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628303213072384 [0;39m <==    Updates: 0
2022-08-18 23:28:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628303213072384 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:28:35.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17628303234043904 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:28:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628303234043904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:28:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628303234043904 [0;39m ==> Parameters: 
2022-08-18 23:28:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628303234043904 [0;39m <==    Updates: 7
2022-08-18 23:28:35.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17628303234043904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:28:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628324172009472 [0;39m 生成今日电子书快照开始
2022-08-18 23:28:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628324172009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:28:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628324172009472 [0;39m ==> Parameters: 
2022-08-18 23:28:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628324172009472 [0;39m <==    Updates: 0
2022-08-18 23:28:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628324172009472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:28:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628345147723776 [0;39m 生成今日电子书快照开始
2022-08-18 23:28:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628345147723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:28:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628345147723776 [0;39m ==> Parameters: 
2022-08-18 23:28:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628345147723776 [0;39m <==    Updates: 0
2022-08-18 23:28:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628345147723776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:28:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628366123438080 [0;39m 生成今日电子书快照开始
2022-08-18 23:28:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628366123438080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:28:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628366123438080 [0;39m ==> Parameters: 
2022-08-18 23:28:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628366123438080 [0;39m <==    Updates: 0
2022-08-18 23:28:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628366123438080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:28:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628387141095424 [0;39m 生成今日电子书快照开始
2022-08-18 23:28:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628387141095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:28:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628387141095424 [0;39m ==> Parameters: 
2022-08-18 23:28:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628387141095424 [0;39m <==    Updates: 0
2022-08-18 23:28:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628387141095424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:29:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628408112615424 [0;39m 生成今日电子书快照开始
2022-08-18 23:29:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628408112615424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:29:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628408112615424 [0;39m ==> Parameters: 
2022-08-18 23:29:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628408112615424 [0;39m <==    Updates: 0
2022-08-18 23:29:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628408112615424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:29:05.015 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17628429088329728 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:29:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628429088329728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:29:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628429088329728 [0;39m ==> Parameters: 
2022-08-18 23:29:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628429088329728 [0;39m <==    Updates: 7
2022-08-18 23:29:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17628429088329728 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:29:05.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628429096718336 [0;39m 生成今日电子书快照开始
2022-08-18 23:29:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628429096718336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:29:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628429096718336 [0;39m ==> Parameters: 
2022-08-18 23:29:05.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628429096718336 [0;39m <==    Updates: 0
2022-08-18 23:29:05.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628429096718336 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:29:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628450051461120 [0;39m 生成今日电子书快照开始
2022-08-18 23:29:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628450051461120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:29:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628450051461120 [0;39m ==> Parameters: 
2022-08-18 23:29:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628450051461120 [0;39m <==    Updates: 0
2022-08-18 23:29:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628450051461120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:29:15.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628470976843776 [0;39m 生成今日电子书快照开始
2022-08-18 23:29:15.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628470976843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:29:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628470976843776 [0;39m ==> Parameters: 
2022-08-18 23:29:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628470976843776 [0;39m <==    Updates: 0
2022-08-18 23:29:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628470976843776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:29:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628491986112512 [0;39m 生成今日电子书快照开始
2022-08-18 23:29:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628491986112512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:29:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628491986112512 [0;39m ==> Parameters: 
2022-08-18 23:29:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628491986112512 [0;39m <==    Updates: 0
2022-08-18 23:29:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628491986112512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:29:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628512924078080 [0;39m 生成今日电子书快照开始
2022-08-18 23:29:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628512924078080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:29:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628512924078080 [0;39m ==> Parameters: 
2022-08-18 23:29:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628512924078080 [0;39m <==    Updates: 0
2022-08-18 23:29:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628512924078080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:29:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628533941735424 [0;39m 生成今日电子书快照开始
2022-08-18 23:29:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628533941735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:29:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628533941735424 [0;39m ==> Parameters: 
2022-08-18 23:29:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628533941735424 [0;39m <==    Updates: 0
2022-08-18 23:29:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628533941735424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:29:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628554917449728 [0;39m 生成今日电子书快照开始
2022-08-18 23:29:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628554917449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:29:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628554917449728 [0;39m ==> Parameters: 
2022-08-18 23:29:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628554917449728 [0;39m <==    Updates: 0
2022-08-18 23:29:35.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628554917449728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:29:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17628554930032640 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:29:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628554930032640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:29:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628554930032640 [0;39m ==> Parameters: 
2022-08-18 23:29:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628554930032640 [0;39m <==    Updates: 7
2022-08-18 23:29:35.020 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17628554930032640 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:29:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628575855415296 [0;39m 生成今日电子书快照开始
2022-08-18 23:29:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628575855415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:29:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628575855415296 [0;39m ==> Parameters: 
2022-08-18 23:29:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628575855415296 [0;39m <==    Updates: 0
2022-08-18 23:29:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628575855415296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:29:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628596814352384 [0;39m 生成今日电子书快照开始
2022-08-18 23:29:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628596814352384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:29:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628596814352384 [0;39m ==> Parameters: 
2022-08-18 23:29:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628596814352384 [0;39m <==    Updates: 0
2022-08-18 23:29:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628596814352384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:29:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628617811038208 [0;39m 生成今日电子书快照开始
2022-08-18 23:29:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628617811038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:29:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628617811038208 [0;39m ==> Parameters: 
2022-08-18 23:29:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628617811038208 [0;39m <==    Updates: 0
2022-08-18 23:29:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628617811038208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:29:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628638749003776 [0;39m 生成今日电子书快照开始
2022-08-18 23:29:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628638749003776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:29:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628638749003776 [0;39m ==> Parameters: 
2022-08-18 23:29:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628638749003776 [0;39m <==    Updates: 0
2022-08-18 23:29:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628638749003776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:30:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628659766661120 [0;39m 生成今日电子书快照开始
2022-08-18 23:30:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628659766661120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:30:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628659766661120 [0;39m ==> Parameters: 
2022-08-18 23:30:00.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628659766661120 [0;39m <==    Updates: 0
2022-08-18 23:30:00.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628659766661120 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:30:05.000 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17628680683655168 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:30:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628680683655168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:30:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628680683655168 [0;39m ==> Parameters: 
2022-08-18 23:30:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628680683655168 [0;39m <==    Updates: 7
2022-08-18 23:30:05.002 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17628680683655168 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:30:05.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628680692043776 [0;39m 生成今日电子书快照开始
2022-08-18 23:30:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628680692043776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:30:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628680692043776 [0;39m ==> Parameters: 
2022-08-18 23:30:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628680692043776 [0;39m <==    Updates: 0
2022-08-18 23:30:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628680692043776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:30:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628701705506816 [0;39m 生成今日电子书快照开始
2022-08-18 23:30:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628701705506816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:30:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628701705506816 [0;39m ==> Parameters: 
2022-08-18 23:30:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628701705506816 [0;39m <==    Updates: 0
2022-08-18 23:30:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628701705506816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:30:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628722668638208 [0;39m 生成今日电子书快照开始
2022-08-18 23:30:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628722668638208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:30:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628722668638208 [0;39m ==> Parameters: 
2022-08-18 23:30:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628722668638208 [0;39m <==    Updates: 0
2022-08-18 23:30:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628722668638208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:30:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628743640158208 [0;39m 生成今日电子书快照开始
2022-08-18 23:30:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628743640158208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:30:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628743640158208 [0;39m ==> Parameters: 
2022-08-18 23:30:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628743640158208 [0;39m <==    Updates: 0
2022-08-18 23:30:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628743640158208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:30:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628764578123776 [0;39m 生成今日电子书快照开始
2022-08-18 23:30:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628764578123776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:30:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628764578123776 [0;39m ==> Parameters: 
2022-08-18 23:30:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628764578123776 [0;39m <==    Updates: 0
2022-08-18 23:30:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628764578123776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:30:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628785570615296 [0;39m 生成今日电子书快照开始
2022-08-18 23:30:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628785570615296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:30:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628785570615296 [0;39m ==> Parameters: 
2022-08-18 23:30:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628785570615296 [0;39m <==    Updates: 0
2022-08-18 23:30:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628785570615296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:30:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628806579884032 [0;39m 生成今日电子书快照开始
2022-08-18 23:30:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628806579884032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:30:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628806579884032 [0;39m ==> Parameters: 
2022-08-18 23:30:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628806579884032 [0;39m <==    Updates: 0
2022-08-18 23:30:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628806579884032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:30:35.019 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17628806592466944 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:30:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628806592466944 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:30:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628806592466944 [0;39m ==> Parameters: 
2022-08-18 23:30:35.020 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628806592466944 [0;39m <==    Updates: 7
2022-08-18 23:30:35.020 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17628806592466944 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:30:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628827526238208 [0;39m 生成今日电子书快照开始
2022-08-18 23:30:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628827526238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:30:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628827526238208 [0;39m ==> Parameters: 
2022-08-18 23:30:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628827526238208 [0;39m <==    Updates: 0
2022-08-18 23:30:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628827526238208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:30:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628848510341120 [0;39m 生成今日电子书快照开始
2022-08-18 23:30:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628848510341120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:30:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628848510341120 [0;39m ==> Parameters: 
2022-08-18 23:30:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628848510341120 [0;39m <==    Updates: 0
2022-08-18 23:30:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628848510341120 [0;39m 生成今日电子书快照结束，耗时：0 毫秒
2022-08-18 23:30:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628869486055424 [0;39m 生成今日电子书快照开始
2022-08-18 23:30:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628869486055424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:30:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628869486055424 [0;39m ==> Parameters: 
2022-08-18 23:30:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628869486055424 [0;39m <==    Updates: 0
2022-08-18 23:30:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628869486055424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:30:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628890419826688 [0;39m 生成今日电子书快照开始
2022-08-18 23:30:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628890419826688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:30:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628890419826688 [0;39m ==> Parameters: 
2022-08-18 23:30:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628890419826688 [0;39m <==    Updates: 0
2022-08-18 23:30:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628890419826688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:31:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628911374569472 [0;39m 生成今日电子书快照开始
2022-08-18 23:31:00.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628911374569472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:31:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628911374569472 [0;39m ==> Parameters: 
2022-08-18 23:31:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628911374569472 [0;39m <==    Updates: 0
2022-08-18 23:31:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628911374569472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:31:05.000 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17628932341895168 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:31:05.000 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628932341895168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:31:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628932341895168 [0;39m ==> Parameters: 
2022-08-18 23:31:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17628932341895168 [0;39m <==    Updates: 7
2022-08-18 23:31:05.002 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17628932341895168 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:31:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628932354478080 [0;39m 生成今日电子书快照开始
2022-08-18 23:31:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628932354478080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:31:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628932354478080 [0;39m ==> Parameters: 
2022-08-18 23:31:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628932354478080 [0;39m <==    Updates: 0
2022-08-18 23:31:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628932354478080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:31:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628953363746816 [0;39m 生成今日电子书快照开始
2022-08-18 23:31:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628953363746816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:31:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628953363746816 [0;39m ==> Parameters: 
2022-08-18 23:31:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628953363746816 [0;39m <==    Updates: 0
2022-08-18 23:31:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628953363746816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:31:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628974314295296 [0;39m 生成今日电子书快照开始
2022-08-18 23:31:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628974314295296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:31:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628974314295296 [0;39m ==> Parameters: 
2022-08-18 23:31:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628974314295296 [0;39m <==    Updates: 0
2022-08-18 23:31:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628974314295296 [0;39m 生成今日电子书快照结束，耗时：0 毫秒
2022-08-18 23:31:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17628995323564032 [0;39m 生成今日电子书快照开始
2022-08-18 23:31:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628995323564032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:31:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628995323564032 [0;39m ==> Parameters: 
2022-08-18 23:31:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17628995323564032 [0;39m <==    Updates: 0
2022-08-18 23:31:20.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17628995323564032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:31:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629016286695424 [0;39m 生成今日电子书快照开始
2022-08-18 23:31:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629016286695424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:31:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629016286695424 [0;39m ==> Parameters: 
2022-08-18 23:31:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629016286695424 [0;39m <==    Updates: 0
2022-08-18 23:31:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629016286695424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:31:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629037249826816 [0;39m 生成今日电子书快照开始
2022-08-18 23:31:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629037249826816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:31:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629037249826816 [0;39m ==> Parameters: 
2022-08-18 23:31:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629037249826816 [0;39m <==    Updates: 0
2022-08-18 23:31:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629037249826816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:31:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629058233929728 [0;39m 生成今日电子书快照开始
2022-08-18 23:31:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629058233929728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:31:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629058233929728 [0;39m ==> Parameters: 
2022-08-18 23:31:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629058233929728 [0;39m <==    Updates: 0
2022-08-18 23:31:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629058233929728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:31:35.018 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17629058246512640 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:31:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629058246512640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:31:35.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629058246512640 [0;39m ==> Parameters: 
2022-08-18 23:31:35.019 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629058246512640 [0;39m <==    Updates: 7
2022-08-18 23:31:35.019 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17629058246512640 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:31:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629079146729472 [0;39m 生成今日电子书快照开始
2022-08-18 23:31:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629079146729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:31:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629079146729472 [0;39m ==> Parameters: 
2022-08-18 23:31:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629079146729472 [0;39m <==    Updates: 0
2022-08-18 23:31:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629079146729472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:31:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629100122443776 [0;39m 生成今日电子书快照开始
2022-08-18 23:31:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629100122443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:31:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629100122443776 [0;39m ==> Parameters: 
2022-08-18 23:31:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629100122443776 [0;39m <==    Updates: 0
2022-08-18 23:31:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629100122443776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:31:50.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629121093963776 [0;39m 生成今日电子书快照开始
2022-08-18 23:31:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629121093963776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:31:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629121093963776 [0;39m ==> Parameters: 
2022-08-18 23:31:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629121093963776 [0;39m <==    Updates: 0
2022-08-18 23:31:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629121093963776 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:31:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629142099038208 [0;39m 生成今日电子书快照开始
2022-08-18 23:31:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629142099038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:31:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629142099038208 [0;39m ==> Parameters: 
2022-08-18 23:31:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629142099038208 [0;39m <==    Updates: 0
2022-08-18 23:31:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629142099038208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:32:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629163074752512 [0;39m 生成今日电子书快照开始
2022-08-18 23:32:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629163074752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:32:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629163074752512 [0;39m ==> Parameters: 
2022-08-18 23:32:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629163074752512 [0;39m <==    Updates: 0
2022-08-18 23:32:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629163074752512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:32:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17629184037883904 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:32:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629184037883904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:32:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629184037883904 [0;39m ==> Parameters: 
2022-08-18 23:32:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629184037883904 [0;39m <==    Updates: 7
2022-08-18 23:32:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17629184037883904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:32:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629184046272512 [0;39m 生成今日电子书快照开始
2022-08-18 23:32:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629184046272512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:32:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629184046272512 [0;39m ==> Parameters: 
2022-08-18 23:32:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629184046272512 [0;39m <==    Updates: 0
2022-08-18 23:32:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629184046272512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:32:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629204980043776 [0;39m 生成今日电子书快照开始
2022-08-18 23:32:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629204980043776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:32:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629204980043776 [0;39m ==> Parameters: 
2022-08-18 23:32:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629204980043776 [0;39m <==    Updates: 0
2022-08-18 23:32:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629204980043776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:32:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629225959952384 [0;39m 生成今日电子书快照开始
2022-08-18 23:32:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629225959952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:32:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629225959952384 [0;39m ==> Parameters: 
2022-08-18 23:32:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629225959952384 [0;39m <==    Updates: 0
2022-08-18 23:32:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629225959952384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:32:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629246948249600 [0;39m 生成今日电子书快照开始
2022-08-18 23:32:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629246948249600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:32:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629246948249600 [0;39m ==> Parameters: 
2022-08-18 23:32:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629246948249600 [0;39m <==    Updates: 0
2022-08-18 23:32:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629246948249600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:32:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629267907186688 [0;39m 生成今日电子书快照开始
2022-08-18 23:32:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629267907186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:32:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629267907186688 [0;39m ==> Parameters: 
2022-08-18 23:32:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629267907186688 [0;39m <==    Updates: 0
2022-08-18 23:32:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629267907186688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:32:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629288895483904 [0;39m 生成今日电子书快照开始
2022-08-18 23:32:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629288895483904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:32:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629288895483904 [0;39m ==> Parameters: 
2022-08-18 23:32:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629288895483904 [0;39m <==    Updates: 0
2022-08-18 23:32:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629288895483904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:32:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17629309875392512 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:32:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629309875392512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:32:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629309875392512 [0;39m ==> Parameters: 
2022-08-18 23:32:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629309875392512 [0;39m <==    Updates: 7
2022-08-18 23:32:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17629309875392512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:32:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629309883781120 [0;39m 生成今日电子书快照开始
2022-08-18 23:32:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629309883781120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:32:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629309883781120 [0;39m ==> Parameters: 
2022-08-18 23:32:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629309883781120 [0;39m <==    Updates: 0
2022-08-18 23:32:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629309883781120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:32:40.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629330872078336 [0;39m 生成今日电子书快照开始
2022-08-18 23:32:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629330872078336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:32:40.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629330872078336 [0;39m ==> Parameters: 
2022-08-18 23:32:40.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629330872078336 [0;39m <==    Updates: 0
2022-08-18 23:32:40.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629330872078336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:32:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629351784878080 [0;39m 生成今日电子书快照开始
2022-08-18 23:32:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629351784878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:32:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629351784878080 [0;39m ==> Parameters: 
2022-08-18 23:32:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629351784878080 [0;39m <==    Updates: 0
2022-08-18 23:32:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629351784878080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:32:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629372794146816 [0;39m 生成今日电子书快照开始
2022-08-18 23:32:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629372794146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:32:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629372794146816 [0;39m ==> Parameters: 
2022-08-18 23:32:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629372794146816 [0;39m <==    Updates: 0
2022-08-18 23:32:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629372794146816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:32:55.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629393719529472 [0;39m 生成今日电子书快照开始
2022-08-18 23:32:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629393719529472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:32:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629393719529472 [0;39m ==> Parameters: 
2022-08-18 23:32:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629393719529472 [0;39m <==    Updates: 0
2022-08-18 23:32:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629393719529472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:33:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629414749769728 [0;39m 生成今日电子书快照开始
2022-08-18 23:33:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629414749769728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:33:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629414749769728 [0;39m ==> Parameters: 
2022-08-18 23:33:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629414749769728 [0;39m <==    Updates: 0
2022-08-18 23:33:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629414749769728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:33:05.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17629435662569472 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:33:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629435662569472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:33:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629435662569472 [0;39m ==> Parameters: 
2022-08-18 23:33:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629435662569472 [0;39m <==    Updates: 7
2022-08-18 23:33:05.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17629435662569472 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:33:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629435670958080 [0;39m 生成今日电子书快照开始
2022-08-18 23:33:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629435670958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:33:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629435670958080 [0;39m ==> Parameters: 
2022-08-18 23:33:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629435670958080 [0;39m <==    Updates: 0
2022-08-18 23:33:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629435670958080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:33:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629456697004032 [0;39m 生成今日电子书快照开始
2022-08-18 23:33:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629456697004032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:33:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629456697004032 [0;39m ==> Parameters: 
2022-08-18 23:33:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629456697004032 [0;39m <==    Updates: 0
2022-08-18 23:33:10.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629456697004032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:33:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629477655941120 [0;39m 生成今日电子书快照开始
2022-08-18 23:33:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629477655941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:33:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629477655941120 [0;39m ==> Parameters: 
2022-08-18 23:33:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629477655941120 [0;39m <==    Updates: 0
2022-08-18 23:33:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629477655941120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:33:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629498593906688 [0;39m 生成今日电子书快照开始
2022-08-18 23:33:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629498593906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:33:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629498593906688 [0;39m ==> Parameters: 
2022-08-18 23:33:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629498593906688 [0;39m <==    Updates: 0
2022-08-18 23:33:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629498593906688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:33:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629519569620992 [0;39m 生成今日电子书快照开始
2022-08-18 23:33:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629519569620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:33:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629519569620992 [0;39m ==> Parameters: 
2022-08-18 23:33:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629519569620992 [0;39m <==    Updates: 0
2022-08-18 23:33:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629519569620992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:33:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629540578889728 [0;39m 生成今日电子书快照开始
2022-08-18 23:33:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629540578889728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:33:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629540578889728 [0;39m ==> Parameters: 
2022-08-18 23:33:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629540578889728 [0;39m <==    Updates: 0
2022-08-18 23:33:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629540578889728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:33:35.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17629561495883776 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:33:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629561495883776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:33:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629561495883776 [0;39m ==> Parameters: 
2022-08-18 23:33:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629561495883776 [0;39m <==    Updates: 7
2022-08-18 23:33:35.004 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17629561495883776 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:33:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629561504272384 [0;39m 生成今日电子书快照开始
2022-08-18 23:33:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629561504272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:33:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629561504272384 [0;39m ==> Parameters: 
2022-08-18 23:33:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629561504272384 [0;39m <==    Updates: 0
2022-08-18 23:33:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629561504272384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:33:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629582471598080 [0;39m 生成今日电子书快照开始
2022-08-18 23:33:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629582471598080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:33:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629582471598080 [0;39m ==> Parameters: 
2022-08-18 23:33:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629582471598080 [0;39m <==    Updates: 0
2022-08-18 23:33:40.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629582471598080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:33:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629603451506688 [0;39m 生成今日电子书快照开始
2022-08-18 23:33:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629603451506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:33:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629603451506688 [0;39m ==> Parameters: 
2022-08-18 23:33:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629603451506688 [0;39m <==    Updates: 0
2022-08-18 23:33:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629603451506688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:33:50.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629624406249472 [0;39m 生成今日电子书快照开始
2022-08-18 23:33:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629624406249472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:33:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629624406249472 [0;39m ==> Parameters: 
2022-08-18 23:33:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629624406249472 [0;39m <==    Updates: 0
2022-08-18 23:33:50.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629624406249472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:33:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629645390352384 [0;39m 生成今日电子书快照开始
2022-08-18 23:33:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629645390352384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:33:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629645390352384 [0;39m ==> Parameters: 
2022-08-18 23:33:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629645390352384 [0;39m <==    Updates: 0
2022-08-18 23:33:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629645390352384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:34:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629666353483776 [0;39m 生成今日电子书快照开始
2022-08-18 23:34:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629666353483776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:34:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629666353483776 [0;39m ==> Parameters: 
2022-08-18 23:34:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629666353483776 [0;39m <==    Updates: 0
2022-08-18 23:34:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629666353483776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:34:05.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629687320809472 [0;39m 生成今日电子书快照开始
2022-08-18 23:34:05.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629687320809472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:34:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629687320809472 [0;39m ==> Parameters: 
2022-08-18 23:34:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629687320809472 [0;39m <==    Updates: 0
2022-08-18 23:34:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629687320809472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:34:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17629687333392384 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:34:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629687333392384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:34:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629687333392384 [0;39m ==> Parameters: 
2022-08-18 23:34:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629687333392384 [0;39m <==    Updates: 7
2022-08-18 23:34:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17629687333392384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:34:10.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629708296523776 [0;39m 生成今日电子书快照开始
2022-08-18 23:34:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629708296523776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:34:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629708296523776 [0;39m ==> Parameters: 
2022-08-18 23:34:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629708296523776 [0;39m <==    Updates: 0
2022-08-18 23:34:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629708296523776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:34:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629729280626688 [0;39m 生成今日电子书快照开始
2022-08-18 23:34:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629729280626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:34:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629729280626688 [0;39m ==> Parameters: 
2022-08-18 23:34:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629729280626688 [0;39m <==    Updates: 0
2022-08-18 23:34:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629729280626688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:34:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629750285701120 [0;39m 生成今日电子书快照开始
2022-08-18 23:34:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629750285701120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:34:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629750285701120 [0;39m ==> Parameters: 
2022-08-18 23:34:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629750285701120 [0;39m <==    Updates: 0
2022-08-18 23:34:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629750285701120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:34:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629771215278080 [0;39m 生成今日电子书快照开始
2022-08-18 23:34:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629771215278080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:34:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629771215278080 [0;39m ==> Parameters: 
2022-08-18 23:34:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629771215278080 [0;39m <==    Updates: 0
2022-08-18 23:34:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629771215278080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:34:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629792211963904 [0;39m 生成今日电子书快照开始
2022-08-18 23:34:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629792211963904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:34:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629792211963904 [0;39m ==> Parameters: 
2022-08-18 23:34:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629792211963904 [0;39m <==    Updates: 0
2022-08-18 23:34:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629792211963904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:34:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17629813175095296 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:34:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629813175095296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:34:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629813175095296 [0;39m ==> Parameters: 
2022-08-18 23:34:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629813175095296 [0;39m <==    Updates: 7
2022-08-18 23:34:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17629813175095296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:34:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629813183483904 [0;39m 生成今日电子书快照开始
2022-08-18 23:34:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629813183483904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:34:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629813183483904 [0;39m ==> Parameters: 
2022-08-18 23:34:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629813183483904 [0;39m <==    Updates: 0
2022-08-18 23:34:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629813183483904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:34:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629834155003904 [0;39m 生成今日电子书快照开始
2022-08-18 23:34:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629834155003904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:34:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629834155003904 [0;39m ==> Parameters: 
2022-08-18 23:34:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629834155003904 [0;39m <==    Updates: 0
2022-08-18 23:34:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629834155003904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:34:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629855151689728 [0;39m 生成今日电子书快照开始
2022-08-18 23:34:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629855151689728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:34:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629855151689728 [0;39m ==> Parameters: 
2022-08-18 23:34:45.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629855151689728 [0;39m <==    Updates: 0
2022-08-18 23:34:45.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629855151689728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:34:50.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629876064489472 [0;39m 生成今日电子书快照开始
2022-08-18 23:34:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629876064489472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:34:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629876064489472 [0;39m ==> Parameters: 
2022-08-18 23:34:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629876064489472 [0;39m <==    Updates: 0
2022-08-18 23:34:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629876064489472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:34:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629897048592384 [0;39m 生成今日电子书快照开始
2022-08-18 23:34:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629897048592384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:34:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629897048592384 [0;39m ==> Parameters: 
2022-08-18 23:34:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629897048592384 [0;39m <==    Updates: 0
2022-08-18 23:34:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629897048592384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:35:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629918024306688 [0;39m 生成今日电子书快照开始
2022-08-18 23:35:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629918024306688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:35:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629918024306688 [0;39m ==> Parameters: 
2022-08-18 23:35:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629918024306688 [0;39m <==    Updates: 0
2022-08-18 23:35:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629918024306688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:35:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629939016798208 [0;39m 生成今日电子书快照开始
2022-08-18 23:35:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629939016798208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:35:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629939016798208 [0;39m ==> Parameters: 
2022-08-18 23:35:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629939016798208 [0;39m <==    Updates: 0
2022-08-18 23:35:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629939016798208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:35:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17629939029381120 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:35:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629939029381120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:35:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629939029381120 [0;39m ==> Parameters: 
2022-08-18 23:35:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17629939029381120 [0;39m <==    Updates: 7
2022-08-18 23:35:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17629939029381120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:35:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629959996706816 [0;39m 生成今日电子书快照开始
2022-08-18 23:35:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629959996706816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:35:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629959996706816 [0;39m ==> Parameters: 
2022-08-18 23:35:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629959996706816 [0;39m <==    Updates: 0
2022-08-18 23:35:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629959996706816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:35:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17629980959838208 [0;39m 生成今日电子书快照开始
2022-08-18 23:35:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629980959838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:35:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629980959838208 [0;39m ==> Parameters: 
2022-08-18 23:35:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17629980959838208 [0;39m <==    Updates: 0
2022-08-18 23:35:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17629980959838208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:35:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630001914580992 [0;39m 生成今日电子书快照开始
2022-08-18 23:35:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630001914580992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:35:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630001914580992 [0;39m ==> Parameters: 
2022-08-18 23:35:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630001914580992 [0;39m <==    Updates: 0
2022-08-18 23:35:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630001914580992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:35:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630022894489600 [0;39m 生成今日电子书快照开始
2022-08-18 23:35:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630022894489600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:35:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630022894489600 [0;39m ==> Parameters: 
2022-08-18 23:35:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630022894489600 [0;39m <==    Updates: 0
2022-08-18 23:35:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630022894489600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:35:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630043857620992 [0;39m 生成今日电子书快照开始
2022-08-18 23:35:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630043857620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:35:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630043857620992 [0;39m ==> Parameters: 
2022-08-18 23:35:30.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630043857620992 [0;39m <==    Updates: 0
2022-08-18 23:35:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630043857620992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:35:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630064841723904 [0;39m 生成今日电子书快照开始
2022-08-18 23:35:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630064841723904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:35:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630064841723904 [0;39m ==> Parameters: 
2022-08-18 23:35:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630064841723904 [0;39m <==    Updates: 0
2022-08-18 23:35:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630064841723904 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:35:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17630064845918208 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:35:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630064845918208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:35:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630064845918208 [0;39m ==> Parameters: 
2022-08-18 23:35:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630064845918208 [0;39m <==    Updates: 7
2022-08-18 23:35:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17630064845918208 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:35:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630085804855296 [0;39m 生成今日电子书快照开始
2022-08-18 23:35:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630085804855296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:35:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630085804855296 [0;39m ==> Parameters: 
2022-08-18 23:35:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630085804855296 [0;39m <==    Updates: 0
2022-08-18 23:35:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630085804855296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:35:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630106801541120 [0;39m 生成今日电子书快照开始
2022-08-18 23:35:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630106801541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:35:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630106801541120 [0;39m ==> Parameters: 
2022-08-18 23:35:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630106801541120 [0;39m <==    Updates: 0
2022-08-18 23:35:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630106801541120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:35:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630127747895296 [0;39m 生成今日电子书快照开始
2022-08-18 23:35:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630127747895296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:35:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630127747895296 [0;39m ==> Parameters: 
2022-08-18 23:35:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630127747895296 [0;39m <==    Updates: 0
2022-08-18 23:35:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630127747895296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:35:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630148706832384 [0;39m 生成今日电子书快照开始
2022-08-18 23:35:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630148706832384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:35:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630148706832384 [0;39m ==> Parameters: 
2022-08-18 23:35:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630148706832384 [0;39m <==    Updates: 0
2022-08-18 23:35:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630148706832384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:36:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630169716101120 [0;39m 生成今日电子书快照开始
2022-08-18 23:36:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630169716101120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:36:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630169716101120 [0;39m ==> Parameters: 
2022-08-18 23:36:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630169716101120 [0;39m <==    Updates: 0
2022-08-18 23:36:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630169716101120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:36:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630190649872384 [0;39m 生成今日电子书快照开始
2022-08-18 23:36:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630190649872384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:36:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630190649872384 [0;39m ==> Parameters: 
2022-08-18 23:36:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630190649872384 [0;39m <==    Updates: 0
2022-08-18 23:36:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630190649872384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:36:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17630190658260992 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:36:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630190658260992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:36:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630190658260992 [0;39m ==> Parameters: 
2022-08-18 23:36:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630190658260992 [0;39m <==    Updates: 7
2022-08-18 23:36:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17630190658260992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:36:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630211642363904 [0;39m 生成今日电子书快照开始
2022-08-18 23:36:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630211642363904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:36:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630211642363904 [0;39m ==> Parameters: 
2022-08-18 23:36:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630211642363904 [0;39m <==    Updates: 0
2022-08-18 23:36:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630211642363904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:36:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630232634855424 [0;39m 生成今日电子书快照开始
2022-08-18 23:36:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630232634855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:36:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630232634855424 [0;39m ==> Parameters: 
2022-08-18 23:36:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630232634855424 [0;39m <==    Updates: 0
2022-08-18 23:36:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630232634855424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:36:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630253585403904 [0;39m 生成今日电子书快照开始
2022-08-18 23:36:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630253585403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:36:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630253585403904 [0;39m ==> Parameters: 
2022-08-18 23:36:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630253585403904 [0;39m <==    Updates: 0
2022-08-18 23:36:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630253585403904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:36:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630274535952384 [0;39m 生成今日电子书快照开始
2022-08-18 23:36:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630274535952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:36:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630274535952384 [0;39m ==> Parameters: 
2022-08-18 23:36:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630274535952384 [0;39m <==    Updates: 0
2022-08-18 23:36:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630274535952384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:36:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630295494889472 [0;39m 生成今日电子书快照开始
2022-08-18 23:36:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630295494889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:36:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630295494889472 [0;39m ==> Parameters: 
2022-08-18 23:36:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630295494889472 [0;39m <==    Updates: 0
2022-08-18 23:36:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630295494889472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:36:35.000 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17630316462215168 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:36:35.000 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630316462215168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:36:35.000 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630316462215168 [0;39m ==> Parameters: 
2022-08-18 23:36:35.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630316462215168 [0;39m <==    Updates: 7
2022-08-18 23:36:35.001 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17630316462215168 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:36:35.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630316466409472 [0;39m 生成今日电子书快照开始
2022-08-18 23:36:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630316466409472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:36:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630316466409472 [0;39m ==> Parameters: 
2022-08-18 23:36:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630316466409472 [0;39m <==    Updates: 0
2022-08-18 23:36:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630316466409472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:36:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630337446318080 [0;39m 生成今日电子书快照开始
2022-08-18 23:36:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630337446318080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:36:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630337446318080 [0;39m ==> Parameters: 
2022-08-18 23:36:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630337446318080 [0;39m <==    Updates: 0
2022-08-18 23:36:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630337446318080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:36:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630358417838080 [0;39m 生成今日电子书快照开始
2022-08-18 23:36:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630358417838080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:36:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630358417838080 [0;39m ==> Parameters: 
2022-08-18 23:36:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630358417838080 [0;39m <==    Updates: 0
2022-08-18 23:36:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630358417838080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:36:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630379443884032 [0;39m 生成今日电子书快照开始
2022-08-18 23:36:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630379443884032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:36:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630379443884032 [0;39m ==> Parameters: 
2022-08-18 23:36:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630379443884032 [0;39m <==    Updates: 0
2022-08-18 23:36:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630379443884032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:36:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630400402821120 [0;39m 生成今日电子书快照开始
2022-08-18 23:36:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630400402821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:36:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630400402821120 [0;39m ==> Parameters: 
2022-08-18 23:36:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630400402821120 [0;39m <==    Updates: 0
2022-08-18 23:36:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630400402821120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:37:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630421353369600 [0;39m 生成今日电子书快照开始
2022-08-18 23:37:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630421353369600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:37:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630421353369600 [0;39m ==> Parameters: 
2022-08-18 23:37:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630421353369600 [0;39m <==    Updates: 0
2022-08-18 23:37:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630421353369600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:37:05.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17630442295529472 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:37:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630442295529472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:37:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630442295529472 [0;39m ==> Parameters: 
2022-08-18 23:37:05.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630442295529472 [0;39m <==    Updates: 7
2022-08-18 23:37:05.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17630442295529472 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:37:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630442303918080 [0;39m 生成今日电子书快照开始
2022-08-18 23:37:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630442303918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:37:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630442303918080 [0;39m ==> Parameters: 
2022-08-18 23:37:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630442303918080 [0;39m <==    Updates: 0
2022-08-18 23:37:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630442303918080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:37:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630463313186816 [0;39m 生成今日电子书快照开始
2022-08-18 23:37:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630463313186816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:37:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630463313186816 [0;39m ==> Parameters: 
2022-08-18 23:37:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630463313186816 [0;39m <==    Updates: 0
2022-08-18 23:37:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630463313186816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:37:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630484251152384 [0;39m 生成今日电子书快照开始
2022-08-18 23:37:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630484251152384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:37:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630484251152384 [0;39m ==> Parameters: 
2022-08-18 23:37:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630484251152384 [0;39m <==    Updates: 0
2022-08-18 23:37:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630484251152384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:37:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630505231060992 [0;39m 生成今日电子书快照开始
2022-08-18 23:37:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630505231060992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:37:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630505231060992 [0;39m ==> Parameters: 
2022-08-18 23:37:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630505231060992 [0;39m <==    Updates: 0
2022-08-18 23:37:20.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630505231060992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:37:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630526227746816 [0;39m 生成今日电子书快照开始
2022-08-18 23:37:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630526227746816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:37:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630526227746816 [0;39m ==> Parameters: 
2022-08-18 23:37:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630526227746816 [0;39m <==    Updates: 0
2022-08-18 23:37:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630526227746816 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:37:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630547157323776 [0;39m 生成今日电子书快照开始
2022-08-18 23:37:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630547157323776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:37:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630547157323776 [0;39m ==> Parameters: 
2022-08-18 23:37:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630547157323776 [0;39m <==    Updates: 0
2022-08-18 23:37:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630547157323776 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:37:35.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17630568149815296 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:37:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630568149815296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:37:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630568149815296 [0;39m ==> Parameters: 
2022-08-18 23:37:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630568149815296 [0;39m <==    Updates: 7
2022-08-18 23:37:35.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17630568149815296 [0;39m 更新电子书下的文档数据结束，耗时：6 毫秒
2022-08-18 23:37:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630568174981120 [0;39m 生成今日电子书快照开始
2022-08-18 23:37:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630568174981120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:37:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630568174981120 [0;39m ==> Parameters: 
2022-08-18 23:37:35.021 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630568174981120 [0;39m <==    Updates: 0
2022-08-18 23:37:35.022 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630568174981120 [0;39m 生成今日电子书快照结束，耗时：8 毫秒
2022-08-18 23:37:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630589125529600 [0;39m 生成今日电子书快照开始
2022-08-18 23:37:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630589125529600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:37:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630589125529600 [0;39m ==> Parameters: 
2022-08-18 23:37:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630589125529600 [0;39m <==    Updates: 0
2022-08-18 23:37:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630589125529600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:37:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630610080272384 [0;39m 生成今日电子书快照开始
2022-08-18 23:37:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630610080272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:37:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630610080272384 [0;39m ==> Parameters: 
2022-08-18 23:37:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630610080272384 [0;39m <==    Updates: 0
2022-08-18 23:37:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630610080272384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:37:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630631089541120 [0;39m 生成今日电子书快照开始
2022-08-18 23:37:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630631089541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:37:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630631089541120 [0;39m ==> Parameters: 
2022-08-18 23:37:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630631089541120 [0;39m <==    Updates: 0
2022-08-18 23:37:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630631089541120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:37:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630652014923776 [0;39m 生成今日电子书快照开始
2022-08-18 23:37:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630652014923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:37:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630652014923776 [0;39m ==> Parameters: 
2022-08-18 23:37:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630652014923776 [0;39m <==    Updates: 0
2022-08-18 23:37:55.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630652014923776 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:38:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630672986443776 [0;39m 生成今日电子书快照开始
2022-08-18 23:38:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630672986443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:38:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630672986443776 [0;39m ==> Parameters: 
2022-08-18 23:38:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630672986443776 [0;39m <==    Updates: 0
2022-08-18 23:38:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630672986443776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:38:05.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630693962158080 [0;39m 生成今日电子书快照开始
2022-08-18 23:38:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630693962158080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:38:05.110 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630693962158080 [0;39m ==> Parameters: 
2022-08-18 23:38:05.111 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630693962158080 [0;39m <==    Updates: 0
2022-08-18 23:38:05.111 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630693962158080 [0;39m 生成今日电子书快照结束，耗时：108 毫秒
2022-08-18 23:38:05.112 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17630694419337216 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:38:05.112 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630694419337216 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:38:05.112 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630694419337216 [0;39m ==> Parameters: 
2022-08-18 23:38:05.113 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630694419337216 [0;39m <==    Updates: 7
2022-08-18 23:38:05.113 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17630694419337216 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:38:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630714967232512 [0;39m 生成今日电子书快照开始
2022-08-18 23:38:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630714967232512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:38:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630714967232512 [0;39m ==> Parameters: 
2022-08-18 23:38:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630714967232512 [0;39m <==    Updates: 0
2022-08-18 23:38:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630714967232512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:38:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630735938752512 [0;39m 生成今日电子书快照开始
2022-08-18 23:38:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630735938752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:38:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630735938752512 [0;39m ==> Parameters: 
2022-08-18 23:38:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630735938752512 [0;39m <==    Updates: 0
2022-08-18 23:38:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630735938752512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:38:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630756876718080 [0;39m 生成今日电子书快照开始
2022-08-18 23:38:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630756876718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:38:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630756876718080 [0;39m ==> Parameters: 
2022-08-18 23:38:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630756876718080 [0;39m <==    Updates: 0
2022-08-18 23:38:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630756876718080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:38:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630777869209600 [0;39m 生成今日电子书快照开始
2022-08-18 23:38:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630777869209600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:38:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630777869209600 [0;39m ==> Parameters: 
2022-08-18 23:38:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630777869209600 [0;39m <==    Updates: 0
2022-08-18 23:38:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630777869209600 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:38:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630798857506816 [0;39m 生成今日电子书快照开始
2022-08-18 23:38:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630798857506816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:38:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630798857506816 [0;39m ==> Parameters: 
2022-08-18 23:38:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630798857506816 [0;39m <==    Updates: 0
2022-08-18 23:38:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630798857506816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:38:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17630819837415424 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:38:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630819837415424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:38:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630819837415424 [0;39m ==> Parameters: 
2022-08-18 23:38:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630819837415424 [0;39m <==    Updates: 7
2022-08-18 23:38:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17630819837415424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:38:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630819841609728 [0;39m 生成今日电子书快照开始
2022-08-18 23:38:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630819841609728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:38:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630819841609728 [0;39m ==> Parameters: 
2022-08-18 23:38:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630819841609728 [0;39m <==    Updates: 0
2022-08-18 23:38:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630819841609728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:38:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630840804741120 [0;39m 生成今日电子书快照开始
2022-08-18 23:38:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630840804741120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:38:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630840804741120 [0;39m ==> Parameters: 
2022-08-18 23:38:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630840804741120 [0;39m <==    Updates: 0
2022-08-18 23:38:40.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630840804741120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:38:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630861776261120 [0;39m 生成今日电子书快照开始
2022-08-18 23:38:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630861776261120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:38:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630861776261120 [0;39m ==> Parameters: 
2022-08-18 23:38:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630861776261120 [0;39m <==    Updates: 0
2022-08-18 23:38:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630861776261120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:38:50.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630882756169728 [0;39m 生成今日电子书快照开始
2022-08-18 23:38:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630882756169728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:38:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630882756169728 [0;39m ==> Parameters: 
2022-08-18 23:38:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630882756169728 [0;39m <==    Updates: 0
2022-08-18 23:38:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630882756169728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:38:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630903723495424 [0;39m 生成今日电子书快照开始
2022-08-18 23:38:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630903723495424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:38:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630903723495424 [0;39m ==> Parameters: 
2022-08-18 23:38:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630903723495424 [0;39m <==    Updates: 0
2022-08-18 23:38:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630903723495424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:39:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630924699209728 [0;39m 生成今日电子书快照开始
2022-08-18 23:39:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630924699209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:39:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630924699209728 [0;39m ==> Parameters: 
2022-08-18 23:39:00.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630924699209728 [0;39m <==    Updates: 0
2022-08-18 23:39:00.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630924699209728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:39:05.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17630945649758208 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:39:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630945649758208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:39:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630945649758208 [0;39m ==> Parameters: 
2022-08-18 23:39:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17630945649758208 [0;39m <==    Updates: 7
2022-08-18 23:39:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17630945649758208 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:39:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630945653952512 [0;39m 生成今日电子书快照开始
2022-08-18 23:39:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630945653952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:39:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630945653952512 [0;39m ==> Parameters: 
2022-08-18 23:39:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630945653952512 [0;39m <==    Updates: 0
2022-08-18 23:39:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630945653952512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:39:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630966638055424 [0;39m 生成今日电子书快照开始
2022-08-18 23:39:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630966638055424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:39:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630966638055424 [0;39m ==> Parameters: 
2022-08-18 23:39:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630966638055424 [0;39m <==    Updates: 0
2022-08-18 23:39:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630966638055424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:39:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17630987567632384 [0;39m 生成今日电子书快照开始
2022-08-18 23:39:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630987567632384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:39:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630987567632384 [0;39m ==> Parameters: 
2022-08-18 23:39:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17630987567632384 [0;39m <==    Updates: 0
2022-08-18 23:39:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17630987567632384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:39:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631008543346688 [0;39m 生成今日电子书快照开始
2022-08-18 23:39:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631008543346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:39:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631008543346688 [0;39m ==> Parameters: 
2022-08-18 23:39:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631008543346688 [0;39m <==    Updates: 0
2022-08-18 23:39:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631008543346688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:39:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631029535838208 [0;39m 生成今日电子书快照开始
2022-08-18 23:39:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631029535838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:39:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631029535838208 [0;39m ==> Parameters: 
2022-08-18 23:39:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631029535838208 [0;39m <==    Updates: 0
2022-08-18 23:39:25.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631029535838208 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-18 23:39:30.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631050477998080 [0;39m 生成今日电子书快照开始
2022-08-18 23:39:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631050477998080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:39:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631050477998080 [0;39m ==> Parameters: 
2022-08-18 23:39:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631050477998080 [0;39m <==    Updates: 0
2022-08-18 23:39:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631050477998080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:39:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631071478878208 [0;39m 生成今日电子书快照开始
2022-08-18 23:39:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631071478878208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:39:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631071478878208 [0;39m ==> Parameters: 
2022-08-18 23:39:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631071478878208 [0;39m <==    Updates: 0
2022-08-18 23:39:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631071478878208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:39:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17631071491461120 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:39:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631071491461120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:39:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631071491461120 [0;39m ==> Parameters: 
2022-08-18 23:39:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631071491461120 [0;39m <==    Updates: 7
2022-08-18 23:39:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17631071491461120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:39:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631092437815296 [0;39m 生成今日电子书快照开始
2022-08-18 23:39:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631092437815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:39:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631092437815296 [0;39m ==> Parameters: 
2022-08-18 23:39:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631092437815296 [0;39m <==    Updates: 0
2022-08-18 23:39:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631092437815296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:39:45.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631113384169472 [0;39m 生成今日电子书快照开始
2022-08-18 23:39:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631113384169472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:39:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631113384169472 [0;39m ==> Parameters: 
2022-08-18 23:39:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631113384169472 [0;39m <==    Updates: 0
2022-08-18 23:39:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631113384169472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:39:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631134380855296 [0;39m 生成今日电子书快照开始
2022-08-18 23:39:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631134380855296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:39:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631134380855296 [0;39m ==> Parameters: 
2022-08-18 23:39:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631134380855296 [0;39m <==    Updates: 0
2022-08-18 23:39:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631134380855296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:39:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631155364958208 [0;39m 生成今日电子书快照开始
2022-08-18 23:39:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631155364958208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:39:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631155364958208 [0;39m ==> Parameters: 
2022-08-18 23:39:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631155364958208 [0;39m <==    Updates: 0
2022-08-18 23:39:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631155364958208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:40:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631176332283904 [0;39m 生成今日电子书快照开始
2022-08-18 23:40:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631176332283904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:40:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631176332283904 [0;39m ==> Parameters: 
2022-08-18 23:40:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631176332283904 [0;39m <==    Updates: 0
2022-08-18 23:40:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631176332283904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:40:05.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17631197270249472 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:40:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631197270249472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:40:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631197270249472 [0;39m ==> Parameters: 
2022-08-18 23:40:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631197270249472 [0;39m <==    Updates: 7
2022-08-18 23:40:05.002 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17631197270249472 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:40:05.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631197274443776 [0;39m 生成今日电子书快照开始
2022-08-18 23:40:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631197274443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:40:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631197274443776 [0;39m ==> Parameters: 
2022-08-18 23:40:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631197274443776 [0;39m <==    Updates: 0
2022-08-18 23:40:05.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631197274443776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:40:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631218287906816 [0;39m 生成今日电子书快照开始
2022-08-18 23:40:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631218287906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:40:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631218287906816 [0;39m ==> Parameters: 
2022-08-18 23:40:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631218287906816 [0;39m <==    Updates: 0
2022-08-18 23:40:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631218287906816 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:40:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631239230066688 [0;39m 生成今日电子书快照开始
2022-08-18 23:40:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631239230066688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:40:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631239230066688 [0;39m ==> Parameters: 
2022-08-18 23:40:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631239230066688 [0;39m <==    Updates: 0
2022-08-18 23:40:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631239230066688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:40:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631260222558208 [0;39m 生成今日电子书快照开始
2022-08-18 23:40:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631260222558208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:40:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631260222558208 [0;39m ==> Parameters: 
2022-08-18 23:40:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631260222558208 [0;39m <==    Updates: 0
2022-08-18 23:40:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631260222558208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:40:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631281173106688 [0;39m 生成今日电子书快照开始
2022-08-18 23:40:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631281173106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:40:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631281173106688 [0;39m ==> Parameters: 
2022-08-18 23:40:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631281173106688 [0;39m <==    Updates: 0
2022-08-18 23:40:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631281173106688 [0;39m 生成今日电子书快照结束，耗时：9 毫秒
2022-08-18 23:40:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631302190764032 [0;39m 生成今日电子书快照开始
2022-08-18 23:40:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631302190764032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:40:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631302190764032 [0;39m ==> Parameters: 
2022-08-18 23:40:30.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631302190764032 [0;39m <==    Updates: 0
2022-08-18 23:40:30.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631302190764032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:40:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631323124535296 [0;39m 生成今日电子书快照开始
2022-08-18 23:40:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631323124535296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:40:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631323124535296 [0;39m ==> Parameters: 
2022-08-18 23:40:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631323124535296 [0;39m <==    Updates: 0
2022-08-18 23:40:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631323124535296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:40:35.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17631323132923904 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:40:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631323132923904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:40:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631323132923904 [0;39m ==> Parameters: 
2022-08-18 23:40:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631323132923904 [0;39m <==    Updates: 7
2022-08-18 23:40:35.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17631323132923904 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:40:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631344091860992 [0;39m 生成今日电子书快照开始
2022-08-18 23:40:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631344091860992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:40:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631344091860992 [0;39m ==> Parameters: 
2022-08-18 23:40:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631344091860992 [0;39m <==    Updates: 0
2022-08-18 23:40:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631344091860992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:40:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631365059186688 [0;39m 生成今日电子书快照开始
2022-08-18 23:40:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631365059186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:40:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631365059186688 [0;39m ==> Parameters: 
2022-08-18 23:40:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631365059186688 [0;39m <==    Updates: 0
2022-08-18 23:40:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631365059186688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:40:50.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631386034900992 [0;39m 生成今日电子书快照开始
2022-08-18 23:40:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631386034900992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:40:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631386034900992 [0;39m ==> Parameters: 
2022-08-18 23:40:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631386034900992 [0;39m <==    Updates: 0
2022-08-18 23:40:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631386034900992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:40:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631407014809600 [0;39m 生成今日电子书快照开始
2022-08-18 23:40:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631407014809600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:40:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631407014809600 [0;39m ==> Parameters: 
2022-08-18 23:40:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631407014809600 [0;39m <==    Updates: 0
2022-08-18 23:40:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631407014809600 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:41:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631428011495424 [0;39m 生成今日电子书快照开始
2022-08-18 23:41:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631428011495424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:41:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631428011495424 [0;39m ==> Parameters: 
2022-08-18 23:41:00.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631428011495424 [0;39m <==    Updates: 0
2022-08-18 23:41:00.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631428011495424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:41:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17631448991404032 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:41:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631448991404032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:41:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631448991404032 [0;39m ==> Parameters: 
2022-08-18 23:41:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631448991404032 [0;39m <==    Updates: 7
2022-08-18 23:41:05.017 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17631448991404032 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:41:05.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631448999792640 [0;39m 生成今日电子书快照开始
2022-08-18 23:41:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631448999792640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:41:05.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631448999792640 [0;39m ==> Parameters: 
2022-08-18 23:41:05.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631448999792640 [0;39m <==    Updates: 0
2022-08-18 23:41:05.021 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631448999792640 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:41:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631469954535424 [0;39m 生成今日电子书快照开始
2022-08-18 23:41:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631469954535424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:41:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631469954535424 [0;39m ==> Parameters: 
2022-08-18 23:41:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631469954535424 [0;39m <==    Updates: 0
2022-08-18 23:41:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631469954535424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:41:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631490921861120 [0;39m 生成今日电子书快照开始
2022-08-18 23:41:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631490921861120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:41:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631490921861120 [0;39m ==> Parameters: 
2022-08-18 23:41:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631490921861120 [0;39m <==    Updates: 0
2022-08-18 23:41:15.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631490921861120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:41:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631511872409600 [0;39m 生成今日电子书快照开始
2022-08-18 23:41:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631511872409600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:41:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631511872409600 [0;39m ==> Parameters: 
2022-08-18 23:41:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631511872409600 [0;39m <==    Updates: 0
2022-08-18 23:41:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631511872409600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:41:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631532831346688 [0;39m 生成今日电子书快照开始
2022-08-18 23:41:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631532831346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:41:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631532831346688 [0;39m ==> Parameters: 
2022-08-18 23:41:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631532831346688 [0;39m <==    Updates: 0
2022-08-18 23:41:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631532831346688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:41:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631553790283776 [0;39m 生成今日电子书快照开始
2022-08-18 23:41:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631553790283776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:41:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631553790283776 [0;39m ==> Parameters: 
2022-08-18 23:41:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631553790283776 [0;39m <==    Updates: 0
2022-08-18 23:41:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631553790283776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:41:35.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17631574761803776 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:41:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631574761803776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:41:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631574761803776 [0;39m ==> Parameters: 
2022-08-18 23:41:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631574761803776 [0;39m <==    Updates: 7
2022-08-18 23:41:35.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17631574761803776 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:41:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631574765998080 [0;39m 生成今日电子书快照开始
2022-08-18 23:41:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631574765998080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:41:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631574765998080 [0;39m ==> Parameters: 
2022-08-18 23:41:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631574765998080 [0;39m <==    Updates: 0
2022-08-18 23:41:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631574765998080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:41:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631595771072512 [0;39m 生成今日电子书快照开始
2022-08-18 23:41:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631595771072512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:41:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631595771072512 [0;39m ==> Parameters: 
2022-08-18 23:41:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631595771072512 [0;39m <==    Updates: 0
2022-08-18 23:41:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631595771072512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:41:45.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631616721620992 [0;39m 生成今日电子书快照开始
2022-08-18 23:41:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631616721620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:41:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631616721620992 [0;39m ==> Parameters: 
2022-08-18 23:41:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631616721620992 [0;39m <==    Updates: 0
2022-08-18 23:41:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631616721620992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:41:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631637714112512 [0;39m 生成今日电子书快照开始
2022-08-18 23:41:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631637714112512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:41:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631637714112512 [0;39m ==> Parameters: 
2022-08-18 23:41:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631637714112512 [0;39m <==    Updates: 0
2022-08-18 23:41:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631637714112512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:41:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631658673049600 [0;39m 生成今日电子书快照开始
2022-08-18 23:41:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631658673049600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:41:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631658673049600 [0;39m ==> Parameters: 
2022-08-18 23:41:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631658673049600 [0;39m <==    Updates: 0
2022-08-18 23:41:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631658673049600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:42:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631679648763904 [0;39m 生成今日电子书快照开始
2022-08-18 23:42:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631679648763904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:42:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631679648763904 [0;39m ==> Parameters: 
2022-08-18 23:42:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631679648763904 [0;39m <==    Updates: 0
2022-08-18 23:42:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631679648763904 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:42:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631700641255424 [0;39m 生成今日电子书快照开始
2022-08-18 23:42:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631700641255424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:42:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631700641255424 [0;39m ==> Parameters: 
2022-08-18 23:42:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631700641255424 [0;39m <==    Updates: 0
2022-08-18 23:42:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631700641255424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:42:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17631700649644032 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:42:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631700649644032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:42:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631700649644032 [0;39m ==> Parameters: 
2022-08-18 23:42:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631700649644032 [0;39m <==    Updates: 7
2022-08-18 23:42:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17631700649644032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:42:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631721600192512 [0;39m 生成今日电子书快照开始
2022-08-18 23:42:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631721600192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:42:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631721600192512 [0;39m ==> Parameters: 
2022-08-18 23:42:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631721600192512 [0;39m <==    Updates: 0
2022-08-18 23:42:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631721600192512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:42:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631742542352384 [0;39m 生成今日电子书快照开始
2022-08-18 23:42:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631742542352384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:42:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631742542352384 [0;39m ==> Parameters: 
2022-08-18 23:42:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631742542352384 [0;39m <==    Updates: 0
2022-08-18 23:42:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631742542352384 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-18 23:42:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631763551621120 [0;39m 生成今日电子书快照开始
2022-08-18 23:42:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631763551621120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:42:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631763551621120 [0;39m ==> Parameters: 
2022-08-18 23:42:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631763551621120 [0;39m <==    Updates: 0
2022-08-18 23:42:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631763551621120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:42:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631784485392384 [0;39m 生成今日电子书快照开始
2022-08-18 23:42:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631784485392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:42:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631784485392384 [0;39m ==> Parameters: 
2022-08-18 23:42:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631784485392384 [0;39m <==    Updates: 0
2022-08-18 23:42:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631784485392384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:42:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631805477883904 [0;39m 生成今日电子书快照开始
2022-08-18 23:42:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631805477883904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:42:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631805477883904 [0;39m ==> Parameters: 
2022-08-18 23:42:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631805477883904 [0;39m <==    Updates: 0
2022-08-18 23:42:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631805477883904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:42:35.010 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17631826453598208 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:42:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631826453598208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:42:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631826453598208 [0;39m ==> Parameters: 
2022-08-18 23:42:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631826453598208 [0;39m <==    Updates: 7
2022-08-18 23:42:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17631826453598208 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-18 23:42:35.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631826470375424 [0;39m 生成今日电子书快照开始
2022-08-18 23:42:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631826470375424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:42:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631826470375424 [0;39m ==> Parameters: 
2022-08-18 23:42:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631826470375424 [0;39m <==    Updates: 0
2022-08-18 23:42:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631826470375424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:42:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631847450284032 [0;39m 生成今日电子书快照开始
2022-08-18 23:42:40.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631847450284032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:42:40.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631847450284032 [0;39m ==> Parameters: 
2022-08-18 23:42:40.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631847450284032 [0;39m <==    Updates: 0
2022-08-18 23:42:40.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631847450284032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:42:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631868388249600 [0;39m 生成今日电子书快照开始
2022-08-18 23:42:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631868388249600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:42:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631868388249600 [0;39m ==> Parameters: 
2022-08-18 23:42:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631868388249600 [0;39m <==    Updates: 0
2022-08-18 23:42:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631868388249600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:42:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631889384935424 [0;39m 生成今日电子书快照开始
2022-08-18 23:42:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631889384935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:42:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631889384935424 [0;39m ==> Parameters: 
2022-08-18 23:42:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631889384935424 [0;39m <==    Updates: 0
2022-08-18 23:42:50.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631889384935424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:42:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631910318706688 [0;39m 生成今日电子书快照开始
2022-08-18 23:42:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631910318706688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:42:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631910318706688 [0;39m ==> Parameters: 
2022-08-18 23:42:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631910318706688 [0;39m <==    Updates: 0
2022-08-18 23:42:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631910318706688 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:42:57.699 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m17615248391540736 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-18 23:42:57.699 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m17615248391540736 [0;39m ------------- LoginInterceptor 结束 耗时：0 ms -------------
2022-08-18 23:42:57.706 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :32  
                [32m17619065900240896 [0;39m ------------- LoginInterceptor 开始 -------------
2022-08-18 23:42:57.707 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :43  
                [32m17619065900240896 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/doc/save
2022-08-18 23:42:57.707 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :47  
                [32m17619065900240896 [0;39m 登录校验开始，token：17610697500397568
2022-08-18 23:42:57.745 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :59  
                [32m17619065900240896 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"17610697500397568"}
2022-08-18 23:42:57.748 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17631921823682560 [0;39m ------------- 开始 -------------
2022-08-18 23:42:57.748 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17631921823682560 [0;39m 请求地址: http://127.0.0.1:8880/doc/save POST
2022-08-18 23:42:57.748 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17631921823682560 [0;39m 类名方法: com.zs.wikibb.controller.DocController.save
2022-08-18 23:42:57.749 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17631921823682560 [0;39m 远程地址: 127.0.0.1
2022-08-18 23:42:57.749 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17631921823682560 [0;39m 请求参数: [{"content":"<blockquote><h2 id=\"fii37\">密码加密存储和传输（MDS）<br><font face=\"宋体\"><font size=\"3\">&nbsp;</font><b style=\"\"><font size=\"4\">传输加密： </font></b><font size=\"3\">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size=\"3\" face=\"Times New Roman\"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）\n</b></font>&nbsp;&nbsp;<font face=\"宋体\" style=\"\"><b style=\"font-size: large;\">存储加密：</b><font size=\"3\">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size=\"3\"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id=\"90d5d\">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id=\"9l5yg\">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face=\"Times New Roman\" size=\"3\"><font color=\"#c24f4a\">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id=\"rckur\">单点登录token与JWT介绍</h2><h3 id=\"o9527\"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size=\"3\">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size=\"3\">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size=\"3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size=\"3\">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size=\"3\">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录。</font><b><br></b></div><div>&nbsp; &nbsp;<font size=\"3\"> X：用户管理、登录、登录校验、退出登录（X有可能只是接口也可以是页面）。<br></font></div><div><h2><b>token与JWT：</b></h2></div><h3><font size=\"3\">&nbsp; &nbsp;<b id=\"8bsf3\"> </b>token+redis：</font><b style=\"font-size: 1.17em;\">token是无意义的</b></h3><h3 id=\"cmxl6\">&nbsp; &nbsp; <b>JWT:token是有意义的，加密的，包含业务信息，一般是用户信息，无需存放在redis中可查看<font color=\"#000000\">&nbsp;</font></b><font face=\"仿宋\" style=\"\"><i style=\"background-color: rgb(249, 150, 59);\"><font color=\"#000000\">jwt.io</font></i><font color=\"#1c487f\">&nbsp;</font></font></h3><div><pre> <font size=\"3\">  &lt;dependency&gt;<br>      &lt;groupId&gt;com.auth0&lt;/groupId&gt;<br>      &lt;artifactId&gt;java-jwt&lt;/artifactId&gt;<br>      &lt;version&gt;3.5.0&lt;/version&gt;<br>  &lt;/dependency&gt;  </font></pre><pre><font size=\"3\">  <i>JwtUtil.sign 加密\n  JwtUtil.verity 校验</i></font></pre><pre><font size=\"3\"></font></pre></div></blockquote><blockquote><h2 id=\"nc8qk\">登录成功处理</h2><div><h3 id=\"iths3\">&nbsp; 1.&nbsp; 后端保存用户信息</h3>&nbsp; <font size=\"3\">&nbsp; &nbsp;集成redis（pom文件集成+controlle层注入工具类）<br>&nbsp; &nbsp; &nbsp;登录成功后，生成token，以token为key，以用户信息为value，放入redis中</font></div><div><h3>&nbsp; 2.&nbsp; 前端显示登录用户</h3><br></div></blockquote>","ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1}]
2022-08-18 23:42:57.750 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17631921823682560 [0;39m ==>  Preparing: update doc set ebook_id = ?, parent = ?, `name` = ?, sort = ?, view_count = ?, vote_count = ? where id = ?
2022-08-18 23:42:57.751 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17631921823682560 [0;39m ==> Parameters: 202714600712572928(Long), 0(Long), 用户管理功能开发(String), 9(Integer), 9(Integer), 1(Integer), 202715583089872896(Long)
2022-08-18 23:42:57.758 DEBUG com.zs.wikibb.mapper.DocMapper.updateByPrimaryKey :137 
                [32m17631921823682560 [0;39m <==    Updates: 1
2022-08-18 23:42:57.759 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17631921823682560 [0;39m ==>  Preparing: update content set content = ? where id = ?
2022-08-18 23:42:57.759 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17631921823682560 [0;39m ==> Parameters: <blockquote><h2 id="fii37">密码加密存储和传输（MDS）<br><font face="宋体"><font size="3">&nbsp;</font><b style=""><font size="4">传输加密： </font></b><font size="3">前端为了防止在控制台获取密码实际值，可以在前端页面引入MD5.js文件让其密码也进行16进制加密</font><br></font><pre><font size="3" face="Times New Roman"><b>    userwiki.value.password=hexMd5(userwiki.value.password+KEY);  （KEY指的是非固定的盐值，因为16进制加密也属于固定值，防止泄露）
</b></font>&nbsp;&nbsp;<font face="宋体" style=""><b style="font-size: large;">存储加密：</b><font size="3">在Controller层调用MD5函数使其密码进行加密凑操作</font></font></pre><pre><font size="3"> //密码加密<br>   userwikiSaveReq.setPassword(DigestUtils.md5DigestAsHex(userwikiSaveReq.getPassword().getBytes()));</font></pre></h2><h2 id="90d5d">自定义异常处理(BusinessException)比如说抛出用户名已存在</h2></blockquote><blockquote><h2 id="9l5yg">自定义异常：BusinessExceptinon+BusinessExceptionCode</h2><div><pre><font face="Times New Roman" size="3"><font color="#c24f4a">代码示例（用户名已存在时）：</font>throw new BusinessException(BusinessExceptionCode.LOGIN_USER_ERROR);</font></pre></div></blockquote><blockquote><h2 id="rckur">单点登录token与JWT介绍</h2><h3 id="o9527"><b>登录：</b></h3><div>&nbsp; &nbsp; <font size="3">&nbsp; &nbsp; 1. 前端输入用户名密码</font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 校验用户名密码<br></font></div><div><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 生成登录标识（相当于一个令牌证明登录过了，就是token，就是一串唯一的字符串）</font><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<font size="3">4. 前、后端保存token（redis）</font></div><div><h3><b>校验：</b></h3></div><div><p>&nbsp;&nbsp;&nbsp;<font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 前端请求时，带上token（一般就管理类的接口比如增删改需要登录校验，放在header中）</font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 2. 登录拦截器，校验token（到redis中获取token）<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 3. 校验成功则继续后面的业务<br></font></p><p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; 4. 校验失败则 回到登录页面</font></p><h2><b>单点登录系统：</b></h2></div><div>&nbsp; <font size="3">&nbsp; 只需在登录系统X中登录成功一次以后后面的系统需要登录的都无需登录。</font><b><br></b></div><div>&nbsp; &nbsp;<font size="3"> X：用户管理、登录、登录校验、退出登录（X有可能只是接口也可以是页面）。<br></font></div><div><h2><b>token与JWT：</b></h2></div><h3><font size="3">&nbsp; &nbsp;<b id="8bsf3"> </b>token+redis：</font><b style="font-size: 1.17em;">token是无意义的</b></h3><h3 id="cmxl6">&nbsp; &nbsp; <b>JWT:token是有意义的，加密的，包含业务信息，一般是用户信息，无需存放在redis中可查看<font color="#000000">&nbsp;</font></b><font face="仿宋" style=""><i style="background-color: rgb(249, 150, 59);"><font color="#000000">jwt.io</font></i><font color="#1c487f">&nbsp;</font></font></h3><div><pre> <font size="3">  &lt;dependency&gt;<br>      &lt;groupId&gt;com.auth0&lt;/groupId&gt;<br>      &lt;artifactId&gt;java-jwt&lt;/artifactId&gt;<br>      &lt;version&gt;3.5.0&lt;/version&gt;<br>  &lt;/dependency&gt;  </font></pre><pre><font size="3">  <i>JwtUtil.sign 加密
  JwtUtil.verity 校验</i></font></pre><pre><font size="3"></font></pre></div></blockquote><blockquote><h2 id="nc8qk">登录成功处理</h2><div><h3 id="iths3">&nbsp; 1.&nbsp; 后端保存用户信息</h3>&nbsp; <font size="3">&nbsp; &nbsp;集成redis（pom文件集成+controlle层注入工具类）<br>&nbsp; &nbsp; &nbsp;登录成功后，生成token，以token为key，以用户信息为value，放入redis中</font></div><div><h3>&nbsp; 2.&nbsp; 前端显示登录用户</h3><br></div></blockquote>(String), 202715583089872896(Long)
2022-08-18 23:42:57.761 DEBUG c.z.w.m.ContentMapper.updateByPrimaryKeyWithBLOBs :137 
                [32m17631921823682560 [0;39m <==    Updates: 1
2022-08-18 23:42:57.830 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17631921823682560 [0;39m 返回结果: {"success":true}
2022-08-18 23:42:57.830 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17631921823682560 [0;39m ------------- 结束 耗时：82 ms -------------
2022-08-18 23:42:57.831 INFO  com.zs.wikibb.interceptor.LoginInterceptor        :68  
                [32m17631921823682560 [0;39m ------------- LoginInterceptor 结束 耗时：124 ms -------------
2022-08-18 23:42:57.846 INFO  com.zs.wikibb.aspect.LogAspect                    :52  
                [32m17631922234724352 [0;39m ------------- 开始 -------------
2022-08-18 23:42:57.847 INFO  com.zs.wikibb.aspect.LogAspect                    :53  
                [32m17631922234724352 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/202714600712572928 GET
2022-08-18 23:42:57.847 INFO  com.zs.wikibb.aspect.LogAspect                    :54  
                [32m17631922234724352 [0;39m 类名方法: com.zs.wikibb.controller.DocController.all
2022-08-18 23:42:57.847 INFO  com.zs.wikibb.aspect.LogAspect                    :55  
                [32m17631922234724352 [0;39m 远程地址: 127.0.0.1
2022-08-18 23:42:57.847 INFO  com.zs.wikibb.aspect.LogAspect                    :76  
                [32m17631922234724352 [0;39m 请求参数: [202714600712572928]
2022-08-18 23:42:57.848 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17631922234724352 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-08-18 23:42:57.849 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17631922234724352 [0;39m ==> Parameters: 202714600712572928(Long)
2022-08-18 23:42:57.851 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17631922234724352 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-08-18 23:42:57.851 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17631922234724352 [0;39m <==        Row: 202714909656616960, 202714600712572928, 0, 课程导学, 1, 48, 5
2022-08-18 23:42:57.852 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17631922234724352 [0;39m <==        Row: 202715069841281024, 202714600712572928, 0, Spring Boot项目搭建, 2, 42, 4
2022-08-18 23:42:57.853 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17631922234724352 [0;39m <==        Row: 202715172312322048, 202714600712572928, 0, 后端架构完善与接口开发, 3, 33, 3
2022-08-18 23:42:57.854 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17631922234724352 [0;39m <==        Row: 202715279778779136, 202714600712572928, 0, Vue 3+ Vue CLI 项目搭建, 4, 22, 3
2022-08-18 23:42:57.854 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17631922234724352 [0;39m <==        Row: 202715322204164096, 202714600712572928, 0, 前后端交互融合, 5, 26, 5
2022-08-18 23:42:57.855 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17631922234724352 [0;39m <==        Row: 202715412436226048, 202714600712572928, 0, 电子书管理功能开发, 6, 25, 2
2022-08-18 23:42:57.856 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17631922234724352 [0;39m <==        Row: 202715466249146368, 202714600712572928, 0, 分类管理功能开发, 7, 10, 2
2022-08-18 23:42:57.857 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17631922234724352 [0;39m <==        Row: 202715537334210560, 202714600712572928, 0, 文档管理功能开发, 8, 11, 3
2022-08-18 23:42:57.857 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17631922234724352 [0;39m <==        Row: 202715583089872896, 202714600712572928, 0, 用户管理功能开发, 9, 9, 1
2022-08-18 23:42:57.858 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17631922234724352 [0;39m <==        Row: 202715650781745152, 202714600712572928, 0, 阅读量&点赞量, 10, 7, 1
2022-08-18 23:42:57.859 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17631922234724352 [0;39m <==        Row: 202715693119049728, 202714600712572928, 0, 知识库功能开发, 11, 4, 1
2022-08-18 23:42:57.859 TRACE com.zs.wikibb.mapper.DocMapper.selectByExample    :143 
                [32m17631922234724352 [0;39m <==        Row: 202715863143550976, 202714600712572928, 0, 项目部署发布, 12, 3, 2
2022-08-18 23:42:57.860 DEBUG com.zs.wikibb.mapper.DocMapper.selectByExample    :137 
                [32m17631922234724352 [0;39m <==      Total: 12
2022-08-18 23:42:57.862 INFO  com.zs.wikibb.aspect.LogAspect                    :88  
                [32m17631922234724352 [0;39m 返回结果: {"content":[{"ebookId":202714600712572928,"id":202714909656616960,"name":"课程导学","parent":0,"sort":1,"viewCount":48,"voteCount":5},{"ebookId":202714600712572928,"id":202715069841281024,"name":"Spring Boot项目搭建","parent":0,"sort":2,"viewCount":42,"voteCount":4},{"ebookId":202714600712572928,"id":202715172312322048,"name":"后端架构完善与接口开发","parent":0,"sort":3,"viewCount":33,"voteCount":3},{"ebookId":202714600712572928,"id":202715279778779136,"name":"Vue 3+ Vue CLI 项目搭建","parent":0,"sort":4,"viewCount":22,"voteCount":3},{"ebookId":202714600712572928,"id":202715322204164096,"name":"前后端交互融合","parent":0,"sort":5,"viewCount":26,"voteCount":5},{"ebookId":202714600712572928,"id":202715412436226048,"name":"电子书管理功能开发","parent":0,"sort":6,"viewCount":25,"voteCount":2},{"ebookId":202714600712572928,"id":202715466249146368,"name":"分类管理功能开发","parent":0,"sort":7,"viewCount":10,"voteCount":2},{"ebookId":202714600712572928,"id":202715537334210560,"name":"文档管理功能开发","parent":0,"sort":8,"viewCount":11,"voteCount":3},{"ebookId":202714600712572928,"id":202715583089872896,"name":"用户管理功能开发","parent":0,"sort":9,"viewCount":9,"voteCount":1},{"ebookId":202714600712572928,"id":202715650781745152,"name":"阅读量&点赞量","parent":0,"sort":10,"viewCount":7,"voteCount":1},{"ebookId":202714600712572928,"id":202715693119049728,"name":"知识库功能开发","parent":0,"sort":11,"viewCount":4,"voteCount":1},{"ebookId":202714600712572928,"id":202715863143550976,"name":"项目部署发布","parent":0,"sort":12,"viewCount":3,"voteCount":2}],"success":true}
2022-08-18 23:42:57.862 INFO  com.zs.wikibb.aspect.LogAspect                    :89  
                [32m17631922234724352 [0;39m ------------- 结束 耗时：16 ms -------------
2022-08-18 23:43:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631931286032384 [0;39m 生成今日电子书快照开始
2022-08-18 23:43:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631931286032384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:43:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631931286032384 [0;39m ==> Parameters: 
2022-08-18 23:43:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631931286032384 [0;39m <==    Updates: 0
2022-08-18 23:43:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631931286032384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:43:05.001 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17631952244969472 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:43:05.001 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631952244969472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:43:05.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631952244969472 [0;39m ==> Parameters: 
2022-08-18 23:43:05.053 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17631952244969472 [0;39m <==    Updates: 7
2022-08-18 23:43:05.054 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17631952244969472 [0;39m 更新电子书下的文档数据结束，耗时：53 毫秒
2022-08-18 23:43:05.054 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631952467267584 [0;39m 生成今日电子书快照开始
2022-08-18 23:43:05.054 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631952467267584 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:43:05.054 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631952467267584 [0;39m ==> Parameters: 
2022-08-18 23:43:05.085 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631952467267584 [0;39m <==    Updates: 0
2022-08-18 23:43:05.086 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631952467267584 [0;39m 生成今日电子书快照结束，耗时：32 毫秒
2022-08-18 23:43:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631973229072384 [0;39m 生成今日电子书快照开始
2022-08-18 23:43:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631973229072384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:43:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631973229072384 [0;39m ==> Parameters: 
2022-08-18 23:43:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631973229072384 [0;39m <==    Updates: 0
2022-08-18 23:43:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631973229072384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:43:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17631994208980992 [0;39m 生成今日电子书快照开始
2022-08-18 23:43:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631994208980992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:43:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631994208980992 [0;39m ==> Parameters: 
2022-08-18 23:43:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17631994208980992 [0;39m <==    Updates: 0
2022-08-18 23:43:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17631994208980992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:43:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632015222444032 [0;39m 生成今日电子书快照开始
2022-08-18 23:43:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632015222444032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:43:20.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632015222444032 [0;39m ==> Parameters: 
2022-08-18 23:43:20.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632015222444032 [0;39m <==    Updates: 0
2022-08-18 23:43:20.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632015222444032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:43:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632036177186816 [0;39m 生成今日电子书快照开始
2022-08-18 23:43:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632036177186816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:43:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632036177186816 [0;39m ==> Parameters: 
2022-08-18 23:43:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632036177186816 [0;39m <==    Updates: 0
2022-08-18 23:43:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632036177186816 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:43:30.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632057119346688 [0;39m 生成今日电子书快照开始
2022-08-18 23:43:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632057119346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:43:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632057119346688 [0;39m ==> Parameters: 
2022-08-18 23:43:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632057119346688 [0;39m <==    Updates: 0
2022-08-18 23:43:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632057119346688 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:43:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632078086672384 [0;39m 生成今日电子书快照开始
2022-08-18 23:43:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632078086672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:43:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632078086672384 [0;39m ==> Parameters: 
2022-08-18 23:43:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632078086672384 [0;39m <==    Updates: 0
2022-08-18 23:43:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632078086672384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:43:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17632078103449600 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:43:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632078103449600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:43:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632078103449600 [0;39m ==> Parameters: 
2022-08-18 23:43:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632078103449600 [0;39m <==    Updates: 7
2022-08-18 23:43:35.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17632078103449600 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:43:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632099070775296 [0;39m 生成今日电子书快照开始
2022-08-18 23:43:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632099070775296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:43:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632099070775296 [0;39m ==> Parameters: 
2022-08-18 23:43:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632099070775296 [0;39m <==    Updates: 0
2022-08-18 23:43:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632099070775296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:43:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632120021323776 [0;39m 生成今日电子书快照开始
2022-08-18 23:43:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632120021323776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:43:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632120021323776 [0;39m ==> Parameters: 
2022-08-18 23:43:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632120021323776 [0;39m <==    Updates: 0
2022-08-18 23:43:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632120021323776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:43:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632141051564032 [0;39m 生成今日电子书快照开始
2022-08-18 23:43:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632141051564032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:43:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632141051564032 [0;39m ==> Parameters: 
2022-08-18 23:43:50.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632141051564032 [0;39m <==    Updates: 0
2022-08-18 23:43:50.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632141051564032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:43:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632162002112512 [0;39m 生成今日电子书快照开始
2022-08-18 23:43:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632162002112512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:43:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632162002112512 [0;39m ==> Parameters: 
2022-08-18 23:43:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632162002112512 [0;39m <==    Updates: 0
2022-08-18 23:43:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632162002112512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:44:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632182973632512 [0;39m 生成今日电子书快照开始
2022-08-18 23:44:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632182973632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:44:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632182973632512 [0;39m ==> Parameters: 
2022-08-18 23:44:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632182973632512 [0;39m <==    Updates: 0
2022-08-18 23:44:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632182973632512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:44:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17632203928375296 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:44:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632203928375296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:44:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632203928375296 [0;39m ==> Parameters: 
2022-08-18 23:44:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632203928375296 [0;39m <==    Updates: 7
2022-08-18 23:44:05.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17632203928375296 [0;39m 更新电子书下的文档数据结束，耗时：3 毫秒
2022-08-18 23:44:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632203940958208 [0;39m 生成今日电子书快照开始
2022-08-18 23:44:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632203940958208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:44:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632203940958208 [0;39m ==> Parameters: 
2022-08-18 23:44:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632203940958208 [0;39m <==    Updates: 0
2022-08-18 23:44:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632203940958208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:44:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632224887312384 [0;39m 生成今日电子书快照开始
2022-08-18 23:44:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632224887312384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:44:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632224887312384 [0;39m ==> Parameters: 
2022-08-18 23:44:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632224887312384 [0;39m <==    Updates: 0
2022-08-18 23:44:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632224887312384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:44:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632245854638080 [0;39m 生成今日电子书快照开始
2022-08-18 23:44:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632245854638080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:44:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632245854638080 [0;39m ==> Parameters: 
2022-08-18 23:44:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632245854638080 [0;39m <==    Updates: 0
2022-08-18 23:44:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632245854638080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:44:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632266855518208 [0;39m 生成今日电子书快照开始
2022-08-18 23:44:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632266855518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:44:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632266855518208 [0;39m ==> Parameters: 
2022-08-18 23:44:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632266855518208 [0;39m <==    Updates: 0
2022-08-18 23:44:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632266855518208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:44:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632287843815424 [0;39m 生成今日电子书快照开始
2022-08-18 23:44:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632287843815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:44:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632287843815424 [0;39m ==> Parameters: 
2022-08-18 23:44:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632287843815424 [0;39m <==    Updates: 0
2022-08-18 23:44:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632287843815424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:44:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632308806946816 [0;39m 生成今日电子书快照开始
2022-08-18 23:44:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632308806946816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:44:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632308806946816 [0;39m ==> Parameters: 
2022-08-18 23:44:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632308806946816 [0;39m <==    Updates: 0
2022-08-18 23:44:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632308806946816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:44:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632329753300992 [0;39m 生成今日电子书快照开始
2022-08-18 23:44:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632329753300992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:44:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632329753300992 [0;39m ==> Parameters: 
2022-08-18 23:44:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632329753300992 [0;39m <==    Updates: 0
2022-08-18 23:44:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632329753300992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:44:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17632329761689600 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:44:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632329761689600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:44:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632329761689600 [0;39m ==> Parameters: 
2022-08-18 23:44:35.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632329761689600 [0;39m <==    Updates: 7
2022-08-18 23:44:35.012 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17632329761689600 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-18 23:44:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632350749986816 [0;39m 生成今日电子书快照开始
2022-08-18 23:44:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632350749986816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:44:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632350749986816 [0;39m ==> Parameters: 
2022-08-18 23:44:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632350749986816 [0;39m <==    Updates: 0
2022-08-18 23:44:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632350749986816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:44:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632371704729600 [0;39m 生成今日电子书快照开始
2022-08-18 23:44:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632371704729600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:44:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632371704729600 [0;39m ==> Parameters: 
2022-08-18 23:44:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632371704729600 [0;39m <==    Updates: 0
2022-08-18 23:44:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632371704729600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:44:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632392672055296 [0;39m 生成今日电子书快照开始
2022-08-18 23:44:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632392672055296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:44:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632392672055296 [0;39m ==> Parameters: 
2022-08-18 23:44:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632392672055296 [0;39m <==    Updates: 0
2022-08-18 23:44:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632392672055296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:44:55.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632413651963904 [0;39m 生成今日电子书快照开始
2022-08-18 23:44:55.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632413651963904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:44:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632413651963904 [0;39m ==> Parameters: 
2022-08-18 23:44:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632413651963904 [0;39m <==    Updates: 0
2022-08-18 23:44:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632413651963904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:45:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632434589929472 [0;39m 生成今日电子书快照开始
2022-08-18 23:45:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632434589929472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:45:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632434589929472 [0;39m ==> Parameters: 
2022-08-18 23:45:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632434589929472 [0;39m <==    Updates: 0
2022-08-18 23:45:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632434589929472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:45:05.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632455561449472 [0;39m 生成今日电子书快照开始
2022-08-18 23:45:05.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632455561449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:45:05.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632455561449472 [0;39m ==> Parameters: 
2022-08-18 23:45:05.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632455561449472 [0;39m <==    Updates: 0
2022-08-18 23:45:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632455561449472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:45:05.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17632455574032384 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:45:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632455574032384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:45:05.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632455574032384 [0;39m ==> Parameters: 
2022-08-18 23:45:05.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632455574032384 [0;39m <==    Updates: 7
2022-08-18 23:45:05.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17632455574032384 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:45:10.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632476562329600 [0;39m 生成今日电子书快照开始
2022-08-18 23:45:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632476562329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:45:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632476562329600 [0;39m ==> Parameters: 
2022-08-18 23:45:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632476562329600 [0;39m <==    Updates: 0
2022-08-18 23:45:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632476562329600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:45:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632497563209728 [0;39m 生成今日电子书快照开始
2022-08-18 23:45:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632497563209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:45:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632497563209728 [0;39m ==> Parameters: 
2022-08-18 23:45:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632497563209728 [0;39m <==    Updates: 0
2022-08-18 23:45:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632497563209728 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:45:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632518488592384 [0;39m 生成今日电子书快照开始
2022-08-18 23:45:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632518488592384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:45:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632518488592384 [0;39m ==> Parameters: 
2022-08-18 23:45:20.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632518488592384 [0;39m <==    Updates: 0
2022-08-18 23:45:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632518488592384 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-18 23:45:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632539493666816 [0;39m 生成今日电子书快照开始
2022-08-18 23:45:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632539493666816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:45:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632539493666816 [0;39m ==> Parameters: 
2022-08-18 23:45:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632539493666816 [0;39m <==    Updates: 0
2022-08-18 23:45:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632539493666816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:45:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632560452603904 [0;39m 生成今日电子书快照开始
2022-08-18 23:45:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632560452603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:45:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632560452603904 [0;39m ==> Parameters: 
2022-08-18 23:45:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632560452603904 [0;39m <==    Updates: 0
2022-08-18 23:45:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632560452603904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:45:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17632581440901120 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:45:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632581440901120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:45:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632581440901120 [0;39m ==> Parameters: 
2022-08-18 23:45:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632581440901120 [0;39m <==    Updates: 7
2022-08-18 23:45:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17632581440901120 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:45:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632581449289728 [0;39m 生成今日电子书快照开始
2022-08-18 23:45:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632581449289728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:45:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632581449289728 [0;39m ==> Parameters: 
2022-08-18 23:45:35.020 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632581449289728 [0;39m <==    Updates: 0
2022-08-18 23:45:35.020 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632581449289728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:45:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632602404032512 [0;39m 生成今日电子书快照开始
2022-08-18 23:45:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632602404032512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:45:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632602404032512 [0;39m ==> Parameters: 
2022-08-18 23:45:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632602404032512 [0;39m <==    Updates: 0
2022-08-18 23:45:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632602404032512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:45:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632623375552512 [0;39m 生成今日电子书快照开始
2022-08-18 23:45:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632623375552512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:45:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632623375552512 [0;39m ==> Parameters: 
2022-08-18 23:45:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632623375552512 [0;39m <==    Updates: 0
2022-08-18 23:45:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632623375552512 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:45:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632644355461120 [0;39m 生成今日电子书快照开始
2022-08-18 23:45:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632644355461120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:45:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632644355461120 [0;39m ==> Parameters: 
2022-08-18 23:45:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632644355461120 [0;39m <==    Updates: 0
2022-08-18 23:45:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632644355461120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:45:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632665331175424 [0;39m 生成今日电子书快照开始
2022-08-18 23:45:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632665331175424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:45:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632665331175424 [0;39m ==> Parameters: 
2022-08-18 23:45:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632665331175424 [0;39m <==    Updates: 0
2022-08-18 23:45:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632665331175424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:46:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632686248169472 [0;39m 生成今日电子书快照开始
2022-08-18 23:46:00.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632686248169472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:46:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632686248169472 [0;39m ==> Parameters: 
2022-08-18 23:46:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632686248169472 [0;39m <==    Updates: 0
2022-08-18 23:46:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632686248169472 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:46:05.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17632707236466688 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:46:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632707236466688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:46:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632707236466688 [0;39m ==> Parameters: 
2022-08-18 23:46:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632707236466688 [0;39m <==    Updates: 7
2022-08-18 23:46:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17632707236466688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:46:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632707244855296 [0;39m 生成今日电子书快照开始
2022-08-18 23:46:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632707244855296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:46:05.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632707244855296 [0;39m ==> Parameters: 
2022-08-18 23:46:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632707244855296 [0;39m <==    Updates: 0
2022-08-18 23:46:05.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632707244855296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:46:10.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632728233152512 [0;39m 生成今日电子书快照开始
2022-08-18 23:46:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632728233152512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:46:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632728233152512 [0;39m ==> Parameters: 
2022-08-18 23:46:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632728233152512 [0;39m <==    Updates: 0
2022-08-18 23:46:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632728233152512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:46:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632749187895296 [0;39m 生成今日电子书快照开始
2022-08-18 23:46:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632749187895296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:46:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632749187895296 [0;39m ==> Parameters: 
2022-08-18 23:46:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632749187895296 [0;39m <==    Updates: 0
2022-08-18 23:46:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632749187895296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:46:20.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632770138443776 [0;39m 生成今日电子书快照开始
2022-08-18 23:46:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632770138443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:46:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632770138443776 [0;39m ==> Parameters: 
2022-08-18 23:46:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632770138443776 [0;39m <==    Updates: 0
2022-08-18 23:46:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632770138443776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:46:25.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632791164489728 [0;39m 生成今日电子书快照开始
2022-08-18 23:46:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632791164489728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:46:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632791164489728 [0;39m ==> Parameters: 
2022-08-18 23:46:25.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632791164489728 [0;39m <==    Updates: 0
2022-08-18 23:46:25.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632791164489728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:46:30.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632812073095168 [0;39m 生成今日电子书快照开始
2022-08-18 23:46:30.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632812073095168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:46:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632812073095168 [0;39m ==> Parameters: 
2022-08-18 23:46:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632812073095168 [0;39m <==    Updates: 0
2022-08-18 23:46:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632812073095168 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:46:35.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17632833069780992 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:46:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632833069780992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:46:35.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632833069780992 [0;39m ==> Parameters: 
2022-08-18 23:46:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632833069780992 [0;39m <==    Updates: 7
2022-08-18 23:46:35.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17632833069780992 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-18 23:46:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632833086558208 [0;39m 生成今日电子书快照开始
2022-08-18 23:46:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632833086558208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:46:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632833086558208 [0;39m ==> Parameters: 
2022-08-18 23:46:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632833086558208 [0;39m <==    Updates: 0
2022-08-18 23:46:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632833086558208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:46:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632854028718080 [0;39m 生成今日电子书快照开始
2022-08-18 23:46:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632854028718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:46:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632854028718080 [0;39m ==> Parameters: 
2022-08-18 23:46:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632854028718080 [0;39m <==    Updates: 0
2022-08-18 23:46:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632854028718080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:46:45.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632874996043776 [0;39m 生成今日电子书快照开始
2022-08-18 23:46:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632874996043776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:46:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632874996043776 [0;39m ==> Parameters: 
2022-08-18 23:46:45.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632874996043776 [0;39m <==    Updates: 0
2022-08-18 23:46:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632874996043776 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:46:50.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632895992729600 [0;39m 生成今日电子书快照开始
2022-08-18 23:46:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632895992729600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:46:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632895992729600 [0;39m ==> Parameters: 
2022-08-18 23:46:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632895992729600 [0;39m <==    Updates: 0
2022-08-18 23:46:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632895992729600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:46:55.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632916976832512 [0;39m 生成今日电子书快照开始
2022-08-18 23:46:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632916976832512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:46:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632916976832512 [0;39m ==> Parameters: 
2022-08-18 23:46:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632916976832512 [0;39m <==    Updates: 0
2022-08-18 23:46:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632916976832512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:47:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632937935769600 [0;39m 生成今日电子书快照开始
2022-08-18 23:47:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632937935769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:47:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632937935769600 [0;39m ==> Parameters: 
2022-08-18 23:47:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632937935769600 [0;39m <==    Updates: 0
2022-08-18 23:47:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632937935769600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:47:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632958911483904 [0;39m 生成今日电子书快照开始
2022-08-18 23:47:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632958911483904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:47:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632958911483904 [0;39m ==> Parameters: 
2022-08-18 23:47:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632958911483904 [0;39m <==    Updates: 0
2022-08-18 23:47:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632958911483904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:47:05.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17632958924066816 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:47:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632958924066816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:47:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632958924066816 [0;39m ==> Parameters: 
2022-08-18 23:47:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17632958924066816 [0;39m <==    Updates: 7
2022-08-18 23:47:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17632958924066816 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:47:10.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17632979895586816 [0;39m 生成今日电子书快照开始
2022-08-18 23:47:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632979895586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:47:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632979895586816 [0;39m ==> Parameters: 
2022-08-18 23:47:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17632979895586816 [0;39m <==    Updates: 0
2022-08-18 23:47:10.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17632979895586816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:47:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633000875495424 [0;39m 生成今日电子书快照开始
2022-08-18 23:47:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633000875495424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:47:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633000875495424 [0;39m ==> Parameters: 
2022-08-18 23:47:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633000875495424 [0;39m <==    Updates: 0
2022-08-18 23:47:15.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633000875495424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:47:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633021834432512 [0;39m 生成今日电子书快照开始
2022-08-18 23:47:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633021834432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:47:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633021834432512 [0;39m ==> Parameters: 
2022-08-18 23:47:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633021834432512 [0;39m <==    Updates: 0
2022-08-18 23:47:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633021834432512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:47:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633042818535424 [0;39m 生成今日电子书快照开始
2022-08-18 23:47:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633042818535424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:47:25.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633042818535424 [0;39m ==> Parameters: 
2022-08-18 23:47:25.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633042818535424 [0;39m <==    Updates: 0
2022-08-18 23:47:25.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633042818535424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:47:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633063781666816 [0;39m 生成今日电子书快照开始
2022-08-18 23:47:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633063781666816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:47:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633063781666816 [0;39m ==> Parameters: 
2022-08-18 23:47:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633063781666816 [0;39m <==    Updates: 0
2022-08-18 23:47:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633063781666816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:47:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633084757381120 [0;39m 生成今日电子书快照开始
2022-08-18 23:47:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633084757381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:47:35.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633084757381120 [0;39m ==> Parameters: 
2022-08-18 23:47:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633084757381120 [0;39m <==    Updates: 0
2022-08-18 23:47:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633084757381120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:47:35.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17633084769964032 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:47:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633084769964032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:47:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633084769964032 [0;39m ==> Parameters: 
2022-08-18 23:47:35.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633084769964032 [0;39m <==    Updates: 7
2022-08-18 23:47:35.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17633084769964032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:47:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633105678569472 [0;39m 生成今日电子书快照开始
2022-08-18 23:47:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633105678569472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:47:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633105678569472 [0;39m ==> Parameters: 
2022-08-18 23:47:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633105678569472 [0;39m <==    Updates: 0
2022-08-18 23:47:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633105678569472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:47:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633126679449600 [0;39m 生成今日电子书快照开始
2022-08-18 23:47:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633126679449600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:47:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633126679449600 [0;39m ==> Parameters: 
2022-08-18 23:47:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633126679449600 [0;39m <==    Updates: 0
2022-08-18 23:47:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633126679449600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:47:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633147684524032 [0;39m 生成今日电子书快照开始
2022-08-18 23:47:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633147684524032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:47:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633147684524032 [0;39m ==> Parameters: 
2022-08-18 23:47:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633147684524032 [0;39m <==    Updates: 0
2022-08-18 23:47:50.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633147684524032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:47:55.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633168588935168 [0;39m 生成今日电子书快照开始
2022-08-18 23:47:55.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633168588935168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:47:55.000 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633168588935168 [0;39m ==> Parameters: 
2022-08-18 23:47:55.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633168588935168 [0;39m <==    Updates: 0
2022-08-18 23:47:55.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633168588935168 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:48:00.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633189581426688 [0;39m 生成今日电子书快照开始
2022-08-18 23:48:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633189581426688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:48:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633189581426688 [0;39m ==> Parameters: 
2022-08-18 23:48:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633189581426688 [0;39m <==    Updates: 0
2022-08-18 23:48:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633189581426688 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:48:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17633210569723904 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:48:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633210569723904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:48:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633210569723904 [0;39m ==> Parameters: 
2022-08-18 23:48:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633210569723904 [0;39m <==    Updates: 7
2022-08-18 23:48:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17633210569723904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:48:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633210578112512 [0;39m 生成今日电子书快照开始
2022-08-18 23:48:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633210578112512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:48:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633210578112512 [0;39m ==> Parameters: 
2022-08-18 23:48:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633210578112512 [0;39m <==    Updates: 0
2022-08-18 23:48:05.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633210578112512 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:48:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633231520272384 [0;39m 生成今日电子书快照开始
2022-08-18 23:48:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633231520272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:48:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633231520272384 [0;39m ==> Parameters: 
2022-08-18 23:48:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633231520272384 [0;39m <==    Updates: 0
2022-08-18 23:48:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633231520272384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:48:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633252525346816 [0;39m 生成今日电子书快照开始
2022-08-18 23:48:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633252525346816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:48:15.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633252525346816 [0;39m ==> Parameters: 
2022-08-18 23:48:15.022 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633252525346816 [0;39m <==    Updates: 0
2022-08-18 23:48:15.023 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633252525346816 [0;39m 生成今日电子书快照结束，耗时：10 毫秒
2022-08-18 23:48:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633273459118080 [0;39m 生成今日电子书快照开始
2022-08-18 23:48:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633273459118080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:48:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633273459118080 [0;39m ==> Parameters: 
2022-08-18 23:48:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633273459118080 [0;39m <==    Updates: 0
2022-08-18 23:48:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633273459118080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:48:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633294447415296 [0;39m 生成今日电子书快照开始
2022-08-18 23:48:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633294447415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:48:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633294447415296 [0;39m ==> Parameters: 
2022-08-18 23:48:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633294447415296 [0;39m <==    Updates: 0
2022-08-18 23:48:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633294447415296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:48:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633315431518208 [0;39m 生成今日电子书快照开始
2022-08-18 23:48:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633315431518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:48:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633315431518208 [0;39m ==> Parameters: 
2022-08-18 23:48:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633315431518208 [0;39m <==    Updates: 0
2022-08-18 23:48:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633315431518208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:48:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17633336419815424 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:48:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633336419815424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:48:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633336419815424 [0;39m ==> Parameters: 
2022-08-18 23:48:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633336419815424 [0;39m <==    Updates: 7
2022-08-18 23:48:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17633336419815424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:48:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633336424009728 [0;39m 生成今日电子书快照开始
2022-08-18 23:48:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633336424009728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:48:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633336424009728 [0;39m ==> Parameters: 
2022-08-18 23:48:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633336424009728 [0;39m <==    Updates: 0
2022-08-18 23:48:35.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633336424009728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:48:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633357382946816 [0;39m 生成今日电子书快照开始
2022-08-18 23:48:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633357382946816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:48:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633357382946816 [0;39m ==> Parameters: 
2022-08-18 23:48:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633357382946816 [0;39m <==    Updates: 0
2022-08-18 23:48:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633357382946816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:48:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633378333495296 [0;39m 生成今日电子书快照开始
2022-08-18 23:48:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633378333495296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:48:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633378333495296 [0;39m ==> Parameters: 
2022-08-18 23:48:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633378333495296 [0;39m <==    Updates: 0
2022-08-18 23:48:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633378333495296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:48:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633399317598208 [0;39m 生成今日电子书快照开始
2022-08-18 23:48:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633399317598208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:48:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633399317598208 [0;39m ==> Parameters: 
2022-08-18 23:48:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633399317598208 [0;39m <==    Updates: 0
2022-08-18 23:48:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633399317598208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:48:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633420310089728 [0;39m 生成今日电子书快照开始
2022-08-18 23:48:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633420310089728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:48:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633420310089728 [0;39m ==> Parameters: 
2022-08-18 23:48:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633420310089728 [0;39m <==    Updates: 0
2022-08-18 23:48:55.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633420310089728 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:49:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633441269026816 [0;39m 生成今日电子书快照开始
2022-08-18 23:49:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633441269026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:49:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633441269026816 [0;39m ==> Parameters: 
2022-08-18 23:49:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633441269026816 [0;39m <==    Updates: 0
2022-08-18 23:49:00.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633441269026816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:49:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17633462236352512 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:49:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633462236352512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:49:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633462236352512 [0;39m ==> Parameters: 
2022-08-18 23:49:05.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633462236352512 [0;39m <==    Updates: 7
2022-08-18 23:49:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17633462236352512 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:49:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633462244741120 [0;39m 生成今日电子书快照开始
2022-08-18 23:49:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633462244741120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:49:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633462244741120 [0;39m ==> Parameters: 
2022-08-18 23:49:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633462244741120 [0;39m <==    Updates: 0
2022-08-18 23:49:05.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633462244741120 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:49:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633483228844032 [0;39m 生成今日电子书快照开始
2022-08-18 23:49:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633483228844032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:49:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633483228844032 [0;39m ==> Parameters: 
2022-08-18 23:49:10.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633483228844032 [0;39m <==    Updates: 0
2022-08-18 23:49:10.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633483228844032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:49:15.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633504191975424 [0;39m 生成今日电子书快照开始
2022-08-18 23:49:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633504191975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:49:15.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633504191975424 [0;39m ==> Parameters: 
2022-08-18 23:49:15.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633504191975424 [0;39m <==    Updates: 0
2022-08-18 23:49:15.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633504191975424 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:49:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633525117358080 [0;39m 生成今日电子书快照开始
2022-08-18 23:49:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633525117358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:49:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633525117358080 [0;39m ==> Parameters: 
2022-08-18 23:49:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633525117358080 [0;39m <==    Updates: 0
2022-08-18 23:49:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633525117358080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:49:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633546126626816 [0;39m 生成今日电子书快照开始
2022-08-18 23:49:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633546126626816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:49:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633546126626816 [0;39m ==> Parameters: 
2022-08-18 23:49:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633546126626816 [0;39m <==    Updates: 0
2022-08-18 23:49:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633546126626816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:49:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633567102341120 [0;39m 生成今日电子书快照开始
2022-08-18 23:49:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633567102341120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:49:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633567102341120 [0;39m ==> Parameters: 
2022-08-18 23:49:30.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633567102341120 [0;39m <==    Updates: 0
2022-08-18 23:49:30.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633567102341120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:49:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633588057083904 [0;39m 生成今日电子书快照开始
2022-08-18 23:49:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633588057083904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:49:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633588057083904 [0;39m ==> Parameters: 
2022-08-18 23:49:35.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633588057083904 [0;39m <==    Updates: 0
2022-08-18 23:49:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633588057083904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:49:35.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17633588073861120 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:49:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633588073861120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:49:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633588073861120 [0;39m ==> Parameters: 
2022-08-18 23:49:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633588073861120 [0;39m <==    Updates: 7
2022-08-18 23:49:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17633588073861120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:49:40.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633609036992512 [0;39m 生成今日电子书快照开始
2022-08-18 23:49:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633609036992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:49:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633609036992512 [0;39m ==> Parameters: 
2022-08-18 23:49:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633609036992512 [0;39m <==    Updates: 0
2022-08-18 23:49:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633609036992512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:49:45.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633630008512512 [0;39m 生成今日电子书快照开始
2022-08-18 23:49:45.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633630008512512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:49:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633630008512512 [0;39m ==> Parameters: 
2022-08-18 23:49:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633630008512512 [0;39m <==    Updates: 0
2022-08-18 23:49:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633630008512512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:49:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633651001004032 [0;39m 生成今日电子书快照开始
2022-08-18 23:49:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633651001004032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:49:50.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633651001004032 [0;39m ==> Parameters: 
2022-08-18 23:49:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633651001004032 [0;39m <==    Updates: 0
2022-08-18 23:49:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633651001004032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:49:55.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633671938969600 [0;39m 生成今日电子书快照开始
2022-08-18 23:49:55.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633671938969600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:49:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633671938969600 [0;39m ==> Parameters: 
2022-08-18 23:49:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633671938969600 [0;39m <==    Updates: 0
2022-08-18 23:49:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633671938969600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:50:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633692931461120 [0;39m 生成今日电子书快照开始
2022-08-18 23:50:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633692931461120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:50:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633692931461120 [0;39m ==> Parameters: 
2022-08-18 23:50:00.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633692931461120 [0;39m <==    Updates: 0
2022-08-18 23:50:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633692931461120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:50:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17633713877815296 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:50:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633713877815296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:50:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633713877815296 [0;39m ==> Parameters: 
2022-08-18 23:50:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633713877815296 [0;39m <==    Updates: 7
2022-08-18 23:50:05.009 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17633713877815296 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:50:05.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633713886203904 [0;39m 生成今日电子书快照开始
2022-08-18 23:50:05.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633713886203904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:50:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633713886203904 [0;39m ==> Parameters: 
2022-08-18 23:50:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633713886203904 [0;39m <==    Updates: 0
2022-08-18 23:50:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633713886203904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:50:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633734849335296 [0;39m 生成今日电子书快照开始
2022-08-18 23:50:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633734849335296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:50:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633734849335296 [0;39m ==> Parameters: 
2022-08-18 23:50:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633734849335296 [0;39m <==    Updates: 0
2022-08-18 23:50:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633734849335296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:50:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633755820855296 [0;39m 生成今日电子书快照开始
2022-08-18 23:50:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633755820855296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:50:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633755820855296 [0;39m ==> Parameters: 
2022-08-18 23:50:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633755820855296 [0;39m <==    Updates: 0
2022-08-18 23:50:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633755820855296 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:50:20.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633776809152512 [0;39m 生成今日电子书快照开始
2022-08-18 23:50:20.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633776809152512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:50:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633776809152512 [0;39m ==> Parameters: 
2022-08-18 23:50:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633776809152512 [0;39m <==    Updates: 0
2022-08-18 23:50:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633776809152512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:50:25.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633797738729472 [0;39m 生成今日电子书快照开始
2022-08-18 23:50:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633797738729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:50:25.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633797738729472 [0;39m ==> Parameters: 
2022-08-18 23:50:25.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633797738729472 [0;39m <==    Updates: 0
2022-08-18 23:50:25.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633797738729472 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:50:30.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633818714443776 [0;39m 生成今日电子书快照开始
2022-08-18 23:50:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633818714443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:50:30.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633818714443776 [0;39m ==> Parameters: 
2022-08-18 23:50:30.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633818714443776 [0;39m <==    Updates: 0
2022-08-18 23:50:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633818714443776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:50:35.005 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17633839698546688 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:50:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633839698546688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:50:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633839698546688 [0;39m ==> Parameters: 
2022-08-18 23:50:35.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633839698546688 [0;39m <==    Updates: 7
2022-08-18 23:50:35.006 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17633839698546688 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:50:35.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633839702740992 [0;39m 生成今日电子书快照开始
2022-08-18 23:50:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633839702740992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:50:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633839702740992 [0;39m ==> Parameters: 
2022-08-18 23:50:35.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633839702740992 [0;39m <==    Updates: 0
2022-08-18 23:50:35.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633839702740992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:50:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633860653289472 [0;39m 生成今日电子书快照开始
2022-08-18 23:50:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633860653289472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:50:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633860653289472 [0;39m ==> Parameters: 
2022-08-18 23:50:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633860653289472 [0;39m <==    Updates: 0
2022-08-18 23:50:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633860653289472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:50:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633881662558208 [0;39m 生成今日电子书快照开始
2022-08-18 23:50:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633881662558208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:50:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633881662558208 [0;39m ==> Parameters: 
2022-08-18 23:50:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633881662558208 [0;39m <==    Updates: 0
2022-08-18 23:50:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633881662558208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:50:50.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633902596329472 [0;39m 生成今日电子书快照开始
2022-08-18 23:50:50.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633902596329472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:50:50.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633902596329472 [0;39m ==> Parameters: 
2022-08-18 23:50:50.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633902596329472 [0;39m <==    Updates: 0
2022-08-18 23:50:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633902596329472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:50:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633923622375424 [0;39m 生成今日电子书快照开始
2022-08-18 23:50:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633923622375424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:50:55.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633923622375424 [0;39m ==> Parameters: 
2022-08-18 23:50:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633923622375424 [0;39m <==    Updates: 0
2022-08-18 23:50:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633923622375424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:51:00.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633944572923904 [0;39m 生成今日电子书快照开始
2022-08-18 23:51:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633944572923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:51:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633944572923904 [0;39m ==> Parameters: 
2022-08-18 23:51:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633944572923904 [0;39m <==    Updates: 0
2022-08-18 23:51:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633944572923904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:51:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633965552832512 [0;39m 生成今日电子书快照开始
2022-08-18 23:51:05.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633965552832512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:51:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633965552832512 [0;39m ==> Parameters: 
2022-08-18 23:51:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633965552832512 [0;39m <==    Updates: 0
2022-08-18 23:51:05.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633965552832512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:51:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17633965561221120 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:51:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633965561221120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:51:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633965561221120 [0;39m ==> Parameters: 
2022-08-18 23:51:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17633965561221120 [0;39m <==    Updates: 7
2022-08-18 23:51:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17633965561221120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:51:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17633986503380992 [0;39m 生成今日电子书快照开始
2022-08-18 23:51:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633986503380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:51:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633986503380992 [0;39m ==> Parameters: 
2022-08-18 23:51:10.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17633986503380992 [0;39m <==    Updates: 0
2022-08-18 23:51:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17633986503380992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:51:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634007495872512 [0;39m 生成今日电子书快照开始
2022-08-18 23:51:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634007495872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:51:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634007495872512 [0;39m ==> Parameters: 
2022-08-18 23:51:15.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634007495872512 [0;39m <==    Updates: 0
2022-08-18 23:51:15.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634007495872512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:51:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634028479975424 [0;39m 生成今日电子书快照开始
2022-08-18 23:51:20.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634028479975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:51:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634028479975424 [0;39m ==> Parameters: 
2022-08-18 23:51:20.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634028479975424 [0;39m <==    Updates: 0
2022-08-18 23:51:20.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634028479975424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:51:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634049405358080 [0;39m 生成今日电子书快照开始
2022-08-18 23:51:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634049405358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:51:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634049405358080 [0;39m ==> Parameters: 
2022-08-18 23:51:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634049405358080 [0;39m <==    Updates: 0
2022-08-18 23:51:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634049405358080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:51:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634070389460992 [0;39m 生成今日电子书快照开始
2022-08-18 23:51:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634070389460992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:51:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634070389460992 [0;39m ==> Parameters: 
2022-08-18 23:51:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634070389460992 [0;39m <==    Updates: 0
2022-08-18 23:51:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634070389460992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:51:35.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634091344203776 [0;39m 生成今日电子书快照开始
2022-08-18 23:51:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634091344203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:51:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634091344203776 [0;39m ==> Parameters: 
2022-08-18 23:51:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634091344203776 [0;39m <==    Updates: 0
2022-08-18 23:51:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634091344203776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:51:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17634091352592384 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:51:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634091352592384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:51:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634091352592384 [0;39m ==> Parameters: 
2022-08-18 23:51:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634091352592384 [0;39m <==    Updates: 7
2022-08-18 23:51:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17634091352592384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:51:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634112349278208 [0;39m 生成今日电子书快照开始
2022-08-18 23:51:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634112349278208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:51:40.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634112349278208 [0;39m ==> Parameters: 
2022-08-18 23:51:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634112349278208 [0;39m <==    Updates: 0
2022-08-18 23:51:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634112349278208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:51:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634133312409600 [0;39m 生成今日电子书快照开始
2022-08-18 23:51:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634133312409600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:51:45.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634133312409600 [0;39m ==> Parameters: 
2022-08-18 23:51:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634133312409600 [0;39m <==    Updates: 0
2022-08-18 23:51:45.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634133312409600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:51:50.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634154267152384 [0;39m 生成今日电子书快照开始
2022-08-18 23:51:50.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634154267152384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:51:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634154267152384 [0;39m ==> Parameters: 
2022-08-18 23:51:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634154267152384 [0;39m <==    Updates: 0
2022-08-18 23:51:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634154267152384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:51:55.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634175263838208 [0;39m 生成今日电子书快照开始
2022-08-18 23:51:55.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634175263838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:51:55.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634175263838208 [0;39m ==> Parameters: 
2022-08-18 23:51:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634175263838208 [0;39m <==    Updates: 0
2022-08-18 23:51:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634175263838208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:52:00.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634196201803776 [0;39m 生成今日电子书快照开始
2022-08-18 23:52:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634196201803776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:52:00.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634196201803776 [0;39m ==> Parameters: 
2022-08-18 23:52:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634196201803776 [0;39m <==    Updates: 0
2022-08-18 23:52:00.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634196201803776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:52:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634217194295296 [0;39m 生成今日电子书快照开始
2022-08-18 23:52:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634217194295296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:52:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634217194295296 [0;39m ==> Parameters: 
2022-08-18 23:52:05.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634217194295296 [0;39m <==    Updates: 0
2022-08-18 23:52:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634217194295296 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:52:05.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17634217211072512 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:52:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634217211072512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:52:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634217211072512 [0;39m ==> Parameters: 
2022-08-18 23:52:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634217211072512 [0;39m <==    Updates: 7
2022-08-18 23:52:05.013 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17634217211072512 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:52:10.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634238161620992 [0;39m 生成今日电子书快照开始
2022-08-18 23:52:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634238161620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:52:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634238161620992 [0;39m ==> Parameters: 
2022-08-18 23:52:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634238161620992 [0;39m <==    Updates: 0
2022-08-18 23:52:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634238161620992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:52:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634259133140992 [0;39m 生成今日电子书快照开始
2022-08-18 23:52:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634259133140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:52:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634259133140992 [0;39m ==> Parameters: 
2022-08-18 23:52:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634259133140992 [0;39m <==    Updates: 0
2022-08-18 23:52:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634259133140992 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:52:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634280083689472 [0;39m 生成今日电子书快照开始
2022-08-18 23:52:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634280083689472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:52:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634280083689472 [0;39m ==> Parameters: 
2022-08-18 23:52:20.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634280083689472 [0;39m <==    Updates: 0
2022-08-18 23:52:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634280083689472 [0;39m 生成今日电子书快照结束，耗时：0 毫秒
2022-08-18 23:52:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634301101346816 [0;39m 生成今日电子书快照开始
2022-08-18 23:52:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634301101346816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:52:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634301101346816 [0;39m ==> Parameters: 
2022-08-18 23:52:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634301101346816 [0;39m <==    Updates: 0
2022-08-18 23:52:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634301101346816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:52:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634322047700992 [0;39m 生成今日电子书快照开始
2022-08-18 23:52:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634322047700992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:52:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634322047700992 [0;39m ==> Parameters: 
2022-08-18 23:52:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634322047700992 [0;39m <==    Updates: 0
2022-08-18 23:52:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634322047700992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:52:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17634343052775424 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:52:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634343052775424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:52:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634343052775424 [0;39m ==> Parameters: 
2022-08-18 23:52:35.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634343052775424 [0;39m <==    Updates: 7
2022-08-18 23:52:35.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17634343052775424 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:52:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634343061164032 [0;39m 生成今日电子书快照开始
2022-08-18 23:52:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634343061164032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:52:35.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634343061164032 [0;39m ==> Parameters: 
2022-08-18 23:52:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634343061164032 [0;39m <==    Updates: 0
2022-08-18 23:52:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634343061164032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:52:40.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634364007518208 [0;39m 生成今日电子书快照开始
2022-08-18 23:52:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634364007518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:52:40.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634364007518208 [0;39m ==> Parameters: 
2022-08-18 23:52:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634364007518208 [0;39m <==    Updates: 0
2022-08-18 23:52:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634364007518208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:52:45.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634385000009728 [0;39m 生成今日电子书快照开始
2022-08-18 23:52:45.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634385000009728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:52:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634385000009728 [0;39m ==> Parameters: 
2022-08-18 23:52:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634385000009728 [0;39m <==    Updates: 0
2022-08-18 23:52:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634385000009728 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:52:50.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634405954752512 [0;39m 生成今日电子书快照开始
2022-08-18 23:52:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634405954752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:52:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634405954752512 [0;39m ==> Parameters: 
2022-08-18 23:52:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634405954752512 [0;39m <==    Updates: 0
2022-08-18 23:52:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634405954752512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:52:55.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634426951438336 [0;39m 生成今日电子书快照开始
2022-08-18 23:52:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634426951438336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:52:55.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634426951438336 [0;39m ==> Parameters: 
2022-08-18 23:52:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634426951438336 [0;39m <==    Updates: 0
2022-08-18 23:52:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634426951438336 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:53:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634447906181120 [0;39m 生成今日电子书快照开始
2022-08-18 23:53:00.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634447906181120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:53:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634447906181120 [0;39m ==> Parameters: 
2022-08-18 23:53:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634447906181120 [0;39m <==    Updates: 0
2022-08-18 23:53:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634447906181120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:53:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634468839952384 [0;39m 生成今日电子书快照开始
2022-08-18 23:53:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634468839952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:53:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634468839952384 [0;39m ==> Parameters: 
2022-08-18 23:53:05.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634468839952384 [0;39m <==    Updates: 0
2022-08-18 23:53:05.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634468839952384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:53:05.007 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17634468852535296 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:53:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634468852535296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:53:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634468852535296 [0;39m ==> Parameters: 
2022-08-18 23:53:05.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634468852535296 [0;39m <==    Updates: 7
2022-08-18 23:53:05.008 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17634468852535296 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:53:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634489798889472 [0;39m 生成今日电子书快照开始
2022-08-18 23:53:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634489798889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:53:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634489798889472 [0;39m ==> Parameters: 
2022-08-18 23:53:10.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634489798889472 [0;39m <==    Updates: 0
2022-08-18 23:53:10.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634489798889472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:53:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634510803963904 [0;39m 生成今日电子书快照开始
2022-08-18 23:53:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634510803963904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:53:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634510803963904 [0;39m ==> Parameters: 
2022-08-18 23:53:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634510803963904 [0;39m <==    Updates: 0
2022-08-18 23:53:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634510803963904 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:53:20.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634531754512384 [0;39m 生成今日电子书快照开始
2022-08-18 23:53:20.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634531754512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:53:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634531754512384 [0;39m ==> Parameters: 
2022-08-18 23:53:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634531754512384 [0;39m <==    Updates: 0
2022-08-18 23:53:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634531754512384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:53:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634552742809600 [0;39m 生成今日电子书快照开始
2022-08-18 23:53:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634552742809600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:53:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634552742809600 [0;39m ==> Parameters: 
2022-08-18 23:53:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634552742809600 [0;39m <==    Updates: 0
2022-08-18 23:53:25.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634552742809600 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:53:30.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634573710135296 [0;39m 生成今日电子书快照开始
2022-08-18 23:53:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634573710135296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:53:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634573710135296 [0;39m ==> Parameters: 
2022-08-18 23:53:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634573710135296 [0;39m <==    Updates: 0
2022-08-18 23:53:30.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634573710135296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:53:35.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17634594711015424 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:53:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634594711015424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:53:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634594711015424 [0;39m ==> Parameters: 
2022-08-18 23:53:35.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634594711015424 [0;39m <==    Updates: 7
2022-08-18 23:53:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17634594711015424 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:53:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634594715209728 [0;39m 生成今日电子书快照开始
2022-08-18 23:53:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634594715209728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:53:35.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634594715209728 [0;39m ==> Parameters: 
2022-08-18 23:53:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634594715209728 [0;39m <==    Updates: 0
2022-08-18 23:53:35.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634594715209728 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:53:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634615648980992 [0;39m 生成今日电子书快照开始
2022-08-18 23:53:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634615648980992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:53:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634615648980992 [0;39m ==> Parameters: 
2022-08-18 23:53:40.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634615648980992 [0;39m <==    Updates: 0
2022-08-18 23:53:40.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634615648980992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:53:45.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634636624695296 [0;39m 生成今日电子书快照开始
2022-08-18 23:53:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634636624695296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:53:45.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634636624695296 [0;39m ==> Parameters: 
2022-08-18 23:53:45.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634636624695296 [0;39m <==    Updates: 0
2022-08-18 23:53:45.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634636624695296 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:53:50.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634657587826688 [0;39m 生成今日电子书快照开始
2022-08-18 23:53:50.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634657587826688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:53:50.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634657587826688 [0;39m ==> Parameters: 
2022-08-18 23:53:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634657587826688 [0;39m <==    Updates: 0
2022-08-18 23:53:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634657587826688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:53:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634678559346688 [0;39m 生成今日电子书快照开始
2022-08-18 23:53:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634678559346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:53:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634678559346688 [0;39m ==> Parameters: 
2022-08-18 23:53:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634678559346688 [0;39m <==    Updates: 0
2022-08-18 23:53:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634678559346688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:54:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634699543449600 [0;39m 生成今日电子书快照开始
2022-08-18 23:54:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634699543449600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:54:00.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634699543449600 [0;39m ==> Parameters: 
2022-08-18 23:54:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634699543449600 [0;39m <==    Updates: 0
2022-08-18 23:54:00.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634699543449600 [0;39m 生成今日电子书快照结束，耗时：5 毫秒
2022-08-18 23:54:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634720540135424 [0;39m 生成今日电子书快照开始
2022-08-18 23:54:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634720540135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:54:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634720540135424 [0;39m ==> Parameters: 
2022-08-18 23:54:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634720540135424 [0;39m <==    Updates: 0
2022-08-18 23:54:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634720540135424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:54:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17634720548524032 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:54:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634720548524032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:54:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634720548524032 [0;39m ==> Parameters: 
2022-08-18 23:54:05.018 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634720548524032 [0;39m <==    Updates: 7
2022-08-18 23:54:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17634720548524032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:54:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634741511655424 [0;39m 生成今日电子书快照开始
2022-08-18 23:54:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634741511655424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:54:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634741511655424 [0;39m ==> Parameters: 
2022-08-18 23:54:10.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634741511655424 [0;39m <==    Updates: 0
2022-08-18 23:54:10.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634741511655424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:54:15.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634762458009600 [0;39m 生成今日电子书快照开始
2022-08-18 23:54:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634762458009600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:54:15.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634762458009600 [0;39m ==> Parameters: 
2022-08-18 23:54:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634762458009600 [0;39m <==    Updates: 0
2022-08-18 23:54:15.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634762458009600 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:54:20.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634783421140992 [0;39m 生成今日电子书快照开始
2022-08-18 23:54:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634783421140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:54:20.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634783421140992 [0;39m ==> Parameters: 
2022-08-18 23:54:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634783421140992 [0;39m <==    Updates: 0
2022-08-18 23:54:20.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634783421140992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:54:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634804409438208 [0;39m 生成今日电子书快照开始
2022-08-18 23:54:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634804409438208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:54:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634804409438208 [0;39m ==> Parameters: 
2022-08-18 23:54:25.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634804409438208 [0;39m <==    Updates: 0
2022-08-18 23:54:25.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634804409438208 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:54:30.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634825376763904 [0;39m 生成今日电子书快照开始
2022-08-18 23:54:30.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634825376763904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:54:30.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634825376763904 [0;39m ==> Parameters: 
2022-08-18 23:54:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634825376763904 [0;39m <==    Updates: 0
2022-08-18 23:54:30.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634825376763904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:54:35.004 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17634846327312384 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:54:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634846327312384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:54:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634846327312384 [0;39m ==> Parameters: 
2022-08-18 23:54:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634846327312384 [0;39m <==    Updates: 7
2022-08-18 23:54:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17634846327312384 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:54:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634846331506688 [0;39m 生成今日电子书快照开始
2022-08-18 23:54:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634846331506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:54:35.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634846331506688 [0;39m ==> Parameters: 
2022-08-18 23:54:35.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634846331506688 [0;39m <==    Updates: 0
2022-08-18 23:54:35.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634846331506688 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:54:40.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634867332386816 [0;39m 生成今日电子书快照开始
2022-08-18 23:54:40.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634867332386816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:54:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634867332386816 [0;39m ==> Parameters: 
2022-08-18 23:54:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634867332386816 [0;39m <==    Updates: 0
2022-08-18 23:54:40.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634867332386816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:54:45.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634888291323904 [0;39m 生成今日电子书快照开始
2022-08-18 23:54:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634888291323904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:54:45.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634888291323904 [0;39m ==> Parameters: 
2022-08-18 23:54:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634888291323904 [0;39m <==    Updates: 0
2022-08-18 23:54:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634888291323904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:54:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634909262843904 [0;39m 生成今日电子书快照开始
2022-08-18 23:54:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634909262843904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:54:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634909262843904 [0;39m ==> Parameters: 
2022-08-18 23:54:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634909262843904 [0;39m <==    Updates: 0
2022-08-18 23:54:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634909262843904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:54:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634930205003776 [0;39m 生成今日电子书快照开始
2022-08-18 23:54:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634930205003776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:54:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634930205003776 [0;39m ==> Parameters: 
2022-08-18 23:54:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634930205003776 [0;39m <==    Updates: 0
2022-08-18 23:54:55.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634930205003776 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:55:00.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634951184912384 [0;39m 生成今日电子书快照开始
2022-08-18 23:55:00.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634951184912384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:55:00.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634951184912384 [0;39m ==> Parameters: 
2022-08-18 23:55:00.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634951184912384 [0;39m <==    Updates: 0
2022-08-18 23:55:00.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634951184912384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:55:05.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634972156432384 [0;39m 生成今日电子书快照开始
2022-08-18 23:55:05.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634972156432384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:55:05.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634972156432384 [0;39m ==> Parameters: 
2022-08-18 23:55:05.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634972156432384 [0;39m <==    Updates: 0
2022-08-18 23:55:05.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634972156432384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:55:05.006 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17634972164820992 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:55:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634972164820992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:55:05.006 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634972164820992 [0;39m ==> Parameters: 
2022-08-18 23:55:05.007 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17634972164820992 [0;39m <==    Updates: 7
2022-08-18 23:55:05.007 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17634972164820992 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:55:10.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17634993148923904 [0;39m 生成今日电子书快照开始
2022-08-18 23:55:10.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634993148923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:55:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634993148923904 [0;39m ==> Parameters: 
2022-08-18 23:55:10.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17634993148923904 [0;39m <==    Updates: 0
2022-08-18 23:55:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17634993148923904 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:55:15.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635014099472384 [0;39m 生成今日电子书快照开始
2022-08-18 23:55:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635014099472384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:55:15.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635014099472384 [0;39m ==> Parameters: 
2022-08-18 23:55:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635014099472384 [0;39m <==    Updates: 0
2022-08-18 23:55:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635014099472384 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:55:20.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635035104546816 [0;39m 生成今日电子书快照开始
2022-08-18 23:55:20.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635035104546816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:55:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635035104546816 [0;39m ==> Parameters: 
2022-08-18 23:55:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635035104546816 [0;39m <==    Updates: 0
2022-08-18 23:55:20.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635035104546816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:55:25.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635056071872512 [0;39m 生成今日电子书快照开始
2022-08-18 23:55:25.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635056071872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:55:25.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635056071872512 [0;39m ==> Parameters: 
2022-08-18 23:55:25.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635056071872512 [0;39m <==    Updates: 0
2022-08-18 23:55:25.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635056071872512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:55:30.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635077043392512 [0;39m 生成今日电子书快照开始
2022-08-18 23:55:30.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635077043392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:55:30.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635077043392512 [0;39m ==> Parameters: 
2022-08-18 23:55:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635077043392512 [0;39m <==    Updates: 0
2022-08-18 23:55:30.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635077043392512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:55:35.008 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17635098002329600 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:55:35.008 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635098002329600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:55:35.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635098002329600 [0;39m ==> Parameters: 
2022-08-18 23:55:35.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635098002329600 [0;39m <==    Updates: 7
2022-08-18 23:55:35.010 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17635098002329600 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:55:35.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635098010718208 [0;39m 生成今日电子书快照开始
2022-08-18 23:55:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635098010718208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:55:35.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635098010718208 [0;39m ==> Parameters: 
2022-08-18 23:55:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635098010718208 [0;39m <==    Updates: 0
2022-08-18 23:55:35.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635098010718208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:55:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635118952878080 [0;39m 生成今日电子书快照开始
2022-08-18 23:55:40.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635118952878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:55:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635118952878080 [0;39m ==> Parameters: 
2022-08-18 23:55:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635118952878080 [0;39m <==    Updates: 0
2022-08-18 23:55:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635118952878080 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:55:45.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635139966341120 [0;39m 生成今日电子书快照开始
2022-08-18 23:55:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635139966341120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:55:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635139966341120 [0;39m ==> Parameters: 
2022-08-18 23:55:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635139966341120 [0;39m <==    Updates: 0
2022-08-18 23:55:45.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635139966341120 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:55:50.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635160921083904 [0;39m 生成今日电子书快照开始
2022-08-18 23:55:50.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635160921083904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:55:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635160921083904 [0;39m ==> Parameters: 
2022-08-18 23:55:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635160921083904 [0;39m <==    Updates: 0
2022-08-18 23:55:50.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635160921083904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:55:55.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635181905186816 [0;39m 生成今日电子书快照开始
2022-08-18 23:55:55.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635181905186816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:55:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635181905186816 [0;39m ==> Parameters: 
2022-08-18 23:55:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635181905186816 [0;39m <==    Updates: 0
2022-08-18 23:55:55.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635181905186816 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:56:00.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635202872512512 [0;39m 生成今日电子书快照开始
2022-08-18 23:56:00.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635202872512512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:56:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635202872512512 [0;39m ==> Parameters: 
2022-08-18 23:56:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635202872512512 [0;39m <==    Updates: 0
2022-08-18 23:56:00.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635202872512512 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:56:05.009 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17635223835643904 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:56:05.009 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635223835643904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:56:05.010 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635223835643904 [0;39m ==> Parameters: 
2022-08-18 23:56:05.011 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635223835643904 [0;39m <==    Updates: 7
2022-08-18 23:56:05.011 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17635223835643904 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:56:05.011 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635223844032512 [0;39m 生成今日电子书快照开始
2022-08-18 23:56:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635223844032512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:56:05.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635223844032512 [0;39m ==> Parameters: 
2022-08-18 23:56:05.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635223844032512 [0;39m <==    Updates: 0
2022-08-18 23:56:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635223844032512 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:56:10.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635244828135424 [0;39m 生成今日电子书快照开始
2022-08-18 23:56:10.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635244828135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:56:10.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635244828135424 [0;39m ==> Parameters: 
2022-08-18 23:56:10.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635244828135424 [0;39m <==    Updates: 0
2022-08-18 23:56:10.017 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635244828135424 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:56:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635265753518080 [0;39m 生成今日电子书快照开始
2022-08-18 23:56:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635265753518080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:56:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635265753518080 [0;39m ==> Parameters: 
2022-08-18 23:56:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635265753518080 [0;39m <==    Updates: 0
2022-08-18 23:56:15.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635265753518080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:56:20.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635286733426688 [0;39m 生成今日电子书快照开始
2022-08-18 23:56:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635286733426688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:56:20.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635286733426688 [0;39m ==> Parameters: 
2022-08-18 23:56:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635286733426688 [0;39m <==    Updates: 0
2022-08-18 23:56:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635286733426688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:56:25.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635307717529600 [0;39m 生成今日电子书快照开始
2022-08-18 23:56:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635307717529600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:56:25.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635307717529600 [0;39m ==> Parameters: 
2022-08-18 23:56:25.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635307717529600 [0;39m <==    Updates: 0
2022-08-18 23:56:25.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635307717529600 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:56:30.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635328710021120 [0;39m 生成今日电子书快照开始
2022-08-18 23:56:30.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635328710021120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:56:30.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635328710021120 [0;39m ==> Parameters: 
2022-08-18 23:56:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635328710021120 [0;39m <==    Updates: 0
2022-08-18 23:56:30.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635328710021120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:56:35.011 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17635349673152512 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:56:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635349673152512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:56:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635349673152512 [0;39m ==> Parameters: 
2022-08-18 23:56:35.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635349673152512 [0;39m <==    Updates: 7
2022-08-18 23:56:35.015 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17635349673152512 [0;39m 更新电子书下的文档数据结束，耗时：4 毫秒
2022-08-18 23:56:35.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635349689929728 [0;39m 生成今日电子书快照开始
2022-08-18 23:56:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635349689929728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:56:35.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635349689929728 [0;39m ==> Parameters: 
2022-08-18 23:56:35.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635349689929728 [0;39m <==    Updates: 0
2022-08-18 23:56:35.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635349689929728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:56:40.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635370653061120 [0;39m 生成今日电子书快照开始
2022-08-18 23:56:40.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635370653061120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:56:40.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635370653061120 [0;39m ==> Parameters: 
2022-08-18 23:56:40.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635370653061120 [0;39m <==    Updates: 0
2022-08-18 23:56:40.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635370653061120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:56:45.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635391620386816 [0;39m 生成今日电子书快照开始
2022-08-18 23:56:45.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635391620386816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:56:45.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635391620386816 [0;39m ==> Parameters: 
2022-08-18 23:56:45.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635391620386816 [0;39m <==    Updates: 0
2022-08-18 23:56:45.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635391620386816 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:56:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635412596101120 [0;39m 生成今日电子书快照开始
2022-08-18 23:56:50.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635412596101120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:56:50.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635412596101120 [0;39m ==> Parameters: 
2022-08-18 23:56:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635412596101120 [0;39m <==    Updates: 0
2022-08-18 23:56:50.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635412596101120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:56:55.002 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635433521483776 [0;39m 生成今日电子书快照开始
2022-08-18 23:56:55.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635433521483776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:56:55.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635433521483776 [0;39m ==> Parameters: 
2022-08-18 23:56:55.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635433521483776 [0;39m <==    Updates: 0
2022-08-18 23:56:55.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635433521483776 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:57:00.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635454497198080 [0;39m 生成今日电子书快照开始
2022-08-18 23:57:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635454497198080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:57:00.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635454497198080 [0;39m ==> Parameters: 
2022-08-18 23:57:00.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635454497198080 [0;39m <==    Updates: 0
2022-08-18 23:57:00.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635454497198080 [0;39m 生成今日电子书快照结束，耗时：7 毫秒
2022-08-18 23:57:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635475514855424 [0;39m 生成今日电子书快照开始
2022-08-18 23:57:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635475514855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:57:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635475514855424 [0;39m ==> Parameters: 
2022-08-18 23:57:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635475514855424 [0;39m <==    Updates: 0
2022-08-18 23:57:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635475514855424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:57:05.016 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17635475523244032 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:57:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635475523244032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:57:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635475523244032 [0;39m ==> Parameters: 
2022-08-18 23:57:05.017 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635475523244032 [0;39m <==    Updates: 7
2022-08-18 23:57:05.018 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17635475523244032 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:57:10.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635496469598208 [0;39m 生成今日电子书快照开始
2022-08-18 23:57:10.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635496469598208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:57:10.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635496469598208 [0;39m ==> Parameters: 
2022-08-18 23:57:10.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635496469598208 [0;39m <==    Updates: 0
2022-08-18 23:57:10.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635496469598208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:57:15.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635517411758080 [0;39m 生成今日电子书快照开始
2022-08-18 23:57:15.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635517411758080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:57:15.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635517411758080 [0;39m ==> Parameters: 
2022-08-18 23:57:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635517411758080 [0;39m <==    Updates: 0
2022-08-18 23:57:15.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635517411758080 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:57:20.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635538425221120 [0;39m 生成今日电子书快照开始
2022-08-18 23:57:20.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635538425221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:57:20.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635538425221120 [0;39m ==> Parameters: 
2022-08-18 23:57:20.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635538425221120 [0;39m <==    Updates: 0
2022-08-18 23:57:20.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635538425221120 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:57:25.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635559358992384 [0;39m 生成今日电子书快照开始
2022-08-18 23:57:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635559358992384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:57:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635559358992384 [0;39m ==> Parameters: 
2022-08-18 23:57:25.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635559358992384 [0;39m <==    Updates: 0
2022-08-18 23:57:25.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635559358992384 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:57:30.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635580317929472 [0;39m 生成今日电子书快照开始
2022-08-18 23:57:30.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635580317929472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:57:30.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635580317929472 [0;39m ==> Parameters: 
2022-08-18 23:57:30.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635580317929472 [0;39m <==    Updates: 0
2022-08-18 23:57:30.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635580317929472 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:57:35.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635601289449472 [0;39m 生成今日电子书快照开始
2022-08-18 23:57:35.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635601289449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:57:35.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635601289449472 [0;39m ==> Parameters: 
2022-08-18 23:57:35.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635601289449472 [0;39m <==    Updates: 0
2022-08-18 23:57:35.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635601289449472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:57:35.003 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17635601297838080 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:57:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635601297838080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:57:35.004 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635601297838080 [0;39m ==> Parameters: 
2022-08-18 23:57:35.005 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635601297838080 [0;39m <==    Updates: 7
2022-08-18 23:57:35.005 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17635601297838080 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:57:40.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635622260969472 [0;39m 生成今日电子书快照开始
2022-08-18 23:57:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635622260969472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:57:40.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635622260969472 [0;39m ==> Parameters: 
2022-08-18 23:57:40.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635622260969472 [0;39m <==    Updates: 0
2022-08-18 23:57:40.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635622260969472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:57:45.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635643240878080 [0;39m 生成今日电子书快照开始
2022-08-18 23:57:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635643240878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:57:45.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635643240878080 [0;39m ==> Parameters: 
2022-08-18 23:57:45.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635643240878080 [0;39m <==    Updates: 0
2022-08-18 23:57:45.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635643240878080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:57:50.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635664229175296 [0;39m 生成今日电子书快照开始
2022-08-18 23:57:50.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635664229175296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:57:50.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635664229175296 [0;39m ==> Parameters: 
2022-08-18 23:57:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635664229175296 [0;39m <==    Updates: 0
2022-08-18 23:57:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635664229175296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:57:55.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635685192306688 [0;39m 生成今日电子书快照开始
2022-08-18 23:57:55.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635685192306688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:57:55.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635685192306688 [0;39m ==> Parameters: 
2022-08-18 23:57:55.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635685192306688 [0;39m <==    Updates: 0
2022-08-18 23:57:55.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635685192306688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:58:00.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635706147049472 [0;39m 生成今日电子书快照开始
2022-08-18 23:58:00.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635706147049472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:58:00.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635706147049472 [0;39m ==> Parameters: 
2022-08-18 23:58:00.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635706147049472 [0;39m <==    Updates: 0
2022-08-18 23:58:00.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635706147049472 [0;39m 生成今日电子书快照结束，耗时：6 毫秒
2022-08-18 23:58:05.013 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17635727168901120 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:58:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635727168901120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:58:05.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635727168901120 [0;39m ==> Parameters: 
2022-08-18 23:58:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635727168901120 [0;39m <==    Updates: 7
2022-08-18 23:58:05.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17635727168901120 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:58:05.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635727173095424 [0;39m 生成今日电子书快照开始
2022-08-18 23:58:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635727173095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:58:05.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635727173095424 [0;39m ==> Parameters: 
2022-08-18 23:58:05.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635727173095424 [0;39m <==    Updates: 0
2022-08-18 23:58:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635727173095424 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:58:10.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635748106866688 [0;39m 生成今日电子书快照开始
2022-08-18 23:58:10.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635748106866688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:58:10.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635748106866688 [0;39m ==> Parameters: 
2022-08-18 23:58:10.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635748106866688 [0;39m <==    Updates: 0
2022-08-18 23:58:10.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635748106866688 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:58:15.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635769082580992 [0;39m 生成今日电子书快照开始
2022-08-18 23:58:15.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635769082580992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:58:15.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635769082580992 [0;39m ==> Parameters: 
2022-08-18 23:58:15.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635769082580992 [0;39m <==    Updates: 0
2022-08-18 23:58:15.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635769082580992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:58:20.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635790033129472 [0;39m 生成今日电子书快照开始
2022-08-18 23:58:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635790033129472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:58:20.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635790033129472 [0;39m ==> Parameters: 
2022-08-18 23:58:20.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635790033129472 [0;39m <==    Updates: 0
2022-08-18 23:58:20.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635790033129472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:58:25.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635811013038080 [0;39m 生成今日电子书快照开始
2022-08-18 23:58:25.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635811013038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:58:25.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635811013038080 [0;39m ==> Parameters: 
2022-08-18 23:58:25.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635811013038080 [0;39m <==    Updates: 0
2022-08-18 23:58:25.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635811013038080 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:58:30.015 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635832034889728 [0;39m 生成今日电子书快照开始
2022-08-18 23:58:30.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635832034889728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:58:30.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635832034889728 [0;39m ==> Parameters: 
2022-08-18 23:58:30.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635832034889728 [0;39m <==    Updates: 0
2022-08-18 23:58:30.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635832034889728 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:58:35.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635852981243904 [0;39m 生成今日电子书快照开始
2022-08-18 23:58:35.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635852981243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:58:35.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635852981243904 [0;39m ==> Parameters: 
2022-08-18 23:58:35.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635852981243904 [0;39m <==    Updates: 0
2022-08-18 23:58:35.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635852981243904 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:58:35.012 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17635852993826816 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:58:35.012 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635852993826816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:58:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635852993826816 [0;39m ==> Parameters: 
2022-08-18 23:58:35.013 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635852993826816 [0;39m <==    Updates: 7
2022-08-18 23:58:35.014 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17635852993826816 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:58:40.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635873931792384 [0;39m 生成今日电子书快照开始
2022-08-18 23:58:40.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635873931792384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:58:40.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635873931792384 [0;39m ==> Parameters: 
2022-08-18 23:58:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635873931792384 [0;39m <==    Updates: 0
2022-08-18 23:58:40.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635873931792384 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:58:45.000 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635894886535168 [0;39m 生成今日电子书快照开始
2022-08-18 23:58:45.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635894886535168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:58:45.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635894886535168 [0;39m ==> Parameters: 
2022-08-18 23:58:45.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635894886535168 [0;39m <==    Updates: 0
2022-08-18 23:58:45.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635894886535168 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:58:50.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635915916775424 [0;39m 生成今日电子书快照开始
2022-08-18 23:58:50.015 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635915916775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:58:50.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635915916775424 [0;39m ==> Parameters: 
2022-08-18 23:58:50.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635915916775424 [0;39m <==    Updates: 0
2022-08-18 23:58:50.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635915916775424 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:58:55.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635936896684032 [0;39m 生成今日电子书快照开始
2022-08-18 23:58:55.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635936896684032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:58:55.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635936896684032 [0;39m ==> Parameters: 
2022-08-18 23:58:55.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635936896684032 [0;39m <==    Updates: 0
2022-08-18 23:58:55.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635936896684032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:59:00.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635957851426816 [0;39m 生成今日电子书快照开始
2022-08-18 23:59:00.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635957851426816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:59:00.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635957851426816 [0;39m ==> Parameters: 
2022-08-18 23:59:00.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635957851426816 [0;39m <==    Updates: 0
2022-08-18 23:59:00.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635957851426816 [0;39m 生成今日电子书快照结束，耗时：4 毫秒
2022-08-18 23:59:05.014 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17635978831335424 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:59:05.014 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635978831335424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:59:05.015 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635978831335424 [0;39m ==> Parameters: 
2022-08-18 23:59:05.016 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17635978831335424 [0;39m <==    Updates: 7
2022-08-18 23:59:05.016 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17635978831335424 [0;39m 更新电子书下的文档数据结束，耗时：2 毫秒
2022-08-18 23:59:05.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635978839724032 [0;39m 生成今日电子书快照开始
2022-08-18 23:59:05.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635978839724032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:59:05.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635978839724032 [0;39m ==> Parameters: 
2022-08-18 23:59:05.019 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635978839724032 [0;39m <==    Updates: 0
2022-08-18 23:59:05.019 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635978839724032 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:59:10.001 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17635999748329472 [0;39m 生成今日电子书快照开始
2022-08-18 23:59:10.001 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635999748329472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:59:10.002 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635999748329472 [0;39m ==> Parameters: 
2022-08-18 23:59:10.003 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17635999748329472 [0;39m <==    Updates: 0
2022-08-18 23:59:10.003 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17635999748329472 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:59:15.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17636020757598208 [0;39m 生成今日电子书快照开始
2022-08-18 23:59:15.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636020757598208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:59:15.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636020757598208 [0;39m ==> Parameters: 
2022-08-18 23:59:15.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636020757598208 [0;39m <==    Updates: 0
2022-08-18 23:59:15.012 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17636020757598208 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:59:20.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17636041716535296 [0;39m 生成今日电子书快照开始
2022-08-18 23:59:20.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636041716535296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:59:20.008 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636041716535296 [0;39m ==> Parameters: 
2022-08-18 23:59:20.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636041716535296 [0;39m <==    Updates: 0
2022-08-18 23:59:20.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17636041716535296 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:59:25.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17636062683860992 [0;39m 生成今日电子书快照开始
2022-08-18 23:59:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636062683860992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:59:25.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636062683860992 [0;39m ==> Parameters: 
2022-08-18 23:59:25.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636062683860992 [0;39m <==    Updates: 0
2022-08-18 23:59:25.007 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17636062683860992 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:59:30.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17636083655380992 [0;39m 生成今日电子书快照开始
2022-08-18 23:59:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636083655380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:59:30.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636083655380992 [0;39m ==> Parameters: 
2022-08-18 23:59:30.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636083655380992 [0;39m <==    Updates: 0
2022-08-18 23:59:30.008 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17636083655380992 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:59:35.002 INFO  com.zs.wikibb.job.DocJob                          :32  
                [32m17636104610123776 [0;39m 更新电子书下的文档数据开始
2022-08-18 23:59:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17636104610123776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-08-18 23:59:35.002 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17636104610123776 [0;39m ==> Parameters: 
2022-08-18 23:59:35.003 DEBUG com.zs.wikibb.mapper.DocMapperCust.updateEbookInfo:137 
                [32m17636104610123776 [0;39m <==    Updates: 7
2022-08-18 23:59:35.003 INFO  com.zs.wikibb.job.DocJob                          :35  
                [32m17636104610123776 [0;39m 更新电子书下的文档数据结束，耗时：1 毫秒
2022-08-18 23:59:35.004 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17636104618512384 [0;39m 生成今日电子书快照开始
2022-08-18 23:59:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636104618512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:59:35.004 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636104618512384 [0;39m ==> Parameters: 
2022-08-18 23:59:35.005 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636104618512384 [0;39m <==    Updates: 0
2022-08-18 23:59:35.005 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17636104618512384 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
2022-08-18 23:59:40.006 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17636125598420992 [0;39m 生成今日电子书快照开始
2022-08-18 23:59:40.006 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636125598420992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:59:40.007 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636125598420992 [0;39m ==> Parameters: 
2022-08-18 23:59:40.009 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636125598420992 [0;39m <==    Updates: 0
2022-08-18 23:59:40.009 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17636125598420992 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:59:45.016 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17636146611884032 [0;39m 生成今日电子书快照开始
2022-08-18 23:59:45.016 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636146611884032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:59:45.017 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636146611884032 [0;39m ==> Parameters: 
2022-08-18 23:59:45.018 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636146611884032 [0;39m <==    Updates: 0
2022-08-18 23:59:45.018 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17636146611884032 [0;39m 生成今日电子书快照结束，耗时：2 毫秒
2022-08-18 23:59:50.010 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17636167558238208 [0;39m 生成今日电子书快照开始
2022-08-18 23:59:50.010 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636167558238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:59:50.011 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636167558238208 [0;39m ==> Parameters: 
2022-08-18 23:59:50.012 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636167558238208 [0;39m <==    Updates: 0
2022-08-18 23:59:50.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17636167558238208 [0;39m 生成今日电子书快照结束，耗时：3 毫秒
2022-08-18 23:59:55.013 INFO  com.zs.wikibb.job.EbookSnapshotJob                :32  
                [32m17636188542341120 [0;39m 生成今日电子书快照开始
2022-08-18 23:59:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636188542341120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1,ebook t2 set t1.view_count=t2.view_count, t1.vote_count=t2.vote_count where t1.`date`=curdate() and t1.ebook_id=t2.id; update ebook_snapshot t1 left join (select ebook_id,view_count,vote_count from ebook_snapshot where `date`=date_sub(curdate(), interval 1 day )) t2 on t1.ebook_id=t2.ebook_id set t1.view_increase=(t1.view_count- ifnull(t2.view_count, 0)), t1.vote_increase=t1.vote_count- ifnull(t2.vote_count, 0) where t1.`date`=curdate();
2022-08-18 23:59:55.013 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636188542341120 [0;39m ==> Parameters: 
2022-08-18 23:59:55.014 DEBUG c.z.w.mapper.EbookSnapshotMapperCust.genSnapshot  :137 
                [32m17636188542341120 [0;39m <==    Updates: 0
2022-08-18 23:59:55.014 INFO  com.zs.wikibb.job.EbookSnapshotJob                :35  
                [32m17636188542341120 [0;39m 生成今日电子书快照结束，耗时：1 毫秒
